const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-TtmnPN12.js","assets/vendor-icons-B6HpBdFH.js","assets/vendor-react-DwPMHwnM.js","assets/index-BNfydcti.css"])))=>i.map(i=>d[i]);
import{j as e,a as r,c as l,i as u,s as z,B as b,t as B,_ as F,e as P,J as n}from"./index-TtmnPN12.js";import{a as i,a0 as k,a1 as _,T as E}from"./vendor-icons-B6HpBdFH.js";import{M as T,a as A}from"./ModalBase-BgtxHV_N.js";import{I as D}from"./ImageCropEditor-DFvxRXQs.js";import"./vendor-react-DwPMHwnM.js";const W=i.memo(function({images:G,currentImage:C,itemId:x,onSelect:c,onClose:f}){const[o,I]=i.useState(null),[g,p]=i.useState(null),[a,h]=i.useState(!1),[y,d]=i.useState(null),j=i.useRef(null),v=i.useRef(null),R=t=>{const s=t.target.files?.[0];if(s){if(s.size>5*1024*1024){d("Image must be smaller than 5MB");return}if(!s.type.startsWith("image/")){d("Please select an image file");return}d(null),v.current=s;const m=new FileReader;m.onload=w=>p(w.target.result),m.readAsDataURL(s)}t.target&&(t.target.value="")},S=t=>{I(t),p(null)},M=()=>{p(null)},U=async()=>{if(o){h(!0),d(null);try{const{storageService:t}=await F(async()=>{const{storageService:s}=await import("./index-TtmnPN12.js").then(m=>m.a8);return{storageService:s}},__vite__mapDeps([0,1,2,3]));if(!x)c(o);else{const s=await t.uploadFromDataUrl(o,x);c(s.url)}}catch(t){P("Image upload error:",t),d(t.message||"Failed to upload image"),c(o)}finally{h(!1)}}};return e.jsxs(T,{onClose:f,maxWidth:500,children:[e.jsx(A,{title:"Select Image",onClose:f}),e.jsxs("div",{style:{padding:g?0:r[4]},children:[y&&e.jsx("div",{style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:u.md,padding:r[3],margin:g?r[4]:0,marginBottom:r[4],fontSize:"14px",color:l.danger},children:y}),g?e.jsx(D,{imageSrc:g,onCropComplete:S,onCancel:M,outputSize:600,cropShape:"square",title:"Crop your image"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{onClick:()=>!a&&j.current?.click(),style:{border:`2px dashed ${l.border}`,borderRadius:u.lg,padding:r[6],textAlign:"center",cursor:a?"not-allowed":"pointer",marginBottom:r[4],opacity:a?.6:1},children:[e.jsx(k,{size:32,color:l.textMuted,style:{marginBottom:r[2]}}),e.jsx("p",{style:{color:l.textMuted,margin:0},children:a?"Uploading...":"Click to upload an image"}),e.jsx("p",{style:{color:l.textMuted,margin:"8px 0 0",fontSize:"12px"},children:"Max size: 5MB. Formats: JPG, PNG, WebP, GIF"}),e.jsx("input",{ref:j,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",onChange:R,style:{display:"none"},disabled:a})]}),o&&e.jsxs("div",{style:{marginBottom:r[4]},children:[e.jsx("p",{style:{...z.label,marginBottom:r[2]},children:"Preview"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:r[3]},children:[e.jsx("img",{src:o,alt:"Preview",style:{width:80,height:80,objectFit:"cover",borderRadius:u.md}}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:r[2]},children:[e.jsx(b,{onClick:U,icon:a?null:_,disabled:a,children:a?"Uploading...":"Use This Image"}),e.jsx("button",{onClick:()=>p(o),style:{background:"none",border:"none",color:l.primary,cursor:"pointer",fontSize:B.fontSize.sm,textAlign:"left"},children:"Resize / Crop again"})]})]})]}),C&&e.jsx(b,{variant:"secondary",danger:!0,fullWidth:!0,onClick:()=>c(null),icon:E,disabled:a,children:"Remove Current Image"})]})]})]})});W.propTypes={images:n.arrayOf(n.string),currentImage:n.string,itemId:n.string,onSelect:n.func.isRequired,onClose:n.func.isRequired};export{W as ImageSelectorModal};
//# sourceMappingURL=ImageSelectorModal-BOvdi9FA.js.map
