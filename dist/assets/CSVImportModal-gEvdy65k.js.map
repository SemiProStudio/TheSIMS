{"version":3,"file":"CSVImportModal-gEvdy65k.js","sources":["../../modals/CSVImportModal.jsx"],"sourcesContent":["// ============================================================================\n// CSV Import Modal\n// Import inventory items from CSV file with template download\n// ============================================================================\n\nimport React, { memo, useState, useRef } from 'react';\nimport PropTypes from 'prop-types';\nimport { Upload, Download } from 'lucide-react';\nimport { colors, styles, spacing, borderRadius, typography, withOpacity } from '../theme.js';\nimport { Button } from '../components/ui.jsx';\nimport { Modal, ModalHeader } from './ModalBase.jsx';\n\nexport const CSVImportModal = memo(function CSVImportModal({ categories, specs, onImport, onClose }) {\n  const [file, setFile] = useState(null);\n  const [preview, setPreview] = useState(null);\n  const [error, setError] = useState(null);\n  const [importing, setImporting] = useState(false);\n  const [mapping, setMapping] = useState({});\n  const fileInputRef = useRef(null);\n  \n  // CSV column definitions\n  const requiredColumns = ['name', 'category'];\n  const optionalColumns = ['brand', 'status', 'condition', 'location', 'purchaseDate', 'purchasePrice', 'currentValue', 'serialNumber', 'notes'];\n  const allColumns = [...requiredColumns, ...optionalColumns];\n  \n  // Generate CSV template\n  const downloadTemplate = () => {\n    const headers = ['name', 'brand', 'category', 'status', 'condition', 'location', 'purchaseDate', 'purchasePrice', 'currentValue', 'serialNumber', 'notes'];\n    \n    // Add spec columns for each category\n    const specColumns = [];\n    Object.entries(specs).forEach(([category, specList]) => {\n      if (Array.isArray(specList)) {\n        specList.forEach(spec => {\n          const colName = `spec:${spec.name}`;\n          if (!specColumns.includes(colName)) {\n            specColumns.push(colName);\n          }\n        });\n      }\n    });\n    \n    const allHeaders = [...headers, ...specColumns];\n    \n    // Example rows\n    const exampleRows = [\n      ['Sony A7S III', 'Sony', 'Cameras', 'available', 'excellent', 'Studio A - Shelf 1', '2023-06-15', '3498', '2800', 'SN-A7S3-001', 'Great condition'],\n      ['Canon RF 24-70mm f/2.8', 'Canon', 'Lenses', 'available', 'good', 'Lens Cabinet', '2023-03-20', '2399', '2100', 'SN-RF2470-002', ''],\n      ['Aputure 600d Pro', 'Aputure', 'Lighting', 'checked-out', 'excellent', 'Lighting Storage', '2023-01-10', '1699', '1400', 'SN-600D-003', '']\n    ];\n    \n    // Pad example rows to match header count\n    const paddedRows = exampleRows.map(row => {\n      while (row.length < allHeaders.length) row.push('');\n      return row;\n    });\n    \n    const csvContent = [\n      allHeaders.join(','),\n      ...paddedRows.map(row => row.map(cell => \n        cell.includes(',') || cell.includes('\"') ? `\"${cell.replace(/\"/g, '\"\"')}\"` : cell\n      ).join(','))\n    ].join('\\n');\n    \n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = 'sims-import-template.csv';\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n  \n  // Parse CSV file\n  const parseCSV = (text) => {\n    const lines = text.split(/\\r?\\n/).filter(line => line.trim());\n    if (lines.length < 2) {\n      throw new Error('CSV file must have a header row and at least one data row');\n    }\n    \n    // Parse header\n    const headers = parseCSVLine(lines[0]);\n    \n    // Check for required columns\n    const missingRequired = requiredColumns.filter(col => \n      !headers.some(h => h.toLowerCase() === col.toLowerCase())\n    );\n    if (missingRequired.length > 0) {\n      throw new Error(`Missing required columns: ${missingRequired.join(', ')}`);\n    }\n    \n    // Parse data rows\n    const rows = [];\n    for (let i = 1; i < lines.length; i++) {\n      const values = parseCSVLine(lines[i]);\n      if (values.length === 0 || values.every(v => !v.trim())) continue;\n      \n      const row = {};\n      headers.forEach((header, idx) => {\n        row[header.toLowerCase()] = values[idx] || '';\n      });\n      rows.push(row);\n    }\n    \n    return { headers, rows };\n  };\n  \n  // Parse a single CSV line handling quotes\n  const parseCSVLine = (line) => {\n    const result = [];\n    let current = '';\n    let inQuotes = false;\n    \n    for (let i = 0; i < line.length; i++) {\n      const char = line[i];\n      const nextChar = line[i + 1];\n      \n      if (inQuotes) {\n        if (char === '\"' && nextChar === '\"') {\n          current += '\"';\n          i++;\n        } else if (char === '\"') {\n          inQuotes = false;\n        } else {\n          current += char;\n        }\n      } else {\n        if (char === '\"') {\n          inQuotes = true;\n        } else if (char === ',') {\n          result.push(current.trim());\n          current = '';\n        } else {\n          current += char;\n        }\n      }\n    }\n    result.push(current.trim());\n    \n    return result;\n  };\n  \n  // Handle file selection\n  const handleFileChange = async (e) => {\n    const selectedFile = e.target.files?.[0];\n    if (!selectedFile) return;\n    \n    setFile(selectedFile);\n    setError(null);\n    setPreview(null);\n    \n    try {\n      const text = await selectedFile.text();\n      const parsed = parseCSV(text);\n      setPreview(parsed);\n      \n      // Auto-map columns\n      const autoMapping = {};\n      parsed.headers.forEach(header => {\n        const lower = header.toLowerCase();\n        if (allColumns.includes(lower)) {\n          autoMapping[header] = lower;\n        } else if (lower.startsWith('spec:')) {\n          autoMapping[header] = header;\n        }\n      });\n      setMapping(autoMapping);\n    } catch (err) {\n      setError(err.message);\n    }\n  };\n  \n  // Validate and import\n  const handleImport = async () => {\n    if (!preview) return;\n    \n    setImporting(true);\n    setError(null);\n    \n    try {\n      const items = [];\n      const errors = [];\n      \n      preview.rows.forEach((row, idx) => {\n        // Validate required fields\n        if (!row.name?.trim()) {\n          errors.push(`Row ${idx + 2}: Missing name`);\n          return;\n        }\n        if (!row.category?.trim()) {\n          errors.push(`Row ${idx + 2}: Missing category`);\n          return;\n        }\n        if (!categories.includes(row.category)) {\n          errors.push(`Row ${idx + 2}: Unknown category \"${row.category}\"`);\n          return;\n        }\n        \n        // Build item object\n        const item = {\n          name: row.name.trim(),\n          brand: row.brand?.trim() || '',\n          category: row.category.trim(),\n          status: row.status?.trim() || 'available',\n          condition: row.condition?.trim() || 'excellent',\n          location: row.location?.trim() || '',\n          purchaseDate: row.purchasedate?.trim() || row.purchaseDate?.trim() || '',\n          purchasePrice: parseFloat(row.purchaseprice || row.purchasePrice) || 0,\n          currentValue: parseFloat(row.currentvalue || row.currentValue) || 0,\n          serialNumber: row.serialnumber?.trim() || row.serialNumber?.trim() || '',\n          notes: row.notes?.trim() ? [{ \n            id: `imported_${Date.now()}_${idx}`, \n            user: 'Import', \n            date: new Date().toISOString().split('T')[0], \n            text: row.notes.trim(),\n            replies: [],\n            deleted: false \n          }] : [],\n          specs: {},\n          reservations: [],\n          reminders: [],\n          viewCount: 0,\n          checkoutCount: 0\n        };\n        \n        // Extract specs from spec: columns\n        Object.entries(row).forEach(([key, value]) => {\n          if (key.startsWith('spec:') && value?.trim()) {\n            const specName = key.substring(5);\n            item.specs[specName] = value.trim();\n          }\n        });\n        \n        items.push(item);\n      });\n      \n      if (errors.length > 0) {\n        setError(`Import errors:\\n${errors.slice(0, 5).join('\\n')}${errors.length > 5 ? `\\n... and ${errors.length - 5} more` : ''}`);\n        setImporting(false);\n        return;\n      }\n      \n      // Call import handler\n      await onImport(items);\n      onClose();\n    } catch (err) {\n      setError(err.message || 'Import failed');\n    } finally {\n      setImporting(false);\n    }\n  };\n  \n  return (\n    <Modal onClose={onClose} maxWidth={600}>\n      <ModalHeader title=\"Import from CSV\" onClose={onClose} />\n      <div style={{ padding: spacing[4] }}>\n        \n        {/* Template download */}\n        <div style={{\n          background: `${withOpacity(colors.primary, 10)}`,\n          borderRadius: borderRadius.lg,\n          padding: spacing[4],\n          marginBottom: spacing[4]\n        }}>\n          <h4 style={{ margin: `0 0 ${spacing[2]}px`, color: colors.textPrimary, fontSize: typography.fontSize.base }}>\n            Need a template?\n          </h4>\n          <p style={{ color: colors.textSecondary, fontSize: typography.fontSize.sm, marginBottom: spacing[3] }}>\n            Download our CSV template with all available columns and example data.\n          </p>\n          <Button variant=\"secondary\" onClick={downloadTemplate} icon={Download}>\n            Download Template\n          </Button>\n        </div>\n        \n        {/* File upload */}\n        <div \n          onClick={() => fileInputRef.current?.click()}\n          style={{\n            border: `2px dashed ${colors.border}`,\n            borderRadius: borderRadius.lg,\n            padding: spacing[6],\n            textAlign: 'center',\n            cursor: 'pointer',\n            marginBottom: spacing[4],\n            transition: 'border-color 0.2s',\n          }}\n        >\n          <Upload size={32} color={colors.textMuted} style={{ marginBottom: spacing[2] }} />\n          <p style={{ color: colors.textPrimary, margin: `0 0 ${spacing[1]}px` }}>\n            {file ? file.name : 'Click to select CSV file'}\n          </p>\n          <p style={{ color: colors.textMuted, margin: 0, fontSize: typography.fontSize.sm }}>\n            or drag and drop\n          </p>\n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            accept=\".csv,text/csv\"\n            onChange={handleFileChange}\n            style={{ display: 'none' }}\n          />\n        </div>\n        \n        {/* Error display */}\n        {error && (\n          <div style={{\n            background: `${withOpacity(colors.danger, 20)}`,\n            border: `1px solid ${withOpacity(colors.danger, 50)}`,\n            borderRadius: borderRadius.md,\n            padding: spacing[3],\n            marginBottom: spacing[4],\n            color: colors.danger,\n            fontSize: typography.fontSize.sm,\n            whiteSpace: 'pre-line'\n          }}>\n            {error}\n          </div>\n        )}\n        \n        {/* Preview */}\n        {preview && (\n          <div style={{ marginBottom: spacing[4] }}>\n            <h4 style={{ margin: `0 0 ${spacing[2]}px`, color: colors.textPrimary }}>\n              Preview ({preview.rows.length} items)\n            </h4>\n            <div style={{\n              background: colors.bgLight,\n              borderRadius: borderRadius.md,\n              maxHeight: 200,\n              overflowY: 'auto'\n            }}>\n              <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: typography.fontSize.sm }}>\n                <thead>\n                  <tr>\n                    {['name', 'brand', 'category', 'status'].map(col => (\n                      <th key={col} style={{\n                        textAlign: 'left',\n                        padding: spacing[2],\n                        borderBottom: `1px solid ${colors.border}`,\n                        color: colors.textMuted,\n                        fontWeight: typography.fontWeight.medium\n                      }}>\n                        {col}\n                      </th>\n                    ))}\n                  </tr>\n                </thead>\n                <tbody>\n                  {preview.rows.slice(0, 5).map((row, idx) => (\n                    <tr key={idx}>\n                      {['name', 'brand', 'category', 'status'].map(col => (\n                        <td key={col} style={{\n                          padding: spacing[2],\n                          borderBottom: `1px solid ${colors.borderLight}`,\n                          color: colors.textPrimary\n                        }}>\n                          {row[col] || '-'}\n                        </td>\n                      ))}\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n              {preview.rows.length > 5 && (\n                <p style={{\n                  color: colors.textMuted,\n                  fontSize: typography.fontSize.xs,\n                  textAlign: 'center',\n                  padding: spacing[2],\n                  margin: 0\n                }}>\n                  ... and {preview.rows.length - 5} more items\n                </p>\n              )}\n            </div>\n          </div>\n        )}\n        \n        {/* Action buttons */}\n        <div style={{ display: 'flex', gap: spacing[3], justifyContent: 'flex-end' }}>\n          <Button variant=\"secondary\" onClick={onClose}>Cancel</Button>\n          <Button \n            onClick={handleImport} \n            disabled={!preview || importing}\n            icon={importing ? null : Upload}\n          >\n            {importing ? 'Importing...' : `Import ${preview?.rows.length || 0} Items`}\n          </Button>\n        </div>\n      </div>\n    </Modal>\n  );\n});\n\n// ============================================================================\n// PropTypes\n// ============================================================================\nCSVImportModal.propTypes = {\n  /** Available categories for import */\n  categories: PropTypes.arrayOf(PropTypes.string).isRequired,\n  /** Spec configuration by category */\n  specs: PropTypes.objectOf(\n    PropTypes.arrayOf(PropTypes.shape({\n      name: PropTypes.string.isRequired,\n      required: PropTypes.bool,\n    }))\n  ),\n  /** Callback when import is confirmed with items array */\n  onImport: PropTypes.func.isRequired,\n  /** Callback to close modal */\n  onClose: PropTypes.func.isRequired,\n};\n"],"names":["CSVImportModal","memo","categories","specs","onImport","onClose","file","setFile","useState","preview","setPreview","error","setError","importing","setImporting","mapping","setMapping","fileInputRef","useRef","requiredColumns","optionalColumns","allColumns","downloadTemplate","headers","specColumns","category","specList","spec","colName","allHeaders","paddedRows","row","csvContent","cell","blob","url","a","parseCSV","text","lines","line","parseCSVLine","missingRequired","col","h","rows","i","values","v","header","idx","result","current","inQuotes","char","nextChar","handleFileChange","e","selectedFile","parsed","autoMapping","lower","err","handleImport","items","errors","item","key","value","specName","jsxs","Modal","jsx","ModalHeader","spacing","withOpacity","colors","borderRadius","typography","Button","Download","Upload","PropTypes"],"mappings":"mOAYO,MAAMA,EAAiBC,EAAAA,KAAK,SAAwB,CAAE,WAAAC,EAAY,MAAAC,EAAO,SAAAC,EAAU,QAAAC,GAAW,CACnG,KAAM,CAACC,EAAMC,CAAO,EAAIC,EAAAA,SAAS,IAAI,EAC/B,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,IAAI,EACrC,CAACG,EAAOC,CAAQ,EAAIJ,EAAAA,SAAS,IAAI,EACjC,CAACK,EAAWC,CAAY,EAAIN,EAAAA,SAAS,EAAK,EAC1C,CAACO,EAASC,CAAU,EAAIR,EAAAA,SAAS,CAAA,CAAE,EACnCS,EAAeC,EAAAA,OAAO,IAAI,EAG1BC,EAAkB,CAAC,OAAQ,UAAU,EACrCC,EAAkB,CAAC,QAAS,SAAU,YAAa,WAAY,eAAgB,gBAAiB,eAAgB,eAAgB,OAAO,EACvIC,EAAa,CAAC,GAAGF,EAAiB,GAAGC,CAAe,EAGpDE,EAAmB,IAAM,CAC7B,MAAMC,EAAU,CAAC,OAAQ,QAAS,WAAY,SAAU,YAAa,WAAY,eAAgB,gBAAiB,eAAgB,eAAgB,OAAO,EAGnJC,EAAc,CAAA,EACpB,OAAO,QAAQrB,CAAK,EAAE,QAAQ,CAAC,CAACsB,EAAUC,CAAQ,IAAM,CAClD,MAAM,QAAQA,CAAQ,GACxBA,EAAS,QAAQC,GAAQ,CACvB,MAAMC,EAAU,QAAQD,EAAK,IAAI,GAC5BH,EAAY,SAASI,CAAO,GAC/BJ,EAAY,KAAKI,CAAO,CAE5B,CAAC,CAEL,CAAC,EAED,MAAMC,EAAa,CAAC,GAAGN,EAAS,GAAGC,CAAW,EAUxCM,EAPc,CAClB,CAAC,eAAgB,OAAQ,UAAW,YAAa,YAAa,qBAAsB,aAAc,OAAQ,OAAQ,cAAe,iBAAiB,EAClJ,CAAC,yBAA0B,QAAS,SAAU,YAAa,OAAQ,eAAgB,aAAc,OAAQ,OAAQ,gBAAiB,EAAE,EACpI,CAAC,mBAAoB,UAAW,WAAY,cAAe,YAAa,mBAAoB,aAAc,OAAQ,OAAQ,cAAe,EAAE,CAAA,EAI9G,IAAIC,GAAO,CACxC,KAAOA,EAAI,OAASF,EAAW,QAAQE,EAAI,KAAK,EAAE,EAClD,OAAOA,CACT,CAAC,EAEKC,EAAa,CACjBH,EAAW,KAAK,GAAG,EACnB,GAAGC,EAAW,IAAIC,GAAOA,EAAI,IAAIE,GAC/BA,EAAK,SAAS,GAAG,GAAKA,EAAK,SAAS,GAAG,EAAI,IAAIA,EAAK,QAAQ,KAAM,IAAI,CAAC,IAAMA,CAAA,EAC7E,KAAK,GAAG,CAAC,CAAA,EACX,KAAK;AAAA,CAAI,EAELC,EAAO,IAAI,KAAK,CAACF,CAAU,EAAG,CAAE,KAAM,yBAA0B,EAChEG,EAAM,IAAI,gBAAgBD,CAAI,EAC9BE,EAAI,SAAS,cAAc,GAAG,EACpCA,EAAE,KAAOD,EACTC,EAAE,SAAW,2BACbA,EAAE,MAAA,EACF,IAAI,gBAAgBD,CAAG,CACzB,EAGME,EAAYC,GAAS,CACzB,MAAMC,EAAQD,EAAK,MAAM,OAAO,EAAE,OAAOE,GAAQA,EAAK,MAAM,EAC5D,GAAID,EAAM,OAAS,EACjB,MAAM,IAAI,MAAM,2DAA2D,EAI7E,MAAMhB,EAAUkB,EAAaF,EAAM,CAAC,CAAC,EAG/BG,EAAkBvB,EAAgB,OAAOwB,GAC7C,CAACpB,EAAQ,KAAKqB,GAAKA,EAAE,YAAA,IAAkBD,EAAI,YAAA,CAAa,CAAA,EAE1D,GAAID,EAAgB,OAAS,EAC3B,MAAM,IAAI,MAAM,6BAA6BA,EAAgB,KAAK,IAAI,CAAC,EAAE,EAI3E,MAAMG,EAAO,CAAA,EACb,QAASC,EAAI,EAAGA,EAAIP,EAAM,OAAQO,IAAK,CACrC,MAAMC,EAASN,EAAaF,EAAMO,CAAC,CAAC,EACpC,GAAIC,EAAO,SAAW,GAAKA,EAAO,SAAW,CAACC,EAAE,KAAA,CAAM,EAAG,SAEzD,MAAMjB,EAAM,CAAA,EACZR,EAAQ,QAAQ,CAAC0B,EAAQC,IAAQ,CAC/BnB,EAAIkB,EAAO,YAAA,CAAa,EAAIF,EAAOG,CAAG,GAAK,EAC7C,CAAC,EACDL,EAAK,KAAKd,CAAG,CACf,CAEA,MAAO,CAAE,QAAAR,EAAS,KAAAsB,CAAA,CACpB,EAGMJ,EAAgBD,GAAS,CAC7B,MAAMW,EAAS,CAAA,EACf,IAAIC,EAAU,GACVC,EAAW,GAEf,QAASP,EAAI,EAAGA,EAAIN,EAAK,OAAQM,IAAK,CACpC,MAAMQ,EAAOd,EAAKM,CAAC,EACbS,EAAWf,EAAKM,EAAI,CAAC,EAEvBO,EACEC,IAAS,KAAOC,IAAa,KAC/BH,GAAW,IACXN,KACSQ,IAAS,IAClBD,EAAW,GAEXD,GAAWE,EAGTA,IAAS,IACXD,EAAW,GACFC,IAAS,KAClBH,EAAO,KAAKC,EAAQ,MAAM,EAC1BA,EAAU,IAEVA,GAAWE,CAGjB,CACA,OAAAH,EAAO,KAAKC,EAAQ,MAAM,EAEnBD,CACT,EAGMK,EAAmB,MAAOC,GAAM,CACpC,MAAMC,EAAeD,EAAE,OAAO,QAAQ,CAAC,EACvC,GAAKC,EAEL,CAAAnD,EAAQmD,CAAY,EACpB9C,EAAS,IAAI,EACbF,EAAW,IAAI,EAEf,GAAI,CACF,MAAM4B,EAAO,MAAMoB,EAAa,KAAA,EAC1BC,EAAStB,EAASC,CAAI,EAC5B5B,EAAWiD,CAAM,EAGjB,MAAMC,EAAc,CAAA,EACpBD,EAAO,QAAQ,QAAQV,GAAU,CAC/B,MAAMY,EAAQZ,EAAO,YAAA,EACjB5B,EAAW,SAASwC,CAAK,EAC3BD,EAAYX,CAAM,EAAIY,EACbA,EAAM,WAAW,OAAO,IACjCD,EAAYX,CAAM,EAAIA,EAE1B,CAAC,EACDjC,EAAW4C,CAAW,CACxB,OAASE,EAAK,CACZlD,EAASkD,EAAI,OAAO,CACtB,EACF,EAGMC,EAAe,SAAY,CAC/B,GAAKtD,EAEL,CAAAK,EAAa,EAAI,EACjBF,EAAS,IAAI,EAEb,GAAI,CACF,MAAMoD,EAAQ,CAAA,EACRC,EAAS,CAAA,EAuDf,GArDAxD,EAAQ,KAAK,QAAQ,CAACsB,EAAKmB,IAAQ,CAEjC,GAAI,CAACnB,EAAI,MAAM,OAAQ,CACrBkC,EAAO,KAAK,OAAOf,EAAM,CAAC,gBAAgB,EAC1C,MACF,CACA,GAAI,CAACnB,EAAI,UAAU,OAAQ,CACzBkC,EAAO,KAAK,OAAOf,EAAM,CAAC,oBAAoB,EAC9C,MACF,CACA,GAAI,CAAChD,EAAW,SAAS6B,EAAI,QAAQ,EAAG,CACtCkC,EAAO,KAAK,OAAOf,EAAM,CAAC,uBAAuBnB,EAAI,QAAQ,GAAG,EAChE,MACF,CAGA,MAAMmC,EAAO,CACX,KAAMnC,EAAI,KAAK,KAAA,EACf,MAAOA,EAAI,OAAO,KAAA,GAAU,GAC5B,SAAUA,EAAI,SAAS,KAAA,EACvB,OAAQA,EAAI,QAAQ,KAAA,GAAU,YAC9B,UAAWA,EAAI,WAAW,KAAA,GAAU,YACpC,SAAUA,EAAI,UAAU,KAAA,GAAU,GAClC,aAAcA,EAAI,cAAc,KAAA,GAAUA,EAAI,cAAc,QAAU,GACtE,cAAe,WAAWA,EAAI,eAAiBA,EAAI,aAAa,GAAK,EACrE,aAAc,WAAWA,EAAI,cAAgBA,EAAI,YAAY,GAAK,EAClE,aAAcA,EAAI,cAAc,KAAA,GAAUA,EAAI,cAAc,QAAU,GACtE,MAAOA,EAAI,OAAO,KAAA,EAAS,CAAC,CAC1B,GAAI,YAAY,KAAK,IAAA,CAAK,IAAImB,CAAG,GACjC,KAAM,SACN,SAAU,OAAO,cAAc,MAAM,GAAG,EAAE,CAAC,EAC3C,KAAMnB,EAAI,MAAM,KAAA,EAChB,QAAS,CAAA,EACT,QAAS,EAAA,CACV,EAAI,CAAA,EACL,MAAO,CAAA,EACP,aAAc,CAAA,EACd,UAAW,CAAA,EACX,UAAW,EACX,cAAe,CAAA,EAIjB,OAAO,QAAQA,CAAG,EAAE,QAAQ,CAAC,CAACoC,EAAKC,CAAK,IAAM,CAC5C,GAAID,EAAI,WAAW,OAAO,GAAKC,GAAO,OAAQ,CAC5C,MAAMC,EAAWF,EAAI,UAAU,CAAC,EAChCD,EAAK,MAAMG,CAAQ,EAAID,EAAM,KAAA,CAC/B,CACF,CAAC,EAEDJ,EAAM,KAAKE,CAAI,CACjB,CAAC,EAEGD,EAAO,OAAS,EAAG,CACrBrD,EAAS;AAAA,EAAmBqD,EAAO,MAAM,EAAG,CAAC,EAAE,KAAK;AAAA,CAAI,CAAC,GAAGA,EAAO,OAAS,EAAI;AAAA,UAAaA,EAAO,OAAS,CAAC,QAAU,EAAE,EAAE,EAC5HnD,EAAa,EAAK,EAClB,MACF,CAGA,MAAMV,EAAS4D,CAAK,EACpB3D,EAAA,CACF,OAASyD,EAAK,CACZlD,EAASkD,EAAI,SAAW,eAAe,CACzC,QAAA,CACEhD,EAAa,EAAK,CACpB,EACF,EAEA,OACEwD,EAAAA,KAACC,EAAA,CAAM,QAAAlE,EAAkB,SAAU,IACjC,SAAA,CAAAmE,EAAAA,IAACC,EAAA,CAAY,MAAM,kBAAkB,QAAApE,CAAA,CAAkB,EACvDiE,OAAC,OAAI,MAAO,CAAE,QAASI,EAAQ,CAAC,GAG9B,SAAA,CAAAJ,OAAC,OAAI,MAAO,CACV,WAAY,GAAGK,EAAYC,EAAO,QAAS,EAAE,CAAC,GAC9C,aAAcC,EAAa,GAC3B,QAASH,EAAQ,CAAC,EAClB,aAAcA,EAAQ,CAAC,CAAA,EAEvB,SAAA,CAAAF,MAAC,MAAG,MAAO,CAAE,OAAQ,OAAOE,EAAQ,CAAC,CAAC,KAAM,MAAOE,EAAO,YAAa,SAAUE,EAAW,SAAS,IAAA,EAAQ,SAAA,mBAE7G,QACC,IAAA,CAAE,MAAO,CAAE,MAAOF,EAAO,cAAe,SAAUE,EAAW,SAAS,GAAI,aAAcJ,EAAQ,CAAC,GAAK,SAAA,yEAEvG,EACAF,EAAAA,IAACO,GAAO,QAAQ,YAAY,QAASzD,EAAkB,KAAM0D,EAAU,SAAA,mBAAA,CAEvE,CAAA,EACF,EAGAV,EAAAA,KAAC,MAAA,CACC,QAAS,IAAMrD,EAAa,SAAS,MAAA,EACrC,MAAO,CACL,OAAQ,cAAc2D,EAAO,MAAM,GACnC,aAAcC,EAAa,GAC3B,QAASH,EAAQ,CAAC,EAClB,UAAW,SACX,OAAQ,UACR,aAAcA,EAAQ,CAAC,EACvB,WAAY,mBAAA,EAGd,SAAA,CAAAF,EAAAA,IAACS,EAAA,CAAO,KAAM,GAAI,MAAOL,EAAO,UAAW,MAAO,CAAE,aAAcF,EAAQ,CAAC,CAAA,CAAE,CAAG,QAC/E,IAAA,CAAE,MAAO,CAAE,MAAOE,EAAO,YAAa,OAAQ,OAAOF,EAAQ,CAAC,CAAC,MAC7D,SAAApE,EAAOA,EAAK,KAAO,2BACtB,EACAkE,EAAAA,IAAC,IAAA,CAAE,MAAO,CAAE,MAAOI,EAAO,UAAW,OAAQ,EAAG,SAAUE,EAAW,SAAS,EAAA,EAAM,SAAA,mBAEpF,EACAN,EAAAA,IAAC,QAAA,CACC,IAAKvD,EACL,KAAK,OACL,OAAO,gBACP,SAAUuC,EACV,MAAO,CAAE,QAAS,MAAA,CAAO,CAAA,CAC3B,CAAA,CAAA,EAID7C,GACC6D,EAAAA,IAAC,MAAA,CAAI,MAAO,CACV,WAAY,GAAGG,EAAYC,EAAO,OAAQ,EAAE,CAAC,GAC7C,OAAQ,aAAaD,EAAYC,EAAO,OAAQ,EAAE,CAAC,GACnD,aAAcC,EAAa,GAC3B,QAASH,EAAQ,CAAC,EAClB,aAAcA,EAAQ,CAAC,EACvB,MAAOE,EAAO,OACd,SAAUE,EAAW,SAAS,GAC9B,WAAY,UAAA,EAEX,SAAAnE,EACH,EAIDF,UACE,MAAA,CAAI,MAAO,CAAE,aAAciE,EAAQ,CAAC,CAAA,EACnC,SAAA,CAAAJ,EAAAA,KAAC,KAAA,CAAG,MAAO,CAAE,OAAQ,OAAOI,EAAQ,CAAC,CAAC,KAAM,MAAOE,EAAO,WAAA,EAAe,SAAA,CAAA,YAC7DnE,EAAQ,KAAK,OAAO,SAAA,EAChC,EACA6D,OAAC,OAAI,MAAO,CACV,WAAYM,EAAO,QACnB,aAAcC,EAAa,GAC3B,UAAW,IACX,UAAW,MAAA,EAEX,SAAA,CAAAP,EAAAA,KAAC,QAAA,CAAM,MAAO,CAAE,MAAO,OAAQ,eAAgB,WAAY,SAAUQ,EAAW,SAAS,EAAA,EACvF,SAAA,CAAAN,EAAAA,IAAC,QAAA,CACC,SAAAA,EAAAA,IAAC,KAAA,CACE,SAAA,CAAC,OAAQ,QAAS,WAAY,QAAQ,EAAE,IAAI7B,GAC3C6B,MAAC,MAAa,MAAO,CACnB,UAAW,OACX,QAASE,EAAQ,CAAC,EAClB,aAAc,aAAaE,EAAO,MAAM,GACxC,MAAOA,EAAO,UACd,WAAYE,EAAW,WAAW,MAAA,EAEjC,SAAAnC,CAAA,EAPMA,CAQT,CACD,EACH,CAAA,CACF,EACA6B,EAAAA,IAAC,QAAA,CACE,SAAA/D,EAAQ,KAAK,MAAM,EAAG,CAAC,EAAE,IAAI,CAACsB,EAAKmB,UACjC,KAAA,CACE,SAAA,CAAC,OAAQ,QAAS,WAAY,QAAQ,EAAE,IAAIP,GAC3C6B,EAAAA,IAAC,KAAA,CAAa,MAAO,CACnB,QAASE,EAAQ,CAAC,EAClB,aAAc,aAAaE,EAAO,WAAW,GAC7C,MAAOA,EAAO,WAAA,EAEb,SAAA7C,EAAIY,CAAG,GAAK,KALNA,CAMT,CACD,CAAA,EATMO,CAUT,CACD,CAAA,CACH,CAAA,EACF,EACCzC,EAAQ,KAAK,OAAS,GACrB6D,EAAAA,KAAC,KAAE,MAAO,CACR,MAAOM,EAAO,UACd,SAAUE,EAAW,SAAS,GAC9B,UAAW,SACX,QAASJ,EAAQ,CAAC,EAClB,OAAQ,CAAA,EACP,SAAA,CAAA,WACQjE,EAAQ,KAAK,OAAS,EAAE,aAAA,CAAA,CACnC,CAAA,CAAA,CAEJ,CAAA,EACF,EAIF6D,EAAAA,KAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,IAAKI,EAAQ,CAAC,EAAG,eAAgB,UAAA,EAC9D,SAAA,CAAAF,MAACO,EAAA,CAAO,QAAQ,YAAY,QAAS1E,EAAS,SAAA,SAAM,EACpDmE,EAAAA,IAACO,EAAA,CACC,QAAShB,EACT,SAAU,CAACtD,GAAWI,EACtB,KAAMA,EAAY,KAAOoE,EAExB,WAAY,eAAiB,UAAUxE,GAAS,KAAK,QAAU,CAAC,QAAA,CAAA,CACnE,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EACF,CAEJ,CAAC,EAKDT,EAAe,UAAY,CAEzB,WAAYkF,EAAU,QAAQA,EAAU,MAAM,EAAE,WAEhD,MAAOA,EAAU,SACfA,EAAU,QAAQA,EAAU,MAAM,CAChC,KAAMA,EAAU,OAAO,WACvB,SAAUA,EAAU,IAAA,CACrB,CAAC,CAAA,EAGJ,SAAUA,EAAU,KAAK,WAEzB,QAASA,EAAU,KAAK,UAC1B"}