{"version":3,"file":"ClientsView-DulEZl16.js","sources":["../../views/ClientsView.jsx"],"sourcesContent":["// ============================================================================\n// Clients View - Client & Project Management (Phase 6)\n// ============================================================================\n\nimport React, { memo, useState, useCallback, useMemo, useEffect } from 'react';\nimport { \n  Users, Plus, Search, Building2, Mail, Phone, Calendar, \n  Package, ChevronRight, Edit2, Trash2, MapPin, FileText,\n  Clock, DollarSign, Star, MessageSquare, X\n} from 'lucide-react';\nimport { colors, styles, spacing, borderRadius, typography, withOpacity} from '../theme.js';\nimport { formatMoney } from '../utils.js';\nimport { Card, Button, SearchInput, Badge, ConfirmDialog, CollapsibleSection } from '../components/ui.jsx';\nimport { Select } from '../components/Select.jsx';\nimport NotesSection from '../components/NotesSection.jsx';\nimport { useData } from '../lib/DataContext.jsx';\n\nimport { error as logError } from '../lib/logger.js';\n\n// Client type options\nconst CLIENT_TYPES = ['Individual', 'Company', 'Agency', 'Non-Profit', 'Government', 'Other'];\n\n// ============================================================================\n// Client Card Component\n// ============================================================================\nconst ClientCard = memo(function ClientCard({ client, stats, onSelect }) {\n  return (\n    <Card \n      style={{ cursor: 'pointer', position: 'relative' }}\n      onClick={() => onSelect(client)}\n    >\n      <div style={{ display: 'flex', gap: spacing[3] }}>\n        {/* Avatar */}\n        <div style={{\n          width: 48, height: 48,\n          borderRadius: borderRadius.lg,\n          background: `${withOpacity(colors.primary, 20)}`,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          flexShrink: 0,\n        }}>\n          {client.type === 'Company' || client.type === 'Agency' ? (\n            <Building2 size={24} color={colors.primary} />\n          ) : (\n            <Users size={24} color={colors.primary} />\n          )}\n        </div>\n        \n        {/* Info */}\n        <div style={{ flex: 1, minWidth: 0 }}>\n          <div style={{ \n            display: 'flex', \n            alignItems: 'center', \n            gap: spacing[2],\n            marginBottom: spacing[1],\n          }}>\n            <span style={{ \n              fontWeight: typography.fontWeight.semibold, \n              color: colors.textPrimary,\n              overflow: 'hidden',\n              textOverflow: 'ellipsis',\n              whiteSpace: 'nowrap',\n            }}>\n              {client.name}\n            </span>\n            {client.favorite && <Star size={14} color=\"#f59e0b\" fill=\"#f59e0b\" />}\n          </div>\n          \n          {client.company && client.type === 'Individual' && (\n            <div style={{ \n              fontSize: typography.fontSize.xs, \n              color: colors.textMuted,\n              marginBottom: spacing[1],\n            }}>\n              {client.company}\n            </div>\n          )}\n          \n          <div style={{ display: 'flex', gap: spacing[3], flexWrap: 'wrap' }}>\n            {client.email && (\n              <span style={{ \n                fontSize: typography.fontSize.xs, \n                color: colors.textSecondary,\n                display: 'flex',\n                alignItems: 'center',\n                gap: 4,\n              }}>\n                <Mail size={12} /> {client.email}\n              </span>\n            )}\n            {client.phone && (\n              <span style={{ \n                fontSize: typography.fontSize.xs, \n                color: colors.textSecondary,\n                display: 'flex',\n                alignItems: 'center',\n                gap: 4,\n              }}>\n                <Phone size={12} /> {client.phone}\n              </span>\n            )}\n          </div>\n        </div>\n        \n        {/* Stats */}\n        <div style={{ \n          display: 'flex', \n          flexDirection: 'column', \n          alignItems: 'flex-end',\n          gap: spacing[1],\n        }}>\n          <Badge color={colors.primary}>{stats.totalProjects} projects</Badge>\n          {stats.activeReservations > 0 && (\n            <Badge color={colors.success}>{stats.activeReservations} active</Badge>\n          )}\n        </div>\n      </div>\n    </Card>\n  );\n});\n\n// ============================================================================\n// Client Form Modal\n// ============================================================================\nconst ClientFormModal = memo(function ClientFormModal({ client, onSave, onClose }) {\n  const [formData, setFormData] = useState({\n    name: client?.name || '',\n    type: client?.type || 'Individual',\n    company: client?.company || '',\n    email: client?.email || '',\n    phone: client?.phone || '',\n    address: client?.address || '',\n    notes: client?.notes || '',\n    favorite: client?.favorite || false,\n  });\n  const [nameError, setNameError] = useState('');\n  \n  const isNameEmpty = !formData.name.trim();\n  const isEditing = !!client;\n  \n  const handleSubmit = (e) => {\n    e.preventDefault();\n    if (isNameEmpty) {\n      setNameError('Client name is required');\n      return;\n    }\n    \n    onSave({\n      ...client,\n      ...formData,\n      id: client?.id || `CL${Date.now()}`,\n      createdAt: client?.createdAt || new Date().toISOString(),\n      updatedAt: new Date().toISOString(),\n    });\n  };\n  \n  return (\n    <div className=\"modal-backdrop\" style={styles.modal} onClick={onClose}>\n      <div style={styles.modalBox} onClick={e => e.stopPropagation()}>\n        {/* Header */}\n        <div style={{\n          padding: spacing[4],\n          borderBottom: `1px solid ${colors.borderLight}`,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'space-between',\n        }}>\n          <h3 style={{ margin: 0, color: colors.textPrimary }}>\n            {client ? 'Edit Client' : 'Add New Client'}\n          </h3>\n          <button\n            onClick={onClose}\n            style={{\n              background: 'none',\n              border: 'none',\n              color: colors.textMuted,\n              cursor: 'pointer',\n              padding: spacing[1],\n            }}\n          >\n            <X size={20} />\n          </button>\n        </div>\n        \n        <form onSubmit={handleSubmit} style={{ padding: spacing[4], maxHeight: 'calc(90vh - 80px)', overflowY: 'auto' }}>\n          {/* Name - Required field */}\n          <div className=\"form-section\">\n            <label className={`form-label ${isNameEmpty ? 'label-required-empty' : ''}`}>\n              Name <span className=\"required-indicator\">*</span>\n            </label>\n            <input\n              type=\"text\"\n              value={formData.name}\n              onChange={(e) => { setFormData(prev => ({ ...prev, name: e.target.value })); setNameError(''); }}\n              className={`input ${isNameEmpty ? 'input-required-empty' : ''}`}\n              placeholder=\"Client name\"\n              autoFocus\n            />\n            {nameError && <span className=\"required-error-text\">{nameError}</span>}\n          </div>\n          \n          {/* Type */}\n          <div className=\"form-section\">\n            <label className=\"form-label\">Type</label>\n            <Select\n              value={formData.type}\n              onChange={(e) => setFormData(prev => ({ ...prev, type: e.target.value }))}\n              options={CLIENT_TYPES.map(t => ({ value: t, label: t }))}\n              aria-label=\"Client type\"\n            />\n          </div>\n          \n          {/* Company (if Individual) */}\n          {formData.type === 'Individual' && (\n            <div className=\"form-section\">\n              <label className=\"form-label\">Company</label>\n              <input\n                type=\"text\"\n                value={formData.company}\n                onChange={(e) => setFormData(prev => ({ ...prev, company: e.target.value }))}\n                className=\"input\"\n                placeholder=\"Company name (optional)\"\n              />\n            </div>\n          )}\n          \n          {/* Email & Phone */}\n          <div className=\"form-row\">\n            <div className=\"form-field\">\n              <label className=\"form-label\">Email</label>\n              <input\n                type=\"email\"\n                value={formData.email}\n                onChange={(e) => setFormData(prev => ({ ...prev, email: e.target.value }))}\n                className=\"input\"\n                placeholder=\"email@example.com\"\n              />\n            </div>\n            <div className=\"form-field\">\n              <label className=\"form-label\">Phone</label>\n              <input\n                type=\"tel\"\n                value={formData.phone}\n                onChange={(e) => setFormData(prev => ({ ...prev, phone: e.target.value }))}\n                className=\"input\"\n                placeholder=\"555-123-4567\"\n              />\n            </div>\n          </div>\n          \n          {/* Address */}\n          <div className=\"form-section\">\n            <label className=\"form-label\">Address</label>\n            <input\n              type=\"text\"\n              value={formData.address}\n              onChange={(e) => setFormData(prev => ({ ...prev, address: e.target.value }))}\n              className=\"input\"\n              placeholder=\"Street address, city, state\"\n            />\n          </div>\n          \n          {/* Notes */}\n          <div className=\"form-section\">\n            <label className=\"form-label\">Notes</label>\n            <textarea\n              value={formData.notes}\n              onChange={(e) => setFormData(prev => ({ ...prev, notes: e.target.value }))}\n              className=\"input\"\n              style={{ minHeight: 80, resize: 'vertical' }}\n              placeholder=\"Additional notes about this client\"\n            />\n          </div>\n          \n          {/* Favorite */}\n          <label style={{ \n            display: 'flex', \n            alignItems: 'center', \n            gap: spacing[2],\n            color: colors.textSecondary,\n            fontSize: typography.fontSize.sm,\n            cursor: 'pointer',\n            marginBottom: spacing[4],\n          }}>\n            <input\n              type=\"checkbox\"\n              checked={formData.favorite}\n              onChange={(e) => setFormData(prev => ({ ...prev, favorite: e.target.checked }))}\n            />\n            <Star size={14} /> Mark as favorite\n          </label>\n          \n          {/* Actions */}\n          <div style={{ display: 'flex', justifyContent: 'flex-end', gap: spacing[2] }}>\n            <Button type=\"button\" variant=\"secondary\" onClick={onClose}>Cancel</Button>\n            <Button type=\"submit\" icon={isEditing ? Edit2 : Plus}>\n              {isEditing ? 'Save Changes' : 'Add Client'}\n            </Button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n});\n\n// ============================================================================\n// Client Detail View\n// ============================================================================\nconst ClientDetailView = memo(function ClientDetailView({ \n  client, \n  projects, \n  onBack, \n  onEdit,\n  onDelete,\n  onViewReservation,\n  onAddNote,\n  onReplyNote,\n  onDeleteNote,\n  user,\n}) {\n  const [notesCollapsed, setNotesCollapsed] = useState(false);\n  \n  const stats = useMemo(() => ({\n    totalProjects: projects.length,\n    activeProjects: projects.filter(p => new Date(p.end) >= new Date()).length,\n    totalValue: projects.reduce((sum, p) => sum + (p.value || 0), 0),\n    lastProject: projects.length > 0 \n      ? projects.sort((a, b) => new Date(b.start) - new Date(a.start))[0]\n      : null,\n  }), [projects]);\n  \n  const clientNotes = client.clientNotes || [];\n  \n  return (\n    <div>\n      {/* Header */}\n      <button\n        onClick={onBack}\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          gap: spacing[2],\n          background: 'transparent',\n          border: 'none',\n          color: colors.textMuted,\n          cursor: 'pointer',\n          marginBottom: spacing[3],\n          fontSize: typography.fontSize.sm,\n        }}\n      >\n        ← Back to Clients\n      </button>\n      \n      <Card style={{ marginBottom: spacing[4] }}>\n        <div style={{ display: 'flex', gap: spacing[4], alignItems: 'flex-start' }}>\n          {/* Avatar */}\n          <div style={{\n            width: 64, height: 64,\n            borderRadius: borderRadius.xl,\n            background: `${withOpacity(colors.primary, 20)}`,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            flexShrink: 0,\n          }}>\n            {client.type === 'Company' || client.type === 'Agency' ? (\n              <Building2 size={32} color={colors.primary} />\n            ) : (\n              <Users size={32} color={colors.primary} />\n            )}\n          </div>\n          \n          {/* Info */}\n          <div style={{ flex: 1 }}>\n            <div style={{ display: 'flex', alignItems: 'center', gap: spacing[2], marginBottom: spacing[2] }}>\n              <h2 style={{ margin: 0, color: colors.textPrimary }}>{client.name}</h2>\n              {client.favorite && <Star size={18} color=\"#f59e0b\" fill=\"#f59e0b\" />}\n              <Badge>{client.type}</Badge>\n            </div>\n            \n            <div style={{ display: 'flex', gap: spacing[4], flexWrap: 'wrap', color: colors.textSecondary, fontSize: typography.fontSize.sm }}>\n              {client.email && (\n                <span style={{ display: 'flex', alignItems: 'center', gap: 4 }}>\n                  <Mail size={14} /> {client.email}\n                </span>\n              )}\n              {client.phone && (\n                <span style={{ display: 'flex', alignItems: 'center', gap: 4 }}>\n                  <Phone size={14} /> {client.phone}\n                </span>\n              )}\n              {client.address && (\n                <span style={{ display: 'flex', alignItems: 'center', gap: 4 }}>\n                  <MapPin size={14} /> {client.address}\n                </span>\n              )}\n            </div>\n            \n            {client.notes && (\n              <p style={{ \n                margin: `${spacing[3]}px 0 0`, \n                color: colors.textMuted,\n                fontSize: typography.fontSize.sm,\n              }}>\n                {client.notes}\n              </p>\n            )}\n          </div>\n          \n          <div style={{ display: 'flex', gap: spacing[2], alignItems: 'center' }}>\n            <Button variant=\"secondary\" onClick={() => onEdit(client)} icon={Edit2}>\n              Edit\n            </Button>\n            <button className=\"btn-icon danger\" onClick={() => onDelete(client)}>\n              <Trash2 size={16} />\n            </button>\n          </div>\n        </div>\n      </Card>\n      \n      {/* Stats */}\n      <div style={{ \n        display: 'grid', \n        gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', \n        gap: spacing[3],\n        marginBottom: spacing[4],\n      }}>\n        <Card style={{ textAlign: 'center', padding: spacing[4] }}>\n          <div style={{ fontSize: typography.fontSize['2xl'], fontWeight: 'bold', color: colors.primary }}>\n            {stats.totalProjects}\n          </div>\n          <div style={{ fontSize: typography.fontSize.xs, color: colors.textMuted }}>Total Projects</div>\n        </Card>\n        <Card style={{ textAlign: 'center', padding: spacing[4] }}>\n          <div style={{ fontSize: typography.fontSize['2xl'], fontWeight: 'bold', color: colors.success }}>\n            {stats.activeProjects}\n          </div>\n          <div style={{ fontSize: typography.fontSize.xs, color: colors.textMuted }}>Active</div>\n        </Card>\n        <Card style={{ textAlign: 'center', padding: spacing[4] }}>\n          <div style={{ fontSize: typography.fontSize['2xl'], fontWeight: 'bold', color: colors.accent1 }}>\n            {formatMoney(stats.totalValue)}\n          </div>\n          <div style={{ fontSize: typography.fontSize.xs, color: colors.textMuted }}>Total Value</div>\n        </Card>\n      </div>\n      \n      {/* Notes Section */}\n      <CollapsibleSection\n        title=\"Notes\"\n        icon={MessageSquare}\n        badge={clientNotes.filter(n => !n.deleted).length || null}\n        badgeColor={colors.primary}\n        collapsed={notesCollapsed}\n        onToggleCollapse={() => setNotesCollapsed(!notesCollapsed)}\n        style={{ marginBottom: spacing[4] }}\n      >\n        <NotesSection\n          notes={clientNotes}\n          onAddNote={onAddNote}\n          onReply={onReplyNote}\n          onDelete={onDeleteNote}\n          user={user}\n          panelColor={colors.primary}\n        />\n      </CollapsibleSection>\n      \n      {/* Project History */}\n      <Card>\n        <h3 style={{ margin: `0 0 ${spacing[3]}px`, color: colors.textPrimary }}>\n          Project History\n        </h3>\n        \n        {projects.length === 0 ? (\n          <div style={{ \n            textAlign: 'center', \n            padding: spacing[6],\n            color: colors.textMuted,\n          }}>\n            No projects yet\n          </div>\n        ) : (\n          <div style={{ display: 'flex', flexDirection: 'column', gap: spacing[2] }}>\n            {projects.map(project => (\n              <div\n                key={project.id}\n                onClick={() => onViewReservation?.(project)}\n                style={{\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: spacing[3],\n                  padding: spacing[3],\n                  background: colors.bgLight,\n                  borderRadius: borderRadius.md,\n                  cursor: 'pointer',\n                }}\n              >\n                <Calendar size={16} color={colors.textMuted} />\n                <div style={{ flex: 1 }}>\n                  <div style={{ fontWeight: typography.fontWeight.medium, color: colors.textPrimary }}>\n                    {project.project}\n                  </div>\n                  <div style={{ fontSize: typography.fontSize.xs, color: colors.textMuted }}>\n                    {project.start} - {project.end} • {project.itemCount || 1} items\n                  </div>\n                </div>\n                {project.value > 0 && (\n                  <span style={{ color: colors.textSecondary, fontSize: typography.fontSize.sm }}>\n                    ${project.value}\n                  </span>\n                )}\n                <ChevronRight size={16} color={colors.textMuted} />\n              </div>\n            ))}\n          </div>\n        )}\n      </Card>\n    </div>\n  );\n});\n\n// ============================================================================\n// Main Clients View\n// ============================================================================\nfunction ClientsView({ \n  clients = [], \n  inventory = [],\n  onUpdateClients,\n  onViewReservation,\n  onAddNote,\n  onReplyNote,\n  onDeleteNote,\n  user,\n  addAuditLog,\n}) {\n  const dataContext = useData();\n  const [searchQuery, setSearchQuery] = useState('');\n  const [selectedClient, setSelectedClient] = useState(null);\n  const [editingClient, setEditingClient] = useState(null);\n  const [showAddModal, setShowAddModal] = useState(false);\n  const [deleteConfirm, setDeleteConfirm] = useState({ isOpen: false, client: null });\n  const [filterType, setFilterType] = useState('all');\n  \n  // Keep selectedClient in sync with clients prop (for when notes are added/updated)\n  useEffect(() => {\n    if (selectedClient) {\n      const updatedClient = clients.find(c => c.id === selectedClient.id);\n      if (updatedClient && updatedClient !== selectedClient) {\n        setSelectedClient(updatedClient);\n      }\n    }\n  }, [clients, selectedClient]);\n  \n  // Get project history for each client from reservations\n  const getClientProjects = useCallback((clientId) => {\n    const projects = [];\n    inventory.forEach(item => {\n      (item.reservations || []).forEach(res => {\n        if (res.clientId === clientId) {\n          projects.push({\n            ...res,\n            itemId: item.id,\n            itemName: item.name,\n            itemCount: 1,\n          });\n        }\n      });\n    });\n    return projects.sort((a, b) => new Date(b.start) - new Date(a.start));\n  }, [inventory]);\n  \n  // Get stats for a client\n  const getClientStats = useCallback((client) => {\n    const projects = getClientProjects(client.id);\n    return {\n      totalProjects: projects.length,\n      activeReservations: projects.filter(p => new Date(p.end) >= new Date()).length,\n      totalValue: projects.reduce((sum, p) => sum + (p.value || 0), 0),\n    };\n  }, [getClientProjects]);\n  \n  // Filter clients\n  const filteredClients = useMemo(() => {\n    let result = [...clients];\n    \n    // Search filter\n    if (searchQuery) {\n      const q = searchQuery.toLowerCase();\n      result = result.filter(c => \n        c.name.toLowerCase().includes(q) ||\n        c.email?.toLowerCase().includes(q) ||\n        c.company?.toLowerCase().includes(q)\n      );\n    }\n    \n    // Type filter\n    if (filterType !== 'all') {\n      if (filterType === 'favorites') {\n        result = result.filter(c => c.favorite);\n      } else {\n        result = result.filter(c => c.type === filterType);\n      }\n    }\n    \n    // Sort: favorites first, then by name\n    return result.sort((a, b) => {\n      if (a.favorite && !b.favorite) return -1;\n      if (!a.favorite && b.favorite) return 1;\n      return a.name.localeCompare(b.name);\n    });\n  }, [clients, searchQuery, filterType]);\n  \n  // Handlers\n  const handleSaveClient = useCallback(async (clientData) => {\n    const exists = clients.find(c => c.id === clientData.id);\n    if (exists) {\n      // Update existing client\n      if (dataContext?.updateClient) {\n        try {\n          await dataContext.updateClient(clientData.id, clientData);\n        } catch (err) {\n          logError('Failed to update client:', err);\n          onUpdateClients(clients.map(c => c.id === clientData.id ? clientData : c));\n        }\n      } else {\n        onUpdateClients(clients.map(c => c.id === clientData.id ? clientData : c));\n      }\n    } else {\n      // New client - create in database\n      if (dataContext?.createClient) {\n        try {\n          await dataContext.createClient(clientData);\n        } catch (err) {\n          logError('Failed to create client:', err);\n          onUpdateClients([...clients, clientData]);\n        }\n      } else {\n        onUpdateClients([...clients, clientData]);\n      }\n      setSelectedClient(clientData);\n    }\n    setShowAddModal(false);\n    setEditingClient(null);\n  }, [clients, onUpdateClients, dataContext]);\n  \n  const handleDeleteClient = useCallback(async () => {\n    if (deleteConfirm.client) {\n      const clientToDelete = deleteConfirm.client;\n      \n      // Delete from database\n      if (dataContext?.deleteClient) {\n        try {\n          await dataContext.deleteClient(clientToDelete.id);\n        } catch (err) {\n          logError('Failed to delete client:', err);\n          onUpdateClients(clients.filter(c => c.id !== clientToDelete.id));\n        }\n      } else {\n        onUpdateClients(clients.filter(c => c.id !== clientToDelete.id));\n      }\n      \n      // Log deletion\n      if (addAuditLog) {\n        addAuditLog({\n          type: 'client_deleted',\n          description: `Client \"${clientToDelete.name}\" deleted`,\n          user: user?.name || 'Unknown',\n          clientId: clientToDelete.id\n        });\n      }\n    }\n    setDeleteConfirm({ isOpen: false, client: null });\n  }, [clients, onUpdateClients, deleteConfirm.client, addAuditLog, user, dataContext]);\n  \n  // Detail view\n  if (selectedClient) {\n    return (\n      <>\n        <ClientDetailView\n          client={selectedClient}\n          projects={getClientProjects(selectedClient.id)}\n          onBack={() => setSelectedClient(null)}\n          onEdit={(c) => { setEditingClient(c); }}\n          onDelete={(c) => { setDeleteConfirm({ isOpen: true, client: c }); }}\n          onViewReservation={onViewReservation}\n          onAddNote={(text) => onAddNote(selectedClient.id, text)}\n          onReplyNote={(parentId, text) => onReplyNote(selectedClient.id, parentId, text)}\n          onDeleteNote={(noteId) => onDeleteNote(selectedClient.id, noteId)}\n          user={user}\n        />\n        {editingClient && (\n          <ClientFormModal\n            client={editingClient}\n            onSave={(updated) => {\n              onUpdateClients(clients.map(c => c.id === updated.id ? updated : c));\n              setEditingClient(null);\n              // Update selectedClient to reflect changes\n              setSelectedClient(updated);\n            }}\n            onClose={() => setEditingClient(null)}\n          />\n        )}\n        \n        {/* Delete Confirmation */}\n        <ConfirmDialog\n          isOpen={deleteConfirm.isOpen}\n          title=\"Delete Client\"\n          message={`Are you sure you want to delete \"${deleteConfirm.client?.name}\"? This cannot be undone.`}\n          confirmText=\"Delete\"\n          onConfirm={() => { handleDeleteClient(); setSelectedClient(null); }}\n          onCancel={() => setDeleteConfirm({ isOpen: false, client: null })}\n        />\n      </>\n    );\n  }\n  \n  return (\n    <div>\n      {/* Header */}\n      <div className=\"page-header\">\n        <div>\n          <h2 className=\"page-title\" style={{ display: 'flex', alignItems: 'center', gap: spacing[2] }}>\n            <Users size={24} /> Clients\n          </h2>\n          <p style={{ margin: `${spacing[1]}px 0 0`, color: colors.textMuted, fontSize: typography.fontSize.sm }}>\n            {clients.length} total clients\n          </p>\n        </div>\n        <Button onClick={() => setShowAddModal(true)} icon={Plus}>\n          Add Client\n        </Button>\n      </div>\n      \n      {/* Filters */}\n      <Card style={{ marginBottom: spacing[4] }}>\n        <div style={{ display: 'flex', gap: spacing[3], flexWrap: 'wrap' }}>\n          <div style={{ flex: 1, minWidth: 200 }}>\n            <SearchInput\n              value={searchQuery}\n              onChange={setSearchQuery}\n              placeholder=\"Search clients...\"\n            />\n          </div>\n          <Select\n            value={filterType}\n            onChange={(e) => setFilterType(e.target.value)}\n            options={[\n              { value: 'all', label: 'All Types' },\n              { value: 'favorites', label: '★ Favorites' },\n              ...CLIENT_TYPES.map(t => ({ value: t, label: t }))\n            ]}\n            style={{ minWidth: 140 }}\n            aria-label=\"Filter by type\"\n          />\n        </div>\n      </Card>\n      \n      {/* Client List */}\n      {filteredClients.length === 0 ? (\n        <Card style={{ textAlign: 'center', padding: spacing[8] }}>\n          <Users size={48} color={colors.textMuted} style={{ marginBottom: spacing[3] }} />\n          <h3 style={{ margin: 0, color: colors.textPrimary }}>\n            {clients.length === 0 ? 'No clients yet' : 'No clients match your search'}\n          </h3>\n          <p style={{ margin: `${spacing[2]}px 0 0`, color: colors.textMuted }}>\n            {clients.length === 0 \n              ? 'Add your first client to start tracking projects'\n              : 'Try adjusting your search or filters'\n            }\n          </p>\n          {clients.length === 0 && (\n            <Button onClick={() => setShowAddModal(true)} icon={Plus} style={{ marginTop: spacing[4] }}>\n              Add Client\n            </Button>\n          )}\n        </Card>\n      ) : (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: spacing[3] }}>\n          {filteredClients.map(client => (\n            <ClientCard\n              key={client.id}\n              client={client}\n              stats={getClientStats(client)}\n              onSelect={setSelectedClient}\n            />\n          ))}\n        </div>\n      )}\n      \n      {/* Add/Edit Modal */}\n      {(showAddModal || editingClient) && (\n        <ClientFormModal\n          client={editingClient}\n          onSave={handleSaveClient}\n          onClose={() => { setShowAddModal(false); setEditingClient(null); }}\n        />\n      )}\n      \n      {/* Delete Confirmation */}\n      {deleteConfirm && (\n        <ConfirmDialog\n          title=\"Delete Client\"\n          message={`Are you sure you want to delete \"${deleteConfirm.name}\"? This cannot be undone.`}\n          confirmLabel=\"Delete\"\n          confirmVariant=\"danger\"\n          onConfirm={() => handleDeleteClient(deleteConfirm)}\n          onCancel={() => setDeleteConfirm(null)}\n        />\n      )}\n    </div>\n  );\n}\n\nexport default memo(ClientsView);\n"],"names":["CLIENT_TYPES","ClientCard","memo","client","stats","onSelect","jsx","Card","jsxs","spacing","borderRadius","withOpacity","colors","Building2","Users","typography","Star","Mail","Phone","Badge","ClientFormModal","onSave","onClose","formData","setFormData","useState","nameError","setNameError","isNameEmpty","isEditing","handleSubmit","e","styles","X","prev","Select","t","Button","Edit2","Plus","ClientDetailView","projects","onBack","onEdit","onDelete","onViewReservation","onAddNote","onReplyNote","onDeleteNote","user","notesCollapsed","setNotesCollapsed","useMemo","p","sum","a","b","clientNotes","MapPin","Trash2","formatMoney","CollapsibleSection","MessageSquare","n","NotesSection","project","Calendar","ChevronRight","ClientsView","clients","inventory","onUpdateClients","addAuditLog","dataContext","useData","searchQuery","setSearchQuery","selectedClient","setSelectedClient","editingClient","setEditingClient","showAddModal","setShowAddModal","deleteConfirm","setDeleteConfirm","filterType","setFilterType","useEffect","updatedClient","c","getClientProjects","useCallback","clientId","item","res","getClientStats","filteredClients","result","q","handleSaveClient","clientData","err","logError","handleDeleteClient","clientToDelete","Fragment","text","parentId","noteId","updated","ConfirmDialog","SearchInput","ClientsView_default"],"mappings":"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"}