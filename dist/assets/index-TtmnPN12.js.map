{"version":3,"mappings":"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","names":["f","require$$0","k","l","m","n","p","q","c","a","g","b","d","e","h","reactJsxRuntime_production_min","jsxRuntimeModule","client","name","version","initQueue","params","isBrowser","detectEnvironment","env","isDevelopment","getScriptSrc","props","injectSpeedInsights","_a","src","script","route","getBasePath","define_process_env_default","SpeedInsights","useEffect","setScriptRoute","useRef","PERMISSION_LEVELS","APP_FUNCTIONS","DEFAULT_ROLES","acc","key","VIEWS","MODALS","DASHBOARD_SECTIONS","ITEM_DETAIL_SECTIONS","createDefaultSectionPrefs","sections","prefs","s","DEFAULT_LAYOUT_PREFS","STATUS","CONDITION","CATEGORIES","CATEGORY_PREFIXES","DEFAULT_CATEGORY_SETTINGS","DEFAULT_NEW_CATEGORY_SETTINGS","PROJECT_TYPES","SCHEDULE_MODES","SCHEDULE_PERIODS","LABEL_FORMATS","DEFAULT_SPECS","MAINTENANCE_TYPES","MAINTENANCE_STATUS","EMPTY_ITEM_FORM","EMPTY_RESERVATION_FORM","LOCATION_TYPES","log","warn","error","colors","withOpacity","color","percent","typography","spacing","borderRadius","shadows","zIndex","transitions","styles","generateItemCode","category","existingCodes","prefix","code","attempts","maxAttempts","codes","generateId","formatDate","date","formatDateTime","getTodayISO","doDateRangesOverlap","start1","end1","start2","end2","findConflictingReservations","existingReservations","startDate","endDate","excludeReservationId","reservation","checkCheckoutConflict","item","getAllReservationConflicts","reservationConflicts","checkoutConflict","formatMoney","amount","getStatusColor","status","getConditionColor","condition","updateById","array","id","updates","removeById","findById","filterBySearch","items","query","fields","field","filterByCategory","categories","cats","filterByStatus","statuses","stats","today","addReplyToNote","notes","parentId","reply","note","markNoteDeleted","noteId","findNoteById","found","flattenLocations","locations","parentPath","result","loc","fullPath","isReminderDue","reminder","DEPRECIATION_METHODS","DEFAULT_USEFUL_LIFE","calculateDepreciation","purchasePrice","purchaseDate","usefulLife","salvageValue","method","purchase","ageInYears","ageInMonths","depreciableAmount","currentValue","annualDepreciation","monthlyDepreciation","totalDepreciation","schedule","year","yearEnd","startValue","endValue","dbRate","remainingValue","yearDepreciation","ddbRate","ddbRemainingValue","straightLineRemaining","COLOR_CATEGORIES","DEFAULT_CUSTOM_THEME","shadow","opacity","themes","generateRandomTheme","randomColor","randomLight","randomDark","hexToRgb","hex","getLuminance","r","rs","gs","bs","getContrastRatio","color1","color2","rgb1","rgb2","l1","l2","lighter","darker","checkContrast","foreground","background","isLargeText","ratio","minRatio","aaaRatio","level","getContrastStatus","CONTRAST_PAIRS","validateThemeContrast","themeColors","pair","fgColor","bgColor","getContrastSummary","validationResults","passing","failing","skipped","total","announcerElement","getAnnouncer","announce","message","politeness","announcer","announcePageChange","pageName","loadCustomTheme","saved","getAvailableThemes","themeList","customTheme","customIndex","t","ThemeContext","createContext","ThemeProvider","children","themeId","setThemeId","useState","randomColors","setRandomColors","customThemeColors","setCustomThemeColors","applyTheme","useCallback","theme","generatedColors","shouldAnnounce","root","body","property","value","newColors","setTheme","newThemeId","updateCustomTheme","customThemeData","currentTheme","useMemo","jsx","useTheme","context","useContext","PermissionsContext","PermissionsProvider","currentUser","roles","userRole","userRoleId","hasPermission","functionId","requiredLevel","permission","levels","requiredLevelNum","canView","canEdit","isHidden","getPermissionLevel","visibleFunctions","func","usePermissions","ViewOnlyBanner","jsxs","PermissionGate","requireEdit","fallback","supabaseClient","initPromise","initSupabase","logError","getSupabase","supabase","err","auth","email","password","data","session","user","callback","newPassword","INVENTORY_FIELD_MAP","RESERVATION_FIELD_MAP","REMINDER_FIELD_MAP","MAINTENANCE_FIELD_MAP","CHECKOUT_HISTORY_FIELD_MAP","reverseMap","fieldMap","reversed","fe","db","fromDb","row","defaults","dbKey","feKey","defaultValue","toDb","obj","options","partial","passThroughFields","numericFields","INVENTORY_DEFAULTS","INVENTORY_PASSTHROUGH","INVENTORY_NUMERIC","transformInventoryItem","transformItemForDb","dbItem","inventoryService","reminders","reservations","maintenance","checkoutHistory","itemNotesService","itemRemindersService","reservationsService","maintenanceService","checkoutHistoryService","validateItem","__vitePreload","validators","validation","dbUpdates","userId","userName","clientId","clientName","project","dueBack","rpcErr","categoryPrefix","itemId","buildThreadedNotes","transformReminder","transformReservation","res","days","future","transformMaintenanceRecord","record","completedDate","cost","sum","transformCheckoutHistory","limit","clientsService","clientNotesService","newId","favorite","packagesService","pkg","pi","packageData","index","updatedData","packListsService","list","packList","packages","packedItems","listData","pkgId","packListId","isPacked","categoriesService","specsService","grouped","spec","categoryName","specs","locationsService","buildLocationTree","location","usersService","roleId","rolesService","role","auditLogService","entry","transformNote","notesMap","rootNotes","transformed","parent","buildTree","notificationPreferencesService","preferences","emailService","to","templateKey","templateData","borrowerEmail","borrowerName","checkoutDate","dueDate","returnDate","userEmail","daysUntilDue","AuthContext","AuthProvider","setUser","userProfile","setUserProfile","setSession","loading","setLoading","setError","subscription","currentSession","profile","profileErr","event","newSession","signIn","authUser","signUp","signOut","resetPassword","updatePassword","updateProfile","updatedProfile","useAuth","isNonEmptyString","isValidLength","min","max","len","sanitizeString","parseCurrency","cleaned","num","isValidDate","isValidDateRange","isValidStatus","isValidCondition","isValidCategory","customCategories","editingId","errors","numValue","isValid","sanitizedData","validateReservation","isValidEmail","datesOverlap","validateClient","validateMaintenanceRecord","s1","e1","s2","e2","DataContext","DataProvider","dataLoaded","setDataLoaded","inventory","setInventory","setPackages","packLists","setPackLists","clients","setClients","users","setUsers","setRoles","setLocations","setCategories","setSpecs","auditLog","setAuditLog","loadData","inventoryData","categoriesData","usersData","rolesData","locationsData","specsData","reservationsData","packagesData","packListsData","clientsData","auditLogData","reservationsByItemId","prev","addAuditLog","newEntry","updateInventory","newInventory","updateItem","createItem","newItem","deleteItem","getItemWithDetails","addItemNote","dbNote","deleteItemNote","addItemReminder","dbReminder","updateItemReminder","reminderId","deleteItemReminder","addMaintenance","dbRecord","updateMaintenance","recordId","deleteMaintenance","createReservation","dbReservation","updateReservation","reservationId","deleteReservation","checkOutItem","checkoutData","checkInItem","checkinData","returnedBy","conditionNotes","returnNotes","damageReported","damageDescription","newStatus","noteErr","updatePackages","newPackages","createPackage","newPackage","updatePackage","deletePackage","updatePackLists","newPackLists","createPackList","newPackList","updatePackList","pl","deletePackList","updateClients","newClients","createClient","newClient","updateClient","deleteClient","updateUsers","newUsers","updateRoles","newRoles","updateLocations","newLocations","updateCategories","newCategories","updateSpecs","newSpecs","saveNotificationPreferences","getNotificationPreferences","sendCheckoutEmail","sendCheckinEmail","sendReservationEmail","useData","Spinner","size","className","FullPageLoading","ModalLoading","ViewLoading","ReactPropTypesSecret","ReactPropTypesSecret_1","emptyFunction","emptyFunctionWithReset","factoryWithThrowingShims","shim","propName","componentName","propFullName","secret","getShim","ReactPropTypes","propTypesModule","BackButton","memo","onClick","ArrowLeft","PageHeader","title","subtitle","action","backButton","onBack","backLabel","Fragment","DragHandle","canDrag","GripVertical","Badge","text","sizes","content","Button","forwardRef","variant","disabled","danger","fullWidth","Icon","iconOnly","ariaLabel","customStyle","customClassName","type","ref","classNames","accessibleLabel","Card","padding","isClickable","CardHeader","withAlpha","alpha","shorthandRegex","expandedHex","CollapsibleSection","badge","badgeColor","collapsed","onToggleCollapse","style","headerColor","accentColor","Input","label","containerStyle","inputClassNames","SelectInput","selectClassNames","opt","StatCard","ItemImage","alt","radius","showPlaceholder","Modal","isOpen","onClose","maxWidth","EmptyState","description","ConfirmDialog","confirmText","cancelText","onConfirm","onCancel","dialogRef","cancelButtonRef","handleKeyDown","SearchInput","onChange","placeholder","onClear","inputId","isFocused","setIsFocused","Avatar","initial","Divider","sp","Grid","columns","minWidth","gap","Flex","direction","align","justify","wrap","Pagination","page","totalPages","totalItems","pageSize","onPageChange","showItemCount","startItem","endItem","getPageNumbers","pages","i","start","end","pageButtonStyle","isActive","pageNum","idx","LoadingSpinner","LoadingOverlay","fullScreen","VisuallyHidden","Component","LiveRegion","atomic","SkipLink","targetId","PropTypes","InstallStatus","usePWA","installStatus","setInstallStatus","installPrompt","setInstallPrompt","isOnline","setIsOnline","swStatus","setSwStatus","swRegistration","setSwRegistration","updateAvailable","setUpdateAvailable","deferredPrompt","handleOnline","handleOffline","handleBeforeInstallPrompt","handleAppInstalled","promptInstall","outcome","dismissInstall","registration","newWorker","refreshing","updateServiceWorker","checkForUpdates","clearCache","cacheNames","requestNotificationPermission","notificationsEnabled","sendNotification","canInstall","isInstalled","isStandalone","useInventoryActions","dataContext","setSelectedItem","setCurrentView","setChangeLog","setConfirmDialog","selectedItem","currentView","editingItemId","setEditingItemId","itemForm","setItemForm","resetItemForm","closeModal","openModal","isLoading","setIsLoading","bulkActionIds","setBulkActionIds","addChangeLog","itemSpecs","storageService","uploadErr","originalItem","changes","oldVal","newVal","oldImg","newImg","itemToDelete","handleBulkAction","ids","applyBulkStatus","updatedItems","applyBulkLocation","newLocation","applyBulkCategory","newCategory","applyBulkDelete","deletedItems","openEditItem","usePagination","setPage","paginatedItems","goToPage","newPage","nextPage","prevPage","useDebounce","delay","debouncedValue","setDebouncedValue","handler","NavigationContext","NavigationProviderWithData","isAuthenticated","NavigationProvider","isLoggedIn","selectedPackage","setSelectedPackage","selectedPackList","setSelectedPackList","selectedReservation","setSelectedReservation","selectedReservationItem","setSelectedReservationItem","itemBackContext","setItemBackContext","isPopstateNav","state","handlePopState","navigate","viewId","mainContent","navigateToItem","backContext","navigateToPackage","navigateToPackList","navigateToReservation","goBack","isDetailView","resetNavigation","useNavigationContext","ctx","FilterContext","FilterProvider","defaultCategoryFilter","defaultStatusFilter","defaultGridView","searchQuery","setSearchQuery","categoryFilter","setCategoryFilter","selectedCategories","setSelectedCategories","packageCategoryFilter","setPackageCategoryFilter","statusFilter","setStatusFilter","selectedStatuses","setSelectedStatuses","isGridView","setIsGridView","scheduleView","setScheduleView","scheduleMode","setScheduleMode","scheduleDate","setScheduleDate","selectedIds","setSelectedIds","handleSearch","clearSearch","handleCategoryFilter","toggleCategory","clearCategoryFilters","handleStatusFilter","toggleStatus","clearStatusFilters","toggleViewMode","setGridView","setListView","handleScheduleView","view","handleScheduleMode","mode","handleScheduleDate","resetScheduleToToday","toggleSelection","selectAll","clearSelection","isSelected","resetAllFilters","createItemFilter","searchFields","categoryField","statusField","hasActiveFilters","selectionCount","hasSelection","useFilterContext","ModalContext","ModalProvider","activeModal","setActiveModal","editingReservationId","setEditingReservationId","reservationForm","setReservationForm","confirmDialog","modalData","setModalData","modalId","isModalOpen","openAddItemModal","initialData","openEditItemModal","closeItemModal","openAddReservationModal","openEditReservationModal","closeReservationModal","openCheckOutModal","openCheckInModal","openQRModal","openExportModal","openMaintenanceModal","openCSVImportModal","openQRScannerModal","openImageSelectorModal","onSelect","openBulkStatusModal","openBulkLocationModal","openBulkCategoryModal","openBulkDeleteModal","showConfirm","showDeleteConfirm","itemName","closeConfirm","handleConfirm","handleCancel","updateItemForm","updateReservationForm","resetReservationForm","useModalContext","SidebarContext","safeLocalStorage","SidebarProvider","storageKey","defaultCollapsed","mobileBreakpoint","sidebarOpen","setSidebarOpen","sidebarCollapsed","setSidebarCollapsed","isMobile","setIsMobile","handleResize","mobile","handleEscape","toggleSidebarOpen","openSidebar","closeSidebar","toggleSidebarCollapsed","collapseSidebar","expandSidebar","handleNavClick","sidebarWidth","mainContentMargin","useSidebarContext","useCheckoutHandlers","checkoutItem","setCheckoutItem","checkinItemData","setCheckinItemData","maintenanceItem","setMaintenanceItem","editingMaintenanceRecord","setEditingMaintenanceRecord","openCheckoutModal","openCheckinModal","processCheckout","borrowerPhone","projectType","conditionAtCheckout","checkedOutDate","checkedOutTime","processCheckin","conditionChanged","returnTime","currentItem","saveMaintenance","isEdit","tempId","existingHistory","newHistory","dbResult","swapId","history","updateMaintenanceStatus","useKitHandlers","setItemAsKit","kitType","addItemsToKit","childIds","newChildIds","addedItems","updated","childId","removeItemFromKit","removedItem","clearKitItems","clearedItems","addRequiredAccessories","accessoryIds","targetItem","existingAccessories","newAccessories","removeRequiredAccessory","accessoryId","selectImage","image","useReservationHandlers","saveReservation","updatedReservation","itemIds","firstCreatedReservation","targetItemId","firstItemId","firstItem","openEditReservation","resId","projectName","currentSelectedItemId","currentSelectedResId","relatedReservations","affectedItemIds","invItem","itemCount","reservationIdsToDelete","itemIdsAffected","resIdToDelete","useNoteHandlers","selectedClientId","setSelectedClientId","createNoteHandler","entityType","getEntity","setEntity","updater","updateCollection","entityId","notesUpdater","replaceNoteId","realId","entity","updatedNotes","itemNoteHandlers","packageNoteHandlers","reservationNoteHandlers","clientNoteHandlers","useReminderHandlers","addReminder","updatedReminders","completeReminder","uncompleteReminder","deleteReminder","usePackageHandlers","addItemToPackage","packageId","addPackage","Login","loginForm","setLoginForm","onLogin","showPassword","setShowPassword","Login$1","NavButton","colorVar","activeColor","mainNavItems","Home","Package","Layers","ClipboardList","Calendar","QrCode","User","Search","adminNavItems","Settings","BarChart3","VIEW_LABELS","Sidebar","onLogout","onOpenProfile","onOpenScanner","onOpenImport","onOpenExport","showUserMenu","setShowUserMenu","availableThemes","userMenuRef","visibleMainNavItems","visibleAdminNavItems","hasAnyAdminAccess","handleClickOutside","previousViewRef","viewLabel","ChevronRight","ChevronLeft","ScanLine","Upload","Download","ChevronDown","Palette","Bell","LogOut","Sidebar$1","MobileHeader","onOpenSidebar","onOpenModal","onSetView","menuOpen","setMenuOpen","PANEL_COLORS","Dashboard","categorySettings","layoutPrefs","onViewItem","onViewReservation","onFilteredView","onViewAlerts","onViewOverdue","onViewLowStock","onViewReservations","onCustomizeLayout","quickSearch","setQuickSearch","collapsedSections","setCollapsedSections","getSectionPref","sectionId","defaultSection","pref","showSection","isCollapsed","toggleCollapse","sectionOrder","dueReminders","lowStockItems","settings","quantity","threshold","upcomingReservations","searchResults","renderSection","CheckCircle","Clock","AlertTriangle","TrendingDown","Layout","Dashboard$1","BUCKET_NAME","MAX_FILE_SIZE","ALLOWED_TYPES","FULL_SIZE_MAX","THUMBNAIL_SIZE","resizeImage","imageBlob","maxSize","square","resolve","reject","img","url","width","height","sx","sy","sWidth","sHeight","minDim","canvas","blob","fileToBase64","file","reader","timestamp","basePath","fullBlob","thumbBlob","fullResult","thumbResult","fullUrlData","thumbUrlData","resizeError","extension","filename","urlData","dataUrl","path","thumbPath","pathsToDelete","files","listError","paths","expiresIn","existing","isDataUrl","isStorageUrl","getThumbnailUrl","OptimizedImage","objectFit","onLoad","onError","lazy","isLoaded","setIsLoaded","hasError","setHasError","isInView","setIsInView","imgRef","containerRef","imageUrl","observer","handleLoad","handleError","defaultPlaceholder","imageStyle","Select","setIsOpen","highlightedIndex","setHighlightedIndex","dropdownPosition","setDropdownPosition","listRef","selectedOption","displayValue","updateDropdownPosition","rect","spaceBelow","spaceAbove","dropdownHeight","handleScrollOrResize","val","setIsKeyboardNav","isKeyboardNav","highlightedEl","currentIndex","handleSelect","dropdown","createPortal","optValue","optLabel","isHighlighted","PAGE_SIZE_OPTIONS","DEFAULT_PAGE_SIZE","SAVED_VIEWS_KEY","Checkbox","checked","indeterminate","MinusSquare","CheckSquare","Square","SavedViewsDropdown","savedViews","currentFilters","onLoadView","onSaveView","onDeleteView","showSaveDialog","setShowSaveDialog","newViewName","setNewViewName","dropdownRef","React","handleSave","Bookmark","BookmarkPlus","Trash2","GridItem","selectionMode","onToggleSelect","ListItem","SelectionToolbar","selectedCount","totalCount","onSelectAll","onDeselectAll","onBulkAction","allSelected","someSelected","X","GearList","onAddItem","canEditGearList","setPageSize","setSelectionMode","setSavedViews","saveCurrentView","newView","loadView","deleteView","v","debouncedSearch","filteredItems","filteredIds","validIds","toggleSelect","newSet","deselectAll","Plus","List","GearList$1","Note","depth","onReply","onDelete","panelColor","isExpanded","setIsExpanded","showReplyInput","setShowReplyInput","replyText","setReplyText","handleSubmitReply","hasReplies","itemColor","Reply","NotesSection","onAddNote","newNoteText","setNewNoteText","handleSubmitNote","NotesSection$1","MONTH_NAMES","DAY_NAMES","getDaysInMonth","month","getFirstDayOfMonth","day","parseDate","dateString","formatDisplayDate","isSameDay","date1","date2","isToday","DatePicker","clearable","showTodayButton","viewDate","setViewDate","hoveredDay","setHoveredDay","hoveredNav","setHoveredNav","openAbove","setOpenAbove","openLeft","setOpenLeft","inputRef","popupRef","selectedDate","spaceRight","handleInputClick","handlePrevMonth","handleNextMonth","handleSelectDay","isCurrentMonth","handleToday","handleClear","renderDays","daysInMonth","firstDay","daysInPrevMonth","remainingDays","dayYear","dayMonth","isTodayDate","isDisabled","isHovered","dayStyle","inputStyle","RECURRENCE_OPTIONS","ReminderItem","onComplete","onUncomplete","isCompleted","isDue","isPast","effectivePanelColor","borderColor","iconBgColor","RefreshCw","o","AddReminderForm","onAdd","form","setForm","touched","setTouched","handleChange","handleSubmit","showTitleError","showDateError","RemindersSection","onAddReminder","onCompleteReminder","onUncompleteReminder","onDeleteReminder","showAddForm","setShowAddForm","handleAdd","sortedReminders","aDue","bDue","RemindersSection$1","getMaintenanceStatusColor","getMaintenanceStatusIcon","Check","Wrench","formatStatus","MaintenanceEntry","onEdit","expanded","setExpanded","StatusIcon","statusColor","isScheduled","isInProgress","ChevronUp","Building2","DollarSign","MaintenanceSection","maintenanceHistory","onAddMaintenance","onUpdateMaintenance","onCompleteMaintenance","totalCost","pendingCount","sortedHistory","aIsPending","bIsPending","aDate","bDate","MaintenanceSection$1","EVENT_TYPES","MessageSquare","TimelineEvent","isLast","config","ItemTimeline","filter","setFilter","showAll","setShowAll","allEvents","events","rem","filteredEvents","displayedEvents","filterOptions","ItemTimeline$1","DepreciationCalculator","onUpdateValue","setMethod","setUsefulLife","salvagePercent","setSalvagePercent","showSchedule","setShowSchedule","showInfo","setShowInfo","depreciation","methodLabels","Info","isCurrent","DepreciationCalculator$1","SECTION_COLORS","getItemStyle","AddToKitSection","onAddToPackage","selectedPackageId","setSelectedPackageId","itemStyle","containingPackages","availablePackages","handleAddToPackage","RequiredAccessoriesSection","onAddAccessory","onRemoveAccessory","showAddPanel","setShowAddPanel","requiredAccessories","availableItems","existingIds","handleToggleSelect","handleAddSelected","ItemDetail","onCheckout","onCheckin","onShowQR","onAddReservation","onDeleteReservation","onReplyNote","onDeleteNote","onSelectImage","onSetAsKit","onAddToKit","onRemoveFromKit","onClearKit","canEditItems","specsExpanded","setSpecsExpanded","isCheckedOut","categorySpecs","currentCategorySettings","allSpecs","baseSpecs","catSpecs","sortedSections","reservationsColor","notesColor","remindersColor","accessoriesColor","packagesColor","packagesContainingItem","maintenanceColor","History","checkoutColor","valueColor","leftColumnSections","_","rightColumnSections","Edit","ItemDetail$1","MultiSelectDropdown","selectedValues","renderOption","toggleOption","clearAll","displayText","option","ALL_STATUSES","SearchView","clearAllFilters","hasFilters","categoryOptions","cat","statusOptions","renderStatusOption","Filter","Eye","SearchView$1","LabelsView","PackagesView","PackListsView","ReservationDetail","ScheduleView","NotificationSettings","LocationsManager","LayoutCustomize","ThemeSelector","ClientsView","RolesManager","ChangeLog","AdminPanel","UsersPanel","ReportsPanel","AuditLogPanel","MaintenanceReportPanel","InsuranceReportPanel","ItemFormPage","SpecsPage","CategoriesPage","AppViews","handlers","changeLog","navigateToFilteredSearch","navigateToAlerts","navigateToOverdue","navigateToLowStock","navigateToReservations","handleToggleCollapse","handleSaveLayoutPrefs","openMaintenanceEditModal","updateUserProfile","setCategorySettings","newValue","Suspense","newSettings","userToDelete","u","roleData","newRole","userIds","ItemModal","ReservationModal","QRModal","ExportModal","ProfileModal","ImageSelectorModal","QRScannerModal","CSVImportModal","DatabaseExportModal","CheckOutModal","CheckInModal","MaintenanceModal","BulkStatusModal","BulkLocationModal","BulkCategoryModal","BulkDeleteModal","AddUserModal","ImagePreviewModal","AppModals","exportData","newItems","newUser","App","contextRoles","contextSpecs","contextCategories","DEFAULT_CATEGORIES","setIsLoggedIn","setCurrentUser","handleLogin","handleLogout","newPrefs","existingItem","itemWithDetails","catFilter","statFilter","handleNavigate","inventoryActions","updatedUser","services","headers","rows","col","csv","handleMobileNavigate","viewHandlers","modalHandlers","PWAContext","PWAProvider","pwa","contextValue","ErrorBoundary","errorInfo","ReactDOM"],"ignoreList":[0,1,2,3,19,20,21],"sources":["../../node_modules/react/cjs/react-jsx-runtime.production.min.js","../../node_modules/react/jsx-runtime.js","../../node_modules/react-dom/client.js","../../node_modules/@vercel/speed-insights/dist/react/index.mjs","../../constants.js","../../lib/logger.js","../../theme.js","../../utils.js","../../themes-data.js","../../utils/accessibility.js","../../contexts/ThemeContext.jsx","../../contexts/PermissionsContext.jsx","../../lib/supabase.js","../../lib/fieldMap.js","../../lib/services.js","../../lib/AuthContext.jsx","../../lib/validators.js","../../lib/DataContext.jsx","../../components/Loading.jsx","../../node_modules/prop-types/lib/ReactPropTypesSecret.js","../../node_modules/prop-types/factoryWithThrowingShims.js","../../node_modules/prop-types/index.js","../../components/ui.jsx","../../hooks/usePWA.js","../../hooks/useInventoryActions.js","../../hooks/usePagination.js","../../hooks/useDebounce.js","../../contexts/NavigationContext.jsx","../../contexts/FilterContext.jsx","../../contexts/ModalContext.jsx","../../contexts/SidebarContext.jsx","../../hooks/handlers/useCheckoutHandlers.js","../../hooks/handlers/useKitHandlers.js","../../hooks/handlers/useReservationHandlers.js","../../hooks/handlers/useNoteHandlers.js","../../hooks/handlers/useReminderHandlers.js","../../hooks/handlers/usePackageHandlers.js","../../views/Login.jsx","../../components/Sidebar.jsx","../../components/MobileHeader.jsx","../../views/Dashboard.jsx","../../lib/storage.js","../../components/OptimizedImage.jsx","../../components/Select.jsx","../../views/GearList.jsx","../../components/NotesSection.jsx","../../components/DatePicker.jsx","../../components/RemindersSection.jsx","../../components/MaintenanceSection.jsx","../../components/ItemTimeline.jsx","../../components/DepreciationCalculator.jsx","../../views/ItemDetail.jsx","../../components/MultiSelectDropdown.jsx","../../views/SearchView.jsx","../../AppViews.jsx","../../AppModals.jsx","../../App.jsx","../../lib/PWAContext.jsx","../../components/ErrorBoundary.jsx","../../main.jsx"],"sourcesContent":["/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","\"use client\";\n\n// src/react/index.tsx\nimport { useEffect, useRef } from \"react\";\n\n// package.json\nvar name = \"@vercel/speed-insights\";\nvar version = \"1.3.1\";\n\n// src/queue.ts\nvar initQueue = () => {\n  if (window.si) return;\n  window.si = function a(...params) {\n    (window.siq = window.siq || []).push(params);\n  };\n};\n\n// src/utils.ts\nfunction isBrowser() {\n  return typeof window !== \"undefined\";\n}\nfunction detectEnvironment() {\n  try {\n    const env = process.env.NODE_ENV;\n    if (env === \"development\" || env === \"test\") {\n      return \"development\";\n    }\n  } catch (e) {\n  }\n  return \"production\";\n}\nfunction isDevelopment() {\n  return detectEnvironment() === \"development\";\n}\nfunction computeRoute(pathname, pathParams) {\n  if (!pathname || !pathParams) {\n    return pathname;\n  }\n  let result = pathname;\n  try {\n    const entries = Object.entries(pathParams);\n    for (const [key, value] of entries) {\n      if (!Array.isArray(value)) {\n        const matcher = turnValueToRegExp(value);\n        if (matcher.test(result)) {\n          result = result.replace(matcher, `/[${key}]`);\n        }\n      }\n    }\n    for (const [key, value] of entries) {\n      if (Array.isArray(value)) {\n        const matcher = turnValueToRegExp(value.join(\"/\"));\n        if (matcher.test(result)) {\n          result = result.replace(matcher, `/[...${key}]`);\n        }\n      }\n    }\n    return result;\n  } catch (e) {\n    return pathname;\n  }\n}\nfunction turnValueToRegExp(value) {\n  return new RegExp(`/${escapeRegExp(value)}(?=[/?#]|$)`);\n}\nfunction escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n}\nfunction getScriptSrc(props) {\n  if (props.scriptSrc) {\n    return props.scriptSrc;\n  }\n  if (isDevelopment()) {\n    return \"https://va.vercel-scripts.com/v1/speed-insights/script.debug.js\";\n  }\n  if (props.dsn) {\n    return \"https://va.vercel-scripts.com/v1/speed-insights/script.js\";\n  }\n  if (props.basePath) {\n    return `${props.basePath}/speed-insights/script.js`;\n  }\n  return \"/_vercel/speed-insights/script.js\";\n}\n\n// src/generic.ts\nfunction injectSpeedInsights(props = {}) {\n  var _a;\n  if (!isBrowser() || props.route === null) return null;\n  initQueue();\n  const src = getScriptSrc(props);\n  if (document.head.querySelector(`script[src*=\"${src}\"]`)) return null;\n  if (props.beforeSend) {\n    (_a = window.si) == null ? void 0 : _a.call(window, \"beforeSend\", props.beforeSend);\n  }\n  const script = document.createElement(\"script\");\n  script.src = src;\n  script.defer = true;\n  script.dataset.sdkn = name + (props.framework ? `/${props.framework}` : \"\");\n  script.dataset.sdkv = version;\n  if (props.sampleRate) {\n    script.dataset.sampleRate = props.sampleRate.toString();\n  }\n  if (props.route) {\n    script.dataset.route = props.route;\n  }\n  if (props.endpoint) {\n    script.dataset.endpoint = props.endpoint;\n  } else if (props.basePath) {\n    script.dataset.endpoint = `${props.basePath}/speed-insights/vitals`;\n  }\n  if (props.dsn) {\n    script.dataset.dsn = props.dsn;\n  }\n  if (isDevelopment() && props.debug === false) {\n    script.dataset.debug = \"false\";\n  }\n  script.onerror = () => {\n    console.log(\n      `[Vercel Speed Insights] Failed to load script from ${src}. Please check if any content blockers are enabled and try again.`\n    );\n  };\n  document.head.appendChild(script);\n  return {\n    setRoute: (route) => {\n      script.dataset.route = route ?? void 0;\n    }\n  };\n}\n\n// src/react/utils.ts\nfunction getBasePath() {\n  if (typeof process === \"undefined\" || typeof process.env === \"undefined\") {\n    return void 0;\n  }\n  return process.env.REACT_APP_VERCEL_OBSERVABILITY_BASEPATH;\n}\n\n// src/react/index.tsx\nfunction SpeedInsights(props) {\n  useEffect(() => {\n    var _a;\n    if (props.beforeSend) {\n      (_a = window.si) == null ? void 0 : _a.call(window, \"beforeSend\", props.beforeSend);\n    }\n  }, [props.beforeSend]);\n  const setScriptRoute = useRef(null);\n  useEffect(() => {\n    if (!setScriptRoute.current) {\n      const script = injectSpeedInsights({\n        framework: props.framework ?? \"react\",\n        basePath: props.basePath ?? getBasePath(),\n        ...props\n      });\n      if (script) {\n        setScriptRoute.current = script.setRoute;\n      }\n    } else if (props.route) {\n      setScriptRoute.current(props.route);\n    }\n  }, [props.route]);\n  return null;\n}\nexport {\n  SpeedInsights,\n  computeRoute\n};\n//# sourceMappingURL=index.mjs.map","// ============================================================================\n// SIMS Application Constants\n// Centralized location for all application constants, config, and enums\n// ============================================================================\n\n// Permission levels\nexport const PERMISSION_LEVELS = {\n  HIDE: 'hide',\n  VIEW: 'view',\n  EDIT: 'edit',\n};\n\n// App functions/features that can be controlled\nexport const APP_FUNCTIONS = {\n  DASHBOARD: { id: 'dashboard', name: 'Dashboard', description: 'Main dashboard with stats and alerts' },\n  GEAR_LIST: { id: 'gear_list', name: 'Gear List', description: 'View and manage inventory items' },\n  ITEM_DETAILS: { id: 'item_details', name: 'Item Details', description: 'View/edit individual item details' },\n  SCHEDULE: { id: 'schedule', name: 'Schedule', description: 'Calendar and reservation management' },\n  PACK_LISTS: { id: 'pack_lists', name: 'Pack Lists', description: 'Create and manage pack lists' },\n  CLIENTS: { id: 'clients', name: 'Clients', description: 'Client management' },\n  SEARCH: { id: 'search', name: 'Search', description: 'Global search functionality' },\n  LABELS: { id: 'labels', name: 'Labels', description: 'Print labels for items' },\n  REPORTS: { id: 'reports', name: 'Reports', description: 'View reports and analytics' },\n  ADMIN_USERS: { id: 'admin_users', name: 'Admin: Users', description: 'Manage user accounts' },\n  ADMIN_CATEGORIES: { id: 'admin_categories', name: 'Admin: Categories', description: 'Manage item categories' },\n  ADMIN_SPECS: { id: 'admin_specs', name: 'Admin: Specifications', description: 'Manage item specifications' },\n  ADMIN_LOCATIONS: { id: 'admin_locations', name: 'Admin: Locations', description: 'Manage storage locations' },\n  ADMIN_THEMES: { id: 'admin_themes', name: 'Admin: Themes', description: 'Customize app appearance' },\n  ADMIN_LAYOUT: { id: 'admin_layout', name: 'Admin: Layout', description: 'Customize dashboard layout' },\n  ADMIN_NOTIFICATIONS: { id: 'admin_notifications', name: 'Admin: Notifications', description: 'Configure email notifications' },\n  ADMIN_ROLES: { id: 'admin_roles', name: 'Admin: Roles & Permissions', description: 'Manage user roles and permissions' },\n  ADMIN_AUDIT: { id: 'admin_audit', name: 'Admin: Audit Log', description: 'View system audit log' },\n};\n\n// Default roles\nexport const DEFAULT_ROLES = [\n  {\n    id: 'role_admin',\n    name: 'Administrator',\n    description: 'Full access to all features',\n    isSystem: true, // Cannot be deleted\n    permissions: Object.keys(APP_FUNCTIONS).reduce((acc, key) => {\n      acc[APP_FUNCTIONS[key].id] = PERMISSION_LEVELS.EDIT;\n      return acc;\n    }, {}),\n  },\n  {\n    id: 'role_manager',\n    name: 'Manager',\n    description: 'Can manage inventory and users, limited admin access',\n    isSystem: false,\n    permissions: {\n      dashboard: PERMISSION_LEVELS.EDIT,\n      gear_list: PERMISSION_LEVELS.EDIT,\n      item_details: PERMISSION_LEVELS.EDIT,\n      schedule: PERMISSION_LEVELS.EDIT,\n      pack_lists: PERMISSION_LEVELS.EDIT,\n      clients: PERMISSION_LEVELS.EDIT,\n      search: PERMISSION_LEVELS.EDIT,\n      labels: PERMISSION_LEVELS.EDIT,\n      reports: PERMISSION_LEVELS.VIEW,\n      admin_users: PERMISSION_LEVELS.VIEW,\n      admin_categories: PERMISSION_LEVELS.VIEW,\n      admin_specs: PERMISSION_LEVELS.VIEW,\n      admin_locations: PERMISSION_LEVELS.EDIT,\n      admin_themes: PERMISSION_LEVELS.HIDE,\n      admin_layout: PERMISSION_LEVELS.HIDE,\n      admin_notifications: PERMISSION_LEVELS.HIDE,\n      admin_roles: PERMISSION_LEVELS.HIDE,\n      admin_audit: PERMISSION_LEVELS.VIEW,\n    },\n  },\n  {\n    id: 'role_user',\n    name: 'Standard User',\n    description: 'Basic access for day-to-day operations',\n    isSystem: true, // Cannot be deleted\n    permissions: {\n      dashboard: PERMISSION_LEVELS.VIEW,\n      gear_list: PERMISSION_LEVELS.VIEW,\n      item_details: PERMISSION_LEVELS.VIEW,\n      schedule: PERMISSION_LEVELS.EDIT,\n      pack_lists: PERMISSION_LEVELS.EDIT,\n      clients: PERMISSION_LEVELS.VIEW,\n      search: PERMISSION_LEVELS.VIEW,\n      labels: PERMISSION_LEVELS.VIEW,\n      reports: PERMISSION_LEVELS.HIDE,\n      admin_users: PERMISSION_LEVELS.HIDE,\n      admin_categories: PERMISSION_LEVELS.HIDE,\n      admin_specs: PERMISSION_LEVELS.HIDE,\n      admin_locations: PERMISSION_LEVELS.HIDE,\n      admin_themes: PERMISSION_LEVELS.HIDE,\n      admin_layout: PERMISSION_LEVELS.HIDE,\n      admin_notifications: PERMISSION_LEVELS.HIDE,\n      admin_roles: PERMISSION_LEVELS.HIDE,\n      admin_audit: PERMISSION_LEVELS.HIDE,\n    },\n  },\n  {\n    id: 'role_viewer',\n    name: 'Viewer',\n    description: 'Read-only access to inventory',\n    isSystem: false,\n    permissions: {\n      dashboard: PERMISSION_LEVELS.VIEW,\n      gear_list: PERMISSION_LEVELS.VIEW,\n      item_details: PERMISSION_LEVELS.VIEW,\n      schedule: PERMISSION_LEVELS.VIEW,\n      pack_lists: PERMISSION_LEVELS.VIEW,\n      clients: PERMISSION_LEVELS.HIDE,\n      search: PERMISSION_LEVELS.VIEW,\n      labels: PERMISSION_LEVELS.HIDE,\n      reports: PERMISSION_LEVELS.HIDE,\n      admin_users: PERMISSION_LEVELS.HIDE,\n      admin_categories: PERMISSION_LEVELS.HIDE,\n      admin_specs: PERMISSION_LEVELS.HIDE,\n      admin_locations: PERMISSION_LEVELS.HIDE,\n      admin_themes: PERMISSION_LEVELS.HIDE,\n      admin_layout: PERMISSION_LEVELS.HIDE,\n      admin_notifications: PERMISSION_LEVELS.HIDE,\n      admin_roles: PERMISSION_LEVELS.HIDE,\n      admin_audit: PERMISSION_LEVELS.HIDE,\n    },\n  },\n];\n\n// View identifiers\nexport const VIEWS = {\n  DASHBOARD: 'dashboard',\n  GEAR_LIST: 'inventory',\n  GEAR_DETAIL: 'detail',\n  PACKAGES: 'packages',\n  PACKAGE_DETAIL: 'pkg-detail',\n  PACK_LISTS: 'packlists',\n  SCHEDULE: 'schedule',\n  SEARCH: 'search',\n  LABELS: 'labels',\n  RESERVATION_DETAIL: 'reservation-detail',\n  CLIENTS: 'clients',\n  CLIENT_DETAIL: 'client-detail',\n  CLIENT_REPORT: 'client-report',\n  ADMIN: 'admin',\n  USERS: 'users',\n  REPORTS: 'reports',\n  AUDIT_LOG: 'auditlog',\n  CHANGE_LOG: 'changelog',\n  OVERDUE: 'overdue',\n  NOTIFICATIONS: 'notifications',\n  MAINTENANCE_REPORT: 'maintenance-report',\n  INSURANCE_REPORT: 'insurance-report',\n  LOCATIONS_MANAGE: 'locations-manage',\n  ROLES_MANAGE: 'roles-manage',\n  KIT_DETAIL: 'kit-detail',\n  ADD_ITEM: 'add-item',\n  EDIT_SPECS: 'edit-specs',\n  EDIT_CATEGORIES: 'edit-categories',\n  CUSTOMIZE_DASHBOARD: 'customize-dashboard',\n  CUSTOMIZE_ITEM_DETAIL: 'customize-item-detail',\n  THEME_SELECTOR: 'theme-selector',\n};\n\n// Modal identifiers\nexport const MODALS = {\n  ADD_ITEM: 'add-item',\n  EDIT_ITEM: 'edit-item',\n  ADD_RESERVATION: 'add-res',\n  QR_CODE: 'qr',\n  QR_SCANNER: 'qr-scanner',\n  EXPORT: 'export',\n  PROFILE: 'profile',\n  IMAGE_SELECT: 'image-select',\n  IMAGE_PREVIEW: 'image-preview',\n  CSV_IMPORT: 'csv-import',\n  DATABASE_EXPORT: 'database-export',\n  CHECK_OUT: 'check-out',\n  CHECK_IN: 'check-in',\n  MAINTENANCE: 'maintenance',\n  KIT_MANAGE: 'kit-manage',\n  LOCATION_EDIT: 'location-edit',\n  ADD_TO_KIT: 'add-to-kit',\n  ADD_CLIENT: 'add-client',\n  EDIT_CLIENT: 'edit-client',\n  BULK_STATUS: 'bulk-status',\n  BULK_LOCATION: 'bulk-location',\n  BULK_CATEGORY: 'bulk-category',\n  BULK_DELETE: 'bulk-delete',\n  ADD_USER: 'add-user',\n};\n\n// Layout configuration for customizable sections\n// Each section has: id, label, default visibility, and default order\nexport const DASHBOARD_SECTIONS = {\n  STATS: { id: 'stats', label: 'Statistics', order: 0 },\n  QUICK_SEARCH: { id: 'quickSearch', label: 'Quick Gear Search', order: 1 },\n  ALERTS: { id: 'alerts', label: 'Alerts', order: 2 },\n  REMINDERS: { id: 'reminders', label: 'Due Reminders', order: 3 },\n  LOW_STOCK: { id: 'lowStock', label: 'Low Stock Items', order: 4 },\n  RESERVATIONS: { id: 'reservations', label: 'Upcoming Reservations', order: 5 },\n};\n\nexport const ITEM_DETAIL_SECTIONS = {\n  SPECIFICATIONS: { id: 'specifications', label: 'Specifications', order: 0 },\n  RESERVATIONS: { id: 'reservations', label: 'Reservations', order: 1 },\n  NOTES: { id: 'notes', label: 'Notes', order: 2 },\n  REMINDERS: { id: 'reminders', label: 'Reminders', order: 3 },\n  REQUIRED_ACCESSORIES: { id: 'requiredAccessories', label: 'Required Accessories', order: 4 },\n  PACKAGES: { id: 'packages', label: 'Packages', order: 5 },\n  MAINTENANCE: { id: 'maintenance', label: 'Maintenance', order: 6 },\n  TIMELINE: { id: 'timeline', label: 'Item Timeline', order: 7 },\n  CHECKOUT_HISTORY: { id: 'checkoutHistory', label: 'Checkout History', order: 8 },\n  VALUE: { id: 'value', label: 'Value & Purchase', order: 9 },\n  DEPRECIATION: { id: 'depreciation', label: 'Depreciation', order: 10 },\n};\n\n// Helper to create default section prefs (visible, not collapsed, default order)\nconst createDefaultSectionPrefs = (sections) => {\n  const prefs = {};\n  Object.values(sections).forEach(s => {\n    prefs[s.id] = { visible: true, collapsed: false, order: s.order };\n  });\n  return prefs;\n};\n\n// Default layout preferences\nexport const DEFAULT_LAYOUT_PREFS = {\n  dashboard: {\n    sections: createDefaultSectionPrefs(DASHBOARD_SECTIONS),\n  },\n  itemDetail: {\n    sections: createDefaultSectionPrefs(ITEM_DETAIL_SECTIONS),\n  },\n};\n\n// Item statuses\nexport const STATUS = {\n  AVAILABLE: 'available',\n  CHECKED_OUT: 'checked-out',\n  RESERVED: 'reserved',\n  NEEDS_ATTENTION: 'needs-attention',\n  MISSING: 'missing',\n  OVERDUE: 'overdue',\n  LOW_STOCK: 'low-stock',\n};\n\n// Item conditions\nexport const CONDITION = {\n  EXCELLENT: 'excellent',\n  GOOD: 'good',\n  FAIR: 'fair',\n  POOR: 'poor',\n};\n\n// Equipment categories\nexport const CATEGORIES = [\n  'Cameras',\n  'Lenses',\n  'Lighting',\n  'Audio',\n  'Support',\n  'Accessories',\n  'Storage',\n  'Grip',\n  'Monitors',\n  'Power',\n  'Consumables'\n];\n\n// Category code prefixes for ID generation\nexport const CATEGORY_PREFIXES = {\n  Cameras: 'CA',\n  Lenses: 'LE',\n  Lighting: 'LI',\n  Audio: 'AU',\n  Support: 'SU',\n  Accessories: 'AC',\n  Storage: 'ST',\n  Grip: 'GR',\n  Monitors: 'MO',\n  Power: 'PW',\n  Consumables: 'CO',\n};\n\n// Default category settings - controls per-category behavior\n// trackQuantity: whether items in this category have a quantity field (for consumables/non-serialized items)\n// trackSerialNumbers: whether items require serial numbers\n// trackReorderPoint: whether to show reorder point field (only for consumables)\n// defaultLocation: default storage location for new items in this category\nexport const DEFAULT_CATEGORY_SETTINGS = {\n  Cameras: { trackQuantity: false, trackSerialNumbers: true, trackReorderPoint: false, lowStockThreshold: 0 },\n  Lenses: { trackQuantity: false, trackSerialNumbers: true, trackReorderPoint: false, lowStockThreshold: 0 },\n  Lighting: { trackQuantity: true, trackSerialNumbers: false, trackReorderPoint: false, lowStockThreshold: 2 },\n  Audio: { trackQuantity: true, trackSerialNumbers: false, trackReorderPoint: false, lowStockThreshold: 2 },\n  Support: { trackQuantity: true, trackSerialNumbers: false, trackReorderPoint: false, lowStockThreshold: 1 },\n  Accessories: { trackQuantity: true, trackSerialNumbers: false, trackReorderPoint: false, lowStockThreshold: 3 },\n  Storage: { trackQuantity: true, trackSerialNumbers: false, trackReorderPoint: false, lowStockThreshold: 5 },\n  Grip: { trackQuantity: true, trackSerialNumbers: false, trackReorderPoint: false, lowStockThreshold: 2 },\n  Monitors: { trackQuantity: false, trackSerialNumbers: true, trackReorderPoint: false, lowStockThreshold: 0 },\n  Power: { trackQuantity: true, trackSerialNumbers: false, trackReorderPoint: false, lowStockThreshold: 3 },\n  Consumables: { trackQuantity: true, trackSerialNumbers: false, trackReorderPoint: true, lowStockThreshold: 5 },\n};\n\n// Default settings for new categories\nexport const DEFAULT_NEW_CATEGORY_SETTINGS = {\n  trackQuantity: false,\n  trackSerialNumbers: true,\n  trackReorderPoint: false,\n  lowStockThreshold: 0,\n};\n\n// Project types for reservations\nexport const PROJECT_TYPES = [\n  'Wedding',\n  'Corporate',\n  'Documentary',\n  'Commercial',\n  'Music Video',\n  'Film',\n  'Event',\n  'Portrait',\n  'Other'\n];\n\n// Schedule view modes\nexport const SCHEDULE_MODES = {\n  LIST: 'list',\n  CALENDAR: 'calendar',\n};\n\n// Schedule time periods\nexport const SCHEDULE_PERIODS = {\n  DAY: 'day',\n  WEEK: 'week',\n  MONTH: 'month',\n};\n\n// Label format options\nexport const LABEL_FORMATS = [\n  { id: 'small', name: 'Small - QR Only', width: 1, height: 1, description: '300x300px at 300dpi (square)' },\n  { id: 'medium', name: 'Medium - QR + Info', width: 2, height: 1, description: '600x300px at 300dpi' },\n  { id: 'large', name: 'Large - Full Details', width: 3, height: 2, description: '900x600px at 300dpi' },\n  { id: 'brandingText', name: 'With Branding - Text', width: 3, height: 2.5, description: '900x750px at 300dpi' },\n  { id: 'brandingLogo', name: 'With Branding - Logo', width: 3, height: 2.5, description: '900x750px at 300dpi' },\n];\n\n// Default specification fields per category\n// Based on Canon (cameras/lenses), Aputure (lighting), Matthews Studio Equipment (grip)\nexport const DEFAULT_SPECS = {\n  Cameras: [\n    // Sensor & Image\n    { name: 'Sensor Type', required: true },\n    { name: 'Sensor Size', required: true },\n    { name: 'Effective Pixels', required: true },\n    { name: 'Image Processor', required: false },\n    // Video\n    { name: 'Video Resolution', required: false },\n    { name: 'Frame Rates', required: false },\n    { name: 'Video Format', required: false },\n    { name: 'Bit Depth', required: false },\n    { name: 'Chroma Subsampling', required: false },\n    { name: 'HDR Recording', required: false },\n    // Autofocus\n    { name: 'AF System', required: false },\n    { name: 'AF Points', required: false },\n    { name: 'AF Detection', required: false },\n    // Physical\n    { name: 'Mount Type', required: true },\n    { name: 'Stabilization', required: false },\n    { name: 'ISO Range', required: false },\n    { name: 'Shutter Speed Range', required: false },\n    { name: 'Continuous Shooting', required: false },\n    // Display & Viewfinder\n    { name: 'LCD Screen', required: false },\n    { name: 'Viewfinder Type', required: false },\n    { name: 'Viewfinder Coverage', required: false },\n    // Connectivity\n    { name: 'Memory Card Slots', required: false },\n    { name: 'Card Types Supported', required: false },\n    { name: 'Video Output', required: false },\n    { name: 'Audio Input', required: false },\n    { name: 'Wireless Connectivity', required: false },\n    // Physical Specs\n    { name: 'Body Material', required: false },\n    { name: 'Weather Sealing', required: false },\n    { name: 'Dimensions', required: false },\n    { name: 'Weight', required: false },\n    { name: 'Battery Type', required: false },\n    { name: 'Battery Life', required: false }\n  ],\n  Lenses: [\n    // Optical\n    { name: 'Focal Length', required: true },\n    { name: 'Maximum Aperture', required: true },\n    { name: 'Minimum Aperture', required: false },\n    { name: 'Lens Mount', required: true },\n    { name: 'Lens Format Coverage', required: false },\n    { name: 'Angle of View', required: false },\n    { name: 'Optical Design', required: false },\n    { name: 'Diaphragm Blades', required: false },\n    // Focus\n    { name: 'Minimum Focus Distance', required: false },\n    { name: 'Maximum Magnification', required: false },\n    { name: 'Autofocus', required: false },\n    { name: 'AF Motor Type', required: false },\n    { name: 'Full-Time Manual', required: false },\n    { name: 'Focus Breathing', required: false },\n    { name: 'Internal Focus', required: false },\n    // Stabilization & Features\n    { name: 'Image Stabilization', required: false },\n    { name: 'Stabilization Effect', required: false },\n    // Physical\n    { name: 'Filter Thread', required: false },\n    { name: 'Dimensions', required: false },\n    { name: 'Weight', required: false },\n    { name: 'Hood Included', required: false },\n    { name: 'Weather Sealing', required: false },\n    // Cinema Lenses Additional\n    { name: 'Front Diameter', required: false },\n    { name: 'Focus Rotation', required: false },\n    { name: 'Iris Rotation', required: false },\n    { name: 'Focus Gear Position', required: false }\n  ],\n  Lighting: [\n    // Light Output\n    { name: 'Light Type', required: true },\n    { name: 'Max Power Output', required: true },\n    { name: 'Luminous Flux (lm)', required: false },\n    { name: 'Illuminance (lux)', required: false },\n    { name: 'CRI', required: false },\n    { name: 'TLCI', required: false },\n    // Color\n    { name: 'Color Temperature', required: true },\n    { name: 'CCT Range', required: false },\n    { name: 'Bi-Color', required: false },\n    { name: 'RGB/HSI', required: false },\n    { name: 'Gel/Filter Compatible', required: false },\n    { name: 'Green/Magenta Adjustment', required: false },\n    // Beam\n    { name: 'Beam Angle', required: false },\n    { name: 'Reflector Type', required: false },\n    { name: 'Modifier Mount', required: false },\n    { name: 'Barn Doors Included', required: false },\n    // Control\n    { name: 'Dimming', required: false },\n    { name: 'Dimming Range', required: false },\n    { name: 'Strobe/Effects', required: false },\n    { name: 'Control Method', required: false },\n    { name: 'DMX', required: false },\n    { name: 'Wireless Control', required: false },\n    { name: 'App Control', required: false },\n    // Power\n    { name: 'Power Input', required: false },\n    { name: 'Power Draw', required: false },\n    { name: 'Battery Compatible', required: false },\n    { name: 'Battery Type', required: false },\n    { name: 'Battery Runtime', required: false },\n    // Physical\n    { name: 'Cooling System', required: false },\n    { name: 'Operating Temp', required: false },\n    { name: 'Build Material', required: false },\n    { name: 'Mount Type', required: false },\n    { name: 'Dimensions', required: false },\n    { name: 'Weight', required: false }\n  ],\n  Audio: [\n    // Microphone Type\n    { name: 'Microphone Type', required: true },\n    { name: 'Transducer Type', required: false },\n    { name: 'Polar Pattern', required: true },\n    { name: 'Switchable Patterns', required: false },\n    // Audio Specs\n    { name: 'Frequency Response', required: false },\n    { name: 'Sensitivity', required: false },\n    { name: 'Max SPL', required: false },\n    { name: 'Self-Noise', required: false },\n    { name: 'Signal-to-Noise Ratio', required: false },\n    { name: 'Dynamic Range', required: false },\n    { name: 'Bit Depth/Sample Rate', required: false },\n    // Connectivity\n    { name: 'Output Connector', required: true },\n    { name: 'Impedance', required: false },\n    { name: 'Phantom Power', required: false },\n    // Wireless (if applicable)\n    { name: 'Wireless Frequency', required: false },\n    { name: 'Wireless Range', required: false },\n    { name: 'Channels', required: false },\n    { name: 'Encryption', required: false },\n    // Power\n    { name: 'Power Requirements', required: false },\n    { name: 'Battery Type', required: false },\n    { name: 'Battery Life', required: false },\n    // Physical\n    { name: 'Dimensions', required: false },\n    { name: 'Weight', required: false },\n    { name: 'Cable Length', required: false }\n  ],\n  Support: [\n    // Type & Capacity\n    { name: 'Support Type', required: true },\n    { name: 'Max Payload', required: true },\n    { name: 'Max Height', required: false },\n    { name: 'Min Height', required: false },\n    { name: 'Folded Length', required: false },\n    // Head\n    { name: 'Head Type', required: false },\n    { name: 'Head Included', required: false },\n    { name: 'Bowl Size', required: false },\n    { name: 'Pan Range', required: false },\n    { name: 'Tilt Range', required: false },\n    { name: 'Counterbalance', required: false },\n    // Legs\n    { name: 'Leg Sections', required: false },\n    { name: 'Leg Lock Type', required: false },\n    { name: 'Spreader Type', required: false },\n    { name: 'Spike/Rubber Feet', required: false },\n    // Physical\n    { name: 'Material', required: false },\n    { name: 'Weight', required: false },\n    { name: 'Load Capacity', required: false },\n    { name: 'Center Column', required: false }\n  ],\n  Grip: [\n    // Based on Matthews Studio Equipment specifications\n    // Type & Function\n    { name: 'Grip Type', required: true },\n    { name: 'Primary Use', required: false },\n    // Load & Capacity\n    { name: 'Max Load Capacity', required: false },\n    { name: 'Working Load Limit', required: false },\n    // Dimensions\n    { name: 'Length', required: false },\n    { name: 'Width', required: false },\n    { name: 'Height', required: false },\n    { name: 'Extended Length', required: false },\n    { name: 'Collapsed Length', required: false },\n    { name: 'Reach/Arm Length', required: false },\n    // Mounting\n    { name: 'Mounting Hardware', required: false },\n    { name: 'Receiver Size', required: false },\n    { name: 'Pin/Spud Size', required: false },\n    { name: 'Junior/Baby Pin', required: false },\n    // Features\n    { name: 'Riser/Extension', required: false },\n    { name: 'Leveling Leg', required: false },\n    { name: 'Locking Mechanism', required: false },\n    { name: 'Wheels/Casters', required: false },\n    { name: 'Brakes', required: false },\n    // Physical\n    { name: 'Material', required: false },\n    { name: 'Finish', required: false },\n    { name: 'Weight', required: false },\n    // Flags/Frames/Diffusion\n    { name: 'Frame Size', required: false },\n    { name: 'Fabric Type', required: false },\n    { name: 'Diffusion Rating', required: false }\n  ],\n  Accessories: [\n    { name: 'Accessory Type', required: true },\n    { name: 'Compatibility', required: false },\n    { name: 'Material', required: false },\n    { name: 'Dimensions', required: false },\n    { name: 'Weight', required: false },\n    { name: 'Color/Finish', required: false },\n    { name: 'Mounting Type', required: false },\n    { name: 'Thread Size', required: false }\n  ],\n  Storage: [\n    { name: 'Storage Type', required: true },\n    { name: 'Capacity', required: true },\n    { name: 'Interface', required: false },\n    { name: 'Read Speed', required: false },\n    { name: 'Write Speed', required: false },\n    { name: 'Video Speed Class', required: false },\n    { name: 'UHS Speed Class', required: false },\n    { name: 'Min Sustained Write', required: false },\n    { name: 'Form Factor', required: false },\n    { name: 'Operating Temp', required: false },\n    { name: 'Dimensions', required: false },\n    { name: 'Weight', required: false }\n  ],\n  Monitors: [\n    // Display\n    { name: 'Screen Size', required: true },\n    { name: 'Resolution', required: true },\n    { name: 'Panel Type', required: false },\n    { name: 'Pixel Density', required: false },\n    { name: 'Aspect Ratio', required: false },\n    { name: 'Brightness', required: false },\n    { name: 'Contrast Ratio', required: false },\n    { name: 'Color Depth', required: false },\n    { name: 'Color Gamut', required: false },\n    { name: 'HDR Support', required: false },\n    { name: 'LUT Support', required: false },\n    { name: 'Viewing Angle', required: false },\n    // Features\n    { name: 'Touchscreen', required: false },\n    { name: 'Focus Assist', required: false },\n    { name: 'False Color', required: false },\n    { name: 'Waveform/Scopes', required: false },\n    { name: 'Zebras', required: false },\n    { name: 'Anamorphic Desqueeze', required: false },\n    // Connectivity\n    { name: 'HDMI Input', required: false },\n    { name: 'SDI Input', required: false },\n    { name: 'HDMI Output', required: false },\n    { name: 'SDI Output', required: false },\n    // Power\n    { name: 'Power Input', required: false },\n    { name: 'Battery Plate', required: false },\n    { name: 'Power Draw', required: false },\n    // Physical\n    { name: 'Mounting Points', required: false },\n    { name: 'Dimensions', required: false },\n    { name: 'Weight', required: false }\n  ],\n  Power: [\n    // Battery Specs\n    { name: 'Battery Type', required: true },\n    { name: 'Chemistry', required: false },\n    { name: 'Capacity (Wh)', required: true },\n    { name: 'Capacity (mAh)', required: false },\n    { name: 'Voltage', required: true },\n    { name: 'Max Discharge', required: false },\n    // Outputs\n    { name: 'D-Tap Outputs', required: false },\n    { name: 'USB Outputs', required: false },\n    { name: 'DC Outputs', required: false },\n    { name: 'Regulated Outputs', required: false },\n    // Charging\n    { name: 'Charge Time', required: false },\n    { name: 'Charger Included', required: false },\n    // Features\n    { name: 'LED Indicator', required: false },\n    { name: 'Runtime Display', required: false },\n    { name: 'Hot Swappable', required: false },\n    // Physical\n    { name: 'Mount Type', required: false },\n    { name: 'Dimensions', required: false },\n    { name: 'Weight', required: false },\n    // Safety\n    { name: 'Protection Circuits', required: false },\n    { name: 'Airline Approved', required: false }\n  ],\n  Consumables: [\n    // Basic Info\n    { name: 'Type', required: true },\n    { name: 'Size/Dimensions', required: false },\n    { name: 'Color', required: false },\n    // Quantity\n    { name: 'Unit of Measure', required: false },\n    { name: 'Units per Package', required: false },\n    // Usage\n    { name: 'Compatible With', required: false },\n    { name: 'Expiration Date', required: false },\n    // Storage\n    { name: 'Storage Requirements', required: false }\n  ]\n};\n\n// Maintenance types\nexport const MAINTENANCE_TYPES = [\n  'Repair',\n  'Cleaning',\n  'Calibration',\n  'Firmware Update',\n  'Parts Replacement',\n  'Inspection',\n  'Preventive Maintenance',\n  'Other'\n];\n\n// Maintenance status\nexport const MAINTENANCE_STATUS = {\n  SCHEDULED: 'scheduled',\n  IN_PROGRESS: 'in-progress',\n  COMPLETED: 'completed',\n  CANCELLED: 'cancelled',\n};\n\n// Default empty states for forms\nexport const EMPTY_ITEM_FORM = {\n  name: '',\n  brand: '',\n  category: 'Cameras',\n  location: '',\n  purchaseDate: '',\n  purchasePrice: '',\n  currentValue: '',\n  serialNumber: '',\n  condition: CONDITION.EXCELLENT,\n  image: null,\n  specs: {},\n  // Quantity tracking fields (used when category has trackQuantity: true)\n  quantity: 1,\n  reorderPoint: 0,\n};\n\nexport const EMPTY_RESERVATION_FORM = {\n  start: '',\n  end: '',\n  project: '',\n  projectType: 'Other',\n  user: '',\n  contactPhone: '',\n  contactEmail: '',\n  location: '',\n  notes: [],\n  itemId: '',\n  itemIds: [],\n  clientId: ''\n};\n\n// ============================================================================\n// Kit / Container Types\n// ============================================================================\nexport const KIT_TYPES = {\n  KIT: 'kit',           // A collection of items that go together (e.g., Camera Kit)\n  CONTAINER: 'container', // A physical container (e.g., Pelican Case)\n  BUNDLE: 'bundle',     // A logical grouping for checkout purposes\n};\n\n// ============================================================================\n// Hierarchical Locations\n// ============================================================================\n// Default location hierarchy structure\nexport const DEFAULT_LOCATIONS = [\n  {\n    id: 'loc-studio-a',\n    name: 'Studio A',\n    type: 'building',\n    children: [\n      { id: 'loc-studio-a-main', name: 'Main Floor', type: 'room', children: [\n        { id: 'loc-studio-a-shelf-1', name: 'Shelf 1', type: 'shelf', children: [] },\n        { id: 'loc-studio-a-shelf-2', name: 'Shelf 2', type: 'shelf', children: [] },\n        { id: 'loc-studio-a-shelf-3', name: 'Shelf 3', type: 'shelf', children: [] },\n      ]},\n      { id: 'loc-studio-a-lens', name: 'Lens Cabinet', type: 'cabinet', children: [] },\n    ]\n  },\n  {\n    id: 'loc-studio-b',\n    name: 'Studio B',\n    type: 'building',\n    children: [\n      { id: 'loc-studio-b-camera', name: 'Camera Cage', type: 'room', children: [] },\n      { id: 'loc-studio-b-gimbal', name: 'Gimbal Area', type: 'room', children: [] },\n    ]\n  },\n  {\n    id: 'loc-warehouse',\n    name: 'Warehouse',\n    type: 'building',\n    children: [\n      { id: 'loc-warehouse-storage', name: 'Long-term Storage', type: 'room', children: [] },\n      { id: 'loc-warehouse-staging', name: 'Staging Area', type: 'room', children: [] },\n    ]\n  },\n  {\n    id: 'loc-accessories',\n    name: 'Accessories Cabinet',\n    type: 'cabinet',\n    children: []\n  },\n  {\n    id: 'loc-repair',\n    name: 'Repair Shop',\n    type: 'external',\n    children: []\n  },\n];\n\n// Location types\nexport const LOCATION_TYPES = [\n  { value: 'building', label: 'Building', icon: 'Building2' },\n  { value: 'room', label: 'Room', icon: 'Door' },\n  { value: 'cabinet', label: 'Cabinet/Closet', icon: 'Archive' },\n  { value: 'shelf', label: 'Shelf/Rack', icon: 'Layers' },\n  { value: 'case', label: 'Case/Container', icon: 'Box' },\n  { value: 'external', label: 'External Location', icon: 'MapPin' },\n];\n","// =============================================================================\n// Logger Utility\n// Wraps console methods to only output in development mode.\n// In production builds, debug/log calls are no-ops to keep the console clean\n// and avoid leaking internal information (table names, user emails, etc.).\n//\n// Usage:\n//   import { log, warn, error } from './lib/logger.js';\n//   log('[App] User authenticated:', email);   // silent in production\n//   warn('Community aliases not available');     // silent in production\n//   error('Failed to save:', err);              // always outputs\n// =============================================================================\n\nconst isDev = typeof import.meta !== 'undefined' && import.meta.env?.DEV;\n\n/** Debug-level logging  silent in production */\nexport const log = isDev\n  ? console.log.bind(console)\n  : () => {};\n\n/** Info-level logging  silent in production */\nexport const info = isDev\n  ? console.info.bind(console)\n  : () => {};\n\n/** Warning-level logging  silent in production */\nexport const warn = isDev\n  ? console.warn.bind(console)\n  : () => {};\n\n/** Error-level logging  always outputs (errors should be visible) */\nexport const error = console.error.bind(console);\n","// ============================================================================\n// SIMS Theme Configuration\n// Uses CSS custom properties (variables) for dynamic theme switching\n// ============================================================================\n\n// ============================================================================\n// Colors - Using CSS variables for theme support\n// These reference CSS custom properties that are set by ThemeContext\n// For opacity, use the withOpacity() helper which uses CSS color-mix()\n// ============================================================================\n\nimport { warn } from './lib/logger.js';\n\nexport const colors = {\n  // Primary backgrounds\n  bgDark: 'var(--bg-dark)',\n  bgMedium: 'var(--bg-medium)',\n  bgLight: 'var(--bg-light)',\n  bgCard: 'var(--bg-card)',\n  bgCardSolid: 'var(--bg-card-solid)',\n  \n  // Accent colors\n  primary: 'var(--primary)',\n  primaryLight: 'var(--primary-light)',\n  primaryDark: 'var(--primary-dark)',\n  \n  accent1: 'var(--accent1)',\n  accent2: 'var(--accent2)',\n  accent3: 'var(--accent3)',\n  \n  // Status colors\n  available: 'var(--status-available)',\n  checkedOut: 'var(--status-checked-out)',\n  reserved: 'var(--status-reserved)',\n  needsAttention: 'var(--status-needs-attention)',\n  missing: 'var(--status-missing)',\n  \n  // Condition colors\n  excellent: 'var(--condition-excellent)',\n  good: 'var(--condition-good)',\n  fair: 'var(--condition-fair)',\n  poor: 'var(--condition-poor)',\n  \n  // Text colors\n  textPrimary: 'var(--text-primary)',\n  textSecondary: 'var(--text-secondary)',\n  textMuted: 'var(--text-muted)',\n  \n  // Border colors\n  border: 'var(--border)',\n  borderLight: 'var(--border-light)',\n  \n  // Semantic colors\n  danger: 'var(--danger)',\n  dangerBg: 'var(--danger-bg)',\n  success: 'var(--success)',\n  warning: 'var(--warning)',\n  \n  // Focus ring (accessibility)\n  focusRing: 'var(--focus-ring-color)',\n};\n\n// ============================================================================\n// Opacity Helper - Uses CSS color-mix() for theme-aware opacity\n// ============================================================================\n\n/**\n * Apply opacity to a CSS color variable using color-mix()\n * This works with CSS variables and automatically updates with theme changes\n * \n * @param {string} color - A CSS variable reference (e.g., colors.primary or 'var(--primary)') or hex color\n * @param {number} percent - Opacity percentage (0-100), e.g., 20 for 20% opacity\n * @returns {string} CSS color-mix() expression\n * \n * @example\n * // Using with colors object\n * background: withOpacity(colors.primary, 20)  // 20% opacity\n * border: `1px solid ${withOpacity(colors.primary, 50)}`  // 50% opacity\n * \n * // Using with CSS variable string\n * background: withOpacity('var(--panel-alerts)', 15)\n * \n * // Using with hex color (works but not reactive to theme)\n * background: withOpacity('#6366f1', 20)\n */\nexport const withOpacity = (color, percent) => {\n  // Safety check for undefined/null colors\n  if (!color) {\n    warn('withOpacity called with undefined color');\n    return 'transparent';\n  }\n  // Handle hex colors directly for backwards compatibility\n  if (color.startsWith('#')) {\n    return `color-mix(in srgb, ${color} ${percent}%, transparent)`;\n  }\n  // Handle CSS variable references\n  return `color-mix(in srgb, ${color} ${percent}%, transparent)`;\n};\n\n// ============================================================================\n// Static values - These don't change with themes\n// ============================================================================\n\n// Typography\nexport const typography = {\n  fontFamily: 'system-ui, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif',\n  fontSize: {\n    xs: '10px',\n    sm: '12px',\n    base: '14px',\n    md: '15px',\n    lg: '16px',\n    xl: '18px',\n    '2xl': '20px',\n    '3xl': '24px',\n  },\n  fontWeight: {\n    normal: 400,\n    medium: 500,\n    semibold: 600,\n    bold: 700,\n  },\n  lineHeight: {\n    tight: 1.25,\n    normal: 1.5,\n    relaxed: 1.75,\n  },\n};\n\n// Spacing scale (in pixels)\nexport const spacing = {\n  0: 0,\n  1: 4,\n  2: 8,\n  3: 12,\n  4: 16,\n  5: 20,\n  6: 24,\n  8: 32,\n  10: 40,\n  12: 48,\n  16: 64,\n};\n\n// Border radius\nexport const borderRadius = {\n  sm: '4px',\n  md: '8px',\n  lg: '10px',\n  xl: '12px',\n  '2xl': '16px',\n  full: '9999px',\n};\n\n// Shadows - Using CSS variables for theme support\nexport const shadows = {\n  sm: 'var(--shadow-sm)',\n  md: 'var(--shadow-md)',\n  lg: 'var(--shadow-lg)',\n  card: 'var(--shadow-card)',\n};\n\n// Z-index layers\nexport const zIndex = {\n  base: 0,\n  dropdown: 100,\n  sticky: 200,\n  fixed: 300,\n  modalBackdrop: 400,\n  modal: 500,\n  popover: 600,\n  tooltip: 700,\n};\n\n// Transitions\nexport const transitions = {\n  fast: '150ms ease',\n  normal: '250ms ease',\n  slow: '350ms ease',\n};\n\n// ============================================================================\n// Reusable Style Objects\n// ============================================================================\n\nexport const styles = {\n  // Card style\n  card: {\n    background: colors.bgLight,\n    backdropFilter: 'blur(10px)',\n    borderRadius: borderRadius.xl,\n    border: `1px solid ${colors.border}`,\n    boxShadow: shadows.card,\n  },\n\n  // Primary button\n  btn: {\n    display: 'flex',\n    alignItems: 'center',\n    gap: spacing[2],\n    background: `linear-gradient(135deg, ${colors.primary}, ${colors.primaryDark})`,\n    color: colors.textPrimary,\n    border: 'none',\n    padding: `${spacing[2]}px ${spacing[4]}px`,\n    borderRadius: borderRadius.lg,\n    cursor: 'pointer',\n    fontWeight: typography.fontWeight.medium,\n    fontSize: typography.fontSize.sm,\n    transition: transitions.fast,\n  },\n\n  // Secondary button\n  btnSec: {\n    display: 'flex',\n    alignItems: 'center',\n    gap: spacing[2],\n    background: 'transparent',\n    color: colors.textPrimary,\n    border: `1px solid ${colors.border}`,\n    padding: `${spacing[2]}px ${spacing[3]}px`,\n    borderRadius: borderRadius.lg,\n    cursor: 'pointer',\n    fontSize: typography.fontSize.sm,\n    transition: transitions.fast,\n  },\n\n  // Danger button modifier\n  btnDanger: {\n    borderColor: colors.danger,\n    color: colors.danger,\n  },\n\n  // Input field\n  input: {\n    width: '100%',\n    padding: `${spacing[3]}px ${spacing[4]}px`,\n    background: 'var(--input-bg, rgba(93, 138, 168, 0.1))',\n    border: `1px solid ${colors.border}`,\n    borderRadius: borderRadius.lg,\n    color: colors.textPrimary,\n    fontSize: typography.fontSize.base,\n    fontFamily: 'system-ui, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif',\n    outline: 'none',\n    boxSizing: 'border-box',\n  },\n\n  // Select dropdown - matches input but with proper height\n  select: {\n    width: '100%',\n    padding: `${spacing[3]}px ${spacing[4]}px`,\n    paddingRight: `${spacing[8]}px`, // Extra space for dropdown arrow\n    background: 'var(--input-bg, rgba(93, 138, 168, 0.1))',\n    border: `1px solid ${colors.border}`,\n    borderRadius: borderRadius.lg,\n    color: colors.textPrimary,\n    fontSize: typography.fontSize.base,\n    outline: 'none',\n    boxSizing: 'border-box',\n    cursor: 'pointer',\n    appearance: 'none',\n    WebkitAppearance: 'none',\n    MozAppearance: 'none',\n    backgroundImage: `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E\")`,\n    backgroundRepeat: 'no-repeat',\n    backgroundPosition: `right ${spacing[3]}px center`,\n    minHeight: '42px', // Match input height\n  },\n\n  // Form label\n  label: {\n    display: 'block',\n    fontSize: typography.fontSize.xs,\n    color: colors.textMuted,\n    textTransform: 'uppercase',\n    letterSpacing: '0.5px',\n    marginBottom: spacing[2],\n  },\n\n  // Modal backdrop\n  modal: {\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    background: 'rgba(0, 0, 0, 0.7)',\n    backdropFilter: 'blur(4px)',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    zIndex: zIndex.modal,\n    padding: spacing[4],\n  },\n\n  // Modal box\n  modalBox: {\n    background: colors.bgMedium,\n    borderRadius: borderRadius.xl,\n    border: `1px solid ${colors.border}`,\n    maxWidth: '500px',\n    width: '100%',\n    maxHeight: '90vh',\n    overflow: 'hidden',\n    boxShadow: shadows.lg,\n  },\n};\n\n// ============================================================================\n// Component-Specific Styles\n// ============================================================================\n\nexport const componentStyles = {\n  // Sidebar\n  sidebar: {\n    width: '260px',\n    height: '100vh',\n    position: 'fixed',\n    left: 0,\n    top: 0,\n    background: colors.bgMedium,\n    borderRight: `1px solid ${colors.border}`,\n    display: 'flex',\n    flexDirection: 'column',\n    zIndex: zIndex.fixed,\n  },\n\n  // Main content area\n  main: {\n    flex: 1,\n    marginLeft: '260px',\n    padding: spacing[8],\n    minHeight: '100vh',\n    boxSizing: 'border-box',\n  },\n\n  // Page header\n  pageHeader: {\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: spacing[6],\n  },\n\n  // Page title\n  pageTitle: {\n    margin: 0,\n    fontSize: typography.fontSize['3xl'],\n    fontWeight: typography.fontWeight.semibold,\n    color: colors.textPrimary,\n  },\n\n  // Grid layouts\n  grid: {\n    auto: {\n      display: 'grid',\n      gridTemplateColumns: 'repeat(auto-fill, minmax(180px, 1fr))',\n      gap: spacing[4],\n    },\n    two: {\n      display: 'grid',\n      gridTemplateColumns: '1fr 1fr',\n      gap: spacing[4],\n    },\n    sidebar: {\n      display: 'grid',\n      gridTemplateColumns: '1fr 320px',\n      gap: spacing[6],\n    },\n  },\n};\n\n// ============================================================================\n// Helper Functions\n// ============================================================================\n\n/**\n * Merge multiple style objects\n * @param {...Object} styles - Style objects to merge\n * @returns {Object} Merged style object\n */\nexport const mergeStyles = (...styleObjects) => {\n  return Object.assign({}, ...styleObjects);\n};\n\n/**\n * Create a style object with conditional properties\n * @param {Object} baseStyle - Base styles\n * @param {Object} conditionalStyles - Object with condition: styles pairs\n * @returns {Object} Merged style object\n */\nexport const conditionalStyle = (baseStyle, conditionalStyles) => {\n  const result = { ...baseStyle };\n  Object.entries(conditionalStyles).forEach(([condition, styles]) => {\n    if (condition) {\n      Object.assign(result, styles);\n    }\n  });\n  return result;\n};\n","// ============================================================================\n// SIMS Utility Functions\n// Pure functions with no side effects for data transformation and formatting\n// ============================================================================\n\nimport { CATEGORY_PREFIXES, STATUS, CONDITION } from './constants.js';\nimport { colors } from './theme.js';\n\n// ============================================================================\n// ID Generation\n// ============================================================================\n\n/**\n * Generate a unique item code based on category\n * @param {string} category - The item category\n * @param {string[]} existingCodes - Array of existing codes to avoid duplicates\n * @returns {string} A unique item code like \"CA1234\"\n */\nexport const generateItemCode = (category, existingCodes = []) => {\n  const prefix = CATEGORY_PREFIXES[category] || 'OT';\n  let code;\n  let attempts = 0;\n  const maxAttempts = 100;\n  const codes = existingCodes || [];\n  \n  do {\n    code = prefix + Math.floor(1000 + Math.random() * 9000);\n    attempts++;\n  } while (codes.includes(code) && attempts < maxAttempts);\n  \n  if (attempts >= maxAttempts) {\n    // Fallback to timestamp-based code if random generation fails\n    code = prefix + Date.now().toString().slice(-4);\n  }\n  \n  return code;\n};\n\n/**\n * Generate a unique ID for internal use\n * @returns {string} A unique ID\n */\nexport const generateId = () => {\n  return `id_${Date.now()}_${Math.random().toString(36).substring(2, 11)}`;\n};\n\n// ============================================================================\n// Date Formatting\n// ============================================================================\n\n/**\n * Format a date string to a readable format\n * @param {string|Date} date - The date to format\n * @returns {string} Formatted date like \"Jan 15, 2025\"\n */\nexport const formatDate = (date) => {\n  if (!date) return '-';\n  try {\n    const d = new Date(date);\n    if (isNaN(d.getTime())) return '-';\n    return d.toLocaleDateString('en-US', {\n      month: 'short',\n      day: 'numeric',\n      year: 'numeric'\n    });\n  } catch {\n    return '-';\n  }\n};\n\n/**\n * Format a date string to include time\n * @param {string|Date} date - The date to format\n * @returns {string} Formatted datetime like \"Jan 15, 2025, 3:30 PM\"\n */\nexport const formatDateTime = (date) => {\n  if (!date) return '-';\n  try {\n    const d = new Date(date);\n    if (isNaN(d.getTime())) return '-';\n    return d.toLocaleString('en-US', {\n      month: 'short',\n      day: 'numeric',\n      year: 'numeric',\n      hour: 'numeric',\n      minute: '2-digit'\n    });\n  } catch {\n    return '-';\n  }\n};\n\n/**\n * Get today's date as ISO string (YYYY-MM-DD)\n * @returns {string}\n */\nexport const getTodayISO = () => new Date().toISOString().split('T')[0];\n\n/**\n * Check if a date is before today\n * @param {string} date - Date to check\n * @returns {boolean}\n */\nexport const isOverdue = (date) => {\n  if (!date) return false;\n  return date < getTodayISO();\n};\n\n// ============================================================================\n// Reservation Conflict Detection\n// ============================================================================\n\n// Helper: Check if two date ranges overlap (used internally by conflict detection)\nconst doDateRangesOverlap = (start1, end1, start2, end2) => {\n  if (!start1 || !end1 || !start2 || !end2) return false;\n  // Ranges overlap if one starts before the other ends\n  return start1 <= end2 && start2 <= end1;\n};\n\n// Helper: Find conflicting reservations for a given date range\nconst findConflictingReservations = (existingReservations, startDate, endDate, excludeReservationId = null) => {\n  if (!existingReservations || !startDate || !endDate) return [];\n  \n  return existingReservations.filter(reservation => {\n    // Skip the reservation being edited\n    if (excludeReservationId && reservation.id === excludeReservationId) return false;\n    \n    // Check for date overlap\n    return doDateRangesOverlap(startDate, endDate, reservation.start, reservation.end);\n  });\n};\n\n// Helper: Check if an item is currently checked out during a date range\nconst checkCheckoutConflict = (item, startDate, endDate) => {\n  if (!item || item.status !== 'checked-out' || !item.checkedOutDate) return null;\n  \n  // If item is checked out and no due date, it conflicts with everything\n  if (!item.dueBack) {\n    return {\n      type: 'checked-out',\n      borrower: item.checkedOutTo,\n      checkedOutDate: item.checkedOutDate,\n      dueBack: null,\n      message: `Currently checked out to ${item.checkedOutTo} (no return date set)`\n    };\n  }\n  \n  // Check if the checkout period overlaps with the requested dates\n  if (doDateRangesOverlap(startDate, endDate, item.checkedOutDate, item.dueBack)) {\n    return {\n      type: 'checked-out',\n      borrower: item.checkedOutTo,\n      checkedOutDate: item.checkedOutDate,\n      dueBack: item.dueBack,\n      message: `Checked out to ${item.checkedOutTo} until ${item.dueBack}`\n    };\n  }\n  \n  return null;\n};\n\n/**\n * Get all conflicts for a proposed reservation\n * @param {Object} item - The inventory item\n * @param {string} startDate - Proposed start date\n * @param {string} endDate - Proposed end date\n * @param {string} excludeReservationId - Optional reservation ID to exclude\n * @returns {Object} Object with reservationConflicts array and checkoutConflict\n */\nexport const getAllReservationConflicts = (item, startDate, endDate, excludeReservationId = null) => {\n  if (!item) return { reservationConflicts: [], checkoutConflict: null };\n  \n  const reservationConflicts = findConflictingReservations(\n    item.reservations || [],\n    startDate,\n    endDate,\n    excludeReservationId\n  );\n  \n  const checkoutConflict = checkCheckoutConflict(item, startDate, endDate);\n  \n  return {\n    reservationConflicts,\n    checkoutConflict,\n    hasConflicts: reservationConflicts.length > 0 || checkoutConflict !== null\n  };\n};\n\n// ============================================================================\n// Money Formatting\n// ============================================================================\n\n/**\n * Format a number as currency\n * @param {number} amount - The amount to format\n * @returns {string} Formatted currency like \"$1,234\"\n */\nexport const formatMoney = (amount) => {\n  return '$' + (amount || 0).toLocaleString('en-US', {\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0\n  });\n};\n\n// ============================================================================\n// Color Utilities\n// ============================================================================\n\n/**\n * Get the color for a given status\n * @param {string} status - The item status\n * @returns {string} The color code\n */\nexport const getStatusColor = (status) => {\n  const statusColors = {\n    [STATUS.AVAILABLE]: colors.available,\n    [STATUS.CHECKED_OUT]: colors.checkedOut,\n    [STATUS.RESERVED]: colors.reserved,\n    [STATUS.NEEDS_ATTENTION]: colors.needsAttention,\n    [STATUS.MISSING]: colors.missing,\n  };\n  return statusColors[status] || colors.textMuted;\n};\n\n/**\n * Get the color for a given condition\n * @param {string} condition - The item condition\n * @returns {string} The color code\n */\nexport const getConditionColor = (condition) => {\n  const conditionColors = {\n    [CONDITION.EXCELLENT]: colors.excellent,\n    [CONDITION.GOOD]: colors.good,\n    [CONDITION.FAIR]: colors.fair,\n    [CONDITION.POOR]: colors.poor,\n  };\n  return conditionColors[condition] || colors.textMuted;\n};\n\n// ============================================================================\n// Array/Object Utilities\n// ============================================================================\n\n/**\n * Update an item in an array by ID\n * @param {Array} array - The array to update\n * @param {string} id - The ID of the item to update\n * @param {Object|Function} updates - Object with updates or function that receives item\n * @returns {Array} New array with updated item\n */\nexport const updateById = (array, id, updates) => {\n  return array.map(item => {\n    if (item.id !== id) return item;\n    if (typeof updates === 'function') {\n      return { ...item, ...updates(item) };\n    }\n    return { ...item, ...updates };\n  });\n};\n\n/**\n * Remove an item from an array by ID\n * @param {Array} array - The array to filter\n * @param {string} id - The ID of the item to remove\n * @returns {Array} New array without the item\n */\nexport const removeById = (array, id) => {\n  return array.filter(item => item.id !== id);\n};\n\n/**\n * Find an item in an array by ID\n * @param {Array} array - The array to search\n * @param {string} id - The ID to find\n * @returns {Object|undefined} The found item or undefined\n */\nexport const findById = (array, id) => {\n  return array.find(item => item.id === id);\n};\n\n// ============================================================================\n// Search/Filter Utilities\n// ============================================================================\n\n/**\n * Filter items by search query\n * @param {Array} items - Items to filter\n * @param {string} query - Search query\n * @param {string[]} fields - Fields to search in\n * @returns {Array} Filtered items\n */\nexport const filterBySearch = (items, query, fields = ['name', 'brand', 'id']) => {\n  if (!query?.trim()) return items;\n  const q = query.toLowerCase().trim();\n  return items.filter(item =>\n    fields.some(field => \n      item[field]?.toString().toLowerCase().includes(q)\n    )\n  );\n};\n\n/**\n * Filter items by category\n * @param {Array} items - Items to filter\n * @param {string|string[]} categories - Category or categories to filter by\n * @returns {Array} Filtered items\n */\nexport const filterByCategory = (items, categories) => {\n  if (!categories || categories === 'all') return items;\n  const cats = Array.isArray(categories) ? categories : [categories];\n  if (cats.length === 0) return items;\n  return items.filter(item => cats.includes(item.category));\n};\n\n/**\n * Filter items by status\n * @param {Array} items - Items to filter\n * @param {string|string[]} statuses - Status or statuses to filter by\n * @returns {Array} Filtered items\n */\nexport const filterByStatus = (items, statuses) => {\n  if (!statuses || statuses === 'all') return items;\n  const stats = Array.isArray(statuses) ? statuses : [statuses];\n  if (stats.length === 0) return items;\n  \n  // Handle OVERDUE status specially - it's a computed state, not stored status\n  if (stats.includes('overdue')) {\n    const today = getTodayISO();\n    return items.filter(item => \n      item.status === 'checked-out' && item.dueBack && item.dueBack < today\n    );\n  }\n  \n  return items.filter(item => stats.includes(item.status));\n};\n\n// ============================================================================\n// Note Utilities (recursive tree operations)\n// ============================================================================\n\n/**\n * Add a reply to a note in a nested structure\n * @param {Array} notes - Array of notes\n * @param {string} parentId - ID of parent note\n * @param {Object} reply - Reply object to add\n * @returns {Array} Updated notes array\n */\nexport const addReplyToNote = (notes, parentId, reply) => {\n  return notes.map(note => {\n    if (note.id === parentId) {\n      return { ...note, replies: [...(note.replies || []), reply] };\n    }\n    if (note.replies?.length > 0) {\n      return { ...note, replies: addReplyToNote(note.replies, parentId, reply) };\n    }\n    return note;\n  });\n};\n\n/**\n * Mark a note as deleted in a nested structure\n * @param {Array} notes - Array of notes\n * @param {string} noteId - ID of note to mark deleted\n * @returns {Array} Updated notes array\n */\nexport const markNoteDeleted = (notes, noteId) => {\n  return notes.map(note => {\n    if (note.id === noteId) {\n      return { ...note, deleted: true };\n    }\n    if (note.replies?.length > 0) {\n      return { ...note, replies: markNoteDeleted(note.replies, noteId) };\n    }\n    return note;\n  });\n};\n\n/**\n * Find a note by ID in a nested structure\n * @param {Array} notes - Array of notes\n * @param {string} noteId - ID of note to find\n * @returns {Object|null} Found note or null\n */\nexport const findNoteById = (notes, noteId) => {\n  for (const note of notes) {\n    if (note.id === noteId) return note;\n    if (note.replies?.length > 0) {\n      const found = findNoteById(note.replies, noteId);\n      if (found) return found;\n    }\n  }\n  return null;\n};\n\n// ============================================================================\n// Validation Utilities\n// ============================================================================\n\n/**\n * Check if required fields are filled\n * @param {Object} obj - Object to validate\n * @param {string[]} requiredFields - Array of required field names\n// ============================================================================\n// Location Utilities\n// ============================================================================\n\n/**\n * Flatten a hierarchical location tree into a flat array\n * @param {Array} locations - Array of location objects with optional children\n * @param {string} parentPath - Current path prefix\n * @returns {Array} Flat array of locations with fullPath\n */\nexport const flattenLocations = (locations, parentPath = '') => {\n  const result = [];\n  locations.forEach(loc => {\n    const fullPath = parentPath ? `${parentPath} > ${loc.name}` : loc.name;\n    result.push({ \n      id: loc.id, \n      name: loc.name, \n      fullPath, \n      type: loc.type,\n      depth: parentPath.split('>').length - 1 + (parentPath ? 1 : 0),\n    });\n    if (loc.children && loc.children.length > 0) {\n      result.push(...flattenLocations(loc.children, fullPath));\n    }\n  });\n  return result;\n};\n\n// ============================================================================\n// Reminder Utilities\n// ============================================================================\n\n/**\n * Get next due date based on recurrence pattern\n * @param {string} currentDueDate - Current due date (ISO string)\n * @param {string} recurrence - Recurrence type (weekly, monthly, etc.)\n * @returns {string|null} Next due date or null if no recurrence\n */\nexport const getNextDueDate = (currentDueDate, recurrence) => {\n  const date = new Date(currentDueDate);\n  \n  switch (recurrence) {\n    case 'weekly':\n      date.setDate(date.getDate() + 7);\n      break;\n    case 'biweekly':\n      date.setDate(date.getDate() + 14);\n      break;\n    case 'monthly':\n      date.setMonth(date.getMonth() + 1);\n      break;\n    case 'quarterly':\n      date.setMonth(date.getMonth() + 3);\n      break;\n    case 'biannual':\n      date.setMonth(date.getMonth() + 6);\n      break;\n    case 'yearly':\n      date.setFullYear(date.getFullYear() + 1);\n      break;\n    default:\n      return null;\n  }\n  \n  return date.toISOString().split('T')[0];\n};\n\n/**\n * Check if a reminder is due (today or past)\n * @param {Object} reminder - Reminder object with dueDate and completed fields\n * @returns {boolean} True if reminder is due\n */\nexport const isReminderDue = (reminder) => {\n  if (!reminder || reminder.completed) return false;\n  const today = getTodayISO();\n  return reminder.dueDate <= today;\n};\n\n// ============================================================================\n// Depreciation Utilities\n// ============================================================================\n\n/**\n * Depreciation calculation methods\n */\nexport const DEPRECIATION_METHODS = {\n  STRAIGHT_LINE: 'straight-line',\n  DECLINING_BALANCE: 'declining-balance',\n  DOUBLE_DECLINING: 'double-declining',\n};\n\n/**\n * Default useful life by category (in years)\n */\nexport const DEFAULT_USEFUL_LIFE = {\n  Cameras: 5,\n  Lenses: 7,\n  Lighting: 7,\n  Audio: 6,\n  Support: 10,\n  Accessories: 3,\n  Storage: 3,\n  Grip: 10,\n  Monitors: 5,\n  Power: 4,\n};\n\n/**\n * Calculate depreciation for an asset\n * @param {number} purchasePrice - Original purchase price\n * @param {string} purchaseDate - Purchase date (ISO string)\n * @param {number} usefulLife - Useful life in years\n * @param {number} salvageValue - Salvage value at end of life\n * @param {string} method - Depreciation method\n * @returns {Object} Depreciation details including currentValue, schedule, etc.\n */\nexport const calculateDepreciation = (purchasePrice, purchaseDate, usefulLife, salvageValue, method) => {\n  if (!purchaseDate) {\n    return {\n      currentValue: purchasePrice,\n      totalDepreciation: 0,\n      annualDepreciation: 0,\n      monthlyDepreciation: 0,\n      ageInMonths: 0,\n      percentDepreciated: 0,\n      schedule: [],\n    };\n  }\n  const purchase = new Date(purchaseDate);\n  const today = new Date();\n  const ageInYears = (today - purchase) / (365.25 * 24 * 60 * 60 * 1000);\n  const ageInMonths = Math.floor(ageInYears * 12);\n  \n  const depreciableAmount = purchasePrice - salvageValue;\n  \n  let currentValue, annualDepreciation, monthlyDepreciation, totalDepreciation;\n  let schedule = [];\n  \n  switch (method) {\n    case DEPRECIATION_METHODS.STRAIGHT_LINE:\n      // Straight-line: Equal depreciation each year\n      annualDepreciation = depreciableAmount / usefulLife;\n      monthlyDepreciation = annualDepreciation / 12;\n      totalDepreciation = Math.min(ageInYears * annualDepreciation, depreciableAmount);\n      currentValue = Math.max(purchasePrice - totalDepreciation, salvageValue);\n      \n      // Build schedule\n      for (let year = 1; year <= usefulLife; year++) {\n        const yearEnd = new Date(purchase);\n        yearEnd.setFullYear(yearEnd.getFullYear() + year);\n        const startValue = purchasePrice - (annualDepreciation * (year - 1));\n        const endValue = Math.max(startValue - annualDepreciation, salvageValue);\n        schedule.push({\n          year,\n          date: yearEnd.toISOString().split('T')[0],\n          startValue,\n          depreciation: startValue - endValue,\n          endValue,\n          accumulated: purchasePrice - endValue,\n        });\n      }\n      break;\n      \n    case DEPRECIATION_METHODS.DECLINING_BALANCE: {\n      // Declining balance: Fixed percentage of remaining value (150% of straight-line rate)\n      const dbRate = (1 / usefulLife) * 1.5;\n      let remainingValue = purchasePrice;\n      totalDepreciation = 0;\n      \n      for (let year = 1; year <= usefulLife; year++) {\n        const yearEnd = new Date(purchase);\n        yearEnd.setFullYear(yearEnd.getFullYear() + year);\n        const startValue = remainingValue;\n        let yearDepreciation = startValue * dbRate;\n        \n        // Don't depreciate below salvage value\n        if (remainingValue - yearDepreciation < salvageValue) {\n          yearDepreciation = remainingValue - salvageValue;\n        }\n        \n        remainingValue = startValue - yearDepreciation;\n        \n        // Track total depreciation up to current age\n        if (year <= Math.ceil(ageInYears)) {\n          if (year < Math.ceil(ageInYears)) {\n            totalDepreciation += yearDepreciation;\n          } else {\n            // Partial year\n            totalDepreciation += yearDepreciation * (ageInYears - Math.floor(ageInYears));\n          }\n        }\n        \n        schedule.push({\n          year,\n          date: yearEnd.toISOString().split('T')[0],\n          startValue,\n          depreciation: yearDepreciation,\n          endValue: remainingValue,\n          accumulated: purchasePrice - remainingValue,\n        });\n      }\n      \n      currentValue = Math.max(purchasePrice - totalDepreciation, salvageValue);\n      annualDepreciation = schedule[0]?.depreciation || 0;\n      monthlyDepreciation = annualDepreciation / 12;\n      break;\n    }\n      \n    case DEPRECIATION_METHODS.DOUBLE_DECLINING: {\n      // Double declining balance: 200% of straight-line rate\n      const ddbRate = (1 / usefulLife) * 2;\n      let ddbRemainingValue = purchasePrice;\n      totalDepreciation = 0;\n      \n      for (let year = 1; year <= usefulLife; year++) {\n        const yearEnd = new Date(purchase);\n        yearEnd.setFullYear(yearEnd.getFullYear() + year);\n        const startValue = ddbRemainingValue;\n        let yearDepreciation = startValue * ddbRate;\n        \n        // Switch to straight-line if it gives higher depreciation\n        const straightLineRemaining = (ddbRemainingValue - salvageValue) / (usefulLife - year + 1);\n        if (straightLineRemaining > yearDepreciation) {\n          yearDepreciation = straightLineRemaining;\n        }\n        \n        // Don't depreciate below salvage value\n        if (ddbRemainingValue - yearDepreciation < salvageValue) {\n          yearDepreciation = ddbRemainingValue - salvageValue;\n        }\n        \n        ddbRemainingValue = startValue - yearDepreciation;\n        \n        // Track total depreciation up to current age\n        if (year <= Math.ceil(ageInYears)) {\n          if (year < Math.ceil(ageInYears)) {\n            totalDepreciation += yearDepreciation;\n          } else {\n            totalDepreciation += yearDepreciation * (ageInYears - Math.floor(ageInYears));\n          }\n        }\n        \n        schedule.push({\n          year,\n          date: yearEnd.toISOString().split('T')[0],\n          startValue,\n          depreciation: yearDepreciation,\n          endValue: ddbRemainingValue,\n          accumulated: purchasePrice - ddbRemainingValue,\n        });\n      }\n      \n      currentValue = Math.max(purchasePrice - totalDepreciation, salvageValue);\n      annualDepreciation = schedule[0]?.depreciation || 0;\n      monthlyDepreciation = annualDepreciation / 12;\n      break;\n    }\n      \n    default:\n      currentValue = purchasePrice;\n      annualDepreciation = 0;\n      monthlyDepreciation = 0;\n      totalDepreciation = 0;\n  }\n  \n  return {\n    currentValue,\n    totalDepreciation,\n    annualDepreciation,\n    monthlyDepreciation,\n    ageInYears,\n    ageInMonths,\n    schedule,\n    percentDepreciated: (totalDepreciation / depreciableAmount) * 100,\n  };\n};\n","// ============================================================================\n// SIMS Theme Data - All theme definitions in one place\n// ============================================================================\n\n// Base color keys that all themes must define\nexport const COLOR_KEYS = [\n  '--bg-dark', '--bg-medium', '--bg-light', '--bg-card', '--bg-card-solid',\n  '--primary', '--primary-light', '--primary-dark',\n  '--accent1', '--accent2', '--accent3', '--accent4', '--accent5', '--accent6',\n  '--status-available', '--status-checked-out', '--status-reserved', '--status-needs-attention', '--status-missing',\n  '--condition-excellent', '--condition-good', '--condition-fair', '--condition-poor',\n  '--text-primary', '--text-secondary', '--text-muted',\n  '--border', '--border-light',\n  '--danger', '--danger-bg', '--success', '--warning',\n  '--focus-ring-color', '--focus-ring-color-danger',\n  '--sidebar-item1', '--sidebar-item2', '--sidebar-item3', '--sidebar-item4', '--sidebar-item5', '--sidebar-item6',\n  '--panel-stats', '--panel-search', '--panel-alerts', '--panel-reminders', '--panel-lowstock', '--panel-reservations',\n  '--shadow-sm', '--shadow-md', '--shadow-lg', '--shadow-card',\n];\n\n// Color categories for the editor UI\nexport const COLOR_CATEGORIES = {\n  backgrounds: {\n    label: 'Backgrounds',\n    colors: [\n      { key: '--bg-dark', label: 'Main Background' },\n      { key: '--bg-medium', label: 'Medium Background' },\n      { key: '--bg-light', label: 'Light Background' },\n      { key: '--bg-card', label: 'Card Background' },\n    ]\n  },\n  primary: {\n    label: 'Primary Colors',\n    colors: [\n      { key: '--primary', label: 'Primary' },\n      { key: '--primary-light', label: 'Primary Light' },\n      { key: '--primary-dark', label: 'Primary Dark' },\n    ]\n  },\n  accents: {\n    label: 'Accent Colors',\n    colors: [\n      { key: '--accent1', label: 'Accent 1' },\n      { key: '--accent2', label: 'Accent 2' },\n      { key: '--accent3', label: 'Accent 3' },\n      { key: '--accent4', label: 'Accent 4' },\n      { key: '--accent5', label: 'Accent 5' },\n      { key: '--accent6', label: 'Accent 6' },\n    ]\n  },\n  text: {\n    label: 'Text Colors',\n    colors: [\n      { key: '--text-primary', label: 'Primary Text' },\n      { key: '--text-secondary', label: 'Secondary Text' },\n      { key: '--text-muted', label: 'Muted Text' },\n    ]\n  },\n  status: {\n    label: 'Status Colors',\n    colors: [\n      { key: '--status-available', label: 'Available' },\n      { key: '--status-checked-out', label: 'Checked Out' },\n      { key: '--status-reserved', label: 'Reserved' },\n      { key: '--status-needs-attention', label: 'Needs Attention' },\n      { key: '--status-missing', label: 'Missing' },\n    ]\n  },\n  feedback: {\n    label: 'Feedback Colors',\n    colors: [\n      { key: '--danger', label: 'Danger' },\n      { key: '--success', label: 'Success' },\n      { key: '--warning', label: 'Warning' },\n    ]\n  },\n  accessibility: {\n    label: 'Accessibility',\n    colors: [\n      { key: '--focus-ring-color', label: 'Focus Ring Color' },\n      { key: '--focus-ring-color-danger', label: 'Focus Ring (Danger)' },\n    ]\n  },\n  panels: {\n    label: 'Dashboard Panels',\n    colors: [\n      { key: '--panel-stats', label: 'Statistics' },\n      { key: '--panel-search', label: 'Quick Search' },\n      { key: '--panel-alerts', label: 'Alerts' },\n      { key: '--panel-reminders', label: 'Reminders' },\n      { key: '--panel-lowstock', label: 'Low Stock' },\n      { key: '--panel-reservations', label: 'Reservations' },\n    ]\n  },\n};\n\n// Default custom theme (used as starting point for custom editor)\nexport const DEFAULT_CUSTOM_THEME = {\n  '--bg-dark': '#1a1d21',\n  '--bg-medium': '#22262b',\n  '--bg-light': '#2a2f36',\n  '--bg-card': '#22262b',\n  '--bg-card-solid': '#22262b',\n  '--primary': '#5d8aa8',\n  '--primary-light': '#7ba3be',\n  '--primary-dark': '#4a7089',\n  '--accent1': '#6b9e9e',\n  '--accent2': '#7a8f7a',\n  '--accent3': '#8fa5b5',\n  '--accent4': '#a58f8f',\n  '--accent5': '#9e9e6b',\n  '--accent6': '#8f7aa5',\n  '--status-available': '#6b9e78',\n  '--status-checked-out': '#8fa5b5',\n  '--status-reserved': '#5d8aa8',\n  '--status-needs-attention': '#b58f6b',\n  '--status-missing': '#9e6b6b',\n  '--condition-excellent': '#6b9e78',\n  '--condition-good': '#7a8f7a',\n  '--condition-fair': '#b5a56b',\n  '--condition-poor': '#b58f6b',\n  '--text-primary': '#e2e6ea',\n  '--text-secondary': 'rgba(226, 230, 234, 0.65)',\n  '--text-muted': 'rgba(226, 230, 234, 0.4)',\n  '--border': 'rgba(93, 138, 168, 0.2)',\n  '--border-light': 'rgba(93, 138, 168, 0.1)',\n  '--danger': '#b56b6b',\n  '--danger-bg': 'rgba(181, 107, 107, 0.1)',\n  '--success': '#6b9e78',\n  '--warning': '#b5a56b',\n  '--focus-ring-color': '#8bb5cc',\n  '--focus-ring-color-danger': '#d08080',\n  '--sidebar-item1': '#5d8aa8',\n  '--sidebar-item2': '#6b9e9e',\n  '--sidebar-item3': '#7a8f7a',\n  '--sidebar-item4': '#8fa5b5',\n  '--sidebar-item5': '#a58f8f',\n  '--sidebar-item6': '#9e9e6b',\n  '--panel-stats': '#5d8aa8',\n  '--panel-search': '#6b9e9e',\n  '--panel-alerts': '#b58f6b',\n  '--panel-reminders': '#b5a56b',\n  '--panel-lowstock': '#9e6b6b',\n  '--panel-reservations': '#8fa5b5',\n  '--shadow-sm': '0 1px 2px rgba(0, 0, 0, 0.3)',\n  '--shadow-md': '0 4px 6px rgba(0, 0, 0, 0.3)',\n  '--shadow-lg': '0 10px 15px rgba(0, 0, 0, 0.3)',\n  '--shadow-card': '0 4px 20px rgba(0, 0, 0, 0.25)',\n};\n\n// Helper to generate shadows\nconst shadow = (opacity = 0.3) => ({\n  '--shadow-sm': `0 1px 2px rgba(0, 0, 0, ${opacity})`,\n  '--shadow-md': `0 4px 6px rgba(0, 0, 0, ${opacity})`,\n  '--shadow-lg': `0 10px 15px rgba(0, 0, 0, ${opacity})`,\n  '--shadow-card': `0 4px 20px rgba(0, 0, 0, ${opacity - 0.05})`,\n});\n\n// ============================================================================\n// Theme Definitions\n// ============================================================================\n\nexport const themes = {\n  light: {\n    id: 'light', name: 'Light', description: 'Clean, standard light theme',\n    colors: {\n      '--bg-dark': '#f0f2f5', '--bg-medium': '#ffffff', '--bg-light': '#f8f9fa', '--bg-card': '#ffffff', '--bg-card-solid': '#ffffff',\n      '--primary': '#2563eb', '--primary-light': '#3b82f6', '--primary-dark': '#1d4ed8',\n      '--accent1': '#0891b2', '--accent2': '#059669', '--accent3': '#7c3aed', '--accent4': '#db2777', '--accent5': '#ea580c', '--accent6': '#65a30d',\n      '--status-available': '#16a34a', '--status-checked-out': '#2563eb', '--status-reserved': '#7c3aed', '--status-needs-attention': '#ea580c', '--status-missing': '#dc2626',\n      '--condition-excellent': '#16a34a', '--condition-good': '#22c55e', '--condition-fair': '#eab308', '--condition-poor': '#ea580c',\n      '--text-primary': '#1f2937', '--text-secondary': '#4b5563', '--text-muted': '#9ca3af',\n      '--border': '#e5e7eb', '--border-light': '#f3f4f6',\n      '--danger': '#dc2626', '--danger-bg': 'rgba(220, 38, 38, 0.1)', '--success': '#16a34a', '--warning': '#eab308',\n      '--sidebar-item1': '#2563eb', '--sidebar-item2': '#0891b2', '--sidebar-item3': '#059669', '--sidebar-item4': '#7c3aed', '--sidebar-item5': '#db2777', '--sidebar-item6': '#ea580c',\n      '--panel-stats': '#2563eb', '--panel-search': '#0891b2', '--panel-alerts': '#ea580c', '--panel-reminders': '#eab308', '--panel-lowstock': '#dc2626', '--panel-reservations': '#7c3aed',\n      ...shadow(0.08),\n    }\n  },\n\n  dark: {\n    id: 'dark', name: 'Dark', description: 'Default dark theme with muted blue accents',\n    colors: { ...DEFAULT_CUSTOM_THEME }\n  },\n\n  darker: {\n    id: 'darker', name: 'Darker', description: 'Pure black backgrounds with grey accents',\n    colors: {\n      '--bg-dark': '#000000', '--bg-medium': '#0a0a0a', '--bg-light': '#141414', '--bg-card': '#0a0a0a', '--bg-card-solid': '#0a0a0a',\n      '--primary': '#666666', '--primary-light': '#888888', '--primary-dark': '#444444',\n      '--accent1': '#555555', '--accent2': '#666666', '--accent3': '#777777', '--accent4': '#888888', '--accent5': '#999999', '--accent6': '#aaaaaa',\n      '--status-available': '#4a4a4a', '--status-checked-out': '#5a5a5a', '--status-reserved': '#6a6a6a', '--status-needs-attention': '#7a7a7a', '--status-missing': '#8a8a8a',\n      '--condition-excellent': '#4a4a4a', '--condition-good': '#5a5a5a', '--condition-fair': '#6a6a6a', '--condition-poor': '#7a7a7a',\n      '--text-primary': '#999999', '--text-secondary': '#777777', '--text-muted': '#555555',\n      '--border': '#333333', '--border-light': '#222222',\n      '--danger': '#666666', '--danger-bg': 'rgba(102, 102, 102, 0.1)', '--success': '#555555', '--warning': '#777777',\n      '--sidebar-item1': '#666666', '--sidebar-item2': '#666666', '--sidebar-item3': '#666666', '--sidebar-item4': '#666666', '--sidebar-item5': '#666666', '--sidebar-item6': '#666666',\n      '--panel-stats': '#444444', '--panel-search': '#444444', '--panel-alerts': '#444444', '--panel-reminders': '#444444', '--panel-lowstock': '#444444', '--panel-reservations': '#444444',\n      ...shadow(0.5),\n    }\n  },\n\n  primaries: {\n    id: 'primaries', name: 'Primaries', description: \"Bright primary colors like children's toys\",\n    colors: {\n      '--bg-dark': '#ffeb3b', '--bg-medium': '#fff59d', '--bg-light': '#fffde7', '--bg-card': '#ffffff', '--bg-card-solid': '#ffffff',\n      '--primary': '#f44336', '--primary-light': '#e57373', '--primary-dark': '#c62828',\n      '--accent1': '#2196f3', '--accent2': '#4caf50', '--accent3': '#ff9800', '--accent4': '#9c27b0', '--accent5': '#00bcd4', '--accent6': '#e91e63',\n      '--status-available': '#4caf50', '--status-checked-out': '#2196f3', '--status-reserved': '#9c27b0', '--status-needs-attention': '#ff9800', '--status-missing': '#f44336',\n      '--condition-excellent': '#4caf50', '--condition-good': '#8bc34a', '--condition-fair': '#ffeb3b', '--condition-poor': '#ff9800',\n      '--text-primary': '#1a1a1a', '--text-secondary': '#333333', '--text-muted': '#666666',\n      '--border': '#f44336', '--border-light': '#ffcdd2',\n      '--danger': '#f44336', '--danger-bg': 'rgba(244, 67, 54, 0.15)', '--success': '#4caf50', '--warning': '#ff9800',\n      '--sidebar-item1': '#f44336', '--sidebar-item2': '#2196f3', '--sidebar-item3': '#4caf50', '--sidebar-item4': '#ff9800', '--sidebar-item5': '#9c27b0', '--sidebar-item6': '#00bcd4',\n      '--panel-stats': '#2196f3', '--panel-search': '#4caf50', '--panel-alerts': '#ff9800', '--panel-reminders': '#9c27b0', '--panel-lowstock': '#f44336', '--panel-reservations': '#00bcd4',\n      '--shadow-sm': '0 2px 4px rgba(244, 67, 54, 0.3)', '--shadow-md': '0 4px 8px rgba(33, 150, 243, 0.3)', '--shadow-lg': '0 10px 20px rgba(76, 175, 80, 0.3)', '--shadow-card': '0 4px 20px rgba(156, 39, 176, 0.25)',\n    }\n  },\n\n  pastel: {\n    id: 'pastel', name: 'Pastel', description: 'Soft, pleasing pastel tones',\n    colors: {\n      '--bg-dark': '#fdf2f8', '--bg-medium': '#fefefe', '--bg-light': '#f5f3ff', '--bg-card': '#ffffff', '--bg-card-solid': '#ffffff',\n      '--primary': '#a78bfa', '--primary-light': '#c4b5fd', '--primary-dark': '#8b5cf6',\n      '--accent1': '#67e8f9', '--accent2': '#86efac', '--accent3': '#fda4af', '--accent4': '#fdba74', '--accent5': '#fde047', '--accent6': '#a5b4fc',\n      '--status-available': '#86efac', '--status-checked-out': '#93c5fd', '--status-reserved': '#c4b5fd', '--status-needs-attention': '#fdba74', '--status-missing': '#fca5a5',\n      '--condition-excellent': '#86efac', '--condition-good': '#a7f3d0', '--condition-fair': '#fde68a', '--condition-poor': '#fed7aa',\n      '--text-primary': '#374151', '--text-secondary': '#6b7280', '--text-muted': '#9ca3af',\n      '--border': '#e9d5ff', '--border-light': '#f3e8ff',\n      '--danger': '#f9a8d4', '--danger-bg': 'rgba(249, 168, 212, 0.2)', '--success': '#86efac', '--warning': '#fde68a',\n      '--sidebar-item1': '#a78bfa', '--sidebar-item2': '#67e8f9', '--sidebar-item3': '#86efac', '--sidebar-item4': '#fda4af', '--sidebar-item5': '#fdba74', '--sidebar-item6': '#a5b4fc',\n      '--panel-stats': '#a78bfa', '--panel-search': '#67e8f9', '--panel-alerts': '#fdba74', '--panel-reminders': '#fde047', '--panel-lowstock': '#fda4af', '--panel-reservations': '#a5b4fc',\n      ...shadow(0.1),\n    }\n  },\n\n  terminal: {\n    id: 'terminal', name: 'Terminal', description: '80s hacker computer aesthetic',\n    colors: {\n      '--bg-dark': '#0a0a0a', '--bg-medium': '#0d0d0d', '--bg-light': '#111111', '--bg-card': '#0d0d0d', '--bg-card-solid': '#0d0d0d',\n      '--primary': '#00ff00', '--primary-light': '#33ff33', '--primary-dark': '#00cc00',\n      '--accent1': '#00ff00', '--accent2': '#00dd00', '--accent3': '#00bb00', '--accent4': '#00ff66', '--accent5': '#66ff00', '--accent6': '#00ffaa',\n      '--status-available': '#00ff00', '--status-checked-out': '#00cc00', '--status-reserved': '#00aa00', '--status-needs-attention': '#ffff00', '--status-missing': '#ff0000',\n      '--condition-excellent': '#00ff00', '--condition-good': '#00dd00', '--condition-fair': '#ccff00', '--condition-poor': '#ffcc00',\n      '--text-primary': '#00ff00', '--text-secondary': '#00cc00', '--text-muted': '#008800',\n      '--border': '#00ff00', '--border-light': '#004400',\n      '--danger': '#ff0000', '--danger-bg': 'rgba(255, 0, 0, 0.1)', '--success': '#00ff00', '--warning': '#ffff00',\n      '--sidebar-item1': '#00ff00', '--sidebar-item2': '#00ff66', '--sidebar-item3': '#00ffaa', '--sidebar-item4': '#66ff00', '--sidebar-item5': '#00dd00', '--sidebar-item6': '#00cc00',\n      '--panel-stats': '#00ff00', '--panel-search': '#00ff66', '--panel-alerts': '#ffff00', '--panel-reminders': '#00ffaa', '--panel-lowstock': '#ff0000', '--panel-reservations': '#66ff00',\n      '--shadow-sm': '0 0 5px rgba(0, 255, 0, 0.3)', '--shadow-md': '0 0 10px rgba(0, 255, 0, 0.3)', '--shadow-lg': '0 0 20px rgba(0, 255, 0, 0.3)', '--shadow-card': '0 0 15px rgba(0, 255, 0, 0.2)',\n    },\n    fontFamily: '\"Courier New\", Courier, monospace',\n  },\n\n  blackwhite: {\n    id: 'blackwhite', name: 'Black & White', description: 'Pure grayscale aesthetic',\n    colors: {\n      '--bg-dark': '#ffffff', '--bg-medium': '#fafafa', '--bg-light': '#f5f5f5', '--bg-card': '#ffffff', '--bg-card-solid': '#ffffff',\n      '--primary': '#333333', '--primary-light': '#555555', '--primary-dark': '#111111',\n      '--accent1': '#444444', '--accent2': '#666666', '--accent3': '#888888', '--accent4': '#555555', '--accent5': '#777777', '--accent6': '#999999',\n      '--status-available': '#333333', '--status-checked-out': '#555555', '--status-reserved': '#777777', '--status-needs-attention': '#999999', '--status-missing': '#111111',\n      '--condition-excellent': '#222222', '--condition-good': '#444444', '--condition-fair': '#777777', '--condition-poor': '#999999',\n      '--text-primary': '#000000', '--text-secondary': '#333333', '--text-muted': '#888888',\n      '--border': '#cccccc', '--border-light': '#eeeeee',\n      '--danger': '#000000', '--danger-bg': 'rgba(0, 0, 0, 0.05)', '--success': '#333333', '--warning': '#666666',\n      '--sidebar-item1': '#333333', '--sidebar-item2': '#444444', '--sidebar-item3': '#555555', '--sidebar-item4': '#666666', '--sidebar-item5': '#777777', '--sidebar-item6': '#888888',\n      '--panel-stats': '#333333', '--panel-search': '#555555', '--panel-alerts': '#777777', '--panel-reminders': '#444444', '--panel-lowstock': '#222222', '--panel-reservations': '#666666',\n      ...shadow(0.1),\n    }\n  },\n\n  vibrant: {\n    id: 'vibrant', name: 'Vibrant', description: 'Bold, saturated complementary colors',\n    colors: {\n      '--bg-dark': '#1a0a2e', '--bg-medium': '#16213e', '--bg-light': '#1f3460', '--bg-card': '#16213e', '--bg-card-solid': '#16213e',\n      '--primary': '#ff006e', '--primary-light': '#ff4d94', '--primary-dark': '#cc0058',\n      '--accent1': '#00f5d4', '--accent2': '#fee440', '--accent3': '#9b5de5', '--accent4': '#00bbf9', '--accent5': '#f15bb5', '--accent6': '#00ff87',\n      '--status-available': '#00f5d4', '--status-checked-out': '#00bbf9', '--status-reserved': '#9b5de5', '--status-needs-attention': '#fee440', '--status-missing': '#f15bb5',\n      '--condition-excellent': '#00f5d4', '--condition-good': '#00bbf9', '--condition-fair': '#fee440', '--condition-poor': '#f15bb5',\n      '--text-primary': '#ffffff', '--text-secondary': 'rgba(255, 255, 255, 0.8)', '--text-muted': 'rgba(255, 255, 255, 0.5)',\n      '--border': 'rgba(255, 0, 110, 0.3)', '--border-light': 'rgba(255, 0, 110, 0.15)',\n      '--danger': '#f15bb5', '--danger-bg': 'rgba(241, 91, 181, 0.15)', '--success': '#00f5d4', '--warning': '#fee440',\n      '--sidebar-item1': '#ff006e', '--sidebar-item2': '#00f5d4', '--sidebar-item3': '#fee440', '--sidebar-item4': '#9b5de5', '--sidebar-item5': '#00bbf9', '--sidebar-item6': '#f15bb5',\n      '--panel-stats': '#00f5d4', '--panel-search': '#00bbf9', '--panel-alerts': '#fee440', '--panel-reminders': '#9b5de5', '--panel-lowstock': '#f15bb5', '--panel-reservations': '#ff006e',\n      '--shadow-sm': '0 1px 3px rgba(255, 0, 110, 0.4)', '--shadow-md': '0 4px 8px rgba(0, 245, 212, 0.3)', '--shadow-lg': '0 10px 20px rgba(155, 93, 229, 0.3)', '--shadow-card': '0 4px 25px rgba(155, 93, 229, 0.4)',\n    }\n  },\n\n  muted: {\n    id: 'muted', name: 'Muted', description: 'Soft, desaturated tones',\n    colors: {\n      '--bg-dark': '#2d2d3a', '--bg-medium': '#363646', '--bg-light': '#404052', '--bg-card': '#363646', '--bg-card-solid': '#363646',\n      '--primary': '#9d8189', '--primary-light': '#b8a1a8', '--primary-dark': '#7d656b',\n      '--accent1': '#7ec8b8', '--accent2': '#c9b896', '--accent3': '#8b7eb8', '--accent4': '#7eb8c8', '--accent5': '#b87e8b', '--accent6': '#96c9a8',\n      '--status-available': '#7ec8b8', '--status-checked-out': '#7eb8c8', '--status-reserved': '#8b7eb8', '--status-needs-attention': '#c9b896', '--status-missing': '#b87e8b',\n      '--condition-excellent': '#7ec8b8', '--condition-good': '#96c9a8', '--condition-fair': '#c9c196', '--condition-poor': '#c9a896',\n      '--text-primary': '#e8e4e6', '--text-secondary': 'rgba(232, 228, 230, 0.7)', '--text-muted': 'rgba(232, 228, 230, 0.45)',\n      '--border': 'rgba(157, 129, 137, 0.25)', '--border-light': 'rgba(157, 129, 137, 0.12)',\n      '--danger': '#b87e8b', '--danger-bg': 'rgba(184, 126, 139, 0.12)', '--success': '#7ec8b8', '--warning': '#c9b896',\n      '--sidebar-item1': '#9d8189', '--sidebar-item2': '#7ec8b8', '--sidebar-item3': '#c9b896', '--sidebar-item4': '#8b7eb8', '--sidebar-item5': '#7eb8c8', '--sidebar-item6': '#b87e8b',\n      '--panel-stats': '#7ec8b8', '--panel-search': '#7eb8c8', '--panel-alerts': '#c9b896', '--panel-reminders': '#8b7eb8', '--panel-lowstock': '#b87e8b', '--panel-reservations': '#9d8189',\n      ...shadow(0.25),\n    }\n  },\n\n  xp: {\n    id: 'xp', name: 'XP', description: 'Windows XP nostalgia',\n    colors: {\n      '--bg-dark': '#3a6ea5', '--bg-medium': '#ece9d8', '--bg-light': '#f5f4ea', '--bg-card': '#ece9d8', '--bg-card-solid': '#ece9d8',\n      '--primary': '#0054e3', '--primary-light': '#3399ff', '--primary-dark': '#003399',\n      '--accent1': '#21a121', '--accent2': '#ff8c00', '--accent3': '#cc0099', '--accent4': '#0099cc', '--accent5': '#ff6600', '--accent6': '#9933ff',\n      '--status-available': '#21a121', '--status-checked-out': '#0054e3', '--status-reserved': '#ff8c00', '--status-needs-attention': '#ff8c00', '--status-missing': '#cc0000',\n      '--condition-excellent': '#21a121', '--condition-good': '#66cc66', '--condition-fair': '#ffcc00', '--condition-poor': '#ff8c00',\n      '--text-primary': '#000000', '--text-secondary': '#333333', '--text-muted': '#808080',\n      '--border': '#7f9db9', '--border-light': '#d4d0c8',\n      '--danger': '#cc0000', '--danger-bg': 'rgba(204, 0, 0, 0.1)', '--success': '#21a121', '--warning': '#ff8c00',\n      '--sidebar-item1': '#0054e3', '--sidebar-item2': '#21a121', '--sidebar-item3': '#ff8c00', '--sidebar-item4': '#cc0099', '--sidebar-item5': '#0099cc', '--sidebar-item6': '#9933ff',\n      '--panel-stats': '#0054e3', '--panel-search': '#21a121', '--panel-alerts': '#ff8c00', '--panel-reminders': '#cc0099', '--panel-lowstock': '#cc0000', '--panel-reservations': '#0099cc',\n      '--shadow-sm': '1px 1px 0 #808080, inset 1px 1px 0 #ffffff', '--shadow-md': '2px 2px 0 #808080, inset 1px 1px 0 #ffffff', '--shadow-lg': '3px 3px 0 #808080, inset 1px 1px 0 #ffffff', '--shadow-card': '2px 2px 5px rgba(0, 0, 0, 0.3)',\n    },\n    buttonStyle: 'xp',\n  },\n\n  cheese: {\n    id: 'cheese', name: 'Cheese', description: 'For the cheese enthusiasts ',\n    colors: {\n      '--bg-dark': '#ffd54f', '--bg-medium': '#ffecb3', '--bg-light': '#fff8e1', '--bg-card': '#fffde7', '--bg-card-solid': '#fffde7',\n      '--primary': '#ff8f00', '--primary-light': '#ffa726', '--primary-dark': '#e65100',\n      '--accent1': '#ffcc80', '--accent2': '#ffe082', '--accent3': '#ffab40', '--accent4': '#ffd180', '--accent5': '#ffb74d', '--accent6': '#ffca28',\n      '--status-available': '#ffc107', '--status-checked-out': '#ff9800', '--status-reserved': '#ffab40', '--status-needs-attention': '#e65100', '--status-missing': '#bf360c',\n      '--condition-excellent': '#ffc107', '--condition-good': '#ffca28', '--condition-fair': '#ffa000', '--condition-poor': '#ff6f00',\n      '--text-primary': '#4e342e', '--text-secondary': '#5d4037', '--text-muted': '#8d6e63',\n      '--border': '#ffb74d', '--border-light': '#ffe0b2',\n      '--danger': '#bf360c', '--danger-bg': 'rgba(191, 54, 12, 0.1)', '--success': '#ffc107', '--warning': '#ff9800',\n      '--sidebar-item1': '#ff8f00', '--sidebar-item2': '#ffa726', '--sidebar-item3': '#ffb74d', '--sidebar-item4': '#ffca28', '--sidebar-item5': '#ffd54f', '--sidebar-item6': '#ffe082',\n      '--panel-stats': '#ff8f00', '--panel-search': '#ffa726', '--panel-alerts': '#e65100', '--panel-reminders': '#ffb74d', '--panel-lowstock': '#bf360c', '--panel-reservations': '#ffca28',\n      ...shadow(0.25),\n    },\n    backgroundImage: '/cheese-bg.svg',\n    cursor: '/cheese-cursor.svg',\n  },\n\n  cats: {\n    id: 'cats', name: 'Cats', description: 'Purrfect for cat lovers ',\n    colors: {\n      '--bg-dark': '#fce4ec', '--bg-medium': '#fff0f5', '--bg-light': '#fff5f8', '--bg-card': '#ffffff', '--bg-card-solid': '#ffffff',\n      '--primary': '#ec407a', '--primary-light': '#f48fb1', '--primary-dark': '#c2185b',\n      '--accent1': '#ab47bc', '--accent2': '#7e57c2', '--accent3': '#42a5f5', '--accent4': '#ff7043', '--accent5': '#66bb6a', '--accent6': '#ffca28',\n      '--status-available': '#66bb6a', '--status-checked-out': '#42a5f5', '--status-reserved': '#ab47bc', '--status-needs-attention': '#ffa726', '--status-missing': '#ef5350',\n      '--condition-excellent': '#66bb6a', '--condition-good': '#9ccc65', '--condition-fair': '#ffee58', '--condition-poor': '#ffa726',\n      '--text-primary': '#4a4a4a', '--text-secondary': '#6d6d6d', '--text-muted': '#9e9e9e',\n      '--border': '#f8bbd9', '--border-light': '#fce4ec',\n      '--danger': '#ef5350', '--danger-bg': 'rgba(239, 83, 80, 0.1)', '--success': '#66bb6a', '--warning': '#ffa726',\n      '--sidebar-item1': '#ec407a', '--sidebar-item2': '#ab47bc', '--sidebar-item3': '#7e57c2', '--sidebar-item4': '#42a5f5', '--sidebar-item5': '#ff7043', '--sidebar-item6': '#66bb6a',\n      '--panel-stats': '#ec407a', '--panel-search': '#ab47bc', '--panel-alerts': '#ff7043', '--panel-reminders': '#7e57c2', '--panel-lowstock': '#ef5350', '--panel-reservations': '#42a5f5',\n      ...shadow(0.15),\n    },\n    backgroundImage: '/cats-bg.svg',\n    cursor: '/cats-cursor.svg',\n  },\n\n  dogs: {\n    id: 'dogs', name: 'Dogs', description: 'Pawsitively adorable ',\n    colors: {\n      '--bg-dark': '#efebe9', '--bg-medium': '#faf7f5', '--bg-light': '#fffbf8', '--bg-card': '#ffffff', '--bg-card-solid': '#ffffff',\n      '--primary': '#8d6e63', '--primary-light': '#a1887f', '--primary-dark': '#6d4c41',\n      '--accent1': '#ff8a65', '--accent2': '#4fc3f7', '--accent3': '#aed581', '--accent4': '#ffb74d', '--accent5': '#ba68c8', '--accent6': '#4dd0e1',\n      '--status-available': '#81c784', '--status-checked-out': '#4fc3f7', '--status-reserved': '#ffb74d', '--status-needs-attention': '#ff8a65', '--status-missing': '#e57373',\n      '--condition-excellent': '#81c784', '--condition-good': '#aed581', '--condition-fair': '#fff176', '--condition-poor': '#ffb74d',\n      '--text-primary': '#4e342e', '--text-secondary': '#5d4037', '--text-muted': '#8d6e63',\n      '--border': '#d7ccc8', '--border-light': '#efebe9',\n      '--danger': '#e57373', '--danger-bg': 'rgba(229, 115, 115, 0.1)', '--success': '#81c784', '--warning': '#ffb74d',\n      '--sidebar-item1': '#8d6e63', '--sidebar-item2': '#ff8a65', '--sidebar-item3': '#4fc3f7', '--sidebar-item4': '#aed581', '--sidebar-item5': '#ffb74d', '--sidebar-item6': '#ba68c8',\n      '--panel-stats': '#8d6e63', '--panel-search': '#4fc3f7', '--panel-alerts': '#ff8a65', '--panel-reminders': '#ba68c8', '--panel-lowstock': '#e57373', '--panel-reservations': '#aed581',\n      ...shadow(0.15),\n    },\n    backgroundImage: '/dogs-bg.svg',\n    cursor: '/dogs-cursor.svg',\n  },\n\n  random: {\n    id: 'random', name: 'Random', description: 'Randomized colors on each switch',\n    colors: {},\n    isRandom: true,\n  },\n\n  custom: {\n    id: 'custom', name: 'Custom Theme', description: 'Create your own color scheme',\n    colors: {},\n    isCustom: true,\n  },\n};\n\n// Generate random theme colors\nexport const generateRandomTheme = () => {\n  const randomColor = () => `hsl(${Math.random() * 360}, ${60 + Math.random() * 40}%, ${30 + Math.random() * 40}%)`;\n  const randomLight = () => `hsl(${Math.random() * 360}, ${70 + Math.random() * 30}%, ${80 + Math.random() * 15}%)`;\n  const randomDark = () => `hsl(${Math.random() * 360}, ${40 + Math.random() * 30}%, ${10 + Math.random() * 15}%)`;\n  \n  return {\n    '--bg-dark': randomDark(), '--bg-medium': randomDark(), '--bg-light': randomDark(), '--bg-card': randomDark(), '--bg-card-solid': randomDark(),\n    '--primary': randomColor(), '--primary-light': randomColor(), '--primary-dark': randomColor(),\n    '--accent1': randomColor(), '--accent2': randomColor(), '--accent3': randomColor(), '--accent4': randomColor(), '--accent5': randomColor(), '--accent6': randomColor(),\n    '--status-available': randomColor(), '--status-checked-out': randomColor(), '--status-reserved': randomColor(), '--status-needs-attention': randomColor(), '--status-missing': randomColor(),\n    '--condition-excellent': randomColor(), '--condition-good': randomColor(), '--condition-fair': randomColor(), '--condition-poor': randomColor(),\n    '--text-primary': randomLight(), '--text-secondary': randomLight(), '--text-muted': randomColor(),\n    '--border': randomColor(), '--border-light': randomColor(),\n    '--danger': randomColor(), '--danger-bg': randomColor(), '--success': randomColor(), '--warning': randomColor(),\n    '--sidebar-item1': randomColor(), '--sidebar-item2': randomColor(), '--sidebar-item3': randomColor(), '--sidebar-item4': randomColor(), '--sidebar-item5': randomColor(), '--sidebar-item6': randomColor(),\n    '--panel-stats': randomColor(), '--panel-search': randomColor(), '--panel-alerts': randomColor(), '--panel-reminders': randomColor(), '--panel-lowstock': randomColor(), '--panel-reservations': randomColor(),\n    '--shadow-sm': `0 1px 2px ${randomDark()}`, '--shadow-md': `0 4px 6px ${randomDark()}`, '--shadow-lg': `0 10px 15px ${randomDark()}`, '--shadow-card': `0 4px 20px ${randomDark()}`,\n  };\n};\n","// ============================================================================\n// Accessibility Utilities\n// Color contrast checking, screen reader announcements, and theme validation\n// ============================================================================\n\n// ============================================================================\n// Color Contrast Calculations (WCAG 2.1)\n// ============================================================================\n\n/**\n * Convert hex color to RGB values\n * @param {string} hex - Hex color string (#RGB or #RRGGBB)\n * @returns {{r: number, g: number, b: number} | null}\n */\nexport function hexToRgb(hex) {\n  if (!hex || typeof hex !== 'string') return null;\n  \n  // Remove # if present\n  hex = hex.replace(/^#/, '');\n  \n  // Handle shorthand (#RGB)\n  if (hex.length === 3) {\n    hex = hex.split('').map(c => c + c).join('');\n  }\n  \n  if (hex.length !== 6) return null;\n  \n  const result = /^([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  if (!result) return null;\n  \n  return {\n    r: parseInt(result[1], 16),\n    g: parseInt(result[2], 16),\n    b: parseInt(result[3], 16),\n  };\n}\n\n/**\n * Calculate relative luminance of a color (WCAG formula)\n * @param {{r: number, g: number, b: number}} rgb\n * @returns {number} Luminance value (0-1)\n */\nexport function getLuminance({ r, g, b }) {\n  const [rs, gs, bs] = [r, g, b].map(c => {\n    c = c / 255;\n    return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);\n  });\n  return 0.2126 * rs + 0.7152 * gs + 0.0722 * bs;\n}\n\n/**\n * Calculate contrast ratio between two colors (WCAG formula)\n * @param {string} color1 - Hex color\n * @param {string} color2 - Hex color\n * @returns {number} Contrast ratio (1-21)\n */\nexport function getContrastRatio(color1, color2) {\n  const rgb1 = hexToRgb(color1);\n  const rgb2 = hexToRgb(color2);\n  \n  if (!rgb1 || !rgb2) return 1;\n  \n  const l1 = getLuminance(rgb1);\n  const l2 = getLuminance(rgb2);\n  \n  const lighter = Math.max(l1, l2);\n  const darker = Math.min(l1, l2);\n  \n  return (lighter + 0.05) / (darker + 0.05);\n}\n\n/**\n * Check if contrast meets WCAG AA requirements\n * @param {string} foreground - Foreground color (hex)\n * @param {string} background - Background color (hex)\n * @param {boolean} isLargeText - Whether text is large (18px+ or 14px+ bold)\n * @returns {{ratio: number, passes: boolean, level: string}}\n */\nexport function checkContrast(foreground, background, isLargeText = false) {\n  const ratio = getContrastRatio(foreground, background);\n  const minRatio = isLargeText ? 3 : 4.5;\n  const aaaRatio = isLargeText ? 4.5 : 7;\n  \n  let level = 'Fail';\n  if (ratio >= aaaRatio) level = 'AAA';\n  else if (ratio >= minRatio) level = 'AA';\n  \n  return {\n    ratio: Math.round(ratio * 100) / 100,\n    passes: ratio >= minRatio,\n    level,\n  };\n}\n\n/**\n * Get contrast status with description\n * @param {number} ratio - Contrast ratio\n * @returns {{status: string, color: string, description: string}}\n */\nexport function getContrastStatus(ratio) {\n  if (ratio >= 7) {\n    return { status: 'excellent', color: '#22c55e', description: 'Excellent (AAA)' };\n  } else if (ratio >= 4.5) {\n    return { status: 'good', color: '#84cc16', description: 'Good (AA)' };\n  } else if (ratio >= 3) {\n    return { status: 'warning', color: '#eab308', description: 'Large text only' };\n  } else {\n    return { status: 'fail', color: '#ef4444', description: 'Insufficient' };\n  }\n}\n\n// ============================================================================\n// Theme Contrast Validation\n// ============================================================================\n\n/**\n * Define color pairs that should be checked for contrast\n */\nexport const CONTRAST_PAIRS = [\n  { fg: '--text-primary', bg: '--bg-dark', label: 'Primary text on main background' },\n  { fg: '--text-primary', bg: '--bg-medium', label: 'Primary text on medium background' },\n  { fg: '--text-primary', bg: '--bg-light', label: 'Primary text on light background' },\n  { fg: '--text-secondary', bg: '--bg-dark', label: 'Secondary text on main background' },\n  { fg: '--text-muted', bg: '--bg-dark', label: 'Muted text on main background' },\n  { fg: '--primary', bg: '--bg-dark', label: 'Primary color on main background' },\n  { fg: '--primary-light', bg: '--bg-dark', label: 'Primary light on main background' },\n  { fg: '--status-available', bg: '--bg-dark', label: 'Available status on background' },\n  { fg: '--status-needs-attention', bg: '--bg-dark', label: 'Needs attention on background' },\n  { fg: '--danger', bg: '--bg-dark', label: 'Danger color on background' },\n  { fg: '--success', bg: '--bg-dark', label: 'Success color on background' },\n  { fg: '--warning', bg: '--bg-dark', label: 'Warning color on background' },\n  { fg: '--focus-ring-color', bg: '--bg-dark', label: 'Focus ring on background' },\n];\n\n/**\n * Validate all color pairs in a theme for WCAG compliance\n * @param {Object} themeColors - Theme color object with CSS variable keys\n * @returns {Array<{pair: Object, result: Object}>}\n */\nexport function validateThemeContrast(themeColors) {\n  return CONTRAST_PAIRS.map(pair => {\n    const fgColor = themeColors[pair.fg];\n    const bgColor = themeColors[pair.bg];\n    \n    // Skip if either color is not a hex value (e.g., rgba)\n    if (!fgColor?.startsWith('#') || !bgColor?.startsWith('#')) {\n      return { pair, result: { ratio: 0, passes: false, level: 'Unknown', skipped: true } };\n    }\n    \n    return {\n      pair,\n      result: checkContrast(fgColor, bgColor),\n    };\n  });\n}\n\n/**\n * Get summary of contrast validation results\n * @param {Array} validationResults - Results from validateThemeContrast\n * @returns {{passing: number, failing: number, skipped: number, score: number}}\n */\nexport function getContrastSummary(validationResults) {\n  const passing = validationResults.filter(r => r.result.passes).length;\n  const failing = validationResults.filter(r => !r.result.passes && !r.result.skipped).length;\n  const skipped = validationResults.filter(r => r.result.skipped).length;\n  const total = validationResults.length - skipped;\n  \n  return {\n    passing,\n    failing,\n    skipped,\n    score: total > 0 ? Math.round((passing / total) * 100) : 0,\n  };\n}\n\n// ============================================================================\n// Screen Reader Announcements\n// ============================================================================\n\nlet announcerElement = null;\n\n/**\n * Get or create the screen reader announcer element\n */\nfunction getAnnouncer() {\n  if (announcerElement) return announcerElement;\n  \n  announcerElement = document.createElement('div');\n  announcerElement.setAttribute('role', 'status');\n  announcerElement.setAttribute('aria-live', 'polite');\n  announcerElement.setAttribute('aria-atomic', 'true');\n  announcerElement.className = 'sr-only';\n  Object.assign(announcerElement.style, {\n    position: 'absolute',\n    width: '1px',\n    height: '1px',\n    padding: '0',\n    margin: '-1px',\n    overflow: 'hidden',\n    clip: 'rect(0, 0, 0, 0)',\n    whiteSpace: 'nowrap',\n    border: '0',\n  });\n  document.body.appendChild(announcerElement);\n  \n  return announcerElement;\n}\n\n/**\n * Announce a message to screen readers\n * @param {string} message - Message to announce\n * @param {string} politeness - 'polite' or 'assertive'\n */\nexport function announce(message, politeness = 'polite') {\n  const announcer = getAnnouncer();\n  announcer.setAttribute('aria-live', politeness);\n  \n  // Clear and re-set to trigger announcement\n  announcer.textContent = '';\n  requestAnimationFrame(() => {\n    announcer.textContent = message;\n  });\n}\n\n/**\n * Announce an assertive (important) message\n * @param {string} message\n */\nexport function announceAssertive(message) {\n  announce(message, 'assertive');\n}\n\n// ============================================================================\n// Common Announcement Helpers\n// ============================================================================\n\n/**\n * Announce when an item is added\n * @param {string} itemName - Name of the added item\n * @param {string} context - Context (e.g., \"inventory\", \"cart\")\n */\nexport function announceAdded(itemName, context = '') {\n  announce(`${itemName} added${context ? ` to ${context}` : ''}`);\n}\n\n/**\n * Announce when an item is removed\n * @param {string} itemName\n * @param {string} context\n */\nexport function announceRemoved(itemName, context = '') {\n  announce(`${itemName} removed${context ? ` from ${context}` : ''}`);\n}\n\n/**\n * Announce when content is loading\n * @param {string} content - What's loading\n */\nexport function announceLoading(content = 'Content') {\n  announce(`${content} loading`);\n}\n\n/**\n * Announce when content is loaded\n * @param {string} content - What was loaded\n * @param {number} count - Optional count of items\n */\nexport function announceLoaded(content = 'Content', count = null) {\n  if (count !== null) {\n    announce(`${content} loaded. ${count} items found.`);\n  } else {\n    announce(`${content} loaded`);\n  }\n}\n\n/**\n * Announce an error\n * @param {string} errorMessage\n */\nexport function announceError(errorMessage) {\n  announceAssertive(`Error: ${errorMessage}`);\n}\n\n/**\n * Announce a success message\n * @param {string} message\n */\nexport function announceSuccess(message) {\n  announce(message);\n}\n\n/**\n * Announce page/view navigation\n * @param {string} pageName\n */\nexport function announcePageChange(pageName) {\n  announce(`Navigated to ${pageName}`);\n}\n\n/**\n * Announce modal open/close\n * @param {string} modalName\n * @param {boolean} isOpen\n */\nexport function announceModal(modalName, isOpen) {\n  if (isOpen) {\n    announce(`${modalName} dialog opened`);\n  } else {\n    announce(`${modalName} dialog closed`);\n  }\n}\n\n/**\n * Announce selection change\n * @param {string} itemName\n * @param {boolean} isSelected\n */\nexport function announceSelection(itemName, isSelected) {\n  announce(`${itemName} ${isSelected ? 'selected' : 'deselected'}`);\n}\n\n/**\n * Announce filter/sort change\n * @param {string} filterType\n * @param {string} value\n */\nexport function announceFilterChange(filterType, value) {\n  announce(`${filterType} changed to ${value}`);\n}\n\n// ============================================================================\n// Focus Management\n// ============================================================================\n\n/**\n * Move focus to an element and announce it\n * @param {HTMLElement} element\n * @param {string} announcement - Optional announcement\n */\nexport function focusAndAnnounce(element, announcement = '') {\n  if (!element) return;\n  \n  element.focus();\n  if (announcement) {\n    announce(announcement);\n  }\n}\n\n/**\n * Trap focus within a container (for modals)\n * @param {HTMLElement} container\n * @returns {Function} Cleanup function\n */\nexport function trapFocus(container) {\n  if (!container) return () => {};\n  \n  const focusableSelectors = [\n    'button:not([disabled])',\n    'input:not([disabled])',\n    'select:not([disabled])',\n    'textarea:not([disabled])',\n    'a[href]',\n    '[tabindex]:not([tabindex=\"-1\"])',\n  ].join(', ');\n  \n  const focusableElements = container.querySelectorAll(focusableSelectors);\n  const firstFocusable = focusableElements[0];\n  const lastFocusable = focusableElements[focusableElements.length - 1];\n  \n  const handleKeyDown = (e) => {\n    if (e.key !== 'Tab') return;\n    \n    if (e.shiftKey) {\n      if (document.activeElement === firstFocusable) {\n        e.preventDefault();\n        lastFocusable?.focus();\n      }\n    } else {\n      if (document.activeElement === lastFocusable) {\n        e.preventDefault();\n        firstFocusable?.focus();\n      }\n    }\n  };\n  \n  container.addEventListener('keydown', handleKeyDown);\n  \n  // Focus the first focusable element\n  firstFocusable?.focus();\n  \n  return () => {\n    container.removeEventListener('keydown', handleKeyDown);\n  };\n}\n\nexport default {\n  // Contrast\n  hexToRgb,\n  getLuminance,\n  getContrastRatio,\n  checkContrast,\n  getContrastStatus,\n  validateThemeContrast,\n  getContrastSummary,\n  CONTRAST_PAIRS,\n  // Announcements\n  announce,\n  announceAssertive,\n  announceAdded,\n  announceRemoved,\n  announceLoading,\n  announceLoaded,\n  announceError,\n  announceSuccess,\n  announcePageChange,\n  announceModal,\n  announceSelection,\n  announceFilterChange,\n  // Focus\n  focusAndAnnounce,\n  trapFocus,\n};\n","// ============================================================================\n// Theme Context - Manages theme switching with CSS variables\n// ============================================================================\n\nimport React, { createContext, useContext, useState, useEffect, useCallback, useMemo } from 'react';\nimport { themes, generateRandomTheme, DEFAULT_CUSTOM_THEME } from '../themes-data.js';\nimport { announce } from '../utils/accessibility.js';\n\nimport { warn } from '../lib/logger.js';\n\n// Load custom theme from localStorage\nconst loadCustomTheme = () => {\n  if (typeof window === 'undefined') return null;\n  try {\n    const saved = localStorage.getItem('sims-custom-theme');\n    const name = localStorage.getItem('sims-custom-theme-name');\n    if (saved) {\n      const colors = JSON.parse(saved);\n      return {\n        id: 'custom',\n        name: name || 'Custom Theme',\n        description: 'Your custom color scheme',\n        colors: {\n          ...DEFAULT_CUSTOM_THEME,\n          ...colors,\n          '--bg-card-solid': colors['--bg-card'] || colors['--bg-light'] || DEFAULT_CUSTOM_THEME['--bg-card-solid'],\n          '--danger-bg': (colors['--danger'] || DEFAULT_CUSTOM_THEME['--danger']) + '20',\n          // Ensure focus ring colors are set\n          '--focus-ring-color': colors['--focus-ring-color'] || colors['--primary-light'] || DEFAULT_CUSTOM_THEME['--primary-light'],\n          '--focus-ring-color-danger': colors['--focus-ring-color-danger'] || colors['--danger'] || DEFAULT_CUSTOM_THEME['--danger'],\n        },\n        isCustom: true,\n      };\n    }\n  } catch (e) {\n    warn('Failed to load custom theme:', e);\n  }\n  return null;\n};\n\n// Get array of available themes for UI\nexport const getAvailableThemes = () => {\n  const themeList = Object.values(themes);\n  const customTheme = loadCustomTheme();\n  if (customTheme) {\n    const customIndex = themeList.findIndex(t => t.id === 'custom');\n    if (customIndex >= 0) themeList[customIndex] = customTheme;\n  }\n  return themeList;\n};\n\nconst ThemeContext = createContext(null);\n\nexport function ThemeProvider({ children }) {\n  const [themeId, setThemeId] = useState(() => {\n    if (typeof window !== 'undefined') {\n      return localStorage.getItem('sims-theme') || 'dark';\n    }\n    return 'dark';\n  });\n  const [randomColors, setRandomColors] = useState(null);\n  const [customThemeColors, setCustomThemeColors] = useState(null);\n\n  const applyTheme = useCallback((theme, generatedColors = null, shouldAnnounce = false) => {\n    const root = document.documentElement;\n    const body = document.body;\n    \n    let colors;\n    if (theme.isRandom) {\n      colors = generatedColors || generateRandomTheme();\n    } else if (theme.isCustom) {\n      const customTheme = loadCustomTheme();\n      colors = customTheme?.colors || DEFAULT_CUSTOM_THEME;\n    } else {\n      colors = theme.colors;\n    }\n    \n    // Ensure focus ring colors are set (derive from primary if not explicitly set)\n    if (!colors['--focus-ring-color']) {\n      colors['--focus-ring-color'] = colors['--primary-light'] || colors['--primary'];\n    }\n    if (!colors['--focus-ring-color-danger']) {\n      colors['--focus-ring-color-danger'] = colors['--danger'];\n    }\n    \n    // Apply all color variables\n    Object.entries(colors).forEach(([property, value]) => {\n      root.style.setProperty(property, value);\n    });\n    \n    // Apply background image\n    if (theme.backgroundImage) {\n      root.style.setProperty('--theme-bg-image', `url(\"${theme.backgroundImage}\")`);\n    } else {\n      root.style.setProperty('--theme-bg-image', 'none');\n    }\n    \n    // Apply custom cursor\n    if (theme.cursor) {\n      root.style.setProperty('--theme-cursor', `url(\"${theme.cursor}\") 2 2, auto`);\n    } else {\n      root.style.setProperty('--theme-cursor', 'default');\n    }\n    \n    // Apply custom font\n    if (theme.fontFamily) {\n      root.style.setProperty('--theme-font', theme.fontFamily);\n      body.style.fontFamily = theme.fontFamily;\n    } else {\n      root.style.setProperty('--theme-font', '');\n      body.style.fontFamily = '';\n    }\n    \n    localStorage.setItem('sims-theme', theme.id);\n    \n    // Announce theme change to screen readers\n    if (shouldAnnounce) {\n      announce(`Theme changed to ${theme.name}`);\n    }\n    \n    return colors;\n  }, []);\n\n  useEffect(() => {\n    let theme = themes[themeId] || themes.dark;\n    \n    if (theme.isCustom) {\n      const customTheme = loadCustomTheme();\n      if (customTheme) {\n        theme = customTheme;\n        setCustomThemeColors(customTheme.colors);\n      }\n    }\n    \n    if (theme.isRandom) {\n      const newColors = generateRandomTheme();\n      setRandomColors(newColors);\n      applyTheme(theme, newColors, true);\n    } else {\n      setRandomColors(null);\n      applyTheme(theme, null, true);\n    }\n  }, [themeId, applyTheme]);\n\n  const setTheme = useCallback((newThemeId) => {\n    if (themes[newThemeId] || newThemeId === 'custom') {\n      setThemeId(newThemeId);\n    }\n  }, []);\n\n  const updateCustomTheme = useCallback((customThemeData) => {\n    if (customThemeData?.colors) {\n      setCustomThemeColors(customThemeData.colors);\n      if (themeId === 'custom') {\n        applyTheme(customThemeData);\n      }\n    }\n  }, [themeId, applyTheme]);\n\n  const currentTheme = useMemo(() => {\n    const theme = themes[themeId] || themes.dark;\n    if (theme.isRandom && randomColors) {\n      return { ...theme, colors: randomColors };\n    }\n    if (theme.isCustom && customThemeColors) {\n      const customTheme = loadCustomTheme();\n      return customTheme || theme;\n    }\n    return theme;\n  }, [themeId, randomColors, customThemeColors]);\n\n  const value = useMemo(() => ({\n    themeId,\n    currentTheme,\n    setTheme,\n    updateCustomTheme,\n    availableThemes: getAvailableThemes(),\n  }), [themeId, currentTheme, setTheme, updateCustomTheme]);\n\n  return (\n    <ThemeContext.Provider value={value}>\n      {children}\n    </ThemeContext.Provider>\n  );\n}\n\nexport function useTheme() {\n  const context = useContext(ThemeContext);\n  if (!context) {\n    throw new Error('useTheme must be used within a ThemeProvider');\n  }\n  return context;\n}\n\nexport { themes };\nexport default ThemeContext;\n","// ============================================================================\n// Permissions Context\n// Provides permission checking throughout the app\n// ============================================================================\n\nimport React, { createContext, useContext, useMemo, useCallback } from 'react';\nimport { PERMISSION_LEVELS, APP_FUNCTIONS, VIEWS } from '../constants.js';\nimport { typography, borderRadius } from '../theme.js';\n\nconst PermissionsContext = createContext(null);\n\n// Mapping of views to their required permission function IDs\nexport const VIEW_PERMISSIONS = {\n  [VIEWS.DASHBOARD]: 'dashboard',\n  [VIEWS.GEAR_LIST]: 'gear_list',\n  [VIEWS.GEAR_DETAIL]: 'item_details',\n  [VIEWS.PACKAGES]: 'gear_list',\n  [VIEWS.PACKAGE_DETAIL]: 'item_details',\n  [VIEWS.PACK_LISTS]: 'pack_lists',\n  [VIEWS.SCHEDULE]: 'schedule',\n  [VIEWS.SEARCH]: 'search',\n  [VIEWS.LABELS]: 'labels',\n  [VIEWS.CLIENTS]: 'clients',\n  [VIEWS.CLIENT_DETAIL]: 'clients',\n  [VIEWS.REPORTS]: 'reports',\n  [VIEWS.ADMIN]: 'admin_users', // Requires at least one admin permission\n  [VIEWS.USERS]: 'admin_users',\n  [VIEWS.AUDIT_LOG]: 'admin_audit',\n  [VIEWS.CHANGE_LOG]: 'admin_audit',\n  [VIEWS.EDIT_SPECS]: 'admin_specs',\n  [VIEWS.EDIT_CATEGORIES]: 'admin_categories',\n  [VIEWS.ADD_ITEM]: 'gear_list', // Requires edit permission\n  [VIEWS.LOCATIONS_MANAGE]: 'admin_locations',\n  [VIEWS.ROLES_MANAGE]: 'admin_roles',\n  [VIEWS.MAINTENANCE_REPORT]: 'reports',\n  [VIEWS.INSURANCE_REPORT]: 'reports',\n  [VIEWS.CLIENT_REPORT]: 'reports',\n  [VIEWS.THEME_SELECTOR]: 'admin_themes',\n  [VIEWS.NOTIFICATIONS]: 'admin_notifications',\n  [VIEWS.CUSTOMIZE_DASHBOARD]: 'admin_layout',\n  [VIEWS.CUSTOMIZE_ITEM_DETAIL]: 'admin_layout',\n};\n\nexport function PermissionsProvider({ children, currentUser, roles }) {\n  // Get the user's role\n  const userRole = useMemo(() => {\n    if (!currentUser) return null;\n    \n    // If user has an embedded role object from Supabase join, use it directly\n    if (currentUser.role && typeof currentUser.role === 'object' && currentUser.role.permissions) {\n      return currentUser.role;\n    }\n    \n    // Otherwise, look up role from roles array\n    if (!roles || roles.length === 0) return null;\n    \n    // Support both roleId (frontend) and role_id (database) naming\n    const userRoleId = currentUser.roleId || currentUser.role_id;\n    \n    // Find user's assigned role, or fall back to role_user (most restrictive standard role)\n    return roles.find(r => r.id === userRoleId) || \n           roles.find(r => r.id === 'role_user') || \n           null;\n  }, [currentUser, roles]);\n\n  // Check if user has at least the specified permission level for a function\n  const hasPermission = useCallback((functionId, requiredLevel = PERMISSION_LEVELS.VIEW) => {\n    // If no role found, deny all access\n    if (!userRole) {\n      return false;\n    }\n\n    const permission = userRole.permissions[functionId];\n    \n    // If permission not defined, default to hide\n    if (!permission) return false;\n    \n    // Permission hierarchy: edit > view > hide\n    const levels = {\n      [PERMISSION_LEVELS.HIDE]: 0,\n      [PERMISSION_LEVELS.VIEW]: 1,\n      [PERMISSION_LEVELS.EDIT]: 2,\n    };\n    \n    const requiredLevelNum = levels[requiredLevel] || 0;\n    const userLevelNum = levels[permission] || 0;\n    \n    return userLevelNum >= requiredLevelNum;\n  }, [userRole, currentUser]);\n\n  // Check if a function is visible (not hidden)\n  const canView = useCallback((functionId) => {\n    return hasPermission(functionId, PERMISSION_LEVELS.VIEW);\n  }, [hasPermission]);\n\n  // Check if user can edit a function\n  const canEdit = useCallback((functionId) => {\n    return hasPermission(functionId, PERMISSION_LEVELS.EDIT);\n  }, [hasPermission]);\n\n  // Check if a function is hidden\n  const isHidden = useCallback((functionId) => {\n    return !hasPermission(functionId, PERMISSION_LEVELS.VIEW);\n  }, [hasPermission]);\n\n  // Get the permission level for a function\n  const getPermissionLevel = useCallback((functionId) => {\n    if (!userRole) {\n      return PERMISSION_LEVELS.HIDE;\n    }\n    return userRole.permissions[functionId] || PERMISSION_LEVELS.HIDE;\n  }, [userRole]);\n\n  // Get all visible functions\n  const visibleFunctions = useMemo(() => {\n    return Object.values(APP_FUNCTIONS).filter(func => canView(func.id));\n  }, [canView]);\n\n  const value = useMemo(() => ({\n    userRole,\n    hasPermission,\n    canView,\n    canEdit,\n    isHidden,\n    getPermissionLevel,\n    visibleFunctions,\n    PERMISSION_LEVELS,\n  }), [userRole, hasPermission, canView, canEdit, isHidden, getPermissionLevel, visibleFunctions]);\n\n  return (\n    <PermissionsContext.Provider value={value}>\n      {children}\n    </PermissionsContext.Provider>\n  );\n}\n\nexport function usePermissions() {\n  const context = useContext(PermissionsContext);\n  if (!context) {\n    throw new Error('usePermissions must be used within a PermissionsProvider');\n  }\n  return context;\n}\n\n// Higher-order component to protect routes/components\nexport function withPermission(WrappedComponent, functionId, requiredLevel = PERMISSION_LEVELS.VIEW) {\n  return function PermissionProtectedComponent(props) {\n    const { hasPermission, getPermissionLevel } = usePermissions();\n    \n    if (!hasPermission(functionId, requiredLevel)) {\n      return <AccessDenied functionId={functionId} currentLevel={getPermissionLevel(functionId)} requiredLevel={requiredLevel} />;\n    }\n    \n    return <WrappedComponent {...props} />;\n  };\n}\n\n// Access denied component\nexport function AccessDenied({ functionId, currentLevel, requiredLevel, message }) {\n  const funcInfo = APP_FUNCTIONS[Object.keys(APP_FUNCTIONS).find(k => APP_FUNCTIONS[k].id === functionId)];\n  \n  const levelMessages = {\n    [PERMISSION_LEVELS.VIEW]: 'view',\n    [PERMISSION_LEVELS.EDIT]: 'edit',\n  };\n\n  return (\n    <div style={{\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center',\n      justifyContent: 'center',\n      padding: '48px 24px',\n      textAlign: 'center',\n    }}>\n      <div style={{\n        width: 64,\n        height: 64,\n        borderRadius: '50%',\n        background: 'rgba(239, 68, 68, 0.1)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        marginBottom: 16,\n        color: '#ef4444',\n      }}>\n        <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n          <circle cx=\"12\" cy=\"12\" r=\"10\" />\n          <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\" />\n          <line x1=\"12\" y1=\"16\" x2=\"12.01\" y2=\"16\" />\n        </svg>\n      </div>\n      <h3 style={{ margin: '0 0 8px', color: '#1f2937', fontSize: typography.fontSize.xl }}>\n        Access Restricted\n      </h3>\n      <p style={{ margin: '0 0 16px', color: '#6b7280', maxWidth: 400 }}>\n        {message || (\n          currentLevel === PERMISSION_LEVELS.HIDE\n            ? `You don't have permission to access ${funcInfo?.name || 'this feature'}.`\n            : `You have ${currentLevel} access to ${funcInfo?.name || 'this feature'}, but ${levelMessages[requiredLevel]} access is required for this action.`\n        )}\n      </p>\n      <p style={{ margin: 0, color: '#9ca3af', fontSize: typography.fontSize.base }}>\n        Contact your administrator if you need access.\n      </p>\n    </div>\n  );\n}\n\n// Component to show view-only message\nexport function ViewOnlyBanner({ functionId }) {\n  const { canEdit } = usePermissions();\n  \n  if (canEdit(functionId)) return null;\n  \n  return (\n    <div style={{\n      background: 'rgba(59, 130, 246, 0.1)',\n      border: '1px solid rgba(59, 130, 246, 0.3)',\n      borderRadius: borderRadius.md,\n      padding: '8px 16px',\n      marginBottom: 16,\n      display: 'flex',\n      alignItems: 'center',\n      gap: 8,\n      color: '#3b82f6',\n      fontSize: typography.fontSize.base,\n    }}>\n      <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n        <path d=\"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z\" />\n        <circle cx=\"12\" cy=\"12\" r=\"3\" />\n      </svg>\n      <span>You have view-only access. Some actions may be restricted.</span>\n    </div>\n  );\n}\n\n// Permission gate component - renders children only if permission is met\n// Use this in JSX: <PermissionGate permission=\"admin_users\">{children}</PermissionGate>\nexport function PermissionGate({ permission, requireEdit = false, fallback = null, children }) {\n  const { canView, canEdit } = usePermissions();\n  \n  const hasPermission = requireEdit ? canEdit(permission) : canView(permission);\n  \n  if (!hasPermission) {\n    return fallback;\n  }\n  \n  return children;\n}\n\n// Button wrapper that disables based on permissions\nexport function PermissionButton({ functionId, children, onClick, ...props }) {\n  const { canEdit, getPermissionLevel } = usePermissions();\n  const hasEditAccess = canEdit(functionId);\n  \n  const handleClick = (e) => {\n    if (!hasEditAccess) {\n      e.preventDefault();\n      alert(`You don't have permission to perform this action. Your current access level is \"${getPermissionLevel(functionId)}\".`);\n      return;\n    }\n    onClick?.(e);\n  };\n  \n  return (\n    <button\n      {...props}\n      onClick={handleClick}\n      style={{\n        ...props.style,\n        opacity: hasEditAccess ? 1 : 0.5,\n        cursor: hasEditAccess ? 'pointer' : 'not-allowed',\n      }}\n      title={hasEditAccess ? props.title : 'You don\\'t have permission for this action'}\n    >\n      {children}\n    </button>\n  );\n}\n\nexport default PermissionsContext;\n","// =============================================================================\n// Supabase Client Configuration\n// =============================================================================\n\n// Environment variables (set these in your .env file)\nimport { info, error as logError } from './logger.js';\n\nconst supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\nconst supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY;\n\n// Supabase client\nlet supabaseClient = null;\nlet initPromise = null;\n\n// Initialize Supabase client\nasync function initSupabase() {\n  if (!supabaseUrl || !supabaseAnonKey) {\n    logError('Supabase credentials not configured. Set VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY.');\n    throw new Error('Supabase not configured');\n  }\n\n  try {\n    const { createClient } = await import(/* @vite-ignore */ '@supabase/supabase-js');\n    info('%cSIMS connected to Supabase', 'color: #22c55e; font-weight: bold');\n    return createClient(supabaseUrl, supabaseAnonKey, {\n      auth: {\n        autoRefreshToken: true,\n        persistSession: true,\n        detectSessionInUrl: true\n      }\n    });\n  } catch (err) {\n    // If module not found, try CDN as fallback\n    try {\n      const module = await import(/* @vite-ignore */ 'https://esm.sh/@supabase/supabase-js@2');\n      info('%cSIMS connected to Supabase (via CDN)', 'color: #22c55e; font-weight: bold');\n      return module.createClient(supabaseUrl, supabaseAnonKey, {\n        auth: {\n          autoRefreshToken: true,\n          persistSession: true,\n          detectSessionInUrl: true\n        }\n      });\n    } catch (cdnErr) {\n      logError('Failed to load Supabase SDK:', cdnErr);\n      throw new Error('Supabase SDK not available');\n    }\n  }\n}\n\n// Initialize on first access\nexport async function getSupabase() {\n  if (supabaseClient) return supabaseClient;\n  if (!initPromise) {\n    initPromise = initSupabase();\n  }\n  supabaseClient = await initPromise;\n  return supabaseClient;\n}\n\n// Synchronous export for backward compatibility (may be null initially)\nexport let supabase = null;\n\n// Start initialization immediately\ngetSupabase().then(client => { supabase = client; }).catch(err => logError(err));\n\n// =============================================================================\n// Auth Helpers\n// =============================================================================\n\nexport const auth = {\n  // Sign up new user\n  signUp: async (email, password, name) => {\n    const client = await getSupabase();\n    \n    const { data, error } = await client.auth.signUp({\n      email,\n      password,\n      options: {\n        data: { name }\n      }\n    });\n    \n    if (error) throw error;\n    return data;\n  },\n\n  // Sign in existing user\n  signIn: async (email, password) => {\n    const client = await getSupabase();\n    \n    const { data, error } = await client.auth.signInWithPassword({\n      email,\n      password\n    });\n    \n    if (error) throw error;\n    return data;\n  },\n\n  // Sign out\n  signOut: async () => {\n    const client = await getSupabase();\n    \n    const { error } = await client.auth.signOut();\n    if (error) throw error;\n  },\n\n  // Get current session\n  getSession: async () => {\n    const client = await getSupabase();\n    \n    const { data: { session } } = await client.auth.getSession();\n    return session;\n  },\n\n  // Get current user\n  getUser: async () => {\n    const client = await getSupabase();\n    \n    const { data: { user } } = await client.auth.getUser();\n    return user;\n  },\n\n  // Subscribe to auth changes\n  onAuthStateChange: (callback) => {\n    if (!supabase) return { data: { subscription: { unsubscribe: () => {} } } };\n    return supabase.auth.onAuthStateChange(callback);\n  },\n\n  // Reset password\n  resetPassword: async (email) => {\n    const client = await getSupabase();\n    \n    const { error } = await client.auth.resetPasswordForEmail(email);\n    if (error) throw error;\n  },\n\n  // Update password\n  updatePassword: async (newPassword) => {\n    const client = await getSupabase();\n    \n    const { error } = await client.auth.updateUser({ password: newPassword });\n    if (error) throw error;\n  }\n};\n\nexport default supabase;\n","// =============================================================================\n// Field Mapping  Single Source of Truth\n// Maps between frontend camelCase and database snake_case field names.\n//\n// Every transform function in services.js derives from these maps.\n// To add a new field: add one entry here, and both directions work automatically.\n// =============================================================================\n\n// =============================================================================\n// INVENTORY FIELDS\n// Format: frontendKey  databaseKey\n// =============================================================================\n\nexport const INVENTORY_FIELD_MAP = {\n  // Category\n  category:           'category_name',\n  // Dates & prices\n  purchaseDate:       'purchase_date',\n  purchasePrice:      'purchase_price',\n  currentValue:       'current_value',\n  serialNumber:       'serial_number',\n  reorderPoint:       'reorder_point',\n  // Checkout state\n  checkedOutTo:       'checked_out_to_name',\n  checkedOutToUserId: 'checked_out_to_user_id',\n  checkedOutDate:     'checked_out_date',\n  dueBack:            'due_back',\n  checkoutProject:    'checkout_project',\n  checkoutClientId:   'checkout_client_id',\n  // Kit fields\n  isKit:              'is_kit',\n  kitType:            'kit_type',\n  kitItems:           'kit_contents',\n  // Stats\n  viewCount:          'view_count',\n  checkoutCount:      'checkout_count',\n  // Location\n  location:           'location_display',\n  locationId:         'location_id',\n  // Timestamps\n  createdAt:          'created_at',\n  updatedAt:          'updated_at',\n};\n\n// =============================================================================\n// RESERVATION FIELDS\n// =============================================================================\n\nexport const RESERVATION_FIELD_MAP = {\n  // Long aliases first (these get overwritten in reverseMap)\n  startDate:       'start_date',\n  endDate:         'end_date',\n  // Short aliases last (these win in reverseMap  fromDb)\n  start:           'start_date',\n  end:             'end_date',\n  contactName:     'contact_name',\n  contactPhone:    'contact_phone',\n  contactEmail:    'contact_email',\n  itemId:          'item_id',\n  clientId:        'client_id',\n  createdById:     'created_by_id',\n  createdByName:   'created_by_name',\n  projectType:     'project_type',\n  createdAt:       'created_at',\n  updatedAt:       'updated_at',\n};\n\n// =============================================================================\n// REMINDER FIELDS\n// =============================================================================\n\nexport const REMINDER_FIELD_MAP = {\n  itemId:          'item_id',\n  dueDate:         'due_date',\n  completedAt:     'completed_at',\n  completedDate:   'completed_at',\n  createdById:     'created_by_id',\n  createdByName:   'created_by_name',\n  createdAt:       'created_at',\n  updatedAt:       'updated_at',\n};\n\n// =============================================================================\n// MAINTENANCE FIELDS\n// =============================================================================\n\nexport const MAINTENANCE_FIELD_MAP = {\n  itemId:          'item_id',\n  scheduledDate:   'scheduled_date',\n  completedDate:   'completed_date',\n  warrantyWork:    'warranty_work',\n  vendorContact:   'vendor_contact',\n  createdById:     'created_by_id',\n  createdByName:   'created_by_name',\n  createdAt:       'created_at',\n  updatedAt:       'updated_at',\n};\n\n// =============================================================================\n// CHECKOUT HISTORY FIELDS\n// =============================================================================\n\nexport const CHECKOUT_HISTORY_FIELD_MAP = {\n  itemId:            'item_id',\n  userId:            'user_id',\n  userName:          'user_name',\n  clientId:          'client_id',\n  clientName:        'client_name',\n  conditionAtAction: 'condition_at_action',\n};\n\n// =============================================================================\n// GENERIC TRANSFORM UTILITIES\n// =============================================================================\n\n/**\n * Build a reverse map (db  frontend) from a forward map (frontend  db).\n * Caches the result on the map object for performance.\n */\nfunction reverseMap(fieldMap) {\n  if (fieldMap._reverse) return fieldMap._reverse;\n  const reversed = Object.fromEntries(\n    Object.entries(fieldMap).map(([fe, db]) => [db, fe])\n  );\n  fieldMap._reverse = reversed;\n  return reversed;\n}\n\n/**\n * Transform a database row to frontend format using a field map.\n * Spreads the original object, then overlays the mapped frontend keys.\n * Defaults can specify fallback values for specific frontend keys.\n *\n * @param {Object} row - Database row\n * @param {Object} fieldMap - frontend  db mapping\n * @param {Object} [defaults={}] - Default values for frontend keys (e.g. { isKit: false })\n * @returns {Object} Frontend-formatted object\n */\nexport function fromDb(row, fieldMap, defaults = {}) {\n  if (!row) return null;\n  const result = { ...row };\n  const reversed = reverseMap(fieldMap);\n  \n  // Apply mapped fields: for each db column, set the frontend key\n  for (const [dbKey, feKey] of Object.entries(reversed)) {\n    if (row[dbKey] !== undefined) {\n      result[feKey] = row[dbKey];\n    } else if (row[feKey] !== undefined) {\n      // Already has the frontend key (e.g. passed through from frontend)\n      result[feKey] = row[feKey];\n    } else if (feKey in defaults) {\n      result[feKey] = defaults[feKey];\n    }\n  }\n\n  // Apply defaults for any keys not yet set\n  for (const [key, defaultValue] of Object.entries(defaults)) {\n    if (result[key] === undefined || result[key] === null) {\n      result[key] = defaultValue;\n    }\n  }\n\n  return result;\n}\n\n/**\n * Transform a frontend object to database format using a field map.\n * Only includes fields that are present in the input object.\n * Pass-through fields (not in the map) are included as-is.\n *\n * @param {Object} obj - Frontend object\n * @param {Object} fieldMap - frontend  db mapping\n * @param {Object} [options={}]\n * @param {boolean} [options.partial=false] - If true, only include fields present in obj (for updates)\n * @param {string[]} [options.passThroughFields=[]] - Fields to always include as-is\n * @param {Object} [options.numericFields={}] - Fields to coerce to Number { frontendKey: defaultValue }\n * @returns {Object} Database-formatted object\n */\nexport function toDb(obj, fieldMap, options = {}) {\n  if (!obj) return null;\n  const { partial = false, passThroughFields = [], numericFields = {} } = options;\n  const result = {};\n\n  if (!partial) {\n    // Full transform: include all pass-through fields\n    for (const field of passThroughFields) {\n      if (obj[field] !== undefined) {\n        result[field] = obj[field];\n      }\n    }\n  }\n\n  // Map frontend keys to db keys\n  for (const [feKey, dbKey] of Object.entries(fieldMap)) {\n    const value = obj[feKey] !== undefined ? obj[feKey] : obj[dbKey];\n    if (value !== undefined) {\n      // Apply numeric coercion if specified\n      if (feKey in numericFields) {\n        result[dbKey] = Number(value) || numericFields[feKey];\n      } else {\n        result[dbKey] = value;\n      }\n    }\n  }\n\n  // In partial mode, also pass through any unknown keys (they might be db-native keys)\n  if (partial) {\n    for (const [key, value] of Object.entries(obj)) {\n      if (!(key in fieldMap) && !(key in result)) {\n        // Check if it's already a db key in the map values\n        const isDbKey = Object.values(fieldMap).includes(key);\n        if (!isDbKey) {\n          result[key] = value;\n        }\n      }\n    }\n  }\n\n  return result;\n}\n","// =============================================================================\n// SIMS Data Services\n// Service layer for Supabase database operations\n// =============================================================================\n\nimport { getSupabase } from './supabase.js';\nimport { log, warn } from './logger.js';\n\nimport {\n  INVENTORY_FIELD_MAP,\n  RESERVATION_FIELD_MAP,\n  REMINDER_FIELD_MAP,\n  MAINTENANCE_FIELD_MAP,\n  CHECKOUT_HISTORY_FIELD_MAP,\n  fromDb,\n  toDb,\n} from './fieldMap.js';\n\n// Helper to get Supabase client\nasync function db() {\n  return await getSupabase();\n}\n\n// =============================================================================\n// INVENTORY SERVICE\n// =============================================================================\n\n// Default values for inventory items\nconst INVENTORY_DEFAULTS = { isKit: false, kitItems: [], viewCount: 0, checkoutCount: 0, location: '' };\n\n// Inventory pass-through fields (same name in frontend and DB)\nconst INVENTORY_PASSTHROUGH = ['id', 'name', 'brand', 'status', 'condition', 'image', 'specs', 'quantity'];\n\n// Numeric fields with their default values\nconst INVENTORY_NUMERIC = { purchasePrice: 0, currentValue: 0, reorderPoint: 0 };\n\n// Transform database row to frontend format\nfunction transformInventoryItem(item) {\n  if (!item) return null;\n  const result = fromDb(item, INVENTORY_FIELD_MAP, INVENTORY_DEFAULTS);\n  // Dual-key compat: ensure category_name is also set\n  result.category_name = result.category || result.category_name;\n  return result;\n}\n\n// Transform frontend object to database format (full insert)\nfunction transformItemForDb(item) {\n  if (!item) return null;\n  const dbItem = toDb(item, INVENTORY_FIELD_MAP, {\n    passThroughFields: INVENTORY_PASSTHROUGH,\n    numericFields: INVENTORY_NUMERIC,\n  });\n  // Ensure defaults\n  if (!dbItem.status) dbItem.status = 'available';\n  if (!dbItem.condition) dbItem.condition = 'excellent';\n  if (!dbItem.specs) dbItem.specs = {};\n  if (!dbItem.quantity) dbItem.quantity = 1;\n  return dbItem;\n}\n\nexport const inventoryService = {\n  // Columns needed for list views (GearList, Dashboard, Search, PackLists, Labels, etc.)\n  // This is everything except notes, checkout_history, and maintenance which come from separate tables\n  LIST_COLUMNS: [\n    'id', 'name', 'brand', 'status', 'condition', 'image', 'quantity',\n    'category_name', 'serial_number', 'specs',\n    'purchase_date', 'purchase_price', 'current_value', 'reorder_point',\n    'is_kit', 'kit_type', 'kit_contents',\n    'checked_out_to_name', 'checked_out_to_user_id', 'checked_out_date',\n    'due_back', 'checkout_project', 'checkout_client_id',\n    'location_display', 'location_id',\n    'view_count', 'checkout_count',\n    'created_at', 'updated_at'\n  ].join(','),\n\n  // Get all inventory items (slim: list columns only, no related data)\n  async getAll() {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('inventory')\n      .select(this.LIST_COLUMNS)\n      .order('category_name')\n      .order('name');\n    \n    if (error) throw error;\n    return (data || []).map(transformInventoryItem);\n  },\n\n  // Get single item by ID\n  async getById(id) {\n    const supabase = await db();\n    if (!supabase) return null;\n    \n    const { data, error } = await supabase\n      .from('inventory')\n      .select('*')\n      .eq('id', id)\n      .single();\n    \n    if (error) throw error;\n    return transformInventoryItem(data);\n  },\n\n  // Get item with all related data (notes, reminders, reservations, maintenance)\n  async getByIdWithDetails(id) {\n    const supabase = await db();\n    if (!supabase) return null;\n    \n    // Get base item\n    const item = await this.getById(id);\n    if (!item) return null;\n    \n    // Get related data in parallel\n    const [notes, reminders, reservations, maintenance, checkoutHistory] = await Promise.all([\n      itemNotesService.getByItemId(id),\n      itemRemindersService.getByItemId(id),\n      reservationsService.getByItemId(id),\n      maintenanceService.getByItemId(id),\n      checkoutHistoryService.getByItemId(id)\n    ]);\n    \n    return {\n      ...item,\n      notes: notes || [],\n      reminders: reminders || [],\n      reservations: reservations || [],\n      maintenanceHistory: maintenance || [],\n      checkoutHistory: checkoutHistory || []\n    };\n  },\n\n  // Create new item\n  async create(item) {\n    const supabase = await db();\n    if (!supabase) return item;\n    \n    // Validate before writing\n    const { validateItem } = await import('./validators.js');\n    const validation = validateItem(item);\n    if (!validation.isValid) {\n      throw new Error('Validation failed: ' + Object.values(validation.errors).join(', '));\n    }\n    \n    // Transform from frontend camelCase to database snake_case\n    const dbItem = transformItemForDb(validation.data || item);\n    \n    const { data, error } = await supabase\n      .from('inventory')\n      .insert(dbItem)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    \n    // Transform response back to frontend format\n    return transformInventoryItem(data);\n  },\n\n  // Update item\n  async update(id, updates) {\n    const supabase = await db();\n    if (!supabase) return { id, ...updates };\n    \n    // Transform updates to database format (partial update)\n    const dbUpdates = toDb(updates, INVENTORY_FIELD_MAP, { partial: true, numericFields: INVENTORY_NUMERIC });\n    \n    const { data, error } = await supabase\n      .from('inventory')\n      .update(dbUpdates)\n      .eq('id', id)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return transformInventoryItem(data);\n  },\n\n  // Delete item\n  async delete(id) {\n    const supabase = await db();\n    if (!supabase) return { id };\n    \n    const { error } = await supabase\n      .from('inventory')\n      .delete()\n      .eq('id', id);\n    \n    if (error) throw error;\n    return { id };\n  },\n\n  // Check out item\n  async checkOut(id, { userId, userName, clientId, clientName, project, dueBack }) {\n    const supabase = await db();\n    if (!supabase) return null;\n    \n    const { data, error } = await supabase\n      .from('inventory')\n      .update({\n        status: 'checked-out',\n        checked_out_to_user_id: userId,\n        checked_out_to_name: userName,\n        checkout_client_id: clientId,\n        checked_out_date: new Date().toISOString().split('T')[0],\n        due_back: dueBack,\n        checkout_project: project\n      })\n      .eq('id', id)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    \n    // Increment checkout count (non-blocking, may not exist yet)\n    supabase.rpc('increment_checkout_count', { item_id: id })\n      .then(({ error: rpcErr }) => {\n        if (rpcErr) warn('increment_checkout_count RPC not available:', rpcErr.message);\n      });\n    \n    // Add to checkout history (non-blocking)\n    checkoutHistoryService.create({\n      item_id: id,\n      user_id: userId,\n      user_name: userName,\n      client_id: clientId,\n      client_name: clientName,\n      action: 'checkout',\n      project\n    }).catch(err => warn('Checkout history not saved:', err.message));\n    \n    return data;\n  },\n\n  // Check in item\n  async checkIn(id, { userId, userName, notes, condition }) {\n    const supabase = await db();\n    if (!supabase) return null;\n    \n    // Get current item state for history\n    const item = await this.getById(id);\n    \n    const updates = {\n      status: 'available',\n      checked_out_to_user_id: null,\n      checked_out_to_name: null,\n      checkout_client_id: null,\n      checked_out_date: null,\n      due_back: null,\n      checkout_project: null\n    };\n    \n    if (condition) updates.condition = condition;\n    \n    const { data, error } = await supabase\n      .from('inventory')\n      .update(updates)\n      .eq('id', id)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    \n    // Add to checkout history (non-blocking)\n    checkoutHistoryService.create({\n      item_id: id,\n      user_id: userId,\n      user_name: userName,\n      client_id: item?.checkout_client_id,\n      action: 'checkin',\n      notes,\n      condition_at_action: condition\n    }).catch(err => warn('Checkin history not saved:', err.message));\n    \n    return data;\n  },\n\n  // Generate next ID for category\n  async generateId(categoryPrefix) {\n    const supabase = await db();\n    if (!supabase) return `${categoryPrefix}1001`;\n    \n    const { data, error } = await supabase.rpc('generate_item_id', {\n      category_prefix: categoryPrefix\n    });\n    \n    if (error) throw error;\n    return data;\n  },\n\n  // Increment view count\n  async incrementViewCount(id) {\n    const supabase = await db();\n    if (!supabase) return;\n    \n    await supabase.rpc('increment_view_count', { item_id: id });\n  },\n\n  // Search items\n  async search(query) {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('inventory')\n      .select('*')\n      .or(`name.ilike.%${query}%,brand.ilike.%${query}%,id.ilike.%${query}%,serial_number.ilike.%${query}%`)\n      .limit(50);\n    \n    if (error) throw error;\n    return data;\n  },\n\n  // Get items by status\n  async getByStatus(status) {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('inventory')\n      .select('*')\n      .eq('status', status);\n    \n    if (error) throw error;\n    return data;\n  },\n\n  // Get overdue items\n  async getOverdue() {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const today = new Date().toISOString().split('T')[0];\n    const { data, error } = await supabase\n      .from('inventory')\n      .select('*')\n      .eq('status', 'checked-out')\n      .lt('due_back', today);\n    \n    if (error) throw error;\n    return data;\n  }\n};\n\n// =============================================================================\n// ITEM NOTES SERVICE\n// =============================================================================\nexport const itemNotesService = {\n  async getByItemId(itemId) {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('item_notes')\n      .select('*')\n      .eq('item_id', itemId)\n      .eq('deleted', false)\n      .order('created_at', { ascending: false });\n    \n    if (error) throw error;\n    \n    // Build threaded structure\n    return buildThreadedNotes(data);\n  },\n\n  async create(note) {\n    const supabase = await db();\n    if (!supabase) return note;\n    \n    const { data, error } = await supabase\n      .from('item_notes')\n      .insert(note)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async softDelete(id) {\n    const supabase = await db();\n    if (!supabase) return { id };\n    \n    const { data, error } = await supabase\n      .from('item_notes')\n      .update({ deleted: true })\n      .eq('id', id)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  }\n};\n\n// =============================================================================\n// ITEM REMINDERS SERVICE\n// =============================================================================\n// Helper to transform reminder fields\nfunction transformReminder(reminder) {\n  if (!reminder) return null;\n  const result = fromDb(reminder, REMINDER_FIELD_MAP);\n  // Transform nested item if present\n  if (result.item) result.item = transformInventoryItem(result.item);\n  return result;\n}\n\nexport const itemRemindersService = {\n  async getByItemId(itemId) {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('item_reminders')\n      .select('*')\n      .eq('item_id', itemId)\n      .order('due_date');\n    \n    if (error) throw error;\n    return (data || []).map(transformReminder);\n  },\n\n  async getDue() {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const today = new Date().toISOString().split('T')[0];\n    const { data, error } = await supabase\n      .from('item_reminders')\n      .select(`\n        *,\n        item:inventory(id, name, category_name)\n      `)\n      .lte('due_date', today)\n      .eq('completed', false)\n      .order('due_date');\n    \n    if (error) throw error;\n    return (data || []).map(transformReminder);\n  },\n\n  async create(reminder) {\n    const supabase = await db();\n    if (!supabase) return reminder;\n    \n    const { data, error } = await supabase\n      .from('item_reminders')\n      .insert(reminder)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async update(id, updates) {\n    const supabase = await db();\n    if (!supabase) return { id, ...updates };\n    \n    const { data, error } = await supabase\n      .from('item_reminders')\n      .update(updates)\n      .eq('id', id)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async complete(id) {\n    const supabase = await db();\n    if (!supabase) return { id, completed: true };\n    \n    const { data, error } = await supabase\n      .from('item_reminders')\n      .update({\n        completed: true,\n        completed_at: new Date().toISOString()\n      })\n      .eq('id', id)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async delete(id) {\n    const supabase = await db();\n    if (!supabase) return { id };\n    \n    const { error } = await supabase\n      .from('item_reminders')\n      .delete()\n      .eq('id', id);\n    \n    if (error) throw error;\n    return { id };\n  }\n};\n\n// =============================================================================\n// RESERVATIONS SERVICE\n// =============================================================================\n\n// Helper to transform reservation fields\nfunction transformReservation(res) {\n  if (!res) return null;\n  \n  // Parse notes if it's a string (JSONB comes back as string sometimes)\n  let notes = res.notes || [];\n  if (typeof notes === 'string') {\n    try {\n      notes = JSON.parse(notes);\n    } catch (e) {\n      notes = [];\n    }\n  }\n  // Ensure notes is always an array\n  if (!Array.isArray(notes)) {\n    notes = [];\n  }\n  \n  const result = fromDb(res, RESERVATION_FIELD_MAP);\n  result.notes = notes;\n\n  // Normalize field aliases  the field map has duplicates (start/startDate both map\n  // to start_date) and reverseMap only keeps the last one. Ensure the short names\n  // used throughout the app are always present.\n  if (result.startDate && !result.start) result.start = result.startDate;\n  if (result.endDate && !result.end) result.end = result.endDate;\n  if (result.start && !result.startDate) result.startDate = result.start;\n  if (result.end && !result.endDate) result.endDate = result.end;\n  // contactName  user: the app uses 'user' for contact name in forms/display\n  if (result.contactName && !result.user) result.user = result.contactName;\n  if (result.user && !result.contactName) result.contactName = result.user;\n  // Ensure dueBack is set (used by some views)\n  if (!result.dueBack) result.dueBack = result.end || result.endDate;\n\n  // Transform nested item if present\n  if (result.item) result.item = transformInventoryItem(result.item);\n  return result;\n}\n\nexport const reservationsService = {\n  async getAll() {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('reservations')\n      .select(`\n        *,\n        item:inventory(id, name, category_name, brand, status),\n        client:clients(id, name, type, email, phone)\n      `)\n      .order('start_date');\n    \n    if (error) throw error;\n    return (data || []).map(transformReservation);\n  },\n\n  async getByItemId(itemId) {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('reservations')\n      .select(`\n        *,\n        client:clients(id, name, type)\n      `)\n      .eq('item_id', itemId)\n      .order('start_date');\n    \n    if (error) throw error;\n    return (data || []).map(transformReservation);\n  },\n\n  async getByClientId(clientId) {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('reservations')\n      .select(`\n        *,\n        item:inventory(id, name, category_name, brand)\n      `)\n      .eq('client_id', clientId)\n      .order('start_date', { ascending: false });\n    \n    if (error) throw error;\n    return (data || []).map(transformReservation);\n  },\n\n  async getUpcoming(days = 7) {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const today = new Date();\n    const future = new Date(today);\n    future.setDate(future.getDate() + days);\n    \n    const { data, error } = await supabase\n      .from('reservations')\n      .select(`\n        *,\n        item:inventory(id, name, category_name, brand),\n        client:clients(id, name, type)\n      `)\n      .gte('end_date', today.toISOString().split('T')[0])\n      .lte('start_date', future.toISOString().split('T')[0])\n      .eq('status', 'confirmed')\n      .order('start_date');\n    \n    if (error) throw error;\n    return (data || []).map(transformReservation);\n  },\n\n  async getByDateRange(startDate, endDate) {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('reservations')\n      .select(`\n        *,\n        item:inventory(id, name, category_name, brand),\n        client:clients(id, name, type)\n      `)\n      .lte('start_date', endDate)\n      .gte('end_date', startDate)\n      .neq('status', 'cancelled')\n      .order('start_date');\n    \n    if (error) throw error;\n    return (data || []).map(transformReservation);\n  },\n\n  async create(reservation) {\n    const supabase = await db();\n    if (!supabase) return reservation;\n    \n    const { data, error } = await supabase\n      .from('reservations')\n      .insert(reservation)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    \n    // Update item status if reservation starts today or earlier\n    const today = new Date().toISOString().split('T')[0];\n    if (reservation.start_date <= today) {\n      await inventoryService.update(reservation.item_id, { status: 'reserved' });\n    }\n    \n    return transformReservation(data);\n  },\n\n  async update(id, updates) {\n    const supabase = await db();\n    if (!supabase) return { id, ...updates };\n    \n    const { data, error } = await supabase\n      .from('reservations')\n      .update(updates)\n      .eq('id', id)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return transformReservation(data);\n  },\n\n  async delete(id) {\n    const supabase = await db();\n    if (!supabase) return { id };\n    \n    const { error } = await supabase\n      .from('reservations')\n      .delete()\n      .eq('id', id);\n    \n    if (error) throw error;\n    return { id };\n  },\n\n  async cancel(id) {\n    const supabase = await db();\n    if (!supabase) return { id, status: 'cancelled' };\n    \n    const { data, error } = await supabase\n      .from('reservations')\n      .update({ status: 'cancelled' })\n      .eq('id', id)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return transformReservation(data);\n  }\n};\n\n// =============================================================================\n// MAINTENANCE SERVICE\n// =============================================================================\n// Helper to transform maintenance record fields\nfunction transformMaintenanceRecord(record) {\n  if (!record) return null;\n  const result = fromDb(record, MAINTENANCE_FIELD_MAP, { warrantyWork: false });\n  // Transform nested item if present\n  if (result.item) result.item = transformInventoryItem(result.item);\n  return result;\n}\n\nexport const maintenanceService = {\n  async getAll() {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('maintenance_records')\n      .select(`\n        *,\n        item:inventory(id, name, category_name, brand)\n      `)\n      .order('scheduled_date', { ascending: false });\n    \n    if (error) throw error;\n    return (data || []).map(transformMaintenanceRecord);\n  },\n\n  async getByItemId(itemId) {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('maintenance_records')\n      .select('*')\n      .eq('item_id', itemId)\n      .order('scheduled_date', { ascending: false });\n    \n    if (error) throw error;\n    return (data || []).map(transformMaintenanceRecord);\n  },\n\n  async getPending() {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('maintenance_records')\n      .select(`\n        *,\n        item:inventory(id, name, category_name, brand)\n      `)\n      .in('status', ['scheduled', 'in-progress'])\n      .order('scheduled_date');\n    \n    if (error) throw error;\n    return (data || []).map(transformMaintenanceRecord);\n  },\n\n  async create(record) {\n    const supabase = await db();\n    if (!supabase) return record;\n    \n    const { data, error } = await supabase\n      .from('maintenance_records')\n      .insert(record)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return transformMaintenanceRecord(data);\n  },\n\n  async update(id, updates) {\n    const supabase = await db();\n    if (!supabase) return { id, ...updates };\n    \n    const { data, error } = await supabase\n      .from('maintenance_records')\n      .update(updates)\n      .eq('id', id)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return transformMaintenanceRecord(data);\n  },\n\n  async complete(id, { completedDate, notes, cost }) {\n    const supabase = await db();\n    if (!supabase) return { id, status: 'completed' };\n    \n    const { data, error } = await supabase\n      .from('maintenance_records')\n      .update({\n        status: 'completed',\n        completed_date: completedDate || new Date().toISOString().split('T')[0],\n        notes,\n        cost\n      })\n      .eq('id', id)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return transformMaintenanceRecord(data);\n  },\n\n  async delete(id) {\n    const supabase = await db();\n    if (!supabase) return { id };\n    \n    const { error } = await supabase\n      .from('maintenance_records')\n      .delete()\n      .eq('id', id);\n    \n    if (error) throw error;\n    return { id };\n  },\n\n  // Get maintenance cost summary for an item\n  async getCostSummary(itemId) {\n    const supabase = await db();\n    if (!supabase) return { total: 0, count: 0 };\n    \n    const { data, error } = await supabase\n      .from('maintenance_records')\n      .select('cost')\n      .eq('item_id', itemId)\n      .eq('status', 'completed');\n    \n    if (error) throw error;\n    \n    const total = data.reduce((sum, r) => sum + (parseFloat(r.cost) || 0), 0);\n    return { total, count: data.length };\n  }\n};\n\n// =============================================================================\n// CHECKOUT HISTORY SERVICE\n// =============================================================================\n// Helper to transform checkout history fields  \nfunction transformCheckoutHistory(record) {\n  if (!record) return null;\n  const result = fromDb(record, CHECKOUT_HISTORY_FIELD_MAP);\n  // Compat alias: 'user' field from user_name\n  result.user = result.userName || result.user;\n  // Compat alias: 'date' field from timestamp\n  result.date = result.timestamp || result.date;\n  return result;\n}\n\nexport const checkoutHistoryService = {\n  async getByItemId(itemId, limit = 50) {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('checkout_history')\n      .select('*')\n      .eq('item_id', itemId)\n      .order('timestamp', { ascending: false })\n      .limit(limit);\n    \n    if (error) throw error;\n    return (data || []).map(transformCheckoutHistory);\n  },\n\n  async getByUserId(userId, limit = 50) {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('checkout_history')\n      .select(`\n        *,\n        item:inventory(id, name, category_name)\n      `)\n      .eq('user_id', userId)\n      .order('timestamp', { ascending: false })\n      .limit(limit);\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async create(record) {\n    const supabase = await db();\n    if (!supabase) return record;\n    \n    const { data, error } = await supabase\n      .from('checkout_history')\n      .insert({\n        ...record,\n        timestamp: new Date().toISOString()\n      })\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  }\n};\n\n// =============================================================================\n// CLIENTS SERVICE\n// =============================================================================\nexport const clientsService = {\n  async getAll() {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('clients')\n      .select('*')\n      .order('favorite', { ascending: false })\n      .order('name');\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async getById(id) {\n    const supabase = await db();\n    if (!supabase) return null;\n    \n    const { data, error } = await supabase\n      .from('clients')\n      .select('*')\n      .eq('id', id)\n      .single();\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async getByIdWithDetails(id) {\n    const supabase = await db();\n    if (!supabase) return null;\n    \n    const client = await this.getById(id);\n    if (!client) return null;\n    \n    const [notes, reservations] = await Promise.all([\n      clientNotesService.getByClientId(id),\n      reservationsService.getByClientId(id)\n    ]);\n    \n    return {\n      ...client,\n      clientNotes: notes || [],\n      reservations: reservations || []\n    };\n  },\n\n  async create(client) {\n    const supabase = await db();\n    if (!supabase) return client;\n    \n    // Generate ID if not provided\n    if (!client.id) {\n      const { data: newId } = await supabase.rpc('generate_client_id');\n      client.id = newId;\n    }\n    \n    const { data, error } = await supabase\n      .from('clients')\n      .insert(client)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async update(id, updates) {\n    const supabase = await db();\n    if (!supabase) return { id, ...updates };\n    \n    const { data, error } = await supabase\n      .from('clients')\n      .update(updates)\n      .eq('id', id)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async delete(id) {\n    const supabase = await db();\n    if (!supabase) return { id };\n    \n    const { error } = await supabase\n      .from('clients')\n      .delete()\n      .eq('id', id);\n    \n    if (error) throw error;\n    return { id };\n  },\n\n  async toggleFavorite(id, favorite) {\n    const supabase = await db();\n    if (!supabase) return { id, favorite };\n    \n    const { data, error } = await supabase\n      .from('clients')\n      .update({ favorite })\n      .eq('id', id)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async generateId() {\n    const supabase = await db();\n    if (!supabase) return 'CL001';\n    \n    const { data, error } = await supabase.rpc('generate_client_id');\n    if (error) throw error;\n    return data;\n  }\n};\n\n// =============================================================================\n// CLIENT NOTES SERVICE\n// =============================================================================\nexport const clientNotesService = {\n  async getByClientId(clientId) {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('client_notes')\n      .select('*')\n      .eq('client_id', clientId)\n      .eq('deleted', false)\n      .order('created_at', { ascending: false });\n    \n    if (error) throw error;\n    \n    // Build threaded structure\n    return buildThreadedNotes(data);\n  },\n\n  async create(note) {\n    const supabase = await db();\n    if (!supabase) return note;\n    \n    const { data, error } = await supabase\n      .from('client_notes')\n      .insert(note)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async softDelete(id) {\n    const supabase = await db();\n    if (!supabase) return { id };\n    \n    const { data, error } = await supabase\n      .from('client_notes')\n      .update({ deleted: true })\n      .eq('id', id)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  }\n};\n\n// =============================================================================\n// PACKAGES SERVICE\n// =============================================================================\nexport const packagesService = {\n  async getAll() {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('packages')\n      .select(`\n        *,\n        package_items(item_id, sort_order)\n      `)\n      .order('name');\n    \n    if (error) throw error;\n    \n    // Transform to expected format\n    return data.map(pkg => ({\n      ...pkg,\n      items: pkg.package_items\n        .sort((a, b) => a.sort_order - b.sort_order)\n        .map(pi => pi.item_id)\n    }));\n  },\n\n  async getById(id) {\n    const supabase = await db();\n    if (!supabase) return null;\n    \n    const { data, error } = await supabase\n      .from('packages')\n      .select(`\n        *,\n        package_items(item_id, sort_order),\n        package_notes(*)\n      `)\n      .eq('id', id)\n      .single();\n    \n    if (error) throw error;\n    \n    return {\n      ...data,\n      items: data.package_items\n        .sort((a, b) => a.sort_order - b.sort_order)\n        .map(pi => pi.item_id),\n      notes: buildThreadedNotes(data.package_notes || [])\n    };\n  },\n\n  async create(pkg) {\n    const supabase = await db();\n    if (!supabase) return pkg;\n    \n    // Extract fields that aren't in DB schema\n    const { items, notes, category, ...packageData } = pkg;\n    \n    // Generate UUID for id if not provided\n    if (!packageData.id) {\n      packageData.id = crypto.randomUUID();\n    }\n    \n    // Create package\n    const { data, error } = await supabase\n      .from('packages')\n      .insert(packageData)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    \n    // Add items\n    if (items?.length > 0) {\n      await supabase\n        .from('package_items')\n        .insert(items.map((itemId, index) => ({\n          package_id: data.id,\n          item_id: itemId,\n          sort_order: index\n        })));\n    }\n    \n    return { ...data, items: items || [], notes: [], category: category || '' };\n  },\n\n  async update(id, updates) {\n    const supabase = await db();\n    if (!supabase) return { id, ...updates };\n    \n    // Extract fields that aren't in DB schema\n    const { items, notes, category, ...packageData } = updates;\n    \n    // Update package (only if there are DB fields to update)\n    let data = { id };\n    if (Object.keys(packageData).length > 0) {\n      const { data: updatedData, error } = await supabase\n        .from('packages')\n        .update(packageData)\n        .eq('id', id)\n        .select()\n        .single();\n      \n      if (error) throw error;\n      data = updatedData;\n    }\n    \n    // Update items if provided\n    if (items !== undefined) {\n      // Delete existing items\n      await supabase\n        .from('package_items')\n        .delete()\n        .eq('package_id', id);\n      \n      // Add new items\n      if (items.length > 0) {\n        await supabase\n          .from('package_items')\n          .insert(items.map((itemId, index) => ({\n            package_id: id,\n            item_id: itemId,\n            sort_order: index\n          })));\n      }\n    }\n    \n    return { ...data, items: items || [], category: category || '' };\n  },\n\n  async delete(id) {\n    const supabase = await db();\n    if (!supabase) return { id };\n    \n    const { error } = await supabase\n      .from('packages')\n      .delete()\n      .eq('id', id);\n    \n    if (error) throw error;\n    return { id };\n  }\n};\n\n// =============================================================================\n// PACK LISTS SERVICE\n// =============================================================================\nexport const packListsService = {\n  async getAll() {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('pack_lists')\n      .select(`\n        *,\n        pack_list_items(item_id, quantity, is_packed, sort_order),\n        pack_list_packages(package_id, sort_order)\n      `)\n      .order('created_at', { ascending: false });\n    \n    if (error) throw error;\n    \n    // Transform to expected format\n    return data.map(list => ({\n      ...list,\n      createdAt: list.created_at, // Map snake_case to camelCase\n      items: list.pack_list_items\n        .sort((a, b) => a.sort_order - b.sort_order)\n        .map(i => ({ id: i.item_id, quantity: i.quantity })),\n      packages: list.pack_list_packages\n        .sort((a, b) => a.sort_order - b.sort_order)\n        .map(p => p.package_id),\n      packedItems: list.pack_list_items\n        .filter(i => i.is_packed)\n        .map(i => i.item_id)\n    }));\n  },\n\n  async getById(id) {\n    const supabase = await db();\n    if (!supabase) return null;\n    \n    const { data, error } = await supabase\n      .from('pack_lists')\n      .select(`\n        *,\n        pack_list_items(item_id, quantity, is_packed, sort_order),\n        pack_list_packages(package_id, sort_order)\n      `)\n      .eq('id', id)\n      .single();\n    \n    if (error) throw error;\n    \n    return {\n      ...data,\n      createdAt: data.created_at, // Map snake_case to camelCase\n      items: data.pack_list_items\n        .sort((a, b) => a.sort_order - b.sort_order)\n        .map(i => ({ id: i.item_id, quantity: i.quantity })),\n      packages: data.pack_list_packages\n        .sort((a, b) => a.sort_order - b.sort_order)\n        .map(p => p.package_id),\n      packedItems: data.pack_list_items\n        .filter(i => i.is_packed)\n        .map(i => i.item_id)\n    };\n  },\n\n  async create(packList) {\n    const supabase = await db();\n    if (!supabase) return packList;\n    \n    const { items, packages, packedItems, ...listData } = packList;\n    \n    // Generate UUID for id if not provided\n    if (!listData.id) {\n      listData.id = crypto.randomUUID();\n    }\n    \n    // Add created_at if not provided\n    if (!listData.created_at) {\n      listData.created_at = new Date().toISOString();\n    }\n    \n    // Create pack list\n    const { data, error } = await supabase\n      .from('pack_lists')\n      .insert(listData)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    \n    // Add items\n    if (items?.length > 0) {\n      await supabase\n        .from('pack_list_items')\n        .insert(items.map((item, index) => ({\n          pack_list_id: data.id,\n          item_id: item.id || item,\n          quantity: item.quantity || 1,\n          is_packed: false,\n          sort_order: index\n        })));\n    }\n    \n    // Add packages\n    if (packages?.length > 0) {\n      await supabase\n        .from('pack_list_packages')\n        .insert(packages.map((pkgId, index) => ({\n          pack_list_id: data.id,\n          package_id: pkgId,\n          sort_order: index\n        })));\n    }\n    \n    return { ...data, createdAt: data.created_at, items: items || [], packages: packages || [], packedItems: [] };\n  },\n\n  async update(id, updates) {\n    const supabase = await db();\n    if (!supabase) return { id, ...updates };\n    \n    const { items, packages, packedItems, ...listData } = updates;\n    \n    // Update pack list\n    if (Object.keys(listData).length > 0) {\n      const { error } = await supabase\n        .from('pack_lists')\n        .update(listData)\n        .eq('id', id);\n      \n      if (error) throw error;\n    }\n    \n    // Update items if provided\n    if (items !== undefined) {\n      await supabase.from('pack_list_items').delete().eq('pack_list_id', id);\n      if (items.length > 0) {\n        await supabase.from('pack_list_items').insert(\n          items.map((item, index) => ({\n            pack_list_id: id,\n            item_id: item.id || item,\n            quantity: item.quantity || 1,\n            is_packed: packedItems?.includes(item.id || item) || false,\n            sort_order: index\n          }))\n        );\n      }\n    }\n    \n    // Update packages if provided\n    if (packages !== undefined) {\n      await supabase.from('pack_list_packages').delete().eq('pack_list_id', id);\n      if (packages.length > 0) {\n        await supabase.from('pack_list_packages').insert(\n          packages.map((pkgId, index) => ({\n            pack_list_id: id,\n            package_id: pkgId,\n            sort_order: index\n          }))\n        );\n      }\n    }\n    \n    return { id, ...updates };\n  },\n\n  async delete(id) {\n    const supabase = await db();\n    if (!supabase) return { id };\n    \n    const { error } = await supabase\n      .from('pack_lists')\n      .delete()\n      .eq('id', id);\n    \n    if (error) throw error;\n    return { id };\n  },\n\n  async toggleItemPacked(packListId, itemId, isPacked) {\n    const supabase = await db();\n    if (!supabase) return { packListId, itemId, isPacked };\n    \n    const { data, error } = await supabase\n      .from('pack_list_items')\n      .update({ is_packed: isPacked })\n      .eq('pack_list_id', packListId)\n      .eq('item_id', itemId)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  }\n};\n\n// =============================================================================\n// CATEGORIES SERVICE\n// =============================================================================\nexport const categoriesService = {\n  async getAll() {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('categories')\n      .select('*')\n      .order('sort_order');\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async create(category) {\n    const supabase = await db();\n    if (!supabase) return category;\n    \n    const { data, error } = await supabase\n      .from('categories')\n      .insert(category)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async update(id, updates) {\n    const supabase = await db();\n    if (!supabase) return { id, ...updates };\n    \n    const { data, error } = await supabase\n      .from('categories')\n      .update(updates)\n      .eq('id', id)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async delete(name) {\n    const supabase = await db();\n    if (!supabase) return { name };\n    \n    const { error } = await supabase\n      .from('categories')\n      .delete()\n      .eq('name', name);\n    \n    if (error) throw error;\n    return { name };\n  }\n};\n\n// =============================================================================\n// SPECS SERVICE\n// =============================================================================\nexport const specsService = {\n  async getAll() {\n    const supabase = await db();\n    if (!supabase) return {};\n    \n    const { data, error } = await supabase\n      .from('specs')\n      .select('*')\n      .order('category_name')\n      .order('sort_order');\n    \n    if (error) throw error;\n    \n    // Group by category\n    const grouped = {};\n    data.forEach(spec => {\n      if (!grouped[spec.category_name]) {\n        grouped[spec.category_name] = [];\n      }\n      grouped[spec.category_name].push({\n        name: spec.name,\n        required: spec.required\n      });\n    });\n    \n    return grouped;\n  },\n\n  async getByCategory(categoryName) {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('specs')\n      .select('*')\n      .eq('category_name', categoryName)\n      .order('sort_order');\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async upsert(categoryName, specs) {\n    const supabase = await db();\n    if (!supabase) return specs;\n    \n    // Delete existing specs for category\n    await supabase\n      .from('specs')\n      .delete()\n      .eq('category_name', categoryName);\n    \n    // Insert new specs\n    if (specs.length > 0) {\n      const { data, error } = await supabase\n        .from('specs')\n        .insert(specs.map((spec, index) => ({\n          category_name: categoryName,\n          name: spec.name,\n          required: spec.required || false,\n          sort_order: index\n        })))\n        .select();\n      \n      if (error) throw error;\n      return data;\n    }\n    \n    return [];\n  }\n};\n\n// =============================================================================\n// LOCATIONS SERVICE\n// =============================================================================\nexport const locationsService = {\n  async getAll() {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('locations')\n      .select('*')\n      .order('path');\n    \n    if (error) throw error;\n    \n    // Build tree structure\n    return buildLocationTree(data);\n  },\n\n  async getFlat() {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('locations')\n      .select('*')\n      .order('path');\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async create(location) {\n    const supabase = await db();\n    if (!supabase) return location;\n    \n    const { data, error } = await supabase\n      .from('locations')\n      .insert(location)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async update(id, updates) {\n    const supabase = await db();\n    if (!supabase) return { id, ...updates };\n    \n    const { data, error } = await supabase\n      .from('locations')\n      .update(updates)\n      .eq('id', id)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async delete(id) {\n    const supabase = await db();\n    if (!supabase) return { id };\n    \n    const { error } = await supabase\n      .from('locations')\n      .delete()\n      .eq('id', id);\n    \n    if (error) throw error;\n    return { id };\n  }\n};\n\n// =============================================================================\n// USERS SERVICE\n// =============================================================================\nexport const usersService = {\n  async getAll() {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('users')\n      .select(`\n        *,\n        role:roles(id, name, permissions)\n      `)\n      .order('name');\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async getById(id) {\n    const supabase = await db();\n    if (!supabase) return null;\n    \n    const { data, error } = await supabase\n      .from('users')\n      .select(`\n        *,\n        role:roles(id, name, permissions)\n      `)\n      .eq('id', id)\n      .single();\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async update(id, updates) {\n    const supabase = await db();\n    if (!supabase) return { id, ...updates };\n    \n    const { data, error } = await supabase\n      .from('users')\n      .update(updates)\n      .eq('id', id)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async updateRole(id, roleId) {\n    const supabase = await db();\n    if (!supabase) return { id, role_id: roleId };\n    \n    const { data, error } = await supabase\n      .from('users')\n      .update({ role_id: roleId })\n      .eq('id', id)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  }\n};\n\n// =============================================================================\n// ROLES SERVICE\n// =============================================================================\nexport const rolesService = {\n  async getAll() {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('roles')\n      .select('*')\n      .order('name');\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async create(role) {\n    const supabase = await db();\n    if (!supabase) return role;\n    \n    const { data, error } = await supabase\n      .from('roles')\n      .insert(role)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async update(id, updates) {\n    const supabase = await db();\n    if (!supabase) return { id, ...updates };\n    \n    const { data, error } = await supabase\n      .from('roles')\n      .update(updates)\n      .eq('id', id)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  },\n\n  async delete(id) {\n    const supabase = await db();\n    if (!supabase) return { id };\n    \n    const { error } = await supabase\n      .from('roles')\n      .delete()\n      .eq('id', id);\n    \n    if (error) throw error;\n    return { id };\n  }\n};\n\n// =============================================================================\n// AUDIT LOG SERVICE\n// =============================================================================\nexport const auditLogService = {\n  async getAll(options = {}) {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    let query = supabase\n      .from('audit_log')\n      .select('*')\n      .order('timestamp', { ascending: false });\n    \n    if (options.limit) query = query.limit(options.limit);\n    if (options.type) query = query.eq('type', options.type);\n    if (options.itemId) query = query.eq('item_id', options.itemId);\n    \n    const { data, error } = await query;\n    if (error) throw error;\n    return data;\n  },\n\n  async create(entry) {\n    const supabase = await db();\n    if (!supabase) return entry;\n    \n    // Map camelCase JS fields to snake_case DB columns\n    const row = {\n      type: entry.type,\n      description: entry.description,\n      user: entry.user,\n      timestamp: new Date().toISOString(),\n    };\n    // Only include item_id if provided (column may not exist in all schemas)\n    if (entry.itemId) row.item_id = entry.itemId;\n    \n    const { data, error } = await supabase\n      .from('audit_log')\n      .insert(row)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  }\n};\n\n// =============================================================================\n// DASHBOARD SERVICE\n// =============================================================================\nexport const dashboardService = {\n  async getStats() {\n    const supabase = await db();\n    if (!supabase) {\n      return {\n        total_items: 0,\n        available: 0,\n        checked_out: 0,\n        reserved: 0,\n        needs_attention: 0,\n        overdue: 0,\n        total_value: 0,\n        upcoming_reservations: 0,\n        due_reminders: 0,\n        pending_maintenance: 0\n      };\n    }\n    \n    const { data, error } = await supabase\n      .from('dashboard_stats')\n      .select('*')\n      .single();\n    \n    if (error) throw error;\n    return data;\n  }\n};\n\n// =============================================================================\n// HELPER FUNCTIONS\n// =============================================================================\n\n// Build threaded notes structure\nfunction buildThreadedNotes(notes) {\n  if (!notes || notes.length === 0) return [];\n  \n  // Transform note fields\n  const transformNote = (note) => ({\n    ...note,\n    user: note.user_name || note.user,\n    userName: note.user_name || note.userName,\n    userId: note.user_id || note.userId,\n    itemId: note.item_id || note.itemId,\n    parentId: note.parent_id || note.parentId,\n    date: note.created_at || note.date,\n    createdAt: note.created_at || note.createdAt,\n    replies: []\n  });\n  \n  const notesMap = new Map();\n  const rootNotes = [];\n  \n  // First pass: create map and initialize replies\n  notes.forEach(note => {\n    const transformed = transformNote(note);\n    notesMap.set(transformed.id, transformed);\n  });\n  \n  // Second pass: build tree\n  notesMap.forEach(note => {\n    const parentId = note.parent_id || note.parentId;\n    if (parentId) {\n      const parent = notesMap.get(parentId);\n      if (parent) parent.replies.push(note);\n    } else {\n      rootNotes.push(note);\n    }\n  });\n  \n  return rootNotes;\n}\n\n// Build location tree structure\nfunction buildLocationTree(locations) {\n  if (!locations || locations.length === 0) return [];\n  \n  const buildTree = (items, parentId = null) => {\n    return items\n      .filter(item => item.parent_id === parentId)\n      .map(item => ({\n        ...item,\n        children: buildTree(items, item.id)\n      }));\n  };\n  \n  return buildTree(locations);\n}\n\n// =============================================================================\n// NOTIFICATION PREFERENCES SERVICE\n// =============================================================================\nexport const notificationPreferencesService = {\n  // Get preferences for a user\n  async getByUserId(userId) {\n    const supabase = await db();\n    if (!supabase) return null;\n    \n    const { data, error } = await supabase\n      .from('notification_preferences')\n      .select('*')\n      .eq('user_id', userId)\n      .single();\n    \n    if (error && error.code !== 'PGRST116') throw error; // PGRST116 = not found\n    return data;\n  },\n\n  // Create or update preferences (upsert)\n  async upsert(userId, preferences) {\n    const supabase = await db();\n    if (!supabase) return preferences;\n    \n    const { data, error } = await supabase\n      .from('notification_preferences')\n      .upsert({\n        user_id: userId,\n        ...preferences,\n        updated_at: new Date().toISOString()\n      }, {\n        onConflict: 'user_id'\n      })\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  },\n\n  // Update specific preferences\n  async update(userId, updates) {\n    const supabase = await db();\n    if (!supabase) return updates;\n    \n    const { data, error } = await supabase\n      .from('notification_preferences')\n      .update({\n        ...updates,\n        updated_at: new Date().toISOString()\n      })\n      .eq('user_id', userId)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  }\n};\n\n// =============================================================================\n// NOTIFICATION LOG SERVICE\n// =============================================================================\nexport const notificationLogService = {\n  // Get notification history for a user\n  async getByUserId(userId, limit = 50) {\n    const supabase = await db();\n    if (!supabase) return [];\n    \n    const { data, error } = await supabase\n      .from('notification_log')\n      .select('*')\n      .eq('user_id', userId)\n      .order('created_at', { ascending: false })\n      .limit(limit);\n    \n    if (error) throw error;\n    return data || [];\n  },\n\n  // Log a notification (usually called by edge functions)\n  async create(notification) {\n    const supabase = await db();\n    if (!supabase) return notification;\n    \n    const { data, error } = await supabase\n      .from('notification_log')\n      .insert(notification)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  },\n\n  // Update notification status\n  async updateStatus(id, status, errorMessage = null) {\n    const supabase = await db();\n    if (!supabase) return { id, status };\n    \n    const updates = {\n      status,\n      ...(status === 'sent' ? { sent_at: new Date().toISOString() } : {}),\n      ...(errorMessage ? { error_message: errorMessage } : {})\n    };\n    \n    const { data, error } = await supabase\n      .from('notification_log')\n      .update(updates)\n      .eq('id', id)\n      .select()\n      .single();\n    \n    if (error) throw error;\n    return data;\n  }\n};\n\n// =============================================================================\n// EMAIL SERVICE (calls Supabase Edge Function)\n// =============================================================================\nexport const emailService = {\n  // Send an email via Edge Function\n  async send({ to, templateKey, templateData, userId }) {\n    const supabase = await db();\n    if (!supabase) {\n      log('[Demo Mode] Would send email:', { to, templateKey, templateData });\n      return { success: true, demo: true };\n    }\n    \n    try {\n      const { data, error } = await supabase.functions.invoke('send-email', {\n        body: {\n          to,\n          templateKey,\n          templateData,\n          userId\n        }\n      });\n      \n      if (error) {\n        warn('Email send failed (Edge Function may not be deployed):', error.message);\n        return { success: false, error: error.message };\n      }\n      return data;\n    } catch (err) {\n      warn('Email service unavailable:', err.message);\n      return { success: false, error: err.message };\n    }\n  },\n\n  // Send checkout confirmation email\n  async sendCheckoutConfirmation({ borrowerEmail, borrowerName, item, checkoutDate, dueDate, project }) {\n    return this.send({\n      to: borrowerEmail,\n      templateKey: 'checkout_confirmation',\n      templateData: {\n        borrower_name: borrowerName,\n        item_name: item.name,\n        item_id: item.id,\n        item_brand: item.brand || '',\n        checkout_date: checkoutDate,\n        due_date: dueDate,\n        project: project || '',\n        company_name: 'SIMS'\n      }\n    });\n  },\n\n  // Send checkin confirmation email\n  async sendCheckinConfirmation({ borrowerEmail, borrowerName, item, returnDate }) {\n    return this.send({\n      to: borrowerEmail,\n      templateKey: 'checkin_confirmation',\n      templateData: {\n        borrower_name: borrowerName,\n        item_name: item.name,\n        item_id: item.id,\n        return_date: returnDate,\n        company_name: 'SIMS'\n      }\n    });\n  },\n\n  // Send reservation confirmation email\n  async sendReservationConfirmation({ userEmail, userName, item, reservation }) {\n    return this.send({\n      to: userEmail,\n      templateKey: 'reservation_confirmation',\n      templateData: {\n        user_name: userName,\n        item_name: item.name,\n        item_id: item.id,\n        item_brand: item.brand || '',\n        project_name: reservation.project,\n        start_date: reservation.start,\n        end_date: reservation.end,\n        company_name: 'SIMS'\n      }\n    });\n  },\n\n  // Send due date reminder email\n  async sendDueDateReminder({ borrowerEmail, borrowerName, item, dueDate, daysUntilDue }) {\n    const templateKey = daysUntilDue < 0 ? 'overdue_notice' : 'due_date_reminder';\n    return this.send({\n      to: borrowerEmail,\n      templateKey,\n      templateData: {\n        borrower_name: borrowerName,\n        item_name: item.name,\n        item_id: item.id,\n        due_date: dueDate,\n        days_until_due: Math.abs(daysUntilDue),\n        company_name: 'SIMS'\n      }\n    });\n  }\n};\n\n// =============================================================================\n// EXPORT ALL SERVICES\n// =============================================================================\nexport default {\n  inventory: inventoryService,\n  itemNotes: itemNotesService,\n  itemReminders: itemRemindersService,\n  reservations: reservationsService,\n  maintenance: maintenanceService,\n  checkoutHistory: checkoutHistoryService,\n  clients: clientsService,\n  clientNotes: clientNotesService,\n  packages: packagesService,\n  packLists: packListsService,\n  categories: categoriesService,\n  specs: specsService,\n  locations: locationsService,\n  users: usersService,\n  roles: rolesService,\n  auditLog: auditLogService,\n  dashboard: dashboardService,\n  notificationPreferences: notificationPreferencesService,\n  notificationLog: notificationLogService,\n  email: emailService\n};\n","// =============================================================================\n// SIMS Auth Context\n// Provides authentication state and methods using Supabase Auth\n// =============================================================================\n\nimport React, { createContext, useContext, useState, useEffect, useCallback } from 'react';\nimport { getSupabase, auth } from './supabase.js';\nimport { usersService } from './services.js';\nimport { log, error as logError } from './logger.js';\n\n// Context\nconst AuthContext = createContext(null);\n\n// =============================================================================\n// Auth Provider\n// =============================================================================\nexport function AuthProvider({ children }) {\n  const [user, setUser] = useState(null);\n  const [userProfile, setUserProfile] = useState(null);\n  const [session, setSession] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // =============================================================================\n  // Initialize auth state\n  // =============================================================================\n  useEffect(() => {\n    let subscription = null;\n    \n    const initAuth = async () => {\n      setLoading(true);\n\n      try {\n        // Wait for Supabase client to be ready\n        const supabase = await getSupabase();\n        \n        // Get current session\n        const currentSession = await auth.getSession();\n        setSession(currentSession);\n        \n        if (currentSession?.user) {\n          setUser(currentSession.user);\n          \n          // Fetch user profile from database\n          try {\n            const profile = await usersService.getById(currentSession.user.id);\n            setUserProfile(profile);\n          } catch (profileErr) {\n            logError('Failed to fetch user profile:', profileErr);\n          }\n        }\n        \n        // Subscribe to auth changes (now that supabase is ready)\n        const { data } = supabase.auth.onAuthStateChange(async (event, newSession) => {\n          log('Auth state changed:', event);\n          setSession(newSession);\n          setUser(newSession?.user ?? null);\n          \n          if (newSession?.user) {\n            try {\n              const profile = await usersService.getById(newSession.user.id);\n              setUserProfile(profile);\n            } catch (err) {\n              logError('Failed to fetch user profile:', err);\n            }\n          } else {\n            setUserProfile(null);\n          }\n        });\n        \n        subscription = data.subscription;\n      } catch (err) {\n        logError('Auth init error:', err);\n        setError(err);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    initAuth();\n\n    return () => {\n      subscription?.unsubscribe();\n    };\n  }, []);\n\n  // =============================================================================\n  // Sign In\n  // =============================================================================\n  const signIn = useCallback(async (email, password) => {\n    setError(null);\n\n    try {\n      const data = await auth.signIn(email, password);\n      const authUser = data.user;\n      const newSession = data.session;\n\n      setUser(authUser);\n      setSession(newSession);\n\n      // Fetch user profile\n      let profile = null;\n      if (authUser) {\n        try {\n          profile = await usersService.getById(authUser.id);\n          setUserProfile(profile);\n        } catch (profileErr) {\n          logError('Failed to fetch profile after login:', profileErr);\n        }\n      }\n\n      return { user: profile || authUser, error: null };\n    } catch (err) {\n      logError('Sign in error:', err);\n      setError(err);\n      return { user: null, error: err };\n    }\n  }, []);\n\n  // =============================================================================\n  // Sign Up\n  // =============================================================================\n  const signUp = useCallback(async (email, password, name) => {\n    setError(null);\n    \n    try {\n      const data = await auth.signUp(email, password, name);\n      return { user: data.user, error: null };\n    } catch (err) {\n      setError(err);\n      return { user: null, error: err };\n    }\n  }, []);\n\n  // =============================================================================\n  // Sign Out\n  // =============================================================================\n  const signOut = useCallback(async () => {\n    try {\n      await auth.signOut();\n      setUser(null);\n      setUserProfile(null);\n      setSession(null);\n      setError(null);\n    } catch (err) {\n      setError(err);\n      throw err;\n    }\n  }, []);\n\n  // =============================================================================\n  // Password Reset\n  // =============================================================================\n  const resetPassword = useCallback(async (email) => {\n    setError(null);\n    \n    try {\n      await auth.resetPassword(email);\n      return { error: null };\n    } catch (err) {\n      setError(err);\n      return { error: err };\n    }\n  }, []);\n\n  // =============================================================================\n  // Update Password\n  // =============================================================================\n  const updatePassword = useCallback(async (newPassword) => {\n    setError(null);\n    \n    try {\n      await auth.updatePassword(newPassword);\n      return { error: null };\n    } catch (err) {\n      setError(err);\n      return { error: err };\n    }\n  }, []);\n\n  // =============================================================================\n  // Update Profile\n  // =============================================================================\n  const updateProfile = useCallback(async (updates) => {\n    if (!user) return { error: new Error('Not authenticated') };\n    \n    try {\n      await usersService.update(user.id, updates);\n      const updatedProfile = { ...userProfile, ...updates };\n      setUserProfile(updatedProfile);\n      return { error: null };\n    } catch (err) {\n      setError(err);\n      return { error: err };\n    }\n  }, [user, userProfile]);\n\n  // =============================================================================\n  // Context Value\n  // =============================================================================\n  const value = {\n    // State\n    user,\n    userProfile,\n    session,\n    loading,\n    error,\n    \n    // Computed\n    isAuthenticated: !!user,\n    userRole: userProfile?.role || userProfile?.roleId || 'viewer',\n    userName: userProfile?.name || user?.email?.split('@')[0] || 'User',\n    userEmail: userProfile?.email || user?.email || '',\n    \n    // Methods\n    signIn,\n    signUp,\n    signOut,\n    resetPassword,\n    updatePassword,\n    updateProfile\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\n// =============================================================================\n// Hook\n// =============================================================================\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}\n\nexport default AuthContext;\n","// =============================================================================\n// Data Validators\n// Centralized validation functions for data integrity\n// =============================================================================\n\nimport { STATUS, CONDITION, CATEGORIES } from '../constants.js';\n\n// =============================================================================\n// Validation Result Type\n// =============================================================================\n\n/**\n * @typedef {Object} ValidationResult\n * @property {boolean} isValid - Whether validation passed\n * @property {Object} errors - Field-level error messages\n * @property {Object} data - Sanitized/transformed data (if valid)\n */\n\n// =============================================================================\n// String Validators\n// =============================================================================\n\nexport function isNonEmptyString(value) {\n  return typeof value === 'string' && value.trim().length > 0;\n}\n\nexport function isValidLength(value, min, max) {\n  if (typeof value !== 'string') return false;\n  const len = value.trim().length;\n  return len >= min && len <= max;\n}\n\nexport function sanitizeString(value) {\n  if (typeof value !== 'string') return '';\n  return value.trim();\n}\n\n// =============================================================================\n// Number Validators\n// =============================================================================\n\nexport function isValidNumber(value, min = -Infinity, max = Infinity) {\n  const num = parseFloat(value);\n  return !isNaN(num) && num >= min && num <= max;\n}\n\nexport function parseNumber(value, defaultValue = 0) {\n  const num = parseFloat(value);\n  return isNaN(num) ? defaultValue : num;\n}\n\nexport function parseCurrency(value) {\n  if (typeof value === 'number') return value;\n  if (typeof value !== 'string') return 0;\n  const cleaned = value.replace(/[$,\\s]/g, '');\n  const num = parseFloat(cleaned);\n  return isNaN(num) ? 0 : num;\n}\n\n// =============================================================================\n// Date Validators\n// =============================================================================\n\nexport function isValidDate(value) {\n  if (!value) return false;\n  const date = new Date(value);\n  return !isNaN(date.getTime());\n}\n\nexport function isValidDateRange(startDate, endDate) {\n  if (!isValidDate(startDate) || !isValidDate(endDate)) return false;\n  return new Date(startDate) <= new Date(endDate);\n}\n\nexport function isFutureDate(value) {\n  if (!isValidDate(value)) return false;\n  const date = new Date(value);\n  const today = new Date();\n  today.setHours(0, 0, 0, 0);\n  return date >= today;\n}\n\nexport function isPastDate(value) {\n  if (!isValidDate(value)) return false;\n  const date = new Date(value);\n  const today = new Date();\n  today.setHours(23, 59, 59, 999);\n  return date <= today;\n}\n\n// =============================================================================\n// Enum Validators\n// =============================================================================\n\nexport function isValidStatus(value) {\n  return Object.values(STATUS).includes(value);\n}\n\nexport function isValidCondition(value) {\n  return Object.values(CONDITION).includes(value);\n}\n\nexport function isValidCategory(value, customCategories = []) {\n  const allCategories = [...Object.values(CATEGORIES), ...customCategories];\n  return allCategories.includes(value);\n}\n\n// =============================================================================\n// Item Validator\n// =============================================================================\n\n/**\n * Validate an inventory item\n * @param {Object} data - Item data to validate\n * @param {Object} options - Validation options\n * @param {Array} options.existingCodes - Existing item codes (for uniqueness check)\n * @param {string} options.editingId - ID of item being edited (to exclude from uniqueness check)\n * @param {Array} options.customCategories - Additional valid categories\n * @returns {ValidationResult}\n */\nexport function validateItem(data, options = {}) {\n  const { existingCodes = [], editingId = null, customCategories = [] } = options;\n  const errors = {};\n  \n  // Name validation\n  if (!data.name || !isNonEmptyString(data.name)) {\n    errors.name = 'Name is required';\n  } else if (!isValidLength(data.name, 2, 100)) {\n    errors.name = 'Name must be between 2 and 100 characters';\n  }\n  \n  // Category validation\n  if (!data.category) {\n    errors.category = 'Category is required';\n  } else if (!isValidCategory(data.category, customCategories)) {\n    errors.category = 'Invalid category';\n  }\n  \n  // Code validation (optional but must be unique if provided)\n  if (data.code) {\n    if (!isValidLength(data.code, 2, 20)) {\n      errors.code = 'Code must be between 2 and 20 characters';\n    } else if (existingCodes.includes(data.code) && data.id !== editingId) {\n      errors.code = 'This code is already in use';\n    }\n  }\n  \n  // Status validation\n  if (data.status && !isValidStatus(data.status)) {\n    errors.status = 'Invalid status';\n  }\n  \n  // Condition validation\n  if (data.condition && !isValidCondition(data.condition)) {\n    errors.condition = 'Invalid condition';\n  }\n  \n  // Value validation\n  if (data.value !== undefined && data.value !== '' && data.value !== null) {\n    const numValue = parseCurrency(data.value);\n    if (numValue < 0) {\n      errors.value = 'Value cannot be negative';\n    } else if (numValue > 10000000) {\n      errors.value = 'Value exceeds maximum allowed';\n    }\n  }\n  \n  // Purchase price validation\n  if (data.purchasePrice !== undefined && data.purchasePrice !== '' && data.purchasePrice !== null) {\n    const numPrice = parseCurrency(data.purchasePrice);\n    if (numPrice < 0) {\n      errors.purchasePrice = 'Purchase price cannot be negative';\n    }\n  }\n  \n  // Serial number validation\n  if (data.serialNumber && !isValidLength(data.serialNumber, 0, 50)) {\n    errors.serialNumber = 'Serial number must be 50 characters or less';\n  }\n  \n  // Purchase date validation\n  if (data.purchaseDate && !isValidDate(data.purchaseDate)) {\n    errors.purchaseDate = 'Invalid purchase date';\n  }\n  \n  // Warranty expiration validation\n  if (data.warrantyExpires && !isValidDate(data.warrantyExpires)) {\n    errors.warrantyExpires = 'Invalid warranty expiration date';\n  }\n  \n  const isValid = Object.keys(errors).length === 0;\n  \n  // Sanitize data if valid\n  const sanitizedData = isValid ? {\n    ...data,\n    name: sanitizeString(data.name),\n    code: data.code ? sanitizeString(data.code) : undefined,\n    serialNumber: data.serialNumber ? sanitizeString(data.serialNumber) : undefined,\n    value: data.value !== undefined && data.value !== '' ? parseCurrency(data.value) : undefined,\n    purchasePrice: data.purchasePrice !== undefined && data.purchasePrice !== '' ? parseCurrency(data.purchasePrice) : undefined,\n  } : null;\n  \n  return { isValid, errors, data: sanitizedData };\n}\n\n// =============================================================================\n// Reservation Validator\n// =============================================================================\n\n/**\n * Validate a reservation\n * @param {Object} data - Reservation data\n * @param {Object} options - Validation options\n * @param {Array} options.existingReservations - Existing reservations for conflict check\n * @param {string} options.editingId - ID of reservation being edited\n * @returns {ValidationResult}\n */\nexport function validateReservation(data, options = {}) {\n  const { existingReservations = [], editingId = null } = options;\n  const errors = {};\n  \n  // Start date validation\n  if (!data.start) {\n    errors.start = 'Start date is required';\n  } else if (!isValidDate(data.start)) {\n    errors.start = 'Invalid start date';\n  }\n  \n  // End date validation\n  if (!data.end) {\n    errors.end = 'End date is required';\n  } else if (!isValidDate(data.end)) {\n    errors.end = 'Invalid end date';\n  }\n  \n  // Date range validation\n  if (data.start && data.end && !isValidDateRange(data.start, data.end)) {\n    errors.end = 'End date must be after start date';\n  }\n  \n  // Project name validation\n  if (!data.project || !isNonEmptyString(data.project)) {\n    errors.project = 'Project name is required';\n  } else if (!isValidLength(data.project, 2, 200)) {\n    errors.project = 'Project name must be between 2 and 200 characters';\n  }\n  \n  // User validation\n  if (!data.user || !isNonEmptyString(data.user)) {\n    errors.user = 'Borrower name is required';\n  }\n  \n  // Contact email validation\n  if (data.contactEmail && !isValidEmail(data.contactEmail)) {\n    errors.contactEmail = 'Invalid email address';\n  }\n  \n  // Contact phone validation\n  if (data.contactPhone && !isValidLength(data.contactPhone, 0, 20)) {\n    errors.contactPhone = 'Phone number too long';\n  }\n  \n  // Conflict check\n  if (data.start && data.end && existingReservations.length > 0) {\n    const hasConflict = existingReservations.some(r => {\n      if (r.id === editingId) return false;\n      return datesOverlap(data.start, data.end, r.start, r.end);\n    });\n    \n    if (hasConflict) {\n      errors.dateRange = 'This item is already reserved during the selected dates';\n    }\n  }\n  \n  const isValid = Object.keys(errors).length === 0;\n  \n  return {\n    isValid,\n    errors,\n    data: isValid ? {\n      ...data,\n      project: sanitizeString(data.project),\n      user: sanitizeString(data.user),\n      contactEmail: data.contactEmail ? sanitizeString(data.contactEmail) : undefined,\n      contactPhone: data.contactPhone ? sanitizeString(data.contactPhone) : undefined,\n    } : null,\n  };\n}\n\n// =============================================================================\n// Client Validator\n// =============================================================================\n\nexport function validateClient(data) {\n  const errors = {};\n  \n  if (!data.name || !isNonEmptyString(data.name)) {\n    errors.name = 'Client name is required';\n  } else if (!isValidLength(data.name, 2, 100)) {\n    errors.name = 'Name must be between 2 and 100 characters';\n  }\n  \n  if (data.email && !isValidEmail(data.email)) {\n    errors.email = 'Invalid email address';\n  }\n  \n  if (data.phone && !isValidLength(data.phone, 0, 20)) {\n    errors.phone = 'Phone number too long';\n  }\n  \n  const isValid = Object.keys(errors).length === 0;\n  \n  return {\n    isValid,\n    errors,\n    data: isValid ? {\n      ...data,\n      name: sanitizeString(data.name),\n      email: data.email ? sanitizeString(data.email) : undefined,\n      phone: data.phone ? sanitizeString(data.phone) : undefined,\n    } : null,\n  };\n}\n\n// =============================================================================\n// Maintenance Record Validator\n// =============================================================================\n\nexport function validateMaintenanceRecord(data) {\n  const errors = {};\n  \n  if (!data.type || !isNonEmptyString(data.type)) {\n    errors.type = 'Maintenance type is required';\n  }\n  \n  if (!data.description || !isNonEmptyString(data.description)) {\n    errors.description = 'Description is required';\n  } else if (!isValidLength(data.description, 5, 1000)) {\n    errors.description = 'Description must be between 5 and 1000 characters';\n  }\n  \n  if (data.scheduledDate && !isValidDate(data.scheduledDate)) {\n    errors.scheduledDate = 'Invalid scheduled date';\n  }\n  \n  if (data.completedDate && !isValidDate(data.completedDate)) {\n    errors.completedDate = 'Invalid completed date';\n  }\n  \n  if (data.cost !== undefined && data.cost !== '' && data.cost !== null) {\n    const numCost = parseCurrency(data.cost);\n    if (numCost < 0) {\n      errors.cost = 'Cost cannot be negative';\n    }\n  }\n  \n  const isValid = Object.keys(errors).length === 0;\n  \n  return {\n    isValid,\n    errors,\n    data: isValid ? {\n      ...data,\n      type: sanitizeString(data.type),\n      description: sanitizeString(data.description),\n      vendor: data.vendor ? sanitizeString(data.vendor) : undefined,\n      cost: data.cost !== undefined && data.cost !== '' ? parseCurrency(data.cost) : undefined,\n    } : null,\n  };\n}\n\n// =============================================================================\n// Helper Functions\n// =============================================================================\n\nexport function isValidEmail(email) {\n  if (!email) return false;\n  // Simple email validation - not perfect but catches most issues\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return emailRegex.test(email);\n}\n\nexport function datesOverlap(start1, end1, start2, end2) {\n  const s1 = new Date(start1).getTime();\n  const e1 = new Date(end1).getTime();\n  const s2 = new Date(start2).getTime();\n  const e2 = new Date(end2).getTime();\n  \n  return s1 <= e2 && e1 >= s2;\n}\n\n// =============================================================================\n// Bulk Validation\n// =============================================================================\n\n/**\n * Validate multiple items at once\n * @param {Array} items - Array of items to validate\n * @param {Object} options - Validation options\n * @returns {Object} Results with valid items, invalid items, and errors\n */\nexport function validateItems(items, options = {}) {\n  const existingCodes = items.map(i => i.code).filter(Boolean);\n  const validItems = [];\n  const invalidItems = [];\n  \n  for (const item of items) {\n    const result = validateItem(item, { ...options, existingCodes });\n    if (result.isValid) {\n      validItems.push(result.data);\n    } else {\n      invalidItems.push({ item, errors: result.errors });\n    }\n  }\n  \n  return {\n    isValid: invalidItems.length === 0,\n    validItems,\n    invalidItems,\n    totalCount: items.length,\n    validCount: validItems.length,\n    invalidCount: invalidItems.length,\n  };\n}\n\nexport default {\n  validateItem,\n  validateReservation,\n  validateClient,\n  validateMaintenanceRecord,\n  validateItems,\n  isValidEmail,\n  isValidDate,\n  isValidDateRange,\n  parseCurrency,\n  sanitizeString,\n};\n","// =============================================================================\n// SIMS Data Context\n// Provides centralized state management with Supabase\n// =============================================================================\n\nimport React, { createContext, useContext, useState, useEffect, useCallback, useMemo } from 'react';\nimport {\n  inventoryService,\n  reservationsService,\n  maintenanceService,\n  itemNotesService,\n  itemRemindersService,\n  clientsService,\n  packagesService,\n  packListsService,\n  categoriesService,\n  specsService,\n  locationsService,\n  usersService,\n  rolesService,\n  auditLogService,\n  notificationPreferencesService,\n  emailService,\n  checkoutHistoryService\n} from './services.js';\n\nimport { DEFAULT_ROLES, DEFAULT_LOCATIONS, DEFAULT_SPECS } from '../constants.js';\nimport { log, error as logError } from './logger.js';\nimport { validateReservation, validateClient, validateMaintenanceRecord } from './validators.js';\n\n// =============================================================================\n// CONTEXT\n// =============================================================================\n\nconst DataContext = createContext(null);\n\n// =============================================================================\n// PROVIDER\n// =============================================================================\n\nexport function DataProvider({ children }) {\n  // Loading state\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [dataLoaded, setDataLoaded] = useState(false);\n\n  // Core data state\n  const [inventory, setInventory] = useState([]);\n  const [packages, setPackages] = useState([]);\n  const [packLists, setPackLists] = useState([]);\n  const [clients, setClients] = useState([]);\n  const [users, setUsers] = useState([]);\n  const [roles, setRoles] = useState([]);\n  const [locations, setLocations] = useState([]);\n  const [categories, setCategories] = useState([]);\n  const [specs, setSpecs] = useState({});\n  const [auditLog, setAuditLog] = useState([]);\n\n  // =============================================================================\n  // DATA LOADING FUNCTION (Tiered)\n  //\n  // Tier 1 (blocking): inventory, categories, users, roles, locations, specs\n  //    UI renders as soon as these arrive\n  // Tier 2 (background): reservations, packages, pack lists, clients, audit log\n  //    Loaded after first paint, merged into state progressively\n  // =============================================================================\n  \n  const loadData = useCallback(async () => {\n    log('[DataContext] Starting tiered data load...');\n    setLoading(true);\n    setError(null);\n\n    try {\n      // --- Tier 1: Critical data (blocks rendering) ---\n      const [\n        inventoryData,\n        categoriesData,\n        usersData,\n        rolesData,\n        locationsData,\n        specsData,\n      ] = await Promise.all([\n        inventoryService.getAll(),\n        categoriesService.getAll(),\n        usersService.getAll(),\n        rolesService.getAll(),\n        locationsService.getAll(),\n        specsService.getAll(),\n      ]);\n\n      log('[DataContext] Tier 1 loaded:', {\n        inventory: inventoryData?.length || 0,\n        categories: categoriesData?.length || 0,\n        users: usersData?.length || 0,\n      });\n\n      setInventory(inventoryData || []);\n      setCategories(categoriesData?.map(c => c.name) || []);\n      setUsers(usersData || []);\n      setRoles(rolesData || DEFAULT_ROLES);\n      setLocations(locationsData || []);\n      setSpecs(specsData || {});\n      setDataLoaded(true);\n\n    } catch (err) {\n      logError('[DataContext] Tier 1 load failed:', err);\n      setError(err);\n    } finally {\n      setLoading(false);\n    }\n\n    // --- Tier 2: Secondary data (non-blocking, after first paint) ---\n    try {\n      const [\n        reservationsData,\n        packagesData,\n        packListsData,\n        clientsData,\n        auditLogData,\n      ] = await Promise.all([\n        reservationsService.getAll(),\n        packagesService.getAll(),\n        packListsService.getAll(),\n        clientsService.getAll(),\n        auditLogService.getAll({ limit: 100 }),\n      ]);\n\n      log('[DataContext] Tier 2 loaded:', {\n        reservations: reservationsData?.length || 0,\n        packages: packagesData?.length || 0,\n        packLists: packListsData?.length || 0,\n        clients: clientsData?.length || 0,\n      });\n\n      // Merge reservations into inventory items\n      const reservationsByItemId = {};\n      (reservationsData || []).forEach(res => {\n        if (!reservationsByItemId[res.itemId]) {\n          reservationsByItemId[res.itemId] = [];\n        }\n        reservationsByItemId[res.itemId].push(res);\n      });\n\n      setInventory(prev => prev.map(item => ({\n        ...item,\n        reservations: reservationsByItemId[item.id] || item.reservations || []\n      })));\n\n      setPackages(packagesData || []);\n      setPackLists(packListsData || []);\n      setClients(clientsData || []);\n      setAuditLog(auditLogData || []);\n\n    } catch (err) {\n      logError('[DataContext] Tier 2 load failed (non-critical):', err);\n      // Don't set error state  Tier 1 data is already available\n    }\n  }, []);\n\n  // =============================================================================\n  // INITIAL DATA LOAD\n  // =============================================================================\n\n  useEffect(() => {\n    loadData();\n  }, [loadData]);\n\n  // =============================================================================\n  // AUDIT LOG HELPER\n  // =============================================================================\n\n  const addAuditLog = useCallback(async (entry) => {\n    const newEntry = {\n      ...entry,\n      timestamp: new Date().toISOString()\n    };\n\n    try {\n      await auditLogService.create(newEntry);\n    } catch (err) {\n      logError('Failed to create audit log:', err);\n    }\n\n    setAuditLog(prev => [newEntry, ...prev]);\n  }, []);\n\n  // =============================================================================\n  // INVENTORY OPERATIONS\n  // =============================================================================\n\n  const updateInventory = useCallback(async (newInventory) => {\n    setInventory(newInventory);\n  }, []);\n\n  const updateItem = useCallback(async (id, updates) => {\n    try {\n      await inventoryService.update(id, updates);\n    } catch (err) {\n      logError('Failed to update item:', err);\n      throw err;\n    }\n    \n    setInventory(prev => prev.map(item => \n      item.id === id ? { ...item, ...updates } : item\n    ));\n  }, []);\n\n  const createItem = useCallback(async (item) => {\n    let newItem = item;\n    \n    try {\n      newItem = await inventoryService.create(item);\n    } catch (err) {\n      logError('Failed to create item:', err);\n      throw err;\n    }\n    \n    setInventory(prev => [...prev, newItem]);\n    return newItem;\n  }, []);\n\n  const deleteItem = useCallback(async (id) => {\n    try {\n      await inventoryService.delete(id);\n    } catch (err) {\n      logError('Failed to delete item:', err);\n      throw err;\n    }\n    \n    setInventory(prev => prev.filter(item => item.id !== id));\n  }, []);\n\n  // Fetch item with all related data (notes, reminders, reservations, maintenance)\n  const getItemWithDetails = useCallback(async (id) => {\n    try {\n      const itemWithDetails = await inventoryService.getByIdWithDetails(id);\n      return itemWithDetails;\n    } catch (err) {\n      logError('Failed to fetch item details:', err);\n      return inventory.find(item => item.id === id) || null;\n    }\n  }, [inventory]);\n\n  // =============================================================================\n  // ITEM NOTES OPERATIONS\n  // =============================================================================\n\n  const addItemNote = useCallback(async (itemId, note) => {\n    try {\n      const dbNote = {\n        // Don't pass id - let DB generate UUID\n        item_id: itemId,\n        user_name: note.user,\n        text: note.text,\n        parent_id: note.parentId || null,\n        deleted: false\n      };\n      const result = await itemNotesService.create(dbNote);\n      return result; // Returns record with real UUID\n    } catch (err) {\n      logError('Failed to save note:', err);\n      return null;\n    }\n  }, []);\n\n  const deleteItemNote = useCallback(async (noteId) => {\n    try {\n      await itemNotesService.softDelete(noteId);\n    } catch (err) {\n      logError('Failed to delete note:', err);\n    }\n  }, []);\n\n  // =============================================================================\n  // ITEM REMINDERS OPERATIONS\n  // =============================================================================\n\n  const addItemReminder = useCallback(async (itemId, reminder) => {\n    try {\n      const dbReminder = {\n        // Don't pass id - let DB generate UUID\n        item_id: itemId,\n        title: reminder.title,\n        description: reminder.description || '',\n        due_date: reminder.dueDate,\n        recurrence: reminder.recurrence || 'none',\n        completed: false,\n        created_by_name: reminder.createdBy || 'Unknown'\n      };\n      const result = await itemRemindersService.create(dbReminder);\n      return result; // Returns record with real UUID\n    } catch (err) {\n      logError('Failed to save reminder:', err);\n      return null;\n    }\n  }, []);\n\n  const updateItemReminder = useCallback(async (reminderId, updates) => {\n    try {\n      const dbUpdates = {};\n      if (updates.completed !== undefined) dbUpdates.completed = updates.completed;\n      if (updates.completedDate !== undefined) dbUpdates.completed_at = updates.completedDate;\n      if (updates.title !== undefined) dbUpdates.title = updates.title;\n      if (updates.dueDate !== undefined) dbUpdates.due_date = updates.dueDate;\n      \n      await itemRemindersService.update(reminderId, dbUpdates);\n    } catch (err) {\n      logError('Failed to update reminder:', err);\n    }\n  }, []);\n\n  const deleteItemReminder = useCallback(async (reminderId) => {\n    try {\n      await itemRemindersService.delete(reminderId);\n    } catch (err) {\n      logError('Failed to delete reminder:', err);\n    }\n  }, []);\n\n  // =============================================================================\n  // MAINTENANCE OPERATIONS\n  // =============================================================================\n\n  const addMaintenance = useCallback(async (itemId, record) => {\n    try {\n      // Validate before writing (still in camelCase at this point)\n      const validation = validateMaintenanceRecord(record);\n      if (!validation.isValid) {\n        throw new Error('Validation failed: ' + Object.values(validation.errors).join(', '));\n      }\n      \n      const dbRecord = {\n        // Don't pass id - let DB generate UUID\n        item_id: itemId,\n        type: record.type,\n        description: record.description || '',\n        vendor: record.vendor || null,\n        cost: record.cost || 0,\n        scheduled_date: record.date || record.scheduledDate || null,\n        completed_date: record.completedDate || null,\n        status: record.status || 'completed',\n        notes: record.notes || '',\n        created_by_name: record.performedBy || 'Unknown'\n      };\n      const result = await maintenanceService.create(dbRecord);\n      return result; // Returns record with real UUID\n    } catch (err) {\n      logError('Failed to save maintenance record:', err);\n      return null;\n    }\n  }, []);\n\n  const updateMaintenance = useCallback(async (recordId, updates) => {\n    try {\n      await maintenanceService.update(recordId, updates);\n    } catch (err) {\n      logError('Failed to update maintenance record:', err);\n    }\n  }, []);\n\n  const deleteMaintenance = useCallback(async (recordId) => {\n    try {\n      await maintenanceService.delete(recordId);\n    } catch (err) {\n      logError('Failed to delete maintenance record:', err);\n    }\n  }, []);\n\n  // =============================================================================\n  // RESERVATIONS OPERATIONS\n  // =============================================================================\n\n  const createReservation = useCallback(async (itemId, reservation) => {\n    try {\n      // Validate before writing (still in camelCase at this point)\n      const validation = validateReservation(reservation);\n      if (!validation.isValid) {\n        throw new Error('Validation failed: ' + Object.values(validation.errors).join(', '));\n      }\n      \n      const dbReservation = {\n        // Don't pass id - let DB generate UUID\n        item_id: itemId,\n        client_id: reservation.clientId || null,\n        project: reservation.project,\n        project_type: reservation.projectType || 'Other',\n        start_date: reservation.start,\n        end_date: reservation.end,\n        status: reservation.status || 'confirmed',\n        contact_name: reservation.user,\n        contact_phone: reservation.contactPhone || '',\n        contact_email: reservation.contactEmail || '',\n        location: reservation.location || '',\n        notes: reservation.notes || []  // Supabase handles JSONB directly\n      };\n      const result = await reservationsService.create(dbReservation);\n      return result;\n    } catch (err) {\n      logError('Failed to create reservation:', err);\n      throw err;\n    }\n  }, []);\n\n  const updateReservation = useCallback(async (reservationId, updates) => {\n    try {\n      const dbUpdates = {};\n      if (updates.project !== undefined) dbUpdates.project = updates.project;\n      if (updates.projectType !== undefined) dbUpdates.project_type = updates.projectType;\n      if (updates.start !== undefined) dbUpdates.start_date = updates.start;\n      if (updates.end !== undefined) dbUpdates.end_date = updates.end;\n      if (updates.status !== undefined) dbUpdates.status = updates.status;\n      if (updates.user !== undefined) dbUpdates.contact_name = updates.user;\n      if (updates.contactPhone !== undefined) dbUpdates.contact_phone = updates.contactPhone;\n      if (updates.contactEmail !== undefined) dbUpdates.contact_email = updates.contactEmail;\n      if (updates.location !== undefined) dbUpdates.location = updates.location;\n      if (updates.clientId !== undefined) dbUpdates.client_id = updates.clientId;\n      \n      await reservationsService.update(reservationId, dbUpdates);\n    } catch (err) {\n      logError('Failed to update reservation:', err);\n      throw err;\n    }\n  }, []);\n\n  const deleteReservation = useCallback(async (reservationId) => {\n    try {\n      await reservationsService.delete(reservationId);\n    } catch (err) {\n      logError('Failed to delete reservation:', err);\n      throw err;\n    }\n  }, []);\n\n  // =============================================================================\n  // CHECK IN/OUT OPERATIONS\n  // =============================================================================\n\n  const checkOutItem = useCallback(async (itemId, checkoutData) => {\n    try {\n      const result = await inventoryService.checkOut(itemId, checkoutData);\n      \n      // Update local state\n      setInventory(prev => prev.map(item => \n        item.id === itemId ? { \n          ...item, \n          status: 'checked-out',\n          checkedOutTo: checkoutData.userName,\n          checkedOutToUserId: checkoutData.userId,\n          checkedOutDate: new Date().toISOString().split('T')[0],\n          dueBack: checkoutData.dueBack,\n          checkoutProject: checkoutData.project,\n          checkoutClientId: checkoutData.clientId\n        } : item\n      ));\n      \n      return result;\n    } catch (err) {\n      logError('Failed to check out item:', err);\n      throw err;\n    }\n  }, []);\n\n  const checkInItem = useCallback(async (itemId, checkinData) => {\n    try {\n      const { \n        returnedBy, \n        userId,\n        condition, \n        conditionNotes, \n        returnNotes, \n        damageReported, \n        damageDescription \n      } = checkinData;\n      \n      // Use the dedicated checkIn service method\n      const result = await inventoryService.checkIn(itemId, {\n        userId: userId,\n        userName: returnedBy,\n        notes: returnNotes || conditionNotes,\n        condition: condition\n      });\n      \n      // Determine new status based on damage\n      const newStatus = damageReported ? 'needs-attention' : 'available';\n      \n      // Update local state\n      setInventory(prev => prev.map(item => \n        item.id === itemId ? { \n          ...item, \n          status: newStatus,\n          condition: condition,\n          checkedOutTo: null,\n          checkedOutToUserId: null,\n          checkedOutDate: null,\n          dueBack: null,\n          checkoutProject: null,\n          checkoutClientId: null\n        } : item\n      ));\n      \n      // If damage reported, add a note\n      if (damageReported && damageDescription) {\n        try {\n          await itemNotesService.create({\n            item_id: itemId,\n            user_name: returnedBy || 'System',\n            text: ` Damage reported: ${damageDescription}`\n          });\n        } catch (noteErr) {\n          logError('Failed to add damage note:', noteErr);\n        }\n      }\n      \n      return result;\n    } catch (err) {\n      logError('Failed to check in item:', err);\n      throw err;\n    }\n  }, []);\n\n  // =============================================================================\n  // PACKAGES OPERATIONS\n  // =============================================================================\n\n  const updatePackages = useCallback(async (newPackages) => {\n    setPackages(newPackages);\n  }, []);\n\n  const createPackage = useCallback(async (pkg) => {\n    let newPackage = pkg;\n    \n    try {\n      newPackage = await packagesService.create(pkg);\n    } catch (err) {\n      logError('Failed to create package:', err);\n      throw err;\n    }\n    \n    setPackages(prev => [...prev, newPackage]);\n    return newPackage;\n  }, []);\n\n  const updatePackage = useCallback(async (id, updates) => {\n    try {\n      await packagesService.update(id, updates);\n    } catch (err) {\n      logError('Failed to update package:', err);\n      throw err;\n    }\n    \n    setPackages(prev => prev.map(pkg => \n      pkg.id === id ? { ...pkg, ...updates } : pkg\n    ));\n  }, []);\n\n  const deletePackage = useCallback(async (id) => {\n    try {\n      await packagesService.delete(id);\n    } catch (err) {\n      logError('Failed to delete package:', err);\n      throw err;\n    }\n    \n    setPackages(prev => prev.filter(pkg => pkg.id !== id));\n  }, []);\n\n  // =============================================================================\n  // PACK LISTS OPERATIONS\n  // =============================================================================\n\n  const updatePackLists = useCallback(async (newPackLists) => {\n    setPackLists(newPackLists);\n  }, []);\n\n  const createPackList = useCallback(async (packList) => {\n    let newPackList = packList;\n    \n    try {\n      newPackList = await packListsService.create(packList);\n    } catch (err) {\n      logError('Failed to create pack list:', err);\n      throw err;\n    }\n    \n    setPackLists(prev => [...prev, newPackList]);\n    return newPackList;\n  }, []);\n\n  const updatePackList = useCallback(async (id, updates) => {\n    try {\n      await packListsService.update(id, updates);\n    } catch (err) {\n      logError('Failed to update pack list:', err);\n      throw err;\n    }\n    \n    setPackLists(prev => prev.map(pl => \n      pl.id === id ? { ...pl, ...updates } : pl\n    ));\n  }, []);\n\n  const deletePackList = useCallback(async (id) => {\n    try {\n      await packListsService.delete(id);\n    } catch (err) {\n      logError('Failed to delete pack list:', err);\n      throw err;\n    }\n    \n    setPackLists(prev => prev.filter(pl => pl.id !== id));\n  }, []);\n\n  // =============================================================================\n  // CLIENTS OPERATIONS\n  // =============================================================================\n\n  const updateClients = useCallback(async (newClients) => {\n    setClients(newClients);\n  }, []);\n\n  const createClient = useCallback(async (client) => {\n    // Validate before writing\n    const validation = validateClient(client);\n    if (!validation.isValid) {\n      throw new Error('Validation failed: ' + Object.values(validation.errors).join(', '));\n    }\n    \n    let newClient = client;\n    \n    try {\n      newClient = await clientsService.create(client);\n    } catch (err) {\n      logError('Failed to create client:', err);\n      throw err;\n    }\n    \n    setClients(prev => [...prev, newClient]);\n    return newClient;\n  }, []);\n\n  const updateClient = useCallback(async (id, updates) => {\n    try {\n      await clientsService.update(id, updates);\n    } catch (err) {\n      logError('Failed to update client:', err);\n      throw err;\n    }\n    \n    setClients(prev => prev.map(client => \n      client.id === id ? { ...client, ...updates } : client\n    ));\n  }, []);\n\n  const deleteClient = useCallback(async (id) => {\n    try {\n      await clientsService.delete(id);\n    } catch (err) {\n      logError('Failed to delete client:', err);\n      throw err;\n    }\n    \n    setClients(prev => prev.filter(client => client.id !== id));\n  }, []);\n\n  // =============================================================================\n  // USERS OPERATIONS\n  // =============================================================================\n\n  const updateUsers = useCallback(async (newUsers) => {\n    setUsers(newUsers);\n  }, []);\n\n  // =============================================================================\n  // ROLES OPERATIONS\n  // =============================================================================\n\n  const updateRoles = useCallback(async (newRoles) => {\n    setRoles(newRoles);\n  }, []);\n\n  // =============================================================================\n  // LOCATIONS OPERATIONS\n  // =============================================================================\n\n  const updateLocations = useCallback(async (newLocations) => {\n    setLocations(newLocations);\n  }, []);\n\n  // =============================================================================\n  // CATEGORIES OPERATIONS\n  // =============================================================================\n\n  const updateCategories = useCallback(async (newCategories) => {\n    setCategories(newCategories);\n  }, []);\n\n  // =============================================================================\n  // SPECS OPERATIONS\n  // =============================================================================\n\n  const updateSpecs = useCallback(async (newSpecs) => {\n    setSpecs(newSpecs);\n  }, []);\n\n  // =============================================================================\n  // NOTIFICATION OPERATIONS\n  // =============================================================================\n\n  const saveNotificationPreferences = useCallback(async (userId, preferences) => {\n    try {\n      await notificationPreferencesService.upsert(userId, preferences);\n    } catch (err) {\n      logError('Failed to save notification preferences:', err);\n      throw err;\n    }\n    \n    return preferences;\n  }, []);\n\n  const getNotificationPreferences = useCallback(async (userId) => {\n    try {\n      return await notificationPreferencesService.getByUserId(userId);\n    } catch (err) {\n      logError('Failed to get notification preferences:', err);\n      return null;\n    }\n  }, []);\n\n  const sendCheckoutEmail = useCallback(async ({ borrowerEmail, borrowerName, item, checkoutDate, dueDate, project }) => {\n    try {\n      return await emailService.sendCheckoutConfirmation({\n        borrowerEmail,\n        borrowerName,\n        item,\n        checkoutDate,\n        dueDate,\n        project\n      });\n    } catch (err) {\n      logError('Failed to send checkout email:', err);\n      return { success: false, error: err.message };\n    }\n  }, []);\n\n  const sendCheckinEmail = useCallback(async ({ borrowerEmail, borrowerName, item, returnDate }) => {\n    try {\n      return await emailService.sendCheckinConfirmation({\n        borrowerEmail,\n        borrowerName,\n        item,\n        returnDate\n      });\n    } catch (err) {\n      logError('Failed to send checkin email:', err);\n      return { success: false, error: err.message };\n    }\n  }, []);\n\n  const sendReservationEmail = useCallback(async ({ userEmail, userName, item, reservation }) => {\n    try {\n      return await emailService.sendReservationConfirmation({\n        userEmail,\n        userName,\n        item,\n        reservation\n      });\n    } catch (err) {\n      logError('Failed to send reservation email:', err);\n      return { success: false, error: err.message };\n    }\n  }, []);\n\n  // =============================================================================\n  // CONTEXT VALUE\n  // =============================================================================\n\n  const value = useMemo(() => ({\n    // State\n    loading,\n    error,\n    dataLoaded,\n    \n    // Data\n    inventory,\n    packages,\n    packLists,\n    clients,\n    users,\n    roles,\n    locations,\n    categories,\n    specs,\n    auditLog,\n    \n    // Refresh function\n    refreshData: loadData,\n    \n    // Setters (for direct state updates)\n    setInventory,\n    setPackages,\n    setPackLists,\n    setClients,\n    setUsers,\n    setRoles,\n    setLocations,\n    setCategories,\n    setSpecs,\n    setAuditLog,\n    \n    // Inventory Operations\n    updateInventory,\n    updateItem,\n    createItem,\n    deleteItem,\n    getItemWithDetails,\n    \n    // Item Notes Operations\n    addItemNote,\n    deleteItemNote,\n    \n    // Item Reminders Operations\n    addItemReminder,\n    updateItemReminder,\n    deleteItemReminder,\n    \n    // Maintenance Operations\n    addMaintenance,\n    updateMaintenance,\n    deleteMaintenance,\n    \n    // Reservation Operations\n    createReservation,\n    updateReservation,\n    deleteReservation,\n    \n    // Check In/Out Operations\n    checkOutItem,\n    checkInItem,\n    \n    // Package Operations\n    updatePackages,\n    createPackage,\n    updatePackage,\n    deletePackage,\n    \n    // Pack List Operations\n    updatePackLists,\n    createPackList,\n    updatePackList,\n    deletePackList,\n    \n    // Client Operations\n    updateClients,\n    createClient,\n    updateClient,\n    deleteClient,\n    \n    // Notification Operations\n    saveNotificationPreferences,\n    getNotificationPreferences,\n    sendCheckoutEmail,\n    sendCheckinEmail,\n    sendReservationEmail,\n    \n    // Other Operations\n    updateUsers,\n    updateRoles,\n    updateLocations,\n    updateCategories,\n    updateSpecs,\n    addAuditLog\n  }), [\n    loading,\n    error,\n    dataLoaded,\n    inventory,\n    packages,\n    packLists,\n    clients,\n    users,\n    roles,\n    locations,\n    categories,\n    specs,\n    auditLog,\n    loadData,\n    updateInventory,\n    updateItem,\n    createItem,\n    deleteItem,\n    getItemWithDetails,\n    addItemNote,\n    deleteItemNote,\n    addItemReminder,\n    updateItemReminder,\n    deleteItemReminder,\n    addMaintenance,\n    updateMaintenance,\n    deleteMaintenance,\n    createReservation,\n    updateReservation,\n    deleteReservation,\n    checkOutItem,\n    checkInItem,\n    updatePackages,\n    createPackage,\n    updatePackage,\n    deletePackage,\n    updatePackLists,\n    createPackList,\n    updatePackList,\n    deletePackList,\n    updateClients,\n    createClient,\n    updateClient,\n    deleteClient,\n    saveNotificationPreferences,\n    getNotificationPreferences,\n    sendCheckoutEmail,\n    sendCheckinEmail,\n    sendReservationEmail,\n    updateUsers,\n    updateRoles,\n    updateLocations,\n    updateCategories,\n    updateSpecs,\n    addAuditLog\n  ]);\n\n  return (\n    <DataContext.Provider value={value}>\n      {children}\n    </DataContext.Provider>\n  );\n}\n\n// =============================================================================\n// HOOK\n// =============================================================================\n\nexport function useData() {\n  const context = useContext(DataContext);\n  if (!context) {\n    throw new Error('useData must be used within a DataProvider');\n  }\n  return context;\n}\n\nexport default DataContext;\n","// =============================================================================\n// Loading Components\n// Spinners, skeletons, and loading indicators\n// =============================================================================\n\nimport React, { Suspense } from 'react';\n\n// =============================================================================\n// SPINNER\n// =============================================================================\nexport function Spinner({ size = 40, color = '#6366f1', className = '' }) {\n  return (\n    <svg\n      className={className}\n      width={size}\n      height={size}\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      style={{ animation: 'spin 1s linear infinite' }}\n    >\n      <circle\n        cx=\"12\"\n        cy=\"12\"\n        r=\"10\"\n        stroke={color}\n        strokeWidth=\"3\"\n        strokeOpacity=\"0.25\"\n        fill=\"none\"\n      />\n      <path\n        d=\"M12 2a10 10 0 0 1 10 10\"\n        stroke={color}\n        strokeWidth=\"3\"\n        strokeLinecap=\"round\"\n        fill=\"none\"\n      />\n      <style>{`\n        @keyframes spin {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n      `}</style>\n    </svg>\n  );\n}\n\n// =============================================================================\n// FULL PAGE LOADING\n// =============================================================================\nexport function FullPageLoading({ message = 'Loading...' }) {\n  return (\n    <div style={styles.fullPage}>\n      <Spinner size={48} />\n      <p style={styles.message}>{message}</p>\n    </div>\n  );\n}\n\n// =============================================================================\n// CONTENT LOADING\n// =============================================================================\nexport function ContentLoading({ message = 'Loading...', minHeight = '200px' }) {\n  return (\n    <div style={{ ...styles.content, minHeight }}>\n      <Spinner size={32} />\n      <p style={styles.contentMessage}>{message}</p>\n    </div>\n  );\n}\n\n// =============================================================================\n// SKELETON LOADER\n// =============================================================================\nexport function Skeleton({ \n  width = '100%', \n  height = '20px', \n  borderRadius = '4px',\n  className = '' \n}) {\n  return (\n    <div\n      className={className}\n      style={{\n        width,\n        height,\n        borderRadius,\n        backgroundColor: '#334155',\n        animation: 'pulse 2s ease-in-out infinite',\n      }}\n    >\n      <style>{`\n        @keyframes pulse {\n          0%, 100% { opacity: 1; }\n          50% { opacity: 0.5; }\n        }\n      `}</style>\n    </div>\n  );\n}\n\n// =============================================================================\n// SKELETON CARD\n// =============================================================================\nexport function SkeletonCard() {\n  return (\n    <div style={styles.skeletonCard}>\n      <Skeleton height=\"120px\" borderRadius=\"8px\" />\n      <div style={{ marginTop: '12px' }}>\n        <Skeleton width=\"70%\" height=\"16px\" />\n      </div>\n      <div style={{ marginTop: '8px' }}>\n        <Skeleton width=\"40%\" height=\"14px\" />\n      </div>\n    </div>\n  );\n}\n\n// =============================================================================\n// SKELETON TABLE\n// =============================================================================\nexport function SkeletonTable({ rows = 5 }) {\n  return (\n    <div style={styles.skeletonTable}>\n      {/* Header */}\n      <div style={styles.skeletonTableHeader}>\n        <Skeleton width=\"15%\" height=\"14px\" />\n        <Skeleton width=\"25%\" height=\"14px\" />\n        <Skeleton width=\"20%\" height=\"14px\" />\n        <Skeleton width=\"15%\" height=\"14px\" />\n        <Skeleton width=\"15%\" height=\"14px\" />\n      </div>\n      \n      {/* Rows */}\n      {Array.from({ length: rows }).map((_, i) => (\n        <div key={i} style={styles.skeletonTableRow}>\n          <Skeleton width=\"15%\" height=\"12px\" />\n          <Skeleton width=\"25%\" height=\"12px\" />\n          <Skeleton width=\"20%\" height=\"12px\" />\n          <Skeleton width=\"15%\" height=\"12px\" />\n          <Skeleton width=\"15%\" height=\"12px\" />\n        </div>\n      ))}\n    </div>\n  );\n}\n\n// =============================================================================\n// SKELETON LIST\n// =============================================================================\nexport function SkeletonList({ items = 5 }) {\n  return (\n    <div style={styles.skeletonList}>\n      {Array.from({ length: items }).map((_, i) => (\n        <div key={i} style={styles.skeletonListItem}>\n          <Skeleton width=\"40px\" height=\"40px\" borderRadius=\"8px\" />\n          <div style={{ flex: 1, marginLeft: '12px' }}>\n            <Skeleton width=\"60%\" height=\"14px\" />\n            <Skeleton width=\"40%\" height=\"12px\" style={{ marginTop: '6px' }} />\n          </div>\n        </div>\n      ))}\n    </div>\n  );\n}\n\n// =============================================================================\n// INLINE LOADING\n// =============================================================================\nexport function InlineLoading({ text = 'Loading' }) {\n  return (\n    <span style={styles.inline}>\n      <Spinner size={16} />\n      <span style={{ marginLeft: '8px' }}>{text}</span>\n    </span>\n  );\n}\n\n// =============================================================================\n// BUTTON LOADING\n// =============================================================================\nexport function ButtonLoading({ size = 16, color = 'currentColor' }) {\n  return <Spinner size={size} color={color} />;\n}\n\n// =============================================================================\n// PROGRESS BAR\n// =============================================================================\nexport function ProgressBar({ progress = 0, color = '#6366f1' }) {\n  return (\n    <div style={styles.progressContainer}>\n      <div \n        style={{\n          ...styles.progressBar,\n          width: `${Math.min(100, Math.max(0, progress))}%`,\n          backgroundColor: color,\n        }}\n      />\n    </div>\n  );\n}\n\n// =============================================================================\n// MODAL LOADING - Suspense fallback for lazy-loaded modals\n// =============================================================================\nexport function ModalLoading() {\n  return (\n    <div style={styles.modalBackdrop}>\n      <div style={styles.modalLoadingBox}>\n        <Spinner size={32} />\n        <p style={styles.modalLoadingText}>Loading...</p>\n      </div>\n    </div>\n  );\n}\n\n// =============================================================================\n// VIEW LOADING - Suspense fallback for lazy-loaded views\n// =============================================================================\nexport function ViewLoading({ message = 'Loading view...' }) {\n  return (\n    <div style={styles.viewLoading}>\n      <Spinner size={36} />\n      <p style={styles.viewLoadingText}>{message}</p>\n    </div>\n  );\n}\n\n// =============================================================================\n// SUSPENSE WRAPPER - Helper component for consistent Suspense boundaries\n// =============================================================================\nexport function SuspenseView({ children, fallback }) {\n  return (\n    <React.Suspense fallback={fallback || <ViewLoading />}>\n      {children}\n    </React.Suspense>\n  );\n}\n\nexport function SuspenseModal({ children }) {\n  return (\n    <React.Suspense fallback={<ModalLoading />}>\n      {children}\n    </React.Suspense>\n  );\n}\n\n// =============================================================================\n// STYLES\n// =============================================================================\nconst styles = {\n  fullPage: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n    justifyContent: 'center',\n    height: '100vh',\n    backgroundColor: '#1a1a2e',\n    color: '#94a3b8',\n    fontFamily: 'system-ui, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif',\n  },\n  message: {\n    marginTop: '16px',\n    fontSize: '16px',\n    color: '#94a3b8',\n  },\n  content: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: '40px',\n    color: '#94a3b8',\n  },\n  contentMessage: {\n    marginTop: '12px',\n    fontSize: '14px',\n    color: '#64748b',\n  },\n  skeletonCard: {\n    backgroundColor: '#16213e',\n    borderRadius: '12px',\n    padding: '16px',\n  },\n  skeletonTable: {\n    backgroundColor: '#16213e',\n    borderRadius: '8px',\n    padding: '16px',\n  },\n  skeletonTableHeader: {\n    display: 'flex',\n    gap: '16px',\n    paddingBottom: '12px',\n    borderBottom: '1px solid #334155',\n    marginBottom: '12px',\n  },\n  skeletonTableRow: {\n    display: 'flex',\n    gap: '16px',\n    padding: '12px 0',\n    borderBottom: '1px solid #1e293b',\n  },\n  skeletonList: {\n    display: 'flex',\n    flexDirection: 'column',\n    gap: '12px',\n  },\n  skeletonListItem: {\n    display: 'flex',\n    alignItems: 'center',\n    padding: '12px',\n    backgroundColor: '#16213e',\n    borderRadius: '8px',\n  },\n  inline: {\n    display: 'inline-flex',\n    alignItems: 'center',\n    color: '#94a3b8',\n    fontSize: '14px',\n  },\n  progressContainer: {\n    width: '100%',\n    height: '4px',\n    backgroundColor: '#334155',\n    borderRadius: '2px',\n    overflow: 'hidden',\n  },\n  progressBar: {\n    height: '100%',\n    borderRadius: '2px',\n    transition: 'width 0.3s ease',\n  },\n  modalBackdrop: {\n    position: 'fixed',\n    inset: 0,\n    backgroundColor: 'rgba(0, 0, 0, 0.7)',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    zIndex: 1000,\n  },\n  modalLoadingBox: {\n    backgroundColor: '#16213e',\n    borderRadius: '12px',\n    padding: '32px 48px',\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n    boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.5)',\n  },\n  modalLoadingText: {\n    marginTop: '16px',\n    fontSize: '14px',\n    color: '#94a3b8',\n  },\n  viewLoading: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: '60px 20px',\n    minHeight: '300px',\n  },\n  viewLoadingText: {\n    marginTop: '16px',\n    fontSize: '14px',\n    color: '#64748b',\n  },\n};\n\nexport default {\n  Spinner,\n  FullPageLoading,\n  ContentLoading,\n  Skeleton,\n  SkeletonCard,\n  SkeletonTable,\n  SkeletonList,\n  InlineLoading,\n  ButtonLoading,\n  ProgressBar,\n  ModalLoading,\n  ViewLoading,\n  SuspenseView,\n  SuspenseModal,\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nfunction emptyFunction() {}\nfunction emptyFunctionWithReset() {}\nemptyFunctionWithReset.resetWarningCache = emptyFunction;\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    var err = new Error(\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n    err.name = 'Invariant Violation';\n    throw err;\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bigint: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    elementType: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim,\n\n    checkPropTypes: emptyFunctionWithReset,\n    resetWarningCache: emptyFunction\n  };\n\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var ReactIs = require('react-is');\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(ReactIs.isElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","// ============================================================================\n// SIMS UI Component Library\n// Reusable, composable UI components\n// ============================================================================\n\nimport React, { memo, forwardRef, useState, useCallback, useRef, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { ArrowLeft, GripVertical } from 'lucide-react';\nimport { colors, styles, borderRadius, spacing, typography, withOpacity } from '../theme.js';\n\n// ============================================================================\n// BackButton - Consistent back navigation\n// ============================================================================\n\nexport const BackButton = memo(function BackButton({ onClick, children = 'Back' }) {\n  return (\n    <button \n      onClick={onClick} \n      type=\"button\"\n      aria-label={`Go back: ${children}`}\n      style={{ \n        ...styles.btnSec, \n        marginBottom: spacing[4], \n        border: 'none', \n        background: 'none', \n        padding: 0, \n        color: colors.textSecondary, \n        display: 'flex', \n        alignItems: 'center', \n        gap: spacing[2],\n        cursor: 'pointer',\n      }}\n    >\n      <ArrowLeft size={18} aria-hidden=\"true\" /> {children}\n    </button>\n  );\n});\n\n// ============================================================================\n// PageHeader - Consistent page title with optional subtitle and actions\n// ============================================================================\n\nexport const PageHeader = memo(function PageHeader({ \n  title, \n  subtitle, \n  action,\n  backButton,\n  onBack,\n  backLabel = 'Back',\n}) {\n  return (\n    <>\n      {(backButton || onBack) && (\n        <BackButton onClick={onBack}>{backLabel}</BackButton>\n      )}\n      <div style={{ \n        display: 'flex', \n        justifyContent: 'space-between', \n        alignItems: 'center', \n        marginBottom: spacing[5] \n      }}>\n        <div>\n          <h2 style={{ margin: 0, color: colors.textPrimary }}>{title}</h2>\n          {subtitle && (\n            <p style={{ \n              margin: `${spacing[1]}px 0 0`, \n              color: colors.textMuted, \n              fontSize: typography.fontSize.sm \n            }}>\n              {subtitle}\n            </p>\n          )}\n        </div>\n        {action}\n      </div>\n    </>\n  );\n});\n\n// ============================================================================\n// DraggableList - Reusable drag-to-reorder list\n// ============================================================================\n\nexport function useDragReorder(items, onReorder) {\n  const [draggedIndex, setDraggedIndex] = useState(null);\n  const [dragOverIndex, setDragOverIndex] = useState(null);\n  const dragNodeRef = useRef(null);\n\n  const handleDragStart = useCallback((e, index) => {\n    setDraggedIndex(index);\n    dragNodeRef.current = e.target;\n    if (e.dataTransfer) {\n      e.dataTransfer.effectAllowed = 'move';\n      e.dataTransfer.setData('text/plain', index);\n    }\n    setTimeout(() => {\n      if (dragNodeRef.current) {\n        dragNodeRef.current.style.opacity = '0.5';\n      }\n    }, 0);\n  }, []);\n\n  const handleDragEnd = useCallback(() => {\n    if (dragNodeRef.current) {\n      dragNodeRef.current.style.opacity = '1';\n    }\n    setDraggedIndex(null);\n    setDragOverIndex(null);\n    dragNodeRef.current = null;\n  }, []);\n\n  const handleDragOver = useCallback((e, index) => {\n    e.preventDefault();\n    if (draggedIndex !== null && index !== draggedIndex) {\n      setDragOverIndex(index);\n    }\n  }, [draggedIndex]);\n\n  const handleDragLeave = useCallback(() => {\n    setDragOverIndex(null);\n  }, []);\n\n  const handleDrop = useCallback((e, targetIndex) => {\n    e.preventDefault();\n    if (draggedIndex === null || draggedIndex === targetIndex) {\n      setDragOverIndex(null);\n      return;\n    }\n\n    const newItems = [...items];\n    const [draggedItem] = newItems.splice(draggedIndex, 1);\n    newItems.splice(targetIndex, 0, draggedItem);\n    onReorder(newItems);\n    setDragOverIndex(null);\n  }, [draggedIndex, items, onReorder]);\n\n  const getDragProps = useCallback((index, canDrag = true) => {\n    if (!canDrag) return {};\n    return {\n      draggable: true,\n      onDragStart: (e) => handleDragStart(e, index),\n      onDragEnd: handleDragEnd,\n      onDragOver: (e) => handleDragOver(e, index),\n      onDragLeave: handleDragLeave,\n      onDrop: (e) => handleDrop(e, index),\n    };\n  }, [handleDragStart, handleDragEnd, handleDragOver, handleDragLeave, handleDrop]);\n\n  const getDragStyle = useCallback((index, canDrag = true) => ({\n    background: dragOverIndex === index ? `${withOpacity(colors.primary, 20)}` : undefined,\n    borderTop: dragOverIndex === index ? `2px solid ${colors.primary}` : '2px solid transparent',\n    cursor: canDrag ? 'grab' : 'default',\n    userSelect: 'none',\n    transition: 'background 150ms ease',\n  }), [dragOverIndex]);\n\n  return {\n    draggedIndex,\n    dragOverIndex,\n    getDragProps,\n    getDragStyle,\n  };\n}\n\nexport const DragHandle = memo(function DragHandle({ canDrag = true, size = 16 }) {\n  return (\n    <div style={{ \n      display: 'flex', \n      alignItems: 'center',\n      color: canDrag ? colors.textMuted : colors.borderLight,\n      cursor: canDrag ? 'grab' : 'default',\n    }}>\n      <GripVertical size={size} />\n    </div>\n  );\n});\n\n// ============================================================================\n// Badge - Status/category indicator\n// ============================================================================\n\nexport const Badge = memo(function Badge({ text, children, color = colors.primary, size = 'sm' }) {\n  const sizes = {\n    xs: { padding: '2px 5px', fontSize: '9px' },\n    sm: { padding: '3px 8px', fontSize: '10px' },\n    md: { padding: '4px 10px', fontSize: '11px' },\n  };\n\n  const content = text || children;\n  \n  // Don't render if no content\n  if (!content) return null;\n\n  return (\n    <span\n      style={{\n        display: 'inline-flex',\n        alignItems: 'center',\n        background: withOpacity(color, 25),\n        color: color,\n        borderRadius: borderRadius.full,\n        fontWeight: typography.fontWeight.medium,\n        textTransform: 'uppercase',\n        letterSpacing: '0.3px',\n        whiteSpace: 'nowrap',\n        ...sizes[size],\n      }}\n    >\n      {content}\n    </span>\n  );\n});\n\n// ============================================================================\n// Button - Primary and secondary buttons\n// ============================================================================\n\nexport const Button = memo(forwardRef(function Button(\n  { \n    children, \n    variant = 'primary', \n    size = 'md',\n    disabled = false,\n    danger = false,\n    fullWidth = false,\n    icon: Icon,\n    iconOnly = false,\n    'aria-label': ariaLabel,\n    onClick,\n    style: customStyle,\n    className: customClassName,\n    type = 'button',\n    ...props \n  },\n  ref\n) {\n  // Build CSS class list\n  const classNames = [\n    variant === 'primary' ? 'btn' : 'btn-secondary',\n    danger && 'btn-danger',\n    size === 'sm' && 'btn-sm',\n    fullWidth && 'btn-full',\n    customClassName,\n  ].filter(Boolean).join(' ');\n\n  // Icon-only buttons must have aria-label\n  const isIconOnly = iconOnly || (Icon && !children);\n  const accessibleLabel = ariaLabel || (isIconOnly ? 'Button' : undefined);\n\n  return (\n    <button\n      ref={ref}\n      className={classNames}\n      style={customStyle}\n      disabled={disabled}\n      onClick={onClick}\n      type={type}\n      aria-label={accessibleLabel}\n      aria-disabled={disabled || undefined}\n      {...props}\n    >\n      {Icon && <Icon size={size === 'sm' ? 14 : 16} aria-hidden=\"true\" />}\n      {children}\n    </button>\n  );\n}));\n\n// ============================================================================\n// Card - Container component\n// ============================================================================\n\nexport const Card = memo(function Card({ \n  children, \n  padding = true,\n  onClick,\n  style: customStyle,\n  className: customClassName,\n  ...props \n}) {\n  const isClickable = !!onClick;\n  const classNames = [\n    'card', \n    isClickable && 'card-clickable',\n    customClassName\n  ].filter(Boolean).join(' ');\n  \n  return (\n    <div\n      className={classNames}\n      style={{\n        ...(padding && { padding: spacing[4] }),\n        ...(isClickable && { cursor: 'pointer' }),\n        ...customStyle,\n      }}\n      onClick={onClick}\n      // Make clickable cards keyboard accessible\n      tabIndex={isClickable ? 0 : undefined}\n      role={isClickable ? 'button' : undefined}\n      onKeyDown={isClickable ? (e) => {\n        if (e.key === 'Enter' || e.key === ' ') {\n          e.preventDefault();\n          onClick?.(e);\n        }\n      } : undefined}\n      {...props}\n    >\n      {children}\n    </div>\n  );\n});\n\n// ============================================================================\n// CardHeader - Card header with title\n// ============================================================================\n\nexport const CardHeader = memo(function CardHeader({ \n  title, \n  icon: Icon,\n  action,\n  children \n}) {\n  return (\n    <div\n      style={{\n        padding: `${spacing[4]}px`,\n        borderBottom: `1px solid ${colors.borderLight}`,\n        display: 'flex',\n        alignItems: 'center',\n        gap: spacing[2],\n      }}\n    >\n      {Icon && <Icon size={16} color={colors.primary} />}\n      <strong style={{ color: colors.textPrimary, flex: 1 }}>{title}</strong>\n      {action}\n      {children}\n    </div>\n  );\n});\n\n// ============================================================================\n// CollapsibleSection - Card with collapsible content (click header to toggle)\n// ============================================================================\n\n// Helper to apply opacity to a color (supports hex, CSS variables, and rgb/rgba)\n// Uses CSS color-mix() for CSS variables, converts hex to rgba for hex colors\nconst withAlpha = (color, alpha) => {\n  if (!color) return color;\n  \n  // Already has alpha\n  if (color.startsWith('rgba') || color.startsWith('rgb')) return color;\n  \n  // CSS variable - use color-mix()\n  if (color.startsWith('var(')) {\n    const percent = Math.round(alpha * 100);\n    return `color-mix(in srgb, ${color} ${percent}%, transparent)`;\n  }\n  \n  // Hex color - convert to rgba\n  const shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n  const expandedHex = color.replace(shorthandRegex, (m, r, g, b) => r + r + g + g + b + b);\n  const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(expandedHex);\n  if (!result) return color;\n  return `rgba(${parseInt(result[1], 16)}, ${parseInt(result[2], 16)}, ${parseInt(result[3], 16)}, ${alpha})`;\n};\n\nexport function CollapsibleSection({\n  title,\n  icon: Icon,\n  badge,\n  badgeColor,\n  collapsed,\n  onToggleCollapse,\n  action,\n  children,\n  padding = true,\n  style,\n  headerColor,\n}) {\n  const accentColor = headerColor || colors.primary;\n\n  return (\n    <div style={{\n      background: withAlpha(accentColor, 0.18),\n      borderRadius: borderRadius.lg,\n      border: `1px solid ${withAlpha(accentColor, 0.35)}`,\n      overflow: 'hidden',\n      ...style,\n    }}>\n      {/* Header - clickable to toggle, hover handled by CSS */}\n      <div\n        className=\"collapsible-header\"\n        onClick={onToggleCollapse}\n        style={{\n          '--section-accent-color': accentColor,\n          padding: `${spacing[3]}px ${spacing[4]}px`,\n          display: 'flex',\n          alignItems: 'center',\n          gap: spacing[2],\n          cursor: 'pointer',\n          userSelect: 'none',\n          background: collapsed ? withAlpha(accentColor, 0.30) : withAlpha(accentColor, 0.38),\n          borderBottom: collapsed ? 'none' : `1px solid ${withAlpha(accentColor, 0.4)}`,\n          borderLeft: `4px solid ${accentColor}`,\n        }}\n      >\n        {Icon && <Icon size={16} color={accentColor} />}\n        <strong style={{ color: colors.textPrimary, flex: 1 }}>\n          {title}\n        </strong>\n        {badge !== undefined && badge !== null && (\n          <span style={{\n            background: withAlpha(accentColor, 0.5),\n            color: colors.textPrimary,\n            padding: '2px 8px',\n            borderRadius: borderRadius.full,\n            fontSize: typography.fontSize.xs,\n            fontWeight: typography.fontWeight.medium,\n          }}>\n            {badge}\n          </span>\n        )}\n        {action && (\n          <div onClick={e => e.stopPropagation()}>\n            {action}\n          </div>\n        )}\n      </div>\n      \n      {/* Content - shown when not collapsed */}\n      {!collapsed && (\n        <div style={{ \n          padding: padding ? spacing[4] : 0,\n          background: withAlpha(accentColor, 0.30),\n        }}>\n          {children}\n        </div>\n      )}\n    </div>\n  );\n}\n\n// ============================================================================\n// Input - Form input field\n// ============================================================================\n\nexport const Input = memo(forwardRef(function Input(\n  { \n    label,\n    error,\n    icon: Icon,\n    style: customStyle,\n    containerStyle,\n    className: customClassName,\n    ...props \n  },\n  ref\n) {\n  const inputClassNames = [\n    'input',\n    error && 'input-error',\n    customClassName,\n  ].filter(Boolean).join(' ');\n\n  return (\n    <div style={containerStyle}>\n      {label && <label className={error ? 'label label-error' : 'label'}>{label}</label>}\n      <div style={{ position: 'relative' }}>\n        {Icon && (\n          <div\n            style={{\n              position: 'absolute',\n              left: spacing[3],\n              top: '50%',\n              transform: 'translateY(-50%)',\n              color: colors.textMuted,\n            }}\n          >\n            <Icon size={16} />\n          </div>\n        )}\n        <input\n          ref={ref}\n          className={inputClassNames}\n          style={{\n            ...(Icon && { paddingLeft: spacing[10] }),\n            ...customStyle,\n          }}\n          {...props}\n        />\n      </div>\n      {error && (\n        <span style={{ color: colors.danger, fontSize: typography.fontSize.xs, marginTop: spacing[1] }}>\n          {error}\n        </span>\n      )}\n    </div>\n  );\n}));\n\n// ============================================================================\n// SelectInput - Basic dropdown select (legacy - prefer components/Select.jsx)\n// ============================================================================\n\nexport const SelectInput = memo(forwardRef(function SelectInput(\n  { label, options, style: customStyle, className: customClassName, ...props },\n  ref\n) {\n  const selectClassNames = ['select', customClassName].filter(Boolean).join(' ');\n  \n  return (\n    <div>\n      {label && <label className=\"label\">{label}</label>}\n      <select\n        ref={ref}\n        className={selectClassNames}\n        style={customStyle}\n        {...props}\n      >\n        {options.map(opt => (\n          <option key={opt.value} value={opt.value}>\n            {opt.label}\n          </option>\n        ))}\n      </select>\n    </div>\n  );\n}));\n\n// ============================================================================\n// StatCard - Dashboard statistic card\n// ============================================================================\n\nexport const StatCard = memo(function StatCard({ \n  icon: Icon, \n  value, \n  label, \n  color = colors.primary,\n  onClick,\n}) {\n  return (\n    <div\n      onClick={onClick}\n      style={{\n        padding: spacing[5],\n        textAlign: 'center',\n        borderRadius: borderRadius.xl,\n        border: `1px solid ${colors.border}`,\n        background: colors.bgLight,\n        boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\n        ...(onClick && { cursor: 'pointer' }),\n      }}\n    >\n      <div\n        style={{\n          width: 48,\n          height: 48,\n          margin: '0 auto 12px',\n          background: colors.bgMedium,\n          border: `1px solid ${colors.border}`,\n          borderRadius: borderRadius.xl,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n        }}\n      >\n        <Icon size={24} color={color} />\n      </div>\n      <div\n        style={{\n          fontSize: typography.fontSize['2xl'],\n          fontWeight: typography.fontWeight.bold,\n          color: color,\n          marginBottom: spacing[1],\n        }}\n      >\n        {value}\n      </div>\n      <div\n        style={{\n          fontSize: typography.fontSize.xs,\n          color: colors.textMuted,\n          textTransform: 'uppercase',\n          letterSpacing: '0.5px',\n        }}\n      >\n        {label}\n      </div>\n    </div>\n  );\n});\n\n// ============================================================================\n// ItemImage - Image with placeholder\n// ============================================================================\n\nexport const ItemImage = memo(function ItemImage({ \n  src, \n  alt = '', \n  size = 56,\n  borderRadius: radius = borderRadius.md,\n  showPlaceholder = true,\n}) {\n  if (src) {\n    return (\n      <img\n        src={src}\n        alt={alt}\n        style={{\n          width: size,\n          height: size,\n          borderRadius: radius,\n          objectFit: 'cover',\n        }}\n      />\n    );\n  }\n\n  if (!showPlaceholder) return null;\n\n  return (\n    <div\n      style={{\n        width: size,\n        height: size,\n        borderRadius: radius,\n        background: `${withOpacity(colors.primary, 15)}`,\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n        justifyContent: 'center',\n        color: colors.textMuted,\n      }}\n    >\n      <svg width={size * 0.4} height={size * 0.4} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n        <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"/>\n        <circle cx=\"8.5\" cy=\"8.5\" r=\"1.5\"/>\n        <polyline points=\"21 15 16 10 5 21\"/>\n      </svg>\n      {size >= 48 && (\n        <span style={{ fontSize: Math.max(8, size * 0.15), marginTop: 2 }}>No Image</span>\n      )}\n    </div>\n  );\n});\n\n// ============================================================================\n// Modal - Modal container\n// ============================================================================\n\nexport const Modal = memo(function Modal({ \n  isOpen, \n  onClose, \n  title,\n  maxWidth = 500,\n  children \n}) {\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"modal-backdrop\" style={styles.modal} onClick={onClose}>\n      <div\n        onClick={e => e.stopPropagation()}\n        style={{ ...styles.modalBox, maxWidth }}\n        role=\"dialog\"\n        aria-modal=\"true\"\n        aria-labelledby={title ? 'modal-title' : undefined}\n      >\n        {title && (\n          <div\n            style={{\n              padding: spacing[4],\n              borderBottom: `1px solid ${colors.borderLight}`,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'space-between',\n            }}\n          >\n            <h3 id=\"modal-title\" style={{ margin: 0, fontSize: typography.fontSize.lg, color: colors.textPrimary }}>\n              {title}\n            </h3>\n            <button\n              onClick={onClose}\n              className=\"modal-close\"\n              aria-label=\"Close modal\"\n              type=\"button\"\n              style={{\n                background: 'none',\n                border: 'none',\n                color: colors.textMuted,\n                cursor: 'pointer',\n                padding: spacing[2],\n                borderRadius: borderRadius.full,\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n              }}\n            >\n              <svg width={20} height={20} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" aria-hidden=\"true\">\n                <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n                <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n              </svg>\n            </button>\n          </div>\n        )}\n        <div style={{ padding: spacing[4] }}>\n          {children}\n        </div>\n      </div>\n    </div>\n  );\n});\n\n// ============================================================================\n// EmptyState - No data placeholder\n// ============================================================================\n\nexport const EmptyState = memo(function EmptyState({ \n  icon: Icon, \n  title, \n  description,\n  action,\n}) {\n  return (\n    <Card style={{ padding: spacing[12], textAlign: 'center' }}>\n      {Icon && (\n        <div\n          style={{\n            width: 64,\n            height: 64,\n            margin: '0 auto 16px',\n            background: `${withOpacity(colors.primary, 20)}`,\n            borderRadius: borderRadius['2xl'],\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n          }}\n        >\n          <Icon size={32} color={colors.primary} />\n        </div>\n      )}\n      <h3\n        style={{\n          margin: '0 0 8px',\n          fontSize: typography.fontSize.lg,\n          color: colors.textPrimary,\n        }}\n      >\n        {title}\n      </h3>\n      {description && (\n        <p style={{ color: colors.textMuted, marginBottom: spacing[5] }}>\n          {description}\n        </p>\n      )}\n      {action}\n    </Card>\n  );\n});\n\n// ============================================================================\n// ConfirmDialog - Styled confirmation modal\n// ============================================================================\n\nexport const ConfirmDialog = memo(function ConfirmDialog({ \n  isOpen, \n  title = 'Confirm', \n  message, \n  confirmText = 'Delete', \n  cancelText = 'Cancel',\n  onConfirm, \n  onCancel,\n  danger = true \n}) {\n  const dialogRef = useRef(null);\n  const cancelButtonRef = useRef(null);\n  \n  // Focus management and keyboard handling\n  useEffect(() => {\n    if (isOpen) {\n      // Focus the cancel button when dialog opens\n      cancelButtonRef.current?.focus();\n      \n      // Prevent body scroll\n      document.body.style.overflow = 'hidden';\n      \n      return () => {\n        document.body.style.overflow = '';\n      };\n    }\n  }, [isOpen]);\n  \n  const handleKeyDown = useCallback((e) => {\n    if (e.key === 'Escape') {\n      e.preventDefault();\n      onCancel();\n    }\n  }, [onCancel]);\n  \n  if (!isOpen) return null;\n  \n  return (\n    <div \n      className=\"modal-backdrop\" \n      style={{\n        position: 'fixed',\n        inset: 0,\n        background: 'rgba(0,0,0,0.7)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 1000\n      }} \n      onClick={onCancel}\n      role=\"presentation\"\n    >\n      <div \n        ref={dialogRef}\n        onClick={e => e.stopPropagation()} \n        onKeyDown={handleKeyDown}\n        role=\"alertdialog\"\n        aria-modal=\"true\"\n        aria-labelledby=\"confirm-dialog-title\"\n        aria-describedby=\"confirm-dialog-message\"\n        style={{\n          background: colors.bgMedium,\n          borderRadius: borderRadius.xl,\n          border: `1px solid ${colors.border}`,\n          width: '100%',\n          maxWidth: 400,\n          overflow: 'hidden',\n          boxShadow: '0 20px 50px rgba(0,0,0,0.4)'\n        }}\n      >\n        <div style={{ padding: spacing[5] }}>\n          <h3 \n            id=\"confirm-dialog-title\"\n            style={{ \n              margin: `0 0 ${spacing[3]}px`, \n              fontSize: typography.fontSize.lg, \n              color: colors.textPrimary \n            }}\n          >\n            {title}\n          </h3>\n          <p \n            id=\"confirm-dialog-message\"\n            style={{ \n              margin: 0, \n              color: colors.textSecondary,\n              fontSize: typography.fontSize.sm,\n              lineHeight: 1.5\n            }}\n          >\n            {message}\n          </p>\n        </div>\n        <div style={{ \n          padding: spacing[4], \n          borderTop: `1px solid ${colors.borderLight}`,\n          display: 'flex',\n          gap: spacing[3],\n          justifyContent: 'flex-end'\n        }}>\n          <button\n            ref={cancelButtonRef}\n            onClick={onCancel}\n            type=\"button\"\n            style={{\n              ...styles.btnSec,\n              padding: `${spacing[2]}px ${spacing[4]}px`\n            }}\n          >\n            {cancelText}\n          </button>\n          <button\n            onClick={onConfirm}\n            type=\"button\"\n            style={{\n              ...styles.btn,\n              padding: `${spacing[2]}px ${spacing[4]}px`,\n              background: danger ? colors.danger : colors.primary\n            }}\n          >\n            {confirmText}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n});\n\n// ============================================================================\n// SearchInput - Search input with icon\n// ============================================================================\n\nexport const SearchInput = memo(function SearchInput({ \n  value, \n  onChange, \n  placeholder = 'Search...',\n  onClear,\n  'aria-label': ariaLabel = 'Search',\n  id,\n  style: customStyle = {},\n  ...props \n}) {\n  const inputId = id || `search-input-${Math.random().toString(36).substr(2, 9)}`;\n  const [isFocused, setIsFocused] = useState(false);\n  \n  return (\n    <div\n      role=\"search\"\n      style={{\n        display: 'flex',\n        alignItems: 'center',\n        gap: spacing[2],\n        ...styles.input,\n        padding: '12px 16px',\n        ...(isFocused && {\n          borderColor: colors.primary,\n          boxShadow: `0 0 0 2px color-mix(in srgb, ${colors.primary} 20%, transparent)`,\n        }),\n        ...customStyle,\n      }}\n    >\n      <svg \n        width={18} \n        height={18} \n        viewBox=\"0 0 24 24\" \n        fill=\"none\" \n        stroke={colors.textMuted} \n        strokeWidth=\"2\"\n        aria-hidden=\"true\"\n      >\n        <circle cx=\"11\" cy=\"11\" r=\"8\" />\n        <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\" />\n      </svg>\n      <input\n        id={inputId}\n        type=\"text\"\n        value={value}\n        onChange={e => onChange(e.target.value)}\n        placeholder={placeholder}\n        aria-label={ariaLabel}\n        onFocus={() => setIsFocused(true)}\n        onBlur={() => setIsFocused(false)}\n        style={{\n          background: 'none',\n          border: 'none',\n          color: colors.textPrimary,\n          flex: 1,\n          outline: 'none',\n          fontSize: typography.fontSize.base,\n          padding: 0,\n          margin: 0,\n          // Hide any native styling\n          WebkitAppearance: 'none',\n          MozAppearance: 'none',\n          appearance: 'none',\n          boxShadow: 'none',\n        }}\n        {...props}\n      />\n      {value && onClear && (\n        <button\n          onClick={onClear}\n          type=\"button\"\n          aria-label=\"Clear search\"\n          style={{\n            background: 'none',\n            border: 'none',\n            color: colors.textMuted,\n            cursor: 'pointer',\n            padding: 2,\n          }}\n        >\n          <svg \n            width={14} \n            height={14} \n            viewBox=\"0 0 24 24\" \n            fill=\"none\" \n            stroke=\"currentColor\" \n            strokeWidth=\"2\"\n            aria-hidden=\"true\"\n          >\n            <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n            <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n          </svg>\n        </button>\n      )}\n    </div>\n  );\n});\n\n// ============================================================================\n// Avatar - User avatar\n// ============================================================================\n\nexport const Avatar = memo(function Avatar({ \n  name, \n  src, \n  size = 40,\n  style: customStyle,\n}) {\n  const initial = name?.charAt(0)?.toUpperCase() || '?';\n\n  if (src) {\n    return (\n      <img\n        src={src}\n        alt={name}\n        style={{\n          width: size,\n          height: size,\n          borderRadius: borderRadius.md,\n          objectFit: 'cover',\n          ...customStyle,\n        }}\n      />\n    );\n  }\n\n  return (\n    <div\n      style={{\n        width: size,\n        height: size,\n        borderRadius: borderRadius.md,\n        background: `linear-gradient(135deg, ${colors.primary}, ${colors.accent1})`,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        fontWeight: typography.fontWeight.semibold,\n        color: colors.textPrimary,\n        fontSize: size * 0.4,\n        ...customStyle,\n      }}\n    >\n      {initial}\n    </div>\n  );\n});\n\n// ============================================================================\n// Divider - Horizontal line\n// ============================================================================\n\nexport const Divider = memo(function Divider({ spacing: sp = 4 }) {\n  return (\n    <hr\n      style={{\n        border: 'none',\n        borderTop: `1px solid ${colors.borderLight}`,\n        margin: `${spacing[sp]}px 0`,\n      }}\n    />\n  );\n});\n\n// ============================================================================\n// Grid - Responsive grid layout\n// ============================================================================\n\nexport const Grid = memo(function Grid({ \n  children, \n  columns = 'auto-fill',\n  minWidth = 180,\n  gap = 4,\n  style: customStyle,\n}) {\n  return (\n    <div\n      style={{\n        display: 'grid',\n        gridTemplateColumns: `repeat(${columns}, minmax(${minWidth}px, 1fr))`,\n        gap: spacing[gap],\n        ...customStyle,\n      }}\n    >\n      {children}\n    </div>\n  );\n});\n\n// ============================================================================\n// Flex - Flexbox container\n// ============================================================================\n\nexport const Flex = memo(function Flex({ \n  children, \n  direction = 'row',\n  align = 'center',\n  justify = 'flex-start',\n  gap = 2,\n  wrap = false,\n  style: customStyle,\n  ...props\n}) {\n  return (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: direction,\n        alignItems: align,\n        justifyContent: justify,\n        gap: spacing[gap],\n        flexWrap: wrap ? 'wrap' : 'nowrap',\n        ...customStyle,\n      }}\n      {...props}\n    >\n      {children}\n    </div>\n  );\n});\n\n// ============================================================================\n// Pagination - Page navigation component\n// ============================================================================\n\nexport const Pagination = memo(function Pagination({\n  page,\n  totalPages,\n  totalItems,\n  pageSize,\n  onPageChange,\n  showItemCount = true,\n}) {\n  if (totalPages <= 1) return null;\n\n  const startItem = (page - 1) * pageSize + 1;\n  const endItem = Math.min(page * pageSize, totalItems);\n\n  // Generate page numbers to show\n  const getPageNumbers = () => {\n    const pages = [];\n    const maxVisible = 5;\n    \n    if (totalPages <= maxVisible) {\n      for (let i = 1; i <= totalPages; i++) pages.push(i);\n    } else {\n      // Always show first page\n      pages.push(1);\n      \n      // Calculate middle pages\n      let start = Math.max(2, page - 1);\n      let end = Math.min(totalPages - 1, page + 1);\n      \n      // Adjust if at beginning\n      if (page <= 3) {\n        end = 4;\n      }\n      // Adjust if at end\n      if (page >= totalPages - 2) {\n        start = totalPages - 3;\n      }\n      \n      // Add ellipsis before middle pages if needed\n      if (start > 2) pages.push('...');\n      \n      // Add middle pages\n      for (let i = start; i <= end; i++) pages.push(i);\n      \n      // Add ellipsis after middle pages if needed\n      if (end < totalPages - 1) pages.push('...');\n      \n      // Always show last page\n      pages.push(totalPages);\n    }\n    \n    return pages;\n  };\n\n  const pageButtonStyle = (isActive) => ({\n    ...styles.btnSec,\n    minWidth: 36,\n    height: 36,\n    padding: 0,\n    justifyContent: 'center',\n    background: isActive ? colors.primary : 'transparent',\n    color: isActive ? '#fff' : colors.textPrimary,\n    border: isActive ? 'none' : `1px solid ${colors.border}`,\n    fontWeight: isActive ? typography.fontWeight.medium : typography.fontWeight.normal,\n  });\n\n  return (\n    <div style={{\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'space-between',\n      marginTop: spacing[5],\n      paddingTop: spacing[4],\n      borderTop: `1px solid ${colors.borderLight}`,\n    }}>\n      {/* Item count */}\n      {showItemCount && (\n        <div style={{ \n          fontSize: typography.fontSize.sm, \n          color: colors.textMuted \n        }}>\n          Showing {startItem}-{endItem} of {totalItems} items\n        </div>\n      )}\n\n      {/* Page navigation */}\n      <div style={{ display: 'flex', gap: spacing[1], alignItems: 'center' }}>\n        {/* Previous button */}\n        <button\n          onClick={() => onPageChange(page - 1)}\n          disabled={page === 1}\n          style={{\n            ...pageButtonStyle(false),\n            opacity: page === 1 ? 0.5 : 1,\n            cursor: page === 1 ? 'not-allowed' : 'pointer',\n          }}\n        >\n          \n        </button>\n\n        {/* Page numbers */}\n        {getPageNumbers().map((pageNum, idx) => (\n          pageNum === '...' ? (\n            <span key={`ellipsis-${idx}`} style={{ \n              padding: `0 ${spacing[2]}px`, \n              color: colors.textMuted \n            }}>\n              \n            </span>\n          ) : (\n            <button\n              key={pageNum}\n              onClick={() => onPageChange(pageNum)}\n              style={pageButtonStyle(pageNum === page)}\n            >\n              {pageNum}\n            </button>\n          )\n        ))}\n\n        {/* Next button */}\n        <button\n          onClick={() => onPageChange(page + 1)}\n          disabled={page === totalPages}\n          style={{\n            ...pageButtonStyle(false),\n            opacity: page === totalPages ? 0.5 : 1,\n            cursor: page === totalPages ? 'not-allowed' : 'pointer',\n          }}\n        >\n          \n        </button>\n      </div>\n    </div>\n  );\n});\n\n// ============================================================================\n// LoadingSpinner - Loading indicator\n// ============================================================================\n\nexport const LoadingSpinner = memo(function LoadingSpinner({ \n  size = 24, \n  color = colors.primary,\n  style: customStyle \n}) {\n  return (\n    <div style={{\n      width: size,\n      height: size,\n      border: `2px solid ${withOpacity(color, 30)}`,\n      borderTopColor: color,\n      borderRadius: '50%',\n      animation: 'spin 0.8s linear infinite',\n      ...customStyle,\n    }}>\n      <style>{`\n        @keyframes spin {\n          to { transform: rotate(360deg); }\n        }\n      `}</style>\n    </div>\n  );\n});\n\n// ============================================================================\n// LoadingOverlay - Full-screen or container loading state\n// ============================================================================\n\nexport const LoadingOverlay = memo(function LoadingOverlay({ \n  message = 'Loading...',\n  fullScreen = false,\n}) {\n  const containerStyle = fullScreen ? {\n    position: 'fixed',\n    inset: 0,\n    background: 'rgba(0,0,0,0.7)',\n    zIndex: 1000,\n  } : {\n    position: 'absolute',\n    inset: 0,\n    background: `${colors.bgDark}cc`,\n  };\n\n  return (\n    <div style={{\n      ...containerStyle,\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center',\n      justifyContent: 'center',\n      gap: spacing[3],\n    }}>\n      <LoadingSpinner size={32} />\n      <span style={{ color: colors.textMuted, fontSize: typography.fontSize.sm }}>\n        {message}\n      </span>\n    </div>\n  );\n});\n\n// ============================================================================\n// Accessibility Helpers\n// ============================================================================\n\n// VisuallyHidden - Hide content visually but keep it accessible to screen readers\nexport const VisuallyHidden = memo(function VisuallyHidden({ children, as: Component = 'span' }) {\n  return (\n    <Component\n      style={{\n        position: 'absolute',\n        width: 1,\n        height: 1,\n        padding: 0,\n        margin: -1,\n        overflow: 'hidden',\n        clip: 'rect(0, 0, 0, 0)',\n        whiteSpace: 'nowrap',\n        border: 0,\n      }}\n    >\n      {children}\n    </Component>\n  );\n});\n\n// LiveRegion - Announce dynamic content to screen readers\nexport const LiveRegion = memo(function LiveRegion({ \n  children, \n  politeness = 'polite', // 'polite' or 'assertive'\n  atomic = true \n}) {\n  return (\n    <div\n      role=\"status\"\n      aria-live={politeness}\n      aria-atomic={atomic}\n      style={{\n        position: 'absolute',\n        width: 1,\n        height: 1,\n        padding: 0,\n        margin: -1,\n        overflow: 'hidden',\n        clip: 'rect(0, 0, 0, 0)',\n        whiteSpace: 'nowrap',\n        border: 0,\n      }}\n    >\n      {children}\n    </div>\n  );\n});\n\n// SkipLink - Allow keyboard users to skip to main content\nexport const SkipLink = memo(function SkipLink({ targetId = 'main-content', children = 'Skip to main content' }) {\n  return (\n    <a\n      href={`#${targetId}`}\n      style={{\n        position: 'absolute',\n        left: -9999,\n        top: 'auto',\n        width: 1,\n        height: 1,\n        overflow: 'hidden',\n        zIndex: 9999,\n        padding: `${spacing[2]}px ${spacing[4]}px`,\n        background: colors.primary,\n        color: '#fff',\n        textDecoration: 'none',\n        borderRadius: borderRadius.md,\n      }}\n      onFocus={(e) => {\n        e.target.style.left = spacing[4] + 'px';\n        e.target.style.top = spacing[4] + 'px';\n        e.target.style.width = 'auto';\n        e.target.style.height = 'auto';\n      }}\n      onBlur={(e) => {\n        e.target.style.left = '-9999px';\n        e.target.style.width = '1px';\n        e.target.style.height = '1px';\n      }}\n    >\n      {children}\n    </a>\n  );\n});\n\n// FocusTrap - Trap focus within a container (useful for modals)\nexport function useFocusTrap(containerRef, isActive = true) {\n  useEffect(() => {\n    if (!isActive || !containerRef.current) return;\n    \n    const container = containerRef.current;\n    const focusableElements = container.querySelectorAll(\n      'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n    );\n    \n    if (focusableElements.length === 0) return;\n    \n    const firstElement = focusableElements[0];\n    const lastElement = focusableElements[focusableElements.length - 1];\n    \n    const handleKeyDown = (e) => {\n      if (e.key !== 'Tab') return;\n      \n      if (e.shiftKey && document.activeElement === firstElement) {\n        e.preventDefault();\n        lastElement.focus();\n      } else if (!e.shiftKey && document.activeElement === lastElement) {\n        e.preventDefault();\n        firstElement.focus();\n      }\n    };\n    \n    container.addEventListener('keydown', handleKeyDown);\n    return () => container.removeEventListener('keydown', handleKeyDown);\n  }, [containerRef, isActive]);\n}\n\n// ============================================================================\n// PropTypes Definitions\n// ============================================================================\n\nBackButton.propTypes = {\n  /** Click handler */\n  onClick: PropTypes.func.isRequired,\n  /** Button text */\n  children: PropTypes.node,\n};\n\nPageHeader.propTypes = {\n  /** Page title */\n  title: PropTypes.string.isRequired,\n  /** Optional subtitle */\n  subtitle: PropTypes.string,\n  /** Action button(s) to render on the right */\n  action: PropTypes.node,\n  /** Whether to show back button (deprecated, use onBack) */\n  backButton: PropTypes.bool,\n  /** Callback for back button click */\n  onBack: PropTypes.func,\n  /** Label for back button */\n  backLabel: PropTypes.string,\n};\n\nDragHandle.propTypes = {\n  /** Whether dragging is enabled */\n  canDrag: PropTypes.bool,\n  /** Icon size */\n  size: PropTypes.number,\n};\n\nBadge.propTypes = {\n  /** Badge text (deprecated, use children) */\n  text: PropTypes.string,\n  /** Badge content */\n  children: PropTypes.node,\n  /** Badge color */\n  color: PropTypes.string,\n  /** Badge size: 'xs', 'sm', 'md' */\n  size: PropTypes.oneOf(['xs', 'sm', 'md']),\n};\n\nButton.propTypes = {\n  /** Button content */\n  children: PropTypes.node,\n  /** Button variant */\n  variant: PropTypes.oneOf(['primary', 'secondary']),\n  /** Danger styling */\n  danger: PropTypes.bool,\n  /** Full width button */\n  fullWidth: PropTypes.bool,\n  /** Small size button */\n  small: PropTypes.bool,\n  /** Lucide icon component */\n  icon: PropTypes.elementType,\n  /** Disabled state */\n  disabled: PropTypes.bool,\n  /** Click handler */\n  onClick: PropTypes.func,\n  /** Button type */\n  type: PropTypes.oneOf(['button', 'submit', 'reset']),\n  /** Additional styles */\n  style: PropTypes.object,\n};\n\nCard.propTypes = {\n  /** Card content */\n  children: PropTypes.node.isRequired,\n  /** Whether to include padding */\n  padding: PropTypes.bool,\n  /** Click handler */\n  onClick: PropTypes.func,\n  /** Custom class name */\n  className: PropTypes.string,\n  /** Additional styles */\n  style: PropTypes.object,\n};\n\nCardHeader.propTypes = {\n  /** Header title */\n  title: PropTypes.string.isRequired,\n  /** Lucide icon component */\n  icon: PropTypes.elementType,\n  /** Action element(s) to render on the right */\n  action: PropTypes.node,\n};\n\nInput.propTypes = {\n  /** Label text */\n  label: PropTypes.string,\n  /** Error message */\n  error: PropTypes.string,\n  /** Helper text */\n  helper: PropTypes.string,\n  /** Whether field is required */\n  required: PropTypes.bool,\n  /** Input type */\n  type: PropTypes.string,\n  /** Placeholder text */\n  placeholder: PropTypes.string,\n  /** Current value */\n  value: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  /** Change handler */\n  onChange: PropTypes.func,\n  /** Disabled state */\n  disabled: PropTypes.bool,\n};\n\nSelectInput.propTypes = {\n  /** Label text */\n  label: PropTypes.string,\n  /** Error message */\n  error: PropTypes.string,\n  /** Whether field is required */\n  required: PropTypes.bool,\n  /** Option elements */\n  children: PropTypes.node.isRequired,\n  /** Current value */\n  value: PropTypes.string,\n  /** Change handler */\n  onChange: PropTypes.func,\n  /** Disabled state */\n  disabled: PropTypes.bool,\n};\n\nStatCard.propTypes = {\n  /** Lucide icon component */\n  icon: PropTypes.elementType.isRequired,\n  /** Stat label */\n  label: PropTypes.string.isRequired,\n  /** Stat value */\n  value: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\n  /** Icon and accent color */\n  color: PropTypes.string,\n  /** Click handler */\n  onClick: PropTypes.func,\n  /** Trend indicator: 'up' or 'down' */\n  trend: PropTypes.oneOf(['up', 'down']),\n  /** Trend percentage value */\n  trendValue: PropTypes.string,\n};\n\nItemImage.propTypes = {\n  /** Image source URL */\n  src: PropTypes.string,\n  /** Alt text */\n  alt: PropTypes.string,\n  /** Image size in pixels */\n  size: PropTypes.number,\n  /** Click handler */\n  onClick: PropTypes.func,\n  /** Show clickable indicator */\n  clickable: PropTypes.bool,\n};\n\nModal.propTypes = {\n  /** Close handler */\n  onClose: PropTypes.func.isRequired,\n  /** Maximum width in pixels */\n  maxWidth: PropTypes.number,\n  /** Modal content */\n  children: PropTypes.node.isRequired,\n};\n\nEmptyState.propTypes = {\n  /** Lucide icon component */\n  icon: PropTypes.elementType.isRequired,\n  /** Title text */\n  title: PropTypes.string.isRequired,\n  /** Description text */\n  description: PropTypes.string,\n  /** Action button element */\n  action: PropTypes.node,\n};\n\nConfirmDialog.propTypes = {\n  /** Whether dialog is open */\n  isOpen: PropTypes.bool.isRequired,\n  /** Dialog title */\n  title: PropTypes.string.isRequired,\n  /** Dialog message */\n  message: PropTypes.string.isRequired,\n  /** Confirm button text */\n  confirmText: PropTypes.string,\n  /** Cancel button text */\n  cancelText: PropTypes.string,\n  /** Danger styling */\n  danger: PropTypes.bool,\n  /** Confirm handler */\n  onConfirm: PropTypes.func.isRequired,\n  /** Cancel/close handler */\n  onCancel: PropTypes.func.isRequired,\n};\n\nSearchInput.propTypes = {\n  /** Search value */\n  value: PropTypes.string.isRequired,\n  /** Change handler */\n  onChange: PropTypes.func.isRequired,\n  /** Placeholder text */\n  placeholder: PropTypes.string,\n  /** Debounce delay in ms */\n  debounceMs: PropTypes.number,\n  /** Focus handler */\n  onFocus: PropTypes.func,\n  /** Blur handler */\n  onBlur: PropTypes.func,\n};\n\nAvatar.propTypes = {\n  /** User name for initials */\n  name: PropTypes.string,\n  /** Image source URL */\n  src: PropTypes.string,\n  /** Avatar size in pixels */\n  size: PropTypes.number,\n  /** Custom background color */\n  color: PropTypes.string,\n};\n\nDivider.propTypes = {\n  /** Vertical spacing (theme spacing key) */\n  spacing: PropTypes.number,\n};\n\nGrid.propTypes = {\n  /** Grid content */\n  children: PropTypes.node.isRequired,\n  /** Minimum column width */\n  minWidth: PropTypes.number,\n  /** Gap between items */\n  gap: PropTypes.number,\n};\n\nFlex.propTypes = {\n  /** Flex content */\n  children: PropTypes.node.isRequired,\n  /** Flex direction */\n  direction: PropTypes.oneOf(['row', 'column']),\n  /** Align items */\n  align: PropTypes.oneOf(['start', 'center', 'end', 'stretch']),\n  /** Justify content */\n  justify: PropTypes.oneOf(['start', 'center', 'end', 'between', 'around']),\n  /** Gap between items */\n  gap: PropTypes.number,\n  /** Allow wrapping */\n  wrap: PropTypes.bool,\n};\n\nPagination.propTypes = {\n  /** Current page (1-indexed) */\n  currentPage: PropTypes.number.isRequired,\n  /** Total number of pages */\n  totalPages: PropTypes.number.isRequired,\n  /** Page change handler */\n  onPageChange: PropTypes.func.isRequired,\n  /** Items per page options */\n  itemsPerPageOptions: PropTypes.arrayOf(PropTypes.number),\n  /** Current items per page */\n  itemsPerPage: PropTypes.number,\n  /** Items per page change handler */\n  onItemsPerPageChange: PropTypes.func,\n  /** Total items count */\n  totalItems: PropTypes.number,\n};\n\nLoadingSpinner.propTypes = {\n  /** Spinner size in pixels */\n  size: PropTypes.number,\n  /** Spinner color */\n  color: PropTypes.string,\n};\n\nLoadingOverlay.propTypes = {\n  /** Loading text */\n  text: PropTypes.string,\n  /** Show as inline rather than overlay */\n  inline: PropTypes.bool,\n};\n\nVisuallyHidden.propTypes = {\n  /** Content to hide visually */\n  children: PropTypes.node.isRequired,\n  /** HTML element to render */\n  as: PropTypes.elementType,\n};\n\nLiveRegion.propTypes = {\n  /** Message to announce */\n  message: PropTypes.string,\n  /** ARIA politeness level */\n  politeness: PropTypes.oneOf(['polite', 'assertive']),\n  /** Clear message after delay */\n  clearAfter: PropTypes.number,\n};\n\nSkipLink.propTypes = {\n  /** ID of target element */\n  targetId: PropTypes.string,\n  /** Link text */\n  children: PropTypes.node,\n};\n","// =============================================================================\n// usePWA Hook\n// Manages PWA installation, service worker, and online/offline status\n// =============================================================================\n\nimport { useState, useEffect, useCallback, useRef } from 'react';\n\n/**\n * PWA installation status\n */\nexport const InstallStatus = {\n  IDLE: 'idle',\n  AVAILABLE: 'available',\n  INSTALLED: 'installed',\n  DISMISSED: 'dismissed',\n};\n\n/**\n * Custom hook for PWA functionality\n * @returns {Object} PWA state and methods\n */\nexport function usePWA() {\n  // Installation state\n  const [installStatus, setInstallStatus] = useState(InstallStatus.IDLE);\n  const [installPrompt, setInstallPrompt] = useState(null);\n  \n  // Online/offline state\n  const [isOnline, setIsOnline] = useState(\n    typeof navigator !== 'undefined' ? navigator.onLine : true\n  );\n  \n  // Service worker state\n  const [swStatus, setSwStatus] = useState('idle'); // idle, installing, installed, updating, updated\n  const [swRegistration, setSwRegistration] = useState(null);\n  const [updateAvailable, setUpdateAvailable] = useState(false);\n  \n  // Refs\n  const deferredPrompt = useRef(null);\n\n  // ============================================================================\n  // Online/Offline Detection\n  // ============================================================================\n\n  useEffect(() => {\n    const handleOnline = () => {\n      setIsOnline(true);\n      console.log('[PWA] Online');\n    };\n    \n    const handleOffline = () => {\n      setIsOnline(false);\n      console.log('[PWA] Offline');\n    };\n    \n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n    \n    return () => {\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n    };\n  }, []);\n\n  // ============================================================================\n  // Install Prompt Handling\n  // ============================================================================\n\n  useEffect(() => {\n    const handleBeforeInstallPrompt = (e) => {\n      // Prevent Chrome's default mini-infobar\n      e.preventDefault();\n      \n      // Store the event for later use\n      deferredPrompt.current = e;\n      setInstallPrompt(e);\n      setInstallStatus(InstallStatus.AVAILABLE);\n      \n      console.log('[PWA] Install prompt available');\n    };\n    \n    const handleAppInstalled = () => {\n      deferredPrompt.current = null;\n      setInstallPrompt(null);\n      setInstallStatus(InstallStatus.INSTALLED);\n      \n      console.log('[PWA] App installed');\n    };\n    \n    window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\n    window.addEventListener('appinstalled', handleAppInstalled);\n    \n    // Check if already installed\n    if (window.matchMedia('(display-mode: standalone)').matches) {\n      setInstallStatus(InstallStatus.INSTALLED);\n    }\n    \n    return () => {\n      window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\n      window.removeEventListener('appinstalled', handleAppInstalled);\n    };\n  }, []);\n\n  /**\n   * Prompt user to install the PWA\n   */\n  const promptInstall = useCallback(async () => {\n    if (!deferredPrompt.current) {\n      console.log('[PWA] No install prompt available');\n      return { outcome: 'unavailable' };\n    }\n    \n    // Show the prompt\n    deferredPrompt.current.prompt();\n    \n    // Wait for user choice\n    const { outcome } = await deferredPrompt.current.userChoice;\n    \n    console.log('[PWA] Install prompt outcome:', outcome);\n    \n    if (outcome === 'accepted') {\n      setInstallStatus(InstallStatus.INSTALLED);\n    } else {\n      setInstallStatus(InstallStatus.DISMISSED);\n    }\n    \n    // Clear the prompt\n    deferredPrompt.current = null;\n    setInstallPrompt(null);\n    \n    return { outcome };\n  }, []);\n\n  /**\n   * Dismiss install prompt\n   */\n  const dismissInstall = useCallback(() => {\n    setInstallStatus(InstallStatus.DISMISSED);\n    console.log('[PWA] Install dismissed');\n  }, []);\n\n  // ============================================================================\n  // Service Worker Registration\n  // ============================================================================\n\n  useEffect(() => {\n    if (!('serviceWorker' in navigator)) {\n      console.log('[PWA] Service workers not supported');\n      return;\n    }\n\n    const registerSW = async () => {\n      try {\n        setSwStatus('installing');\n        \n        const registration = await navigator.serviceWorker.register('/sw.js', {\n          scope: '/',\n        });\n        \n        setSwRegistration(registration);\n        console.log('[PWA] Service worker registered');\n        \n        // Check for updates\n        registration.addEventListener('updatefound', () => {\n          const newWorker = registration.installing;\n          \n          if (newWorker) {\n            newWorker.addEventListener('statechange', () => {\n              if (newWorker.state === 'installed') {\n                if (navigator.serviceWorker.controller) {\n                  // New update available\n                  setUpdateAvailable(true);\n                  setSwStatus('updated');\n                  console.log('[PWA] Update available');\n                } else {\n                  // First install\n                  setSwStatus('installed');\n                  console.log('[PWA] Service worker installed');\n                }\n              }\n            });\n          }\n        });\n        \n        // Check for waiting worker on page load\n        if (registration.waiting) {\n          setUpdateAvailable(true);\n          setSwStatus('updated');\n        }\n        \n        // Handle controller change (after skipWaiting)\n        let refreshing = false;\n        navigator.serviceWorker.addEventListener('controllerchange', () => {\n          if (refreshing) return;\n          refreshing = true;\n          window.location.reload();\n        });\n        \n        setSwStatus('installed');\n      } catch (error) {\n        console.error('[PWA] Service worker registration failed:', error);\n        setSwStatus('idle');\n      }\n    };\n\n    registerSW();\n  }, []);\n\n  /**\n   * Update the service worker immediately\n   */\n  const updateServiceWorker = useCallback(() => {\n    if (!swRegistration?.waiting) {\n      return;\n    }\n    \n    // Send skip waiting message to waiting worker\n    swRegistration.waiting.postMessage({ type: 'SKIP_WAITING' });\n    setUpdateAvailable(false);\n    \n    console.log('[PWA] Updating service worker');\n  }, [swRegistration]);\n\n  /**\n   * Check for service worker updates\n   */\n  const checkForUpdates = useCallback(async () => {\n    if (!swRegistration) return;\n    \n    try {\n      await swRegistration.update();\n      console.log('[PWA] Checked for updates');\n    } catch (error) {\n      console.error('[PWA] Update check failed:', error);\n    }\n  }, [swRegistration]);\n\n  /**\n   * Clear all caches\n   */\n  const clearCache = useCallback(async () => {\n    if ('caches' in window) {\n      const cacheNames = await caches.keys();\n      await Promise.all(cacheNames.map((name) => caches.delete(name)));\n      console.log('[PWA] Cache cleared');\n    }\n  }, []);\n\n  // ============================================================================\n  // Push Notifications\n  // ============================================================================\n\n  /**\n   * Request notification permission\n   */\n  const requestNotificationPermission = useCallback(async () => {\n    if (!('Notification' in window)) {\n      console.log('[PWA] Notifications not supported');\n      return 'unsupported';\n    }\n    \n    const permission = await Notification.requestPermission();\n    console.log('[PWA] Notification permission:', permission);\n    return permission;\n  }, []);\n\n  /**\n   * Check if notifications are enabled\n   */\n  const notificationsEnabled = \n    typeof Notification !== 'undefined' && \n    Notification.permission === 'granted';\n\n  /**\n   * Send a local notification\n   */\n  const sendNotification = useCallback((title, options = {}) => {\n    if (!notificationsEnabled) {\n      console.log('[PWA] Notifications not enabled');\n      return null;\n    }\n    \n    return new Notification(title, {\n      icon: '/favicon.svg',\n      badge: '/favicon.svg',\n      ...options,\n    });\n  }, [notificationsEnabled]);\n\n  // ============================================================================\n  // Computed Values\n  // ============================================================================\n\n  const canInstall = installStatus === InstallStatus.AVAILABLE;\n  const isInstalled = installStatus === InstallStatus.INSTALLED || \n    window.matchMedia('(display-mode: standalone)').matches;\n  const isStandalone = window.matchMedia('(display-mode: standalone)').matches;\n\n  return {\n    // Online status\n    isOnline,\n    \n    // Installation\n    installStatus,\n    canInstall,\n    isInstalled,\n    isStandalone,\n    promptInstall,\n    dismissInstall,\n    \n    // Service worker\n    swStatus,\n    swRegistration,\n    updateAvailable,\n    updateServiceWorker,\n    checkForUpdates,\n    clearCache,\n    \n    // Notifications\n    notificationsEnabled,\n    requestNotificationPermission,\n    sendNotification,\n  };\n}\n\nexport default usePWA;\n","// =============================================================================\n// useInventoryActions Hook\n// Encapsulates all inventory CRUD operations with Supabase persistence\n// =============================================================================\n\nimport { useCallback, useState } from 'react';\nimport { generateItemCode, updateById } from '../utils.js';\nimport { VIEWS, STATUS, MODALS } from '../constants.js';\n\nimport { error as logError } from '../lib/logger.js';\n\n/**\n * Custom hook for inventory CRUD operations\n * Integrates with DataContext for Supabase persistence\n * \n * @param {Object} params - Hook parameters\n * @param {Object} params.dataContext - DataContext with Supabase-integrated methods\n * @param {Function} params.dataContext.createItem - Creates item in Supabase + local state\n * @param {Function} params.dataContext.updateItem - Updates item in Supabase + local state\n * @param {Function} params.dataContext.deleteItem - Deletes item from Supabase + local state\n */\nexport function useInventoryActions({\n  // DataContext for Supabase persistence\n  dataContext,\n  \n  // State setters (for operations not yet in DataContext)\n  setInventory,\n  setSelectedItem,\n  setCurrentView,\n  setAuditLog,\n  setChangeLog,\n  setConfirmDialog,\n  \n  // Current state for operations\n  inventory,\n  selectedItem,\n  currentUser,\n  currentView,\n  specs,\n  \n  // Modal state\n  editingItemId,\n  setEditingItemId,\n  itemForm,\n  setItemForm,\n  resetItemForm,\n  closeModal,\n  openModal,\n}) {\n  // ============================================================================\n  // Loading/Error State for async operations\n  // ============================================================================\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n  \n  // ============================================================================\n  // Bulk Action State\n  // ============================================================================\n  const [bulkActionIds, setBulkActionIds] = useState([]);\n\n  // ============================================================================\n  // Audit Log Helper\n  // ============================================================================\n  \n  const addAuditLog = useCallback((entry) => {\n    if (dataContext?.addAuditLog) {\n      dataContext.addAuditLog({\n        ...entry,\n        user: currentUser?.name || 'Unknown',\n      });\n    }\n  }, [dataContext, currentUser]);\n\n  // ============================================================================\n  // Change Log Helper\n  // ============================================================================\n  \n  const addChangeLog = useCallback((entry) => {\n    setChangeLog(prev => [...prev, {\n      ...entry,\n      id: `CL${Date.now()}`,\n      timestamp: new Date().toISOString(),\n      user: currentUser?.name || 'Unknown',\n    }]);\n  }, [currentUser, setChangeLog]);\n\n  // ============================================================================\n  // Create Item - NOW PERSISTS TO SUPABASE\n  // ============================================================================\n  \n  const createItem = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n    \n    try {\n      const id = generateItemCode(itemForm.category, inventory.map(i => i.id));\n      const itemSpecs = {};\n      (specs[itemForm.category] || []).forEach(f => {\n        if (itemForm.specs[f.name]) itemSpecs[f.name] = itemForm.specs[f.name];\n      });\n\n      const newItem = {\n        ...itemForm,\n        id,\n        status: STATUS.AVAILABLE,\n        purchasePrice: Number(itemForm.purchasePrice) || 0,\n        currentValue: Number(itemForm.currentValue) || Number(itemForm.purchasePrice) || 0,\n        quantity: Number(itemForm.quantity) || 1,\n        reorderPoint: Number(itemForm.reorderPoint) || 0,\n        specs: itemSpecs,\n        notes: [],\n        reservations: [],\n        reminders: [],\n        maintenanceHistory: [],\n        viewCount: 0,\n        checkoutCount: 0\n      };\n\n      // Use DataContext method - persists to Supabase AND updates local state\n      if (dataContext?.createItem) {\n        await dataContext.createItem(newItem);\n      } else {\n        // Fallback to local state only (demo mode without DataContext)\n        setInventory(prev => [...prev, newItem]);\n      }\n      \n      // Log the creation\n      addChangeLog({\n        type: 'created',\n        itemId: id,\n        itemType: 'item',\n        itemName: newItem.name,\n        description: `Created new item: ${newItem.name}`,\n        changes: [{ field: 'item', newValue: newItem.name }]\n      });\n      addAuditLog({\n        type: 'item_created',\n        description: `Created item: ${newItem.name} (${id})`,\n        itemId: id,\n      });\n      \n      // If image is a base64 data URL, upload to storage and update the item\n      if (newItem.image && newItem.image.startsWith('data:')) {\n        try {\n          const { storageService } = await import('../lib/index.js');\n          const result = await storageService.uploadFromDataUrl(newItem.image, id);\n          if (result?.url && !result.url.startsWith('data:')) {\n            if (dataContext?.updateItem) {\n              await dataContext.updateItem(id, { image: result.url });\n            } else {\n              setInventory(prev => prev.map(i => i.id === id ? { ...i, image: result.url } : i));\n            }\n          }\n        } catch (uploadErr) {\n          logError('Failed to upload image to storage after item creation:', uploadErr);\n          // Non-fatal  item was created with base64 fallback\n        }\n      }\n      \n      closeModal();\n      resetItemForm?.();\n      \n      // If on the Add Item page, navigate back to Gear List\n      if (currentView === VIEWS.ADD_ITEM) {\n        setCurrentView(VIEWS.GEAR_LIST);\n      }\n      \n      return newItem;\n    } catch (err) {\n      logError('Failed to create item:', err);\n      setError(err.message || 'Failed to create item');\n      throw err;\n    } finally {\n      setIsLoading(false);\n    }\n  }, [itemForm, inventory, specs, closeModal, resetItemForm, currentView, setCurrentView, setInventory, addChangeLog, dataContext]);\n\n  // ============================================================================\n  // Update Item - NOW PERSISTS TO SUPABASE\n  // ============================================================================\n  \n  const updateItem = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n    \n    try {\n      const itemSpecs = {};\n      (specs[itemForm.category] || []).forEach(f => {\n        if (itemForm.specs[f.name]) itemSpecs[f.name] = itemForm.specs[f.name];\n      });\n\n      const updates = {\n        ...itemForm,\n        specs: itemSpecs,\n        purchasePrice: Number(itemForm.purchasePrice) || 0,\n        currentValue: Number(itemForm.currentValue) || 0,\n        quantity: Number(itemForm.quantity) || 1,\n        reorderPoint: Number(itemForm.reorderPoint) || 0,\n      };\n\n      // Find the original item to track changes\n      const originalItem = inventory.find(i => i.id === editingItemId);\n      const changes = [];\n      if (originalItem) {\n        const fieldsToTrack = [\n          { key: 'name', label: 'name' },\n          { key: 'brand', label: 'brand' },\n          { key: 'category', label: 'category' },\n          { key: 'condition', label: 'condition' },\n          { key: 'location', label: 'location' },\n          { key: 'serialNumber', label: 'serialNumber' },\n          { key: 'purchasePrice', label: 'purchasePrice' },\n          { key: 'currentValue', label: 'currentValue' },\n          { key: 'purchaseDate', label: 'purchaseDate' },\n          { key: 'quantity', label: 'quantity' },\n          { key: 'reorderPoint', label: 'reorderPoint' },\n        ];\n        \n        fieldsToTrack.forEach(({ key, label }) => {\n          const oldVal = originalItem[key];\n          const newVal = updates[key];\n          if (String(oldVal || '') !== String(newVal || '')) {\n            changes.push({ field: label, oldValue: oldVal, newValue: newVal });\n          }\n        });\n\n        // Track image changes separately (don't log the full data URL)\n        const oldImg = originalItem.image || null;\n        const newImg = updates.image || null;\n        if (oldImg !== newImg) {\n          changes.push({ \n            field: 'image', \n            oldValue: oldImg ? 'had image' : 'no image', \n            newValue: newImg ? 'image updated' : 'image removed' \n          });\n        }\n      }\n\n      // Use DataContext method - persists to Supabase AND updates local state\n      if (dataContext?.updateItem) {\n        await dataContext.updateItem(editingItemId, updates);\n      } else {\n        // Fallback to local state only\n        setInventory(prev => updateById(prev, editingItemId, updates));\n      }\n      \n      // Update selected item if it's the one being edited\n      if (selectedItem?.id === editingItemId) {\n        setSelectedItem(prev => ({ ...prev, ...updates }));\n      }\n      \n      // Log the update\n      if (changes.length > 0) {\n        addChangeLog({\n          type: 'updated',\n          itemId: editingItemId,\n          itemType: 'item',\n          itemName: updates.name,\n          description: `Updated item: ${updates.name}`,\n          changes\n        });\n        addAuditLog({\n          type: 'item_updated',\n          description: `Updated item: ${updates.name} (${changes.map(c => c.field).join(', ')})`,\n          itemId: editingItemId,\n        });\n      }\n      \n      closeModal();\n      setEditingItemId(null);\n    } catch (err) {\n      logError('Failed to update item:', err);\n      setError(err.message || 'Failed to update item');\n      throw err;\n    } finally {\n      setIsLoading(false);\n    }\n  }, [itemForm, editingItemId, selectedItem, specs, closeModal, inventory, setInventory, setSelectedItem, setEditingItemId, addChangeLog, dataContext]);\n\n  // ============================================================================\n  // Delete Item - NOW PERSISTS TO SUPABASE (with confirmation)\n  // ============================================================================\n  \n  const deleteItem = useCallback((id) => {\n    const itemToDelete = inventory.find(i => i.id === id);\n    \n    setConfirmDialog({\n      isOpen: true,\n      title: 'Delete Item',\n      message: 'Are you sure you want to delete this item? This action cannot be undone.',\n      onConfirm: async () => {\n        setIsLoading(true);\n        setError(null);\n        \n        try {\n          // Use DataContext method - deletes from Supabase AND updates local state\n          if (dataContext?.deleteItem) {\n            await dataContext.deleteItem(id);\n          } else {\n            // Fallback to local state only\n            setInventory(prev => prev.filter(i => i.id !== id));\n          }\n          \n          // Log the deletion\n          addChangeLog({\n            type: 'deleted',\n            itemId: id,\n            itemType: 'item',\n            itemName: itemToDelete?.name || 'Unknown',\n            description: `Deleted item: ${itemToDelete?.name || id}`,\n            changes: [{ field: 'item', oldValue: itemToDelete?.name }]\n          });\n          addAuditLog({\n            type: 'item_deleted',\n            description: `Deleted item: ${itemToDelete?.name || id}`,\n            itemId: id,\n          });\n          \n          // Clear selection if deleted item was selected\n          if (selectedItem?.id === id) {\n            setSelectedItem(null);\n            setCurrentView(VIEWS.GEAR_LIST);\n          }\n          \n          setConfirmDialog(prev => ({ ...prev, isOpen: false }));\n        } catch (err) {\n          logError('Failed to delete item:', err);\n          setError(err.message || 'Failed to delete item');\n          setConfirmDialog(prev => ({ ...prev, isOpen: false }));\n        } finally {\n          setIsLoading(false);\n        }\n      }\n    });\n  }, [selectedItem, inventory, setInventory, setSelectedItem, setCurrentView, setConfirmDialog, addChangeLog, dataContext]);\n\n  // ============================================================================\n  // Bulk Action Handler\n  // ============================================================================\n  \n  const handleBulkAction = useCallback((action, ids) => {\n    setBulkActionIds(ids);\n    switch (action) {\n      case 'status':\n        openModal(MODALS.BULK_STATUS);\n        break;\n      case 'location':\n        openModal(MODALS.BULK_LOCATION);\n        break;\n      case 'category':\n        openModal(MODALS.BULK_CATEGORY);\n        break;\n      case 'delete':\n        openModal(MODALS.BULK_DELETE);\n        break;\n      default:\n        break;\n    }\n  }, [openModal]);\n\n  // ============================================================================\n  // Bulk Operations - NOW PERSIST TO SUPABASE\n  // ============================================================================\n  \n  const applyBulkStatus = useCallback(async (newStatus) => {\n    setIsLoading(true);\n    setError(null);\n    \n    try {\n      const updatedItems = [];\n      \n      // Update each item\n      for (const itemId of bulkActionIds) {\n        const item = inventory.find(i => i.id === itemId);\n        if (item) {\n          updatedItems.push({ id: item.id, name: item.name, oldStatus: item.status });\n          \n          if (dataContext?.updateItem) {\n            await dataContext.updateItem(itemId, { status: newStatus });\n          }\n        }\n      }\n      \n      // If no dataContext, update local state directly\n      if (!dataContext?.updateItem) {\n        setInventory(prev => prev.map(item => {\n          if (bulkActionIds.includes(item.id)) {\n            return { ...item, status: newStatus };\n          }\n          return item;\n        }));\n      }\n      \n      addChangeLog({\n        type: 'bulk_update',\n        itemType: 'item',\n        description: `Changed status to \"${newStatus}\" for ${bulkActionIds.length} items`,\n        changes: updatedItems.map(i => ({ \n          field: `${i.id} (${i.name})`, \n          oldValue: i.oldStatus, \n          newValue: newStatus \n        }))\n      });\n      addAuditLog({\n        type: 'bulk_status_change',\n        description: `Bulk status change to \"${newStatus}\" for ${bulkActionIds.length} items`,\n      });\n      \n      closeModal();\n      setBulkActionIds([]);\n    } catch (err) {\n      logError('Failed to apply bulk status:', err);\n      setError(err.message || 'Failed to update items');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [bulkActionIds, inventory, setInventory, addChangeLog, closeModal, dataContext]);\n\n  const applyBulkLocation = useCallback(async (newLocation) => {\n    setIsLoading(true);\n    setError(null);\n    \n    try {\n      const updatedItems = [];\n      \n      for (const itemId of bulkActionIds) {\n        const item = inventory.find(i => i.id === itemId);\n        if (item) {\n          updatedItems.push({ id: item.id, name: item.name, oldLocation: item.location });\n          \n          if (dataContext?.updateItem) {\n            await dataContext.updateItem(itemId, { location: newLocation });\n          }\n        }\n      }\n      \n      if (!dataContext?.updateItem) {\n        setInventory(prev => prev.map(item => {\n          if (bulkActionIds.includes(item.id)) {\n            return { ...item, location: newLocation };\n          }\n          return item;\n        }));\n      }\n      \n      addChangeLog({\n        type: 'bulk_update',\n        itemType: 'item',\n        description: `Changed location to \"${newLocation}\" for ${bulkActionIds.length} items`,\n        changes: updatedItems.map(i => ({ \n          field: `${i.id} (${i.name})`, \n          oldValue: i.oldLocation || '-', \n          newValue: newLocation \n        }))\n      });\n      addAuditLog({\n        type: 'bulk_location_change',\n        description: `Bulk location change to \"${newLocation}\" for ${bulkActionIds.length} items`,\n      });\n      \n      closeModal();\n      setBulkActionIds([]);\n    } catch (err) {\n      logError('Failed to apply bulk location:', err);\n      setError(err.message || 'Failed to update items');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [bulkActionIds, inventory, setInventory, addChangeLog, addAuditLog, closeModal, dataContext]);\n\n  const applyBulkCategory = useCallback(async (newCategory) => {\n    setIsLoading(true);\n    setError(null);\n    \n    try {\n      const updatedItems = [];\n      \n      for (const itemId of bulkActionIds) {\n        const item = inventory.find(i => i.id === itemId);\n        if (item) {\n          updatedItems.push({ id: item.id, name: item.name, oldCategory: item.category });\n          \n          if (dataContext?.updateItem) {\n            await dataContext.updateItem(itemId, { category: newCategory, specs: {} });\n          }\n        }\n      }\n      \n      if (!dataContext?.updateItem) {\n        setInventory(prev => prev.map(item => {\n          if (bulkActionIds.includes(item.id)) {\n            return { ...item, category: newCategory, specs: {} };\n          }\n          return item;\n        }));\n      }\n      \n      addChangeLog({\n        type: 'bulk_update',\n        itemType: 'item',\n        description: `Changed category to \"${newCategory}\" for ${bulkActionIds.length} items`,\n        changes: updatedItems.map(i => ({ \n          field: `${i.id} (${i.name})`, \n          oldValue: i.oldCategory, \n          newValue: newCategory \n        }))\n      });\n      addAuditLog({\n        type: 'bulk_category_change',\n        description: `Bulk category change to \"${newCategory}\" for ${bulkActionIds.length} items`,\n      });\n      \n      closeModal();\n      setBulkActionIds([]);\n    } catch (err) {\n      logError('Failed to apply bulk category:', err);\n      setError(err.message || 'Failed to update items');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [bulkActionIds, inventory, setInventory, addChangeLog, addAuditLog, closeModal, dataContext]);\n\n  const applyBulkDelete = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n    \n    try {\n      const deletedItems = inventory.filter(i => bulkActionIds.includes(i.id));\n      \n      // Delete each item\n      for (const itemId of bulkActionIds) {\n        if (dataContext?.deleteItem) {\n          await dataContext.deleteItem(itemId);\n        }\n      }\n      \n      if (!dataContext?.deleteItem) {\n        setInventory(prev => prev.filter(item => !bulkActionIds.includes(item.id)));\n      }\n      \n      // Clear selection if current item was deleted\n      if (selectedItem && bulkActionIds.includes(selectedItem.id)) {\n        setSelectedItem(null);\n        setCurrentView(VIEWS.GEAR_LIST);\n      }\n      \n      addChangeLog({\n        type: 'bulk_delete',\n        itemType: 'item',\n        description: `Deleted ${bulkActionIds.length} items`,\n        changes: deletedItems.map(i => ({ \n          field: 'deleted', \n          oldValue: `${i.id} - ${i.name}`, \n          newValue: null \n        }))\n      });\n      addAuditLog({\n        type: 'bulk_delete',\n        description: `Bulk deleted ${bulkActionIds.length} items`,\n      });\n      \n      closeModal();\n      setBulkActionIds([]);\n    } catch (err) {\n      logError('Failed to apply bulk delete:', err);\n      setError(err.message || 'Failed to delete items');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [bulkActionIds, inventory, selectedItem, setInventory, setSelectedItem, setCurrentView, addChangeLog, closeModal, dataContext]);\n\n  // ============================================================================\n  // Edit Item Helper\n  // ============================================================================\n  \n  const openEditItem = useCallback((item) => {\n    setEditingItemId(item.id);\n    setItemForm({\n      name: item.name || '',\n      brand: item.brand || '',\n      category: item.category || 'Cameras',\n      location: item.location || '',\n      purchaseDate: item.purchaseDate || '',\n      purchasePrice: item.purchasePrice || '',\n      currentValue: item.currentValue || '',\n      serialNumber: item.serialNumber || '',\n      condition: item.condition || 'Excellent',\n      image: item.image || null,\n      specs: { ...(item.specs || {}) },\n      quantity: item.quantity ?? 1,\n      reorderPoint: item.reorderPoint ?? 0,\n    });\n    openModal(MODALS.EDIT_ITEM);\n  }, [setEditingItemId, setItemForm, openModal]);\n\n  return {\n    // Loading/Error state\n    isLoading,\n    error,\n    clearError: () => setError(null),\n    \n    // CRUD Operations (now async, persist to Supabase)\n    createItem,\n    updateItem,\n    deleteItem,\n    \n    // Bulk Action State\n    bulkActionIds,\n    setBulkActionIds,\n    \n    // Bulk Operations (now async, persist to Supabase)\n    handleBulkAction,\n    applyBulkStatus,\n    applyBulkLocation,\n    applyBulkCategory,\n    applyBulkDelete,\n    \n    // Helpers\n    openEditItem,\n    addChangeLog,\n  };\n}\n\nexport default useInventoryActions;\n","// =============================================================================\n// usePagination - Pagination logic hook\n// =============================================================================\n\nimport { useState, useCallback, useMemo } from 'react';\n\n/**\n * Hook for pagination\n * @param {Array} items - Items to paginate\n * @param {number} pageSize - Items per page\n */\nexport function usePagination(items, pageSize = 20) {\n  const [page, setPage] = useState(1);\n\n  const totalPages = Math.ceil(items.length / pageSize);\n\n  const paginatedItems = useMemo(() => {\n    const start = (page - 1) * pageSize;\n    return items.slice(start, start + pageSize);\n  }, [items, page, pageSize]);\n\n  const goToPage = useCallback((newPage) => {\n    setPage(Math.max(1, Math.min(newPage, totalPages)));\n  }, [totalPages]);\n\n  const nextPage = useCallback(() => {\n    goToPage(page + 1);\n  }, [page, goToPage]);\n\n  const prevPage = useCallback(() => {\n    goToPage(page - 1);\n  }, [page, goToPage]);\n\n  // Reset to page 1 when items change\n  useMemo(() => {\n    if (page > totalPages && totalPages > 0) {\n      setPage(1);\n    }\n  }, [items.length, totalPages, page]);\n\n  return {\n    page,\n    totalPages,\n    paginatedItems,\n    goToPage,\n    nextPage,\n    prevPage,\n    hasNext: page < totalPages,\n    hasPrev: page > 1,\n  };\n}\n","// =============================================================================\n// useDebounce - Debounced value hook\n// =============================================================================\n\nimport { useState, useEffect } from 'react';\n\n/**\n * Hook for debouncing a value\n * @param {*} value - Value to debounce\n * @param {number} delay - Delay in milliseconds\n */\nexport function useDebounce(value, delay = 300) {\n  const [debouncedValue, setDebouncedValue] = useState(value);\n\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value, delay]);\n\n  return debouncedValue;\n}\n","// =============================================================================\n// NavigationContext\n// Provides navigation state via context so only navigation-dependent\n// components re-render on view changes  not the entire App tree.\n// =============================================================================\n\nimport React, { createContext, useContext, useState, useEffect, useRef, useCallback, useMemo } from 'react';\nimport { VIEWS } from '../constants.js';\nimport { useData } from '../lib/DataContext.jsx';\nimport { useAuth } from '../lib/AuthContext.jsx';\n\nconst NavigationContext = createContext(null);\n\n/**\n * NavigationProviderWithData - A wrapper that pulls inventory/packages from DataContext\n * and isLoggedIn from AuthContext, then passes them to NavigationProvider\n */\nexport function NavigationProviderWithData({ children }) {\n  const { inventory, packages } = useData();\n  const { isAuthenticated } = useAuth();\n  \n  return (\n    <NavigationProvider isLoggedIn={isAuthenticated} inventory={inventory || []} packages={packages || []}>\n      {children}\n    </NavigationProvider>\n  );\n}\n\nexport function NavigationProvider({ children, isLoggedIn = false, inventory = [], packages = [] }) {\n  // Navigation state\n  const [currentView, setCurrentView] = useState(VIEWS.DASHBOARD);\n  const [selectedItem, setSelectedItem] = useState(null);\n  const [selectedPackage, setSelectedPackage] = useState(null);\n  const [selectedPackList, setSelectedPackList] = useState(null);\n  const [selectedReservation, setSelectedReservation] = useState(null);\n  const [selectedReservationItem, setSelectedReservationItem] = useState(null);\n  const [itemBackContext, setItemBackContext] = useState(null);\n\n  // Track if navigation is from popstate (browser back/forward)\n  const isPopstateNav = useRef(false);\n\n  // ============================================================================\n  // Browser History Management\n  // ============================================================================\n\n  useEffect(() => {\n    if (!isLoggedIn) return;\n\n    if (isPopstateNav.current) {\n      isPopstateNav.current = false;\n      return;\n    }\n\n    const state = {\n      view: currentView,\n      selectedItemId: selectedItem?.id || null,\n      selectedPackageId: selectedPackage?.id || null,\n    };\n\n    if (window.history.state?.view === undefined) {\n      window.history.replaceState(state, '', window.location.pathname);\n    } else if (window.history.state?.view !== currentView ||\n               window.history.state?.selectedItemId !== state.selectedItemId) {\n      window.history.pushState(state, '', window.location.pathname);\n    }\n  }, [currentView, selectedItem?.id, selectedPackage?.id, isLoggedIn]);\n\n  useEffect(() => {\n    const handlePopState = (event) => {\n      if (!isLoggedIn) return;\n\n      isPopstateNav.current = true;\n\n      if (event.state?.view) {\n        setCurrentView(event.state.view);\n\n        if (event.state.view === VIEWS.GEAR_DETAIL && event.state.selectedItemId) {\n          const item = inventory.find(i => i.id === event.state.selectedItemId);\n          if (item) setSelectedItem(item);\n        } else if (event.state.view === VIEWS.PACKAGE_DETAIL && event.state.selectedPackageId) {\n          const pkg = packages.find(p => p.id === event.state.selectedPackageId);\n          if (pkg) setSelectedPackage(pkg);\n        }\n      } else {\n        setCurrentView(VIEWS.DASHBOARD);\n      }\n    };\n\n    window.addEventListener('popstate', handlePopState);\n    return () => window.removeEventListener('popstate', handlePopState);\n  }, [isLoggedIn, inventory, packages]);\n\n  // ============================================================================\n  // Navigation Handlers\n  // ============================================================================\n\n  const navigate = useCallback((viewId) => {\n    setCurrentView(viewId);\n    window.scrollTo(0, 0);\n    const mainContent = document.getElementById('main-content');\n    if (mainContent) mainContent.scrollTop = 0;\n\n    if (viewId === VIEWS.GEAR_LIST) setSelectedItem(null);\n    else if (viewId === VIEWS.PACKAGES) setSelectedPackage(null);\n    else if (viewId === VIEWS.PACK_LISTS) setSelectedPackList(null);\n  }, []);\n\n  const navigateToItem = useCallback((item, backContext = null) => {\n    setSelectedItem(item);\n    setItemBackContext(backContext);\n    setCurrentView(VIEWS.GEAR_DETAIL);\n    window.scrollTo(0, 0);\n  }, []);\n\n  const navigateToPackage = useCallback((pkg) => {\n    setSelectedPackage(pkg);\n    setCurrentView(VIEWS.PACKAGE_DETAIL);\n    window.scrollTo(0, 0);\n  }, []);\n\n  const navigateToPackList = useCallback((packList) => {\n    setSelectedPackList(packList);\n    setCurrentView(VIEWS.PACK_LIST_DETAIL);\n    window.scrollTo(0, 0);\n  }, []);\n\n  const navigateToReservation = useCallback((reservation, item) => {\n    setSelectedReservation(reservation);\n    setSelectedReservationItem(item);\n    setCurrentView(VIEWS.RESERVATION_DETAIL);\n    window.scrollTo(0, 0);\n  }, []);\n\n  const goBack = useCallback(() => {\n    if (currentView === VIEWS.GEAR_DETAIL) {\n      setSelectedItem(null);\n      setCurrentView(itemBackContext || VIEWS.GEAR_LIST);\n      setItemBackContext(null);\n    } else if (currentView === VIEWS.PACKAGE_DETAIL) {\n      setSelectedPackage(null);\n      setCurrentView(VIEWS.PACKAGES);\n    } else if (currentView === VIEWS.PACK_LIST_DETAIL) {\n      setSelectedPackList(null);\n      setCurrentView(VIEWS.PACK_LISTS);\n    } else if (currentView === VIEWS.RESERVATION_DETAIL) {\n      setSelectedReservation(null);\n      setSelectedReservationItem(null);\n      setCurrentView(VIEWS.SCHEDULE);\n    } else {\n      setCurrentView(VIEWS.DASHBOARD);\n    }\n    window.scrollTo(0, 0);\n  }, [currentView, itemBackContext]);\n\n  const isDetailView = [\n    VIEWS.GEAR_DETAIL,\n    VIEWS.PACKAGE_DETAIL,\n    VIEWS.PACK_LIST_DETAIL,\n    VIEWS.RESERVATION_DETAIL,\n  ].includes(currentView);\n\n  const resetNavigation = useCallback(() => {\n    setCurrentView(VIEWS.DASHBOARD);\n    setSelectedItem(null);\n    setSelectedPackage(null);\n    setSelectedPackList(null);\n    setSelectedReservation(null);\n    setSelectedReservationItem(null);\n    setItemBackContext(null);\n  }, []);\n\n  // ============================================================================\n  // Memoized context value  only changes when actual state changes\n  // ============================================================================\n  const value = useMemo(() => ({\n    // State\n    currentView,\n    selectedItem,\n    selectedPackage,\n    selectedPackList,\n    selectedReservation,\n    selectedReservationItem,\n    itemBackContext,\n    isDetailView,\n\n    // Setters\n    setCurrentView,\n    setSelectedItem,\n    setSelectedPackage,\n    setSelectedPackList,\n    setSelectedReservation,\n    setSelectedReservationItem,\n    setItemBackContext,\n\n    // Handlers\n    navigate,\n    navigateToItem,\n    navigateToPackage,\n    navigateToPackList,\n    navigateToReservation,\n    goBack,\n    resetNavigation,\n  }), [\n    currentView, selectedItem, selectedPackage, selectedPackList,\n    selectedReservation, selectedReservationItem, itemBackContext, isDetailView,\n    navigate, navigateToItem, navigateToPackage, navigateToPackList,\n    navigateToReservation, goBack, resetNavigation,\n  ]);\n\n  return (\n    <NavigationContext.Provider value={value}>\n      {children}\n    </NavigationContext.Provider>\n  );\n}\n\nexport function useNavigationContext() {\n  const ctx = useContext(NavigationContext);\n  if (!ctx) throw new Error('useNavigationContext must be used within NavigationProvider');\n  return ctx;\n}\n\nexport default NavigationContext;\n","// =============================================================================\n// FilterContext\n// Provides filter/search state via context so only filter-dependent\n// components re-render on search/filter changes  not the entire App tree.\n// =============================================================================\n\nimport React, { createContext, useContext, useState, useCallback, useMemo } from 'react';\nimport { getTodayISO } from '../utils.js';\n\nconst FilterContext = createContext(null);\n\nexport function FilterProvider({ children, defaultCategoryFilter = 'all', defaultStatusFilter = 'all', defaultGridView = true }) {\n  // Search state\n  const [searchQuery, setSearchQuery] = useState('');\n\n  // Category filters\n  const [categoryFilter, setCategoryFilter] = useState(defaultCategoryFilter);\n  const [selectedCategories, setSelectedCategories] = useState([]);\n  const [packageCategoryFilter, setPackageCategoryFilter] = useState('all');\n\n  // Status filters\n  const [statusFilter, setStatusFilter] = useState(defaultStatusFilter);\n  const [selectedStatuses, setSelectedStatuses] = useState([]);\n\n  // View preferences\n  const [isGridView, setIsGridView] = useState(defaultGridView);\n\n  // Schedule view state\n  const [scheduleView, setScheduleView] = useState('week');\n  const [scheduleMode, setScheduleMode] = useState('calendar');\n  const [scheduleDate, setScheduleDate] = useState(getTodayISO());\n\n  // Selection state\n  const [selectedIds, setSelectedIds] = useState([]);\n\n  // ============================================================================\n  // Handlers\n  // ============================================================================\n\n  const handleSearch = useCallback((query) => setSearchQuery(query), []);\n  const clearSearch = useCallback(() => setSearchQuery(''), []);\n\n  const handleCategoryFilter = useCallback((category) => {\n    setCategoryFilter(category);\n    setSelectedCategories([]);\n  }, []);\n\n  const toggleCategory = useCallback((category) => {\n    setSelectedCategories(prev =>\n      prev.includes(category) ? prev.filter(c => c !== category) : [...prev, category]\n    );\n    setCategoryFilter('all');\n  }, []);\n\n  const clearCategoryFilters = useCallback(() => {\n    setCategoryFilter('all');\n    setSelectedCategories([]);\n  }, []);\n\n  const handleStatusFilter = useCallback((status) => {\n    setStatusFilter(status);\n    setSelectedStatuses([]);\n  }, []);\n\n  const toggleStatus = useCallback((status) => {\n    setSelectedStatuses(prev =>\n      prev.includes(status) ? prev.filter(s => s !== status) : [...prev, status]\n    );\n    setStatusFilter('all');\n  }, []);\n\n  const clearStatusFilters = useCallback(() => {\n    setStatusFilter('all');\n    setSelectedStatuses([]);\n  }, []);\n\n  const toggleViewMode = useCallback(() => setIsGridView(prev => !prev), []);\n  const setGridView = useCallback(() => setIsGridView(true), []);\n  const setListView = useCallback(() => setIsGridView(false), []);\n\n  const handleScheduleView = useCallback((view) => setScheduleView(view), []);\n  const handleScheduleMode = useCallback((mode) => setScheduleMode(mode), []);\n  const handleScheduleDate = useCallback((date) => setScheduleDate(date), []);\n  const resetScheduleToToday = useCallback(() => setScheduleDate(getTodayISO()), []);\n\n  const toggleSelection = useCallback((id) => {\n    setSelectedIds(prev =>\n      prev.includes(id) ? prev.filter(i => i !== id) : [...prev, id]\n    );\n  }, []);\n\n  const selectAll = useCallback((ids) => setSelectedIds(ids), []);\n  const clearSelection = useCallback(() => setSelectedIds([]), []);\n  const isSelected = useCallback((id) => selectedIds.includes(id), [selectedIds]);\n\n  const resetAllFilters = useCallback(() => {\n    setSearchQuery('');\n    setCategoryFilter(defaultCategoryFilter);\n    setSelectedCategories([]);\n    setStatusFilter(defaultStatusFilter);\n    setSelectedStatuses([]);\n    setPackageCategoryFilter('all');\n    setSelectedIds([]);\n  }, [defaultCategoryFilter, defaultStatusFilter]);\n\n  const createItemFilter = useCallback((options = {}) => {\n    const {\n      searchFields = ['name', 'code', 'description'],\n      categoryField = 'category',\n      statusField = 'status',\n    } = options;\n\n    return (item) => {\n      if (searchQuery) {\n        const query = searchQuery.toLowerCase();\n        const matchesSearch = searchFields.some(field =>\n          item[field]?.toLowerCase?.().includes(query)\n        );\n        if (!matchesSearch) return false;\n      }\n      if (categoryFilter !== 'all' && item[categoryField] !== categoryFilter) return false;\n      if (selectedCategories.length > 0 && !selectedCategories.includes(item[categoryField])) return false;\n      if (statusFilter !== 'all' && item[statusField] !== statusFilter) return false;\n      if (selectedStatuses.length > 0 && !selectedStatuses.includes(item[statusField])) return false;\n      return true;\n    };\n  }, [searchQuery, categoryFilter, selectedCategories, statusFilter, selectedStatuses]);\n\n  const hasActiveFilters = useMemo(() => {\n    return searchQuery !== '' ||\n      categoryFilter !== 'all' ||\n      selectedCategories.length > 0 ||\n      statusFilter !== 'all' ||\n      selectedStatuses.length > 0;\n  }, [searchQuery, categoryFilter, selectedCategories, statusFilter, selectedStatuses]);\n\n  const selectionCount = selectedIds.length;\n  const hasSelection = selectionCount > 0;\n\n  // ============================================================================\n  // Memoized context value\n  // ============================================================================\n  const value = useMemo(() => ({\n    searchQuery, setSearchQuery, handleSearch, clearSearch,\n    categoryFilter, setCategoryFilter, selectedCategories, setSelectedCategories,\n    packageCategoryFilter, setPackageCategoryFilter,\n    handleCategoryFilter, toggleCategory, clearCategoryFilters,\n    statusFilter, setStatusFilter, selectedStatuses, setSelectedStatuses,\n    handleStatusFilter, toggleStatus, clearStatusFilters,\n    isGridView, setIsGridView, toggleViewMode, setGridView, setListView,\n    scheduleView, setScheduleView, scheduleMode, setScheduleMode,\n    scheduleDate, setScheduleDate,\n    handleScheduleView, handleScheduleMode, handleScheduleDate, resetScheduleToToday,\n    selectedIds, setSelectedIds, toggleSelection, selectAll, clearSelection, isSelected,\n    selectionCount, hasSelection,\n    resetAllFilters, createItemFilter, hasActiveFilters,\n  }), [\n    searchQuery, categoryFilter, selectedCategories, packageCategoryFilter,\n    statusFilter, selectedStatuses, isGridView,\n    scheduleView, scheduleMode, scheduleDate,\n    selectedIds, selectionCount, hasSelection, hasActiveFilters,\n    handleSearch, clearSearch, handleCategoryFilter, toggleCategory, clearCategoryFilters,\n    handleStatusFilter, toggleStatus, clearStatusFilters,\n    toggleViewMode, setGridView, setListView,\n    handleScheduleView, handleScheduleMode, handleScheduleDate, resetScheduleToToday,\n    toggleSelection, selectAll, clearSelection, isSelected,\n    resetAllFilters, createItemFilter,\n  ]);\n\n  return (\n    <FilterContext.Provider value={value}>\n      {children}\n    </FilterContext.Provider>\n  );\n}\n\nexport function useFilterContext() {\n  const ctx = useContext(FilterContext);\n  if (!ctx) throw new Error('useFilterContext must be used within FilterProvider');\n  return ctx;\n}\n\nexport default FilterContext;\n","// =============================================================================\n// ModalContext\n// Provides modal state via context so opening/closing modals only\n// re-renders modal-dependent components  not the entire App tree.\n// =============================================================================\n\nimport React, { createContext, useContext, useState, useCallback, useMemo } from 'react';\nimport { MODALS, EMPTY_ITEM_FORM, EMPTY_RESERVATION_FORM } from '../constants.js';\n\nconst ModalContext = createContext(null);\n\nexport function ModalProvider({ children }) {\n  // Active modal\n  const [activeModal, setActiveModal] = useState(null);\n\n  // Editing state\n  const [editingItemId, setEditingItemId] = useState(null);\n  const [editingReservationId, setEditingReservationId] = useState(null);\n\n  // Form state\n  const [itemForm, setItemForm] = useState(EMPTY_ITEM_FORM);\n  const [reservationForm, setReservationForm] = useState(EMPTY_RESERVATION_FORM);\n\n  // Confirm dialog state\n  const [confirmDialog, setConfirmDialog] = useState({\n    isOpen: false,\n    title: '',\n    message: '',\n    confirmText: 'Confirm',\n    cancelText: 'Cancel',\n    variant: 'default',\n    onConfirm: null,\n    onCancel: null,\n  });\n\n  // Modal-specific data\n  const [modalData, setModalData] = useState(null);\n\n  // ============================================================================\n  // Modal Handlers\n  // ============================================================================\n\n  const openModal = useCallback((modalId, data = null) => {\n    setActiveModal(modalId);\n    setModalData(data);\n  }, []);\n\n  const closeModal = useCallback(() => {\n    setActiveModal(null);\n    setModalData(null);\n  }, []);\n\n  const isModalOpen = useCallback((modalId) => activeModal === modalId, [activeModal]);\n\n  // ============================================================================\n  // Item Modal Handlers\n  // ============================================================================\n\n  const openAddItemModal = useCallback((initialData = null) => {\n    setEditingItemId(null);\n    setItemForm(initialData || { ...EMPTY_ITEM_FORM });\n    setActiveModal(MODALS.ADD_ITEM);\n  }, []);\n\n  const openEditItemModal = useCallback((item) => {\n    setEditingItemId(item.id);\n    setItemForm({\n      name: item.name || '',\n      code: item.code || '',\n      category: item.category || '',\n      subcategory: item.subcategory || '',\n      status: item.status || 'available',\n      condition: item.condition || 'excellent',\n      location: item.location || '',\n      sublocation: item.sublocation || '',\n      value: item.value || '',\n      serialNumber: item.serialNumber || '',\n      manufacturer: item.manufacturer || '',\n      model: item.model || '',\n      purchaseDate: item.purchaseDate || '',\n      purchasePrice: item.purchasePrice || '',\n      vendor: item.vendor || '',\n      warrantyExpires: item.warrantyExpires || '',\n      description: item.description || '',\n      image: item.image || '',\n      tags: item.tags || [],\n      specs: item.specs || {},\n      customFields: item.customFields || {},\n    });\n    setActiveModal(MODALS.ADD_ITEM);\n  }, []);\n\n  const closeItemModal = useCallback(() => {\n    setActiveModal(null);\n    setEditingItemId(null);\n    setItemForm({ ...EMPTY_ITEM_FORM });\n  }, []);\n\n  // ============================================================================\n  // Reservation Modal Handlers\n  // ============================================================================\n\n  const openAddReservationModal = useCallback((item) => {\n    setEditingReservationId(null);\n    setReservationForm({ ...EMPTY_RESERVATION_FORM });\n    setModalData(item);\n    setActiveModal(MODALS.ADD_RESERVATION);\n  }, []);\n\n  const openEditReservationModal = useCallback((reservation, item) => {\n    setEditingReservationId(reservation.id);\n    setReservationForm({\n      name: reservation.name || '',\n      start: reservation.start || '',\n      end: reservation.end || '',\n      clientId: reservation.clientId || '',\n      clientName: reservation.clientName || '',\n      project: reservation.project || '',\n      notes: reservation.notes || '',\n      status: reservation.status || 'pending',\n    });\n    setModalData(item);\n    setActiveModal(MODALS.ADD_RESERVATION);\n  }, []);\n\n  const closeReservationModal = useCallback(() => {\n    setActiveModal(null);\n    setEditingReservationId(null);\n    setReservationForm({ ...EMPTY_RESERVATION_FORM });\n    setModalData(null);\n  }, []);\n\n  // ============================================================================\n  // Check-Out/Check-In\n  // ============================================================================\n\n  const openCheckOutModal = useCallback((item) => {\n    setModalData(item);\n    setActiveModal(MODALS.CHECK_OUT);\n  }, []);\n\n  const openCheckInModal = useCallback((item) => {\n    setModalData(item);\n    setActiveModal(MODALS.CHECK_IN);\n  }, []);\n\n  // ============================================================================\n  // Other Modal Handlers\n  // ============================================================================\n\n  const openQRModal = useCallback((item) => {\n    setModalData(item);\n    setActiveModal(MODALS.QR_CODE);\n  }, []);\n\n  const openExportModal = useCallback((options = {}) => {\n    setModalData(options);\n    setActiveModal(MODALS.EXPORT);\n  }, []);\n\n  const openMaintenanceModal = useCallback((item, record = null) => {\n    setModalData({ item, record });\n    setActiveModal(MODALS.MAINTENANCE);\n  }, []);\n\n  const openCSVImportModal = useCallback(() => setActiveModal(MODALS.CSV_IMPORT), []);\n  const openQRScannerModal = useCallback(() => setActiveModal(MODALS.QR_SCANNER), []);\n\n  const openImageSelectorModal = useCallback((onSelect) => {\n    setModalData({ onSelect });\n    setActiveModal(MODALS.IMAGE_SELECTOR);\n  }, []);\n\n  // ============================================================================\n  // Bulk Action Handlers\n  // ============================================================================\n\n  const openBulkStatusModal = useCallback((ids) => {\n    setModalData({ ids });\n    setActiveModal(MODALS.BULK_STATUS);\n  }, []);\n\n  const openBulkLocationModal = useCallback((ids) => {\n    setModalData({ ids });\n    setActiveModal(MODALS.BULK_LOCATION);\n  }, []);\n\n  const openBulkCategoryModal = useCallback((ids) => {\n    setModalData({ ids });\n    setActiveModal(MODALS.BULK_CATEGORY);\n  }, []);\n\n  const openBulkDeleteModal = useCallback((ids) => {\n    setModalData({ ids });\n    setActiveModal(MODALS.BULK_DELETE);\n  }, []);\n\n  // ============================================================================\n  // Confirm Dialog\n  // ============================================================================\n\n  const showConfirm = useCallback(({ title, message, confirmText = 'Confirm', cancelText = 'Cancel', variant = 'default', onConfirm, onCancel }) => {\n    setConfirmDialog({ isOpen: true, title, message, confirmText, cancelText, variant, onConfirm, onCancel });\n  }, []);\n\n  const showDeleteConfirm = useCallback((itemName, onConfirm) => {\n    showConfirm({\n      title: 'Delete Item',\n      message: `Are you sure you want to delete \"${itemName}\"? This action cannot be undone.`,\n      confirmText: 'Delete',\n      cancelText: 'Cancel',\n      variant: 'danger',\n      onConfirm,\n    });\n  }, [showConfirm]);\n\n  const closeConfirm = useCallback(() => {\n    setConfirmDialog(prev => ({ ...prev, isOpen: false }));\n  }, []);\n\n  const handleConfirm = useCallback(() => {\n    if (confirmDialog.onConfirm) confirmDialog.onConfirm();\n    closeConfirm();\n  }, [confirmDialog.onConfirm, closeConfirm]);\n\n  const handleCancel = useCallback(() => {\n    if (confirmDialog.onCancel) confirmDialog.onCancel();\n    closeConfirm();\n  }, [confirmDialog.onCancel, closeConfirm]);\n\n  // ============================================================================\n  // Form Helpers\n  // ============================================================================\n\n  const updateItemForm = useCallback((field, value) => {\n    setItemForm(prev => ({ ...prev, [field]: value }));\n  }, []);\n\n  const updateReservationForm = useCallback((field, value) => {\n    setReservationForm(prev => ({ ...prev, [field]: value }));\n  }, []);\n\n  const resetItemForm = useCallback(() => {\n    setItemForm({ ...EMPTY_ITEM_FORM });\n    setEditingItemId(null);\n  }, []);\n\n  const resetReservationForm = useCallback(() => {\n    setReservationForm({ ...EMPTY_RESERVATION_FORM });\n    setEditingReservationId(null);\n  }, []);\n\n  // ============================================================================\n  // Memoized context value\n  // ============================================================================\n  const value = useMemo(() => ({\n    activeModal, setActiveModal, modalData, setModalData, openModal, closeModal, isModalOpen,\n    editingItemId, setEditingItemId, editingReservationId, setEditingReservationId,\n    isEditing: editingItemId !== null || editingReservationId !== null,\n    itemForm, setItemForm, updateItemForm, resetItemForm,\n    reservationForm, setReservationForm, updateReservationForm, resetReservationForm,\n    openAddItemModal, openEditItemModal, closeItemModal,\n    openAddReservationModal, openEditReservationModal, closeReservationModal,\n    openCheckOutModal, openCheckInModal,\n    openQRModal, openExportModal, openMaintenanceModal,\n    openCSVImportModal, openQRScannerModal, openImageSelectorModal,\n    openBulkStatusModal, openBulkLocationModal, openBulkCategoryModal, openBulkDeleteModal,\n    confirmDialog, setConfirmDialog, showConfirm, showDeleteConfirm,\n    closeConfirm, handleConfirm, handleCancel,\n  }), [\n    activeModal, modalData, editingItemId, editingReservationId,\n    itemForm, reservationForm, confirmDialog,\n    openModal, closeModal, isModalOpen,\n    updateItemForm, resetItemForm, updateReservationForm, resetReservationForm,\n    openAddItemModal, openEditItemModal, closeItemModal,\n    openAddReservationModal, openEditReservationModal, closeReservationModal,\n    openCheckOutModal, openCheckInModal,\n    openQRModal, openExportModal, openMaintenanceModal,\n    openCSVImportModal, openQRScannerModal, openImageSelectorModal,\n    openBulkStatusModal, openBulkLocationModal, openBulkCategoryModal, openBulkDeleteModal,\n    showConfirm, showDeleteConfirm, closeConfirm, handleConfirm, handleCancel,\n  ]);\n\n  return (\n    <ModalContext.Provider value={value}>\n      {children}\n    </ModalContext.Provider>\n  );\n}\n\nexport function useModalContext() {\n  const ctx = useContext(ModalContext);\n  if (!ctx) throw new Error('useModalContext must be used within ModalProvider');\n  return ctx;\n}\n\nexport default ModalContext;\n","// =============================================================================\n// SidebarContext\n// Provides sidebar state via context so toggling sidebar only re-renders\n// sidebar-dependent components  not the entire App tree.\n// =============================================================================\n\nimport React, { createContext, useContext, useState, useEffect, useCallback, useMemo } from 'react';\n\nconst SidebarContext = createContext(null);\n\n// Safe localStorage wrapper\nconst safeLocalStorage = {\n  getItem(key) { try { return localStorage.getItem(key); } catch { return null; } },\n  setItem(key, value) { try { localStorage.setItem(key, value); } catch { /* ignore */ } },\n};\n\nexport function SidebarProvider({ children, storageKey = 'sims-sidebar-collapsed', defaultCollapsed = false, mobileBreakpoint = 768 }) {\n  const [sidebarOpen, setSidebarOpen] = useState(false);\n\n  const [sidebarCollapsed, setSidebarCollapsed] = useState(() => {\n    const saved = safeLocalStorage.getItem(storageKey);\n    return saved === 'true' ? true : defaultCollapsed;\n  });\n\n  const [isMobile, setIsMobile] = useState(() => {\n    if (typeof window === 'undefined') return false;\n    return window.innerWidth < mobileBreakpoint;\n  });\n\n  // Persist collapsed state\n  useEffect(() => {\n    safeLocalStorage.setItem(storageKey, String(sidebarCollapsed));\n  }, [sidebarCollapsed, storageKey]);\n\n  // Responsive resize\n  useEffect(() => {\n    const handleResize = () => {\n      const mobile = window.innerWidth < mobileBreakpoint;\n      setIsMobile(mobile);\n      if (!mobile && sidebarOpen) setSidebarOpen(false);\n    };\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, [mobileBreakpoint, sidebarOpen]);\n\n  // Escape key closes mobile sidebar\n  useEffect(() => {\n    const handleEscape = (e) => { if (e.key === 'Escape' && sidebarOpen) setSidebarOpen(false); };\n    document.addEventListener('keydown', handleEscape);\n    return () => document.removeEventListener('keydown', handleEscape);\n  }, [sidebarOpen]);\n\n  // Prevent body scroll when mobile sidebar is open\n  useEffect(() => {\n    document.body.style.overflow = (sidebarOpen && isMobile) ? 'hidden' : '';\n    return () => { document.body.style.overflow = ''; };\n  }, [sidebarOpen, isMobile]);\n\n  // Handlers\n  const toggleSidebarOpen = useCallback(() => setSidebarOpen(prev => !prev), []);\n  const openSidebar = useCallback(() => setSidebarOpen(true), []);\n  const closeSidebar = useCallback(() => setSidebarOpen(false), []);\n  const toggleSidebarCollapsed = useCallback(() => setSidebarCollapsed(prev => !prev), []);\n  const collapseSidebar = useCallback(() => setSidebarCollapsed(true), []);\n  const expandSidebar = useCallback(() => setSidebarCollapsed(false), []);\n  const handleNavClick = useCallback(() => { if (isMobile) setSidebarOpen(false); }, [isMobile]);\n\n  // Computed\n  const sidebarWidth = sidebarCollapsed ? 64 : 256;\n  const mainContentMargin = isMobile ? 0 : sidebarWidth;\n\n  const value = useMemo(() => ({\n    sidebarOpen, setSidebarOpen, sidebarCollapsed, setSidebarCollapsed, isMobile,\n    toggleSidebarOpen, openSidebar, closeSidebar,\n    toggleSidebarCollapsed, collapseSidebar, expandSidebar, handleNavClick,\n    sidebarWidth, mainContentMargin,\n    isExpanded: !sidebarCollapsed,\n    showOverlay: sidebarOpen && isMobile,\n  }), [\n    sidebarOpen, sidebarCollapsed, isMobile, sidebarWidth, mainContentMargin,\n    toggleSidebarOpen, openSidebar, closeSidebar,\n    toggleSidebarCollapsed, collapseSidebar, expandSidebar, handleNavClick,\n  ]);\n\n  return (\n    <SidebarContext.Provider value={value}>\n      {children}\n    </SidebarContext.Provider>\n  );\n}\n\nexport function useSidebarContext() {\n  const ctx = useContext(SidebarContext);\n  if (!ctx) throw new Error('useSidebarContext must be used within SidebarProvider');\n  return ctx;\n}\n\nexport default SidebarContext;\n","// ============================================================================\n// Checkout & Maintenance Handlers\n// Extracted from App.jsx  manages check-out, check-in, and maintenance flows\n// ============================================================================\nimport { useState, useCallback } from 'react';\nimport { STATUS, MODALS } from '../../constants.js';\nimport { updateById } from '../../utils.js';\nimport { error as logError } from '../../lib/logger.js';\n\nexport function useCheckoutHandlers({\n  inventory,\n  setInventory,\n  selectedItem,\n  setSelectedItem,\n  dataContext,\n  currentUser,\n  openModal,\n  closeModal,\n  addAuditLog,\n  addChangeLog,\n}) {\n  // Local state\n  const [checkoutItem, setCheckoutItem] = useState(null);\n  const [checkinItemData, setCheckinItemData] = useState(null);\n  const [maintenanceItem, setMaintenanceItem] = useState(null);\n  const [editingMaintenanceRecord, setEditingMaintenanceRecord] = useState(null);\n\n  // ---- Checkout ----\n\n  const openCheckoutModal = useCallback((id) => {\n    const item = inventory.find(i => i.id === id);\n    if (item) {\n      setCheckoutItem(item);\n      openModal(MODALS.CHECK_OUT);\n    }\n  }, [inventory, openModal]);\n\n  const openCheckinModal = useCallback((id) => {\n    const item = inventory.find(i => i.id === id);\n    if (item) {\n      setCheckinItemData(item);\n      openModal(MODALS.CHECK_IN);\n    }\n  }, [inventory, openModal]);\n\n  const processCheckout = useCallback(async (checkoutData) => {\n    const { itemId, borrowerName, borrowerEmail, borrowerPhone, project, projectType, dueDate, notes, conditionAtCheckout, checkedOutDate, checkedOutTime } = checkoutData;\n    \n    try {\n      await dataContext.checkOutItem(itemId, {\n        userId: currentUser?.id,\n        userName: borrowerName,\n        clientId: null,\n        clientName: null,\n        project: project,\n        dueBack: dueDate\n      });\n      \n      if (selectedItem?.id === itemId) {\n        setSelectedItem(prev => ({ \n          ...prev, \n          status: STATUS.CHECKED_OUT,\n          checkedOutTo: borrowerName,\n          checkedOutDate: checkedOutDate,\n          dueBack: dueDate,\n          checkoutProject: project,\n          checkoutProjectType: projectType,\n          checkoutCount: (prev.checkoutCount || 0) + 1\n        }));\n      }\n      \n      addAuditLog({\n        type: 'item_checkout',\n        description: `${checkoutItem?.name || itemId} checked out to ${borrowerName}`,\n        user: currentUser?.name || 'Unknown',\n        itemId: itemId\n      });\n      \n      addChangeLog({\n        type: 'checkout',\n        itemId: itemId,\n        itemType: 'item',\n        itemName: checkoutItem?.name || itemId,\n        description: `Checked out to ${borrowerName} for ${project || 'unspecified project'}`,\n        changes: [\n          { field: 'status', oldValue: STATUS.AVAILABLE, newValue: STATUS.CHECKED_OUT },\n          { field: 'checkedOutTo', newValue: borrowerName },\n          { field: 'dueBack', newValue: dueDate }\n        ]\n      });\n      \n      if (borrowerEmail && dataContext?.sendCheckoutEmail) {\n        dataContext.sendCheckoutEmail({\n          borrowerEmail,\n          borrowerName,\n          item: checkoutItem || { id: itemId, name: itemId },\n          checkoutDate: checkedOutDate,\n          dueDate,\n          project\n        }).catch(err => logError('Email send failed:', err));\n      }\n    } catch (err) {\n      logError('Checkout process failed:', err);\n      alert('Checkout failed: ' + (err.message || 'Please try again.'));\n    } finally {\n      closeModal();\n      setCheckoutItem(null);\n    }\n  }, [currentUser, selectedItem, checkoutItem, closeModal, addAuditLog, addChangeLog, dataContext, inventory]);\n\n  const processCheckin = useCallback(async (checkinData) => {\n    const { itemId, returnedBy, condition, conditionChanged, conditionAtCheckout, conditionNotes, returnNotes, damageReported, damageDescription, returnDate, returnTime } = checkinData;\n    \n    try {\n    const currentItem = inventory.find(i => i.id === itemId);\n    const newStatus = damageReported ? STATUS.NEEDS_ATTENTION : STATUS.AVAILABLE;\n    \n    await dataContext.checkInItem(itemId, {\n      returnedBy,\n      userId: currentUser?.id,\n      condition,\n      conditionNotes,\n      returnNotes,\n      damageReported,\n      damageDescription\n    });\n    \n    if (selectedItem?.id === itemId) {\n      setSelectedItem(prev => ({ \n        ...prev, \n        status: newStatus,\n        condition: condition,\n        checkedOutTo: null,\n        checkedOutDate: null,\n        dueBack: null,\n        checkoutProject: null\n      }));\n    }\n    \n    addAuditLog({\n      type: 'item_checkin',\n      description: `${checkinItemData?.name || itemId} returned by ${returnedBy}${damageReported ? ' (damage reported)' : ''}`,\n      user: currentUser?.name || 'Unknown',\n      itemId: itemId\n    });\n    \n    addChangeLog({\n      type: 'checkin',\n      itemId: itemId,\n      itemType: 'item',\n      itemName: checkinItemData?.name || itemId,\n      description: `Returned by ${returnedBy}${conditionChanged ? ` (condition: ${conditionAtCheckout}  ${condition})` : ''}`,\n      changes: [\n        { field: 'status', oldValue: STATUS.CHECKED_OUT, newValue: damageReported ? STATUS.NEEDS_ATTENTION : STATUS.AVAILABLE },\n        { field: 'returnedBy', newValue: returnedBy },\n        ...(conditionChanged ? [{ field: 'condition', oldValue: conditionAtCheckout, newValue: condition }] : [])\n      ]\n    });\n    \n    const lastCheckout = currentItem?.checkoutHistory?.filter(h => h.type === 'checkout').pop();\n    const borrowerEmail = lastCheckout?.borrowerEmail;\n    if (borrowerEmail && dataContext?.sendCheckinEmail) {\n      dataContext.sendCheckinEmail({\n        borrowerEmail,\n        borrowerName: returnedBy,\n        item: checkinItemData || currentItem || { id: itemId, name: itemId },\n        returnDate\n      }).catch(err => logError('Email send failed:', err));\n    }\n    \n    } catch (err) {\n      logError('Checkin process failed:', err);\n      alert('Check-in failed: ' + (err.message || 'Please try again.'));\n    } finally {\n      closeModal();\n      setCheckinItemData(null);\n    }\n  }, [currentUser, selectedItem, checkinItemData, closeModal, addAuditLog, addChangeLog, dataContext, inventory]);\n\n  // ---- Maintenance ----\n\n  const openMaintenanceModal = useCallback(() => {\n    if (selectedItem) {\n      setMaintenanceItem(selectedItem);\n      setEditingMaintenanceRecord(null);\n      openModal(MODALS.MAINTENANCE);\n    }\n  }, [selectedItem, openModal]);\n\n  const saveMaintenance = useCallback(async (record) => {\n    if (!maintenanceItem) return;\n\n    const itemId = maintenanceItem.id;\n    const isEdit = !!editingMaintenanceRecord;\n    const tempId = record.id;\n\n    setInventory(prev => updateById(prev, itemId, item => {\n      const existingHistory = item.maintenanceHistory || [];\n      let newHistory;\n      \n      if (isEdit) {\n        newHistory = existingHistory.map(m => m.id === record.id ? record : m);\n      } else {\n        newHistory = [...existingHistory, record];\n      }\n      \n      return { maintenanceHistory: newHistory };\n    }));\n\n    if (selectedItem?.id === itemId) {\n      setSelectedItem(prev => {\n        const existingHistory = prev.maintenanceHistory || [];\n        let newHistory;\n        \n        if (isEdit) {\n          newHistory = existingHistory.map(m => m.id === record.id ? record : m);\n        } else {\n          newHistory = [...existingHistory, record];\n        }\n        \n        return { ...prev, maintenanceHistory: newHistory };\n      });\n    }\n\n    if (isEdit) {\n      dataContext.updateMaintenance(record.id, record);\n    } else {\n      const dbResult = await dataContext.addMaintenance(itemId, record);\n      if (dbResult?.id && dbResult.id !== tempId) {\n        const swapId = (history) => (history || []).map(m => \n          m.id === tempId ? { ...m, id: dbResult.id } : m\n        );\n        setInventory(prev => updateById(prev, itemId, item => ({\n          maintenanceHistory: swapId(item.maintenanceHistory)\n        })));\n        if (selectedItem?.id === itemId) {\n          setSelectedItem(prev => ({ ...prev, maintenanceHistory: swapId(prev.maintenanceHistory) }));\n        }\n      }\n    }\n\n    addAuditLog({\n      type: isEdit ? 'maintenance_updated' : 'maintenance_added',\n      description: `${isEdit ? 'Updated' : 'Added'} ${record.type} for ${maintenanceItem.name}`,\n      user: currentUser?.name || 'Unknown',\n      itemId: itemId\n    });\n    \n    addChangeLog({\n      type: 'maintenance',\n      itemId: itemId,\n      itemType: 'item',\n      itemName: maintenanceItem.name,\n      description: `${isEdit ? 'Updated' : 'Added'} maintenance: ${record.type}`,\n      changes: [{ field: 'maintenance', newValue: `${record.type} - ${record.description || record.status}` }]\n    });\n\n    closeModal();\n    setMaintenanceItem(null);\n    setEditingMaintenanceRecord(null);\n  }, [maintenanceItem, editingMaintenanceRecord, selectedItem, currentUser, closeModal, addAuditLog, addChangeLog]);\n\n  const updateMaintenanceStatus = useCallback((recordId, newStatus) => {\n    if (!selectedItem) return;\n\n    const itemId = selectedItem.id;\n    const completedDate = newStatus === 'completed' ? new Date().toISOString().split('T')[0] : null;\n\n    setInventory(prev => updateById(prev, itemId, item => ({\n      maintenanceHistory: (item.maintenanceHistory || []).map(m => \n        m.id === recordId \n          ? { ...m, status: newStatus, completedDate: completedDate || m.completedDate, updatedAt: new Date().toISOString() }\n          : m\n      )\n    })));\n\n    setSelectedItem(prev => ({\n      ...prev,\n      maintenanceHistory: (prev.maintenanceHistory || []).map(m =>\n        m.id === recordId\n          ? { ...m, status: newStatus, completedDate: completedDate || m.completedDate, updatedAt: new Date().toISOString() }\n          : m\n      )\n    }));\n\n    addAuditLog({\n      type: 'maintenance_status_changed',\n      description: `Maintenance status changed to ${newStatus} for ${selectedItem.name}`,\n      user: currentUser?.name || 'Unknown',\n      itemId: itemId\n    });\n  }, [selectedItem, currentUser, addAuditLog]);\n\n  return {\n    // Checkout state\n    checkoutItem,\n    checkinItemData,\n    // Checkout handlers\n    openCheckoutModal,\n    openCheckinModal,\n    processCheckout,\n    processCheckin,\n    // Maintenance state\n    maintenanceItem,\n    setMaintenanceItem,\n    editingMaintenanceRecord,\n    setEditingMaintenanceRecord,\n    // Maintenance handlers\n    openMaintenanceModal,\n    saveMaintenance,\n    updateMaintenanceStatus,\n  };\n}\n","// ============================================================================\n// Kit, Accessories & Image Handlers\n// Extracted from App.jsx  manages kit/container items, accessories, and images\n// ============================================================================\nimport { useCallback } from 'react';\nimport { updateById } from '../../utils.js';\nimport { error as logError } from '../../lib/logger.js';\n\nexport function useKitHandlers({\n  inventory,\n  setInventory,\n  selectedItem,\n  setSelectedItem,\n  dataContext,\n  currentUser,\n  closeModal,\n  addAuditLog,\n  addChangeLog,\n}) {\n  // ---- Kit / Container ----\n\n  const setItemAsKit = useCallback((kitType) => {\n    if (!selectedItem) return;\n\n    setInventory(prev => updateById(prev, selectedItem.id, {\n      isKit: true,\n      kitType: kitType,\n      childItemIds: [],\n    }));\n\n    setSelectedItem(prev => ({\n      ...prev,\n      isKit: true,\n      kitType: kitType,\n      childItemIds: [],\n    }));\n\n    addAuditLog({\n      type: 'item_converted_to_kit',\n      description: `${selectedItem.name} converted to ${kitType}`,\n      user: currentUser?.name || 'Unknown',\n      itemId: selectedItem.id\n    });\n    \n    addChangeLog({\n      type: 'updated',\n      itemId: selectedItem.id,\n      itemType: 'item',\n      itemName: selectedItem.name,\n      description: `Converted \"${selectedItem.name}\" to ${kitType}`,\n      changes: [{ field: 'kitType', oldValue: null, newValue: kitType }]\n    });\n  }, [selectedItem, currentUser, addAuditLog, addChangeLog]);\n\n  const addItemsToKit = useCallback((childIds) => {\n    if (!selectedItem || !selectedItem.isKit) return;\n\n    const newChildIds = [...(selectedItem.childItemIds || []), ...childIds];\n    const addedItems = inventory.filter(i => childIds.includes(i.id));\n\n    setInventory(prev => {\n      let updated = updateById(prev, selectedItem.id, { childItemIds: newChildIds });\n      childIds.forEach(childId => {\n        updated = updateById(updated, childId, { parentKitId: selectedItem.id });\n      });\n      return updated;\n    });\n\n    setSelectedItem(prev => ({\n      ...prev,\n      childItemIds: newChildIds,\n    }));\n\n    addAuditLog({\n      type: 'items_added_to_kit',\n      description: `${childIds.length} item(s) added to kit ${selectedItem.name}`,\n      user: currentUser?.name || 'Unknown',\n      itemId: selectedItem.id\n    });\n    \n    addChangeLog({\n      type: 'updated',\n      itemId: selectedItem.id,\n      itemType: 'item',\n      itemName: selectedItem.name,\n      description: `Added ${childIds.length} item(s) to kit \"${selectedItem.name}\"`,\n      changes: addedItems.map(item => ({ \n        field: 'kitContents', \n        oldValue: null, \n        newValue: `+ ${item.name} (${item.id})` \n      }))\n    });\n  }, [selectedItem, currentUser, inventory, addAuditLog, addChangeLog]);\n\n  const removeItemFromKit = useCallback((childId) => {\n    if (!selectedItem || !selectedItem.isKit) return;\n\n    const removedItem = inventory.find(i => i.id === childId);\n    const newChildIds = (selectedItem.childItemIds || []).filter(id => id !== childId);\n\n    setInventory(prev => {\n      let updated = updateById(prev, selectedItem.id, { childItemIds: newChildIds });\n      updated = updateById(updated, childId, { parentKitId: null });\n      return updated;\n    });\n\n    setSelectedItem(prev => ({\n      ...prev,\n      childItemIds: newChildIds,\n    }));\n    \n    if (removedItem) {\n      addChangeLog({\n        type: 'updated',\n        itemId: selectedItem.id,\n        itemType: 'item',\n        itemName: selectedItem.name,\n        description: `Removed \"${removedItem.name}\" from kit \"${selectedItem.name}\"`,\n        changes: [{ \n          field: 'kitContents', \n          oldValue: `${removedItem.name} (${removedItem.id})`, \n          newValue: null \n        }]\n      });\n    }\n  }, [selectedItem, inventory, addChangeLog]);\n\n  const clearKitItems = useCallback(() => {\n    if (!selectedItem || !selectedItem.isKit) return;\n\n    const childIds = selectedItem.childItemIds || [];\n    const clearedItems = inventory.filter(i => childIds.includes(i.id));\n\n    setInventory(prev => {\n      let updated = updateById(prev, selectedItem.id, { childItemIds: [] });\n      childIds.forEach(childId => {\n        updated = updateById(updated, childId, { parentKitId: null });\n      });\n      return updated;\n    });\n\n    setSelectedItem(prev => ({\n      ...prev,\n      childItemIds: [],\n    }));\n\n    addAuditLog({\n      type: 'kit_cleared',\n      description: `All items removed from kit ${selectedItem.name}`,\n      user: currentUser?.name || 'Unknown',\n      itemId: selectedItem.id\n    });\n    \n    if (clearedItems.length > 0) {\n      addChangeLog({\n        type: 'updated',\n        itemId: selectedItem.id,\n        itemType: 'item',\n        itemName: selectedItem.name,\n        description: `Cleared all ${clearedItems.length} item(s) from kit \"${selectedItem.name}\"`,\n        changes: clearedItems.map(item => ({ \n          field: 'kitContents', \n          oldValue: `${item.name} (${item.id})`, \n          newValue: null \n        }))\n      });\n    }\n  }, [selectedItem, currentUser, inventory, addAuditLog, addChangeLog]);\n\n  // ---- Required Accessories ----\n\n  const addRequiredAccessories = useCallback((itemId, accessoryIds) => {\n    if (!itemId || !accessoryIds || accessoryIds.length === 0) return;\n    \n    const targetItem = inventory.find(i => i.id === itemId);\n    if (!targetItem) return;\n    \n    const existingAccessories = targetItem.requiredAccessories || [];\n    const newAccessories = [...new Set([...existingAccessories, ...accessoryIds])];\n    \n    setInventory(prev => updateById(prev, itemId, { requiredAccessories: newAccessories }));\n    \n    if (selectedItem?.id === itemId) {\n      setSelectedItem(prev => ({ ...prev, requiredAccessories: newAccessories }));\n    }\n    \n    const addedItems = accessoryIds.map(id => inventory.find(i => i.id === id)).filter(Boolean);\n    addChangeLog({\n      type: 'updated',\n      itemId: itemId,\n      itemType: 'item',\n      itemName: targetItem.name,\n      description: `Added ${addedItems.length} required accessor${addedItems.length === 1 ? 'y' : 'ies'}`,\n      changes: addedItems.map(item => ({ \n        field: 'requiredAccessories', \n        oldValue: null, \n        newValue: `${item.name} (${item.id})` \n      }))\n    });\n  }, [inventory, selectedItem, addChangeLog]);\n\n  const removeRequiredAccessory = useCallback((itemId, accessoryId) => {\n    if (!itemId || !accessoryId) return;\n    \n    const targetItem = inventory.find(i => i.id === itemId);\n    if (!targetItem) return;\n    \n    const removedItem = inventory.find(i => i.id === accessoryId);\n    const existingAccessories = targetItem.requiredAccessories || [];\n    const newAccessories = existingAccessories.filter(id => id !== accessoryId);\n    \n    setInventory(prev => updateById(prev, itemId, { requiredAccessories: newAccessories }));\n    \n    if (selectedItem?.id === itemId) {\n      setSelectedItem(prev => ({ ...prev, requiredAccessories: newAccessories }));\n    }\n    \n    if (removedItem) {\n      addChangeLog({\n        type: 'updated',\n        itemId: itemId,\n        itemType: 'item',\n        itemName: targetItem.name,\n        description: `Removed required accessory: ${removedItem.name}`,\n        changes: [{ \n          field: 'requiredAccessories', \n          oldValue: `${removedItem.name} (${removedItem.id})`, \n          newValue: null \n        }]\n      });\n    }\n  }, [inventory, selectedItem, addChangeLog]);\n\n  // ---- Image ----\n\n  const selectImage = useCallback(async (image) => {\n    if (selectedItem) {\n      setInventory(prev => updateById(prev, selectedItem.id, { image }));\n      setSelectedItem(prev => ({ ...prev, image }));\n      \n      {\n        try {\n          await dataContext.updateItem(selectedItem.id, { image });\n        } catch (err) {\n          logError('Failed to save image:', err);\n        }\n      }\n    }\n    closeModal();\n  }, [selectedItem, closeModal, dataContext]);\n\n  return {\n    // Kit\n    setItemAsKit,\n    addItemsToKit,\n    removeItemFromKit,\n    clearKitItems,\n    // Accessories\n    addRequiredAccessories,\n    removeRequiredAccessory,\n    // Image\n    selectImage,\n  };\n}\n","// ============================================================================\n// Reservation Handlers\n// Extracted from App.jsx  manages reservation CRUD flows\n// ============================================================================\nimport { useCallback } from 'react';\nimport { VIEWS, MODALS } from '../../constants.js';\nimport { generateId, updateById } from '../../utils.js';\nimport { error as logError } from '../../lib/logger.js';\n\nexport function useReservationHandlers({\n  inventory,\n  setInventory,\n  selectedItem,\n  setSelectedItem,\n  dataContext,\n  openModal,\n  closeModal,\n  addChangeLog,\n  addAuditLog,\n  currentUser,\n  // Reservation-specific state (from navigation/modal contexts)\n  reservationForm,\n  setReservationForm,\n  editingReservationId,\n  setEditingReservationId,\n  selectedReservationItem,\n  selectedReservation,\n  setSelectedReservation,\n  setCurrentView,\n  resetReservationForm,\n  navigateToReservation,\n  showConfirm,\n}) {\n  const saveReservation = useCallback(async () => {\n    if (editingReservationId) {\n      const updatedReservation = {\n        ...reservationForm,\n        id: editingReservationId,\n        dueBack: reservationForm.end\n      };\n\n      const currentItem = inventory.find(i => i.id === selectedReservationItem.id);\n      const updatedReservations = (currentItem.reservations || []).map(r => \n        r.id === editingReservationId ? updatedReservation : r\n      );\n      \n      {\n        try {\n          await dataContext.updateReservation(editingReservationId, reservationForm);\n        } catch (err) {\n          logError('Failed to update reservation:', err);\n        }\n      }\n      \n      setInventory(prev => updateById(prev, selectedReservationItem.id, item => ({\n        reservations: (item.reservations || []).map(r => \n          r.id === editingReservationId ? updatedReservation : r\n        )\n      })));\n\n      setSelectedReservation(updatedReservation);\n      if (selectedItem?.id === selectedReservationItem.id) {\n        setSelectedItem(prev => ({\n          ...prev,\n          reservations: (prev.reservations || []).map(r => \n            r.id === editingReservationId ? updatedReservation : r\n          )\n        }));\n      }\n      \n      addChangeLog({\n        type: 'updated',\n        itemId: selectedReservationItem.id,\n        itemType: 'item',\n        itemName: selectedReservationItem.name,\n        description: `Updated reservation for ${reservationForm.project}`,\n        changes: [{ field: 'reservation', newValue: `${reservationForm.project} (${reservationForm.start} - ${reservationForm.end})` }]\n      });\n      addAuditLog?.({\n        type: 'reservation_updated',\n        description: `Updated reservation: ${reservationForm.project} for ${selectedReservationItem.name}`,\n        itemId: selectedReservationItem.id,\n        user: currentUser?.name || 'Unknown',\n      });\n      \n      setEditingReservationId(null);\n    } else {\n      // Creating new reservation(s) - support multiple items\n      const itemIds = reservationForm.itemIds?.length \n        ? reservationForm.itemIds \n        : (reservationForm.itemId ? [reservationForm.itemId] : [selectedItem?.id || selectedReservationItem?.id].filter(Boolean));\n      \n      if (itemIds.length === 0) {\n        logError('No items selected for reservation');\n        return;\n      }\n      \n      let firstCreatedReservation = null;\n      for (const targetItemId of itemIds) {\n        const targetItem = inventory.find(i => i.id === targetItemId);\n        if (!targetItem) {\n          logError('Item not found:', targetItemId);\n          continue;\n        }\n        \n        const reservation = {\n          id: generateId(),\n          ...reservationForm,\n          notes: [],\n          dueBack: reservationForm.end\n        };\n\n        try {\n          const dbResult = await dataContext.createReservation(targetItemId, reservationForm);\n          if (dbResult?.id) {\n            reservation.id = dbResult.id;\n          }\n        } catch (err) {\n          logError('Failed to create reservation for', targetItemId, err);\n        }\n        \n        if (!firstCreatedReservation) {\n          firstCreatedReservation = { reservation, item: targetItem };\n        }\n        \n        setInventory(prev => updateById(prev, targetItemId, item => ({\n          reservations: [...(item.reservations || []), reservation]\n        })));\n\n        if (selectedItem?.id === targetItemId) {\n          setSelectedItem(prev => ({\n            ...prev,\n            reservations: [...(prev.reservations || []), reservation]\n          }));\n        }\n        \n        addChangeLog({\n          type: 'reservation_added',\n          itemId: targetItemId,\n          itemType: 'item',\n          itemName: targetItem.name,\n          description: `New reservation: ${reservationForm.project} (${reservationForm.start} - ${reservationForm.end})`,\n          changes: [{ field: 'reservation', newValue: reservationForm.project }]\n        });\n        addAuditLog?.({\n          type: 'reservation_created',\n          description: `Created reservation: ${reservationForm.project} for ${targetItem.name}`,\n          itemId: targetItemId,\n          user: currentUser?.name || 'Unknown',\n        });\n      }\n      \n      // Send reservation confirmation email (non-blocking) - send once for all items\n      const userEmail = reservationForm.contactEmail;\n      const firstItemId = itemIds[0];\n      const firstItem = inventory.find(i => i.id === firstItemId);\n      if (userEmail && dataContext?.sendReservationEmail && firstItem) {\n        dataContext.sendReservationEmail({\n          userEmail,\n          userName: reservationForm.user,\n          item: firstItem,\n          reservation: {\n            ...reservationForm,\n            itemCount: itemIds.length\n          }\n        }).catch(err => logError('Email send failed:', err));\n      }\n      \n      if (firstCreatedReservation) {\n        navigateToReservation(firstCreatedReservation.reservation, firstCreatedReservation.item);\n      }\n    }\n    \n    closeModal();\n    resetReservationForm();\n  }, [reservationForm, editingReservationId, selectedItem, selectedReservationItem, closeModal, resetReservationForm, navigateToReservation, addChangeLog, dataContext, inventory]);\n\n  const openEditReservation = useCallback((reservation) => {\n    setEditingReservationId(reservation.id);\n    setReservationForm({\n      project: reservation.project,\n      projectType: reservation.projectType || 'Other',\n      start: reservation.start,\n      end: reservation.end,\n      user: reservation.user,\n      contactPhone: reservation.contactPhone || '',\n      contactEmail: reservation.contactEmail || '',\n      location: reservation.location || ''\n    });\n    openModal(MODALS.ADD_RESERVATION);\n  }, [openModal]);\n\n  const deleteReservation = useCallback((itemId, resId) => {\n    const item = inventory.find(i => i.id === itemId);\n    const reservation = item?.reservations?.find(r => r.id === resId);\n    \n    if (!itemId || !resId) {\n      logError('[deleteReservation] Missing itemId or resId:', { itemId, resId });\n      return;\n    }\n    \n    const projectName = reservation?.project || 'Unknown';\n    const startDate = reservation?.start;\n    const endDate = reservation?.end;\n    const itemName = item?.name || itemId;\n    const currentSelectedItemId = selectedItem?.id;\n    const currentSelectedResId = selectedReservation?.id;\n    \n    // Find ALL reservations that are part of this multi-item reservation\n    const relatedReservations = [];\n    const affectedItemIds = [];\n    \n    if (reservation) {\n      inventory.forEach(invItem => {\n        (invItem.reservations || []).forEach(r => {\n          if (r.project === projectName && \n              r.start === startDate && \n              r.end === endDate) {\n            relatedReservations.push({ itemId: invItem.id, reservationId: r.id });\n            if (!affectedItemIds.includes(invItem.id)) {\n              affectedItemIds.push(invItem.id);\n            }\n          }\n        });\n      });\n    }\n    \n    const itemCount = relatedReservations.length;\n    \n    const message = itemCount > 1 \n      ? `Are you sure you want to cancel this reservation for ${itemCount} items? This action cannot be undone.`\n      : 'Are you sure you want to cancel this reservation? This action cannot be undone.';\n    \n    const reservationIdsToDelete = relatedReservations.map(r => r.reservationId);\n    const itemIdsAffected = [...affectedItemIds];\n    \n    showConfirm({\n      title: 'Cancel Reservation',\n      message,\n      confirmText: 'Cancel Reservation',\n      cancelText: 'Keep',\n      variant: 'danger',\n      onConfirm: async () => {\n        {\n          try {\n            for (const resIdToDelete of reservationIdsToDelete) {\n              await dataContext.deleteReservation(resIdToDelete);\n            }\n          } catch (err) {\n            logError('Failed to delete reservations:', err);\n          }\n        }\n        \n        setInventory(prev => prev.map(invItem => {\n          if (itemIdsAffected.includes(invItem.id)) {\n            return {\n              ...invItem,\n              reservations: (invItem.reservations || []).filter(r => !reservationIdsToDelete.includes(r.id))\n            };\n          }\n          return invItem;\n        }));\n        \n        if (itemIdsAffected.includes(currentSelectedItemId)) {\n          setSelectedItem(prev => {\n            if (!prev) return prev;\n            return {\n              ...prev,\n              reservations: (prev.reservations || []).filter(r => !reservationIdsToDelete.includes(r.id))\n            };\n          });\n        }\n        \n        if (reservationIdsToDelete.includes(currentSelectedResId)) {\n          setSelectedReservation(null);\n          setCurrentView(VIEWS.SCHEDULE);\n        }\n        \n        addChangeLog({\n          type: 'reservation_removed',\n          itemId: itemId,\n          itemType: 'item',\n          itemName: itemCount > 1 ? `${itemCount} items` : itemName,\n          description: `Cancelled reservation: ${projectName}`,\n          changes: [{ field: 'reservation', oldValue: projectName }]\n        });\n        addAuditLog?.({\n          type: 'reservation_deleted',\n          description: `Deleted reservation: ${projectName}`,\n          itemId: itemId,\n          user: currentUser?.name || 'Unknown',\n        });\n      }\n    });\n  }, [inventory, addChangeLog, addAuditLog, currentUser, dataContext, selectedItem?.id, selectedReservation?.id, showConfirm, setCurrentView, setInventory, setSelectedItem, setSelectedReservation]);\n\n  return {\n    saveReservation,\n    openEditReservation,\n    deleteReservation,\n  };\n}\n","// ============================================================================\n// Note Handlers (Items, Packages, Reservations, Clients)\n// Extracted from App.jsx  manages note CRUD for all entity types\n// ============================================================================\nimport { useState, useCallback, useMemo } from 'react';\nimport { generateId, getTodayISO, updateById, addReplyToNote, markNoteDeleted, findNoteById } from '../../utils.js';\n\nexport function useNoteHandlers({\n  selectedItem,\n  setSelectedItem,\n  setInventory,\n  selectedPackage,\n  setSelectedPackage,\n  selectedReservation,\n  setSelectedReservation,\n  selectedReservationItem,\n  setPackages,\n  setClients,\n  setAuditLog,\n  dataContext,\n  currentUser,\n}) {\n  // Client note selection state\n  const [selectedClientId, setSelectedClientId] = useState(null);\n\n  // ---- Generic note handler factory (items/packages/reservations) ----\n\n  const createNoteHandler = useCallback((entityType) => {\n    const getEntity = () => {\n      if (entityType === 'item') return selectedItem;\n      if (entityType === 'package') return selectedPackage;\n      if (entityType === 'reservation') return selectedReservation;\n      return null;\n    };\n\n    const setEntity = (updater) => {\n      if (entityType === 'item') setSelectedItem(updater);\n      else if (entityType === 'package') setSelectedPackage(updater);\n      else if (entityType === 'reservation') setSelectedReservation(updater);\n    };\n\n    const updateCollection = (entityId, notesUpdater) => {\n      if (entityType === 'item') {\n        setInventory(prev => updateById(prev, entityId, item => ({\n          notes: notesUpdater(item.notes)\n        })));\n      } else if (entityType === 'package') {\n        setPackages(prev => updateById(prev, entityId, pkg => ({\n          notes: notesUpdater(pkg.notes || [])\n        })));\n      } else if (entityType === 'reservation') {\n        setInventory(prev => updateById(prev, selectedReservationItem.id, item => ({\n          reservations: (item.reservations || []).map(r =>\n            r.id === entityId ? { ...r, notes: notesUpdater(r.notes || []) } : r\n          )\n        })));\n      }\n    };\n\n    const replaceNoteId = (notes, tempId, realId) => {\n      return notes.map(n => ({\n        ...n,\n        id: n.id === tempId ? realId : n.id,\n        replies: n.replies ? replaceNoteId(n.replies, tempId, realId) : []\n      }));\n    };\n\n    return {\n      add: async (text) => {\n        const entity = getEntity();\n        if (!text?.trim() || !entity) return;\n\n        const tempId = generateId();\n        const note = {\n          id: tempId,\n          user: currentUser.name,\n          date: getTodayISO(),\n          text: text.trim(),\n          replies: [],\n          deleted: false\n        };\n\n        const currentNotes = entity.notes || [];\n        const updatedNotes = [...currentNotes, note];\n\n        updateCollection(entity.id, () => updatedNotes);\n        setEntity(prev => ({ ...prev, notes: updatedNotes }));\n        \n        if (entityType === 'item' && dataContext?.addItemNote) {\n          const dbResult = await dataContext.addItemNote(entity.id, note);\n          if (dbResult?.id && dbResult.id !== tempId) {\n            const swapId = (notes) => replaceNoteId(notes, tempId, dbResult.id);\n            updateCollection(entity.id, swapId);\n            setEntity(prev => ({ ...prev, notes: swapId(prev.notes || []) }));\n          }\n        }\n      },\n\n      reply: async (parentId, text) => {\n        const entity = getEntity();\n        if (!text?.trim() || !entity) return;\n\n        const tempId = generateId();\n        const reply = {\n          id: tempId,\n          user: currentUser.name,\n          date: getTodayISO(),\n          text: text.trim(),\n          replies: [],\n          deleted: false,\n          parentId: parentId\n        };\n\n        const updatedNotes = addReplyToNote(entity.notes || [], parentId, reply);\n        updateCollection(entity.id, () => updatedNotes);\n        setEntity(prev => ({ ...prev, notes: updatedNotes }));\n        \n        if (entityType === 'item' && dataContext?.addItemNote) {\n          const dbResult = await dataContext.addItemNote(entity.id, reply);\n          if (dbResult?.id && dbResult.id !== tempId) {\n            const swapId = (notes) => replaceNoteId(notes, tempId, dbResult.id);\n            updateCollection(entity.id, swapId);\n            setEntity(prev => ({ ...prev, notes: swapId(prev.notes || []) }));\n          }\n        }\n      },\n\n      delete: (noteId) => {\n        const entity = getEntity();\n        if (!entity) return;\n\n        const note = findNoteById(entity.notes || [], noteId);\n        if (note) {\n          setAuditLog(prev => [...prev, {\n            type: 'note_deleted',\n            timestamp: new Date().toISOString(),\n            description: `Note deleted from ${entityType} ${entity.id}`,\n            content: note.text,\n            user: currentUser.name,\n            itemId: entity.id\n          }]);\n        }\n\n        const updatedNotes = markNoteDeleted(entity.notes || [], noteId);\n        updateCollection(entity.id, () => updatedNotes);\n        setEntity(prev => ({ ...prev, notes: updatedNotes }));\n        \n        if (entityType === 'item' && dataContext?.deleteItemNote) {\n          dataContext.deleteItemNote(noteId);\n        }\n      }\n    };\n  }, [selectedItem, selectedPackage, selectedReservation, selectedReservationItem, currentUser, dataContext, setSelectedReservation]);\n\n  // Memoized note handlers per entity type\n  const itemNoteHandlers = useMemo(() => createNoteHandler('item'), [createNoteHandler]);\n  const packageNoteHandlers = useMemo(() => createNoteHandler('package'), [createNoteHandler]);\n  const reservationNoteHandlers = useMemo(() => createNoteHandler('reservation'), [createNoteHandler]);\n\n  // ---- Client notes ----\n\n  const clientNoteHandlers = useMemo(() => ({\n    add: (clientId, text) => {\n      if (!text?.trim() || !clientId) return;\n      \n      const note = {\n        id: generateId(),\n        user: currentUser?.name || 'Unknown',\n        date: getTodayISO(),\n        text: text.trim(),\n        replies: [],\n        deleted: false\n      };\n      \n      setClients(prev => prev.map(client => \n        client.id === clientId \n          ? { ...client, clientNotes: [...(client.clientNotes || []), note] }\n          : client\n      ));\n    },\n    \n    reply: (clientId, parentId, text) => {\n      if (!text?.trim() || !clientId) return;\n      \n      const reply = {\n        id: generateId(),\n        user: currentUser?.name || 'Unknown',\n        date: getTodayISO(),\n        text: text.trim(),\n        replies: [],\n        deleted: false\n      };\n      \n      setClients(prev => prev.map(client => \n        client.id === clientId \n          ? { ...client, clientNotes: addReplyToNote(client.clientNotes || [], parentId, reply) }\n          : client\n      ));\n    },\n    \n    delete: (clientId, noteId) => {\n      if (!clientId) return;\n      \n      setClients(prev => prev.map(client => \n        client.id === clientId \n          ? { ...client, clientNotes: markNoteDeleted(client.clientNotes || [], noteId) }\n          : client\n      ));\n    }\n  }), [currentUser]);\n\n  return {\n    // Note handlers by entity type\n    itemNoteHandlers,\n    packageNoteHandlers,\n    reservationNoteHandlers,\n    clientNoteHandlers,\n    // Client selection state\n    selectedClientId,\n    setSelectedClientId,\n  };\n}\n","// ============================================================================\n// Reminder Handlers\n// Extracted from App.jsx  manages item reminder CRUD\n// ============================================================================\nimport { useCallback } from 'react';\nimport { getTodayISO, updateById } from '../../utils.js';\n\nexport function useReminderHandlers({\n  selectedItem,\n  setSelectedItem,\n  setInventory,\n  setAuditLog,\n  dataContext,\n  currentUser,\n  showConfirm,\n}) {\n  const addReminder = useCallback(async (reminder) => {\n    if (!selectedItem) return;\n    \n    const tempId = reminder.id;\n    const updatedReminders = [...(selectedItem.reminders || []), reminder];\n    \n    setInventory(prev => updateById(prev, selectedItem.id, item => ({\n      reminders: [...(item.reminders || []), reminder]\n    })));\n    setSelectedItem(prev => ({ ...prev, reminders: updatedReminders }));\n    \n    const dbResult = await dataContext.addItemReminder(selectedItem.id, {\n      ...reminder,\n      createdBy: currentUser.name\n    });\n    if (dbResult?.id && dbResult.id !== tempId) {\n      const swapId = (reminders) => (reminders || []).map(r => \n        r.id === tempId ? { ...r, id: dbResult.id } : r\n      );\n      setInventory(prev => updateById(prev, selectedItem.id, item => ({\n        reminders: swapId(item.reminders)\n      })));\n      setSelectedItem(prev => ({ ...prev, reminders: swapId(prev.reminders) }));\n    }\n    \n    setAuditLog(prev => [...prev, {\n      type: 'reminder_added',\n      timestamp: new Date().toISOString(),\n      description: `Reminder \"${reminder.title}\" added to ${selectedItem.name}`,\n      user: currentUser.name,\n      itemId: selectedItem.id\n    }]);\n  }, [selectedItem, currentUser, dataContext]);\n\n  const completeReminder = useCallback((reminderId) => {\n    if (!selectedItem) return;\n    \n    const reminder = (selectedItem.reminders || []).find(r => r.id === reminderId);\n    if (!reminder) return;\n    \n    const updatedReminders = (selectedItem.reminders || []).map(r =>\n      r.id === reminderId ? { ...r, completed: true, completedDate: getTodayISO() } : r\n    );\n    \n    setInventory(prev => updateById(prev, selectedItem.id, () => ({\n      reminders: updatedReminders\n    })));\n    setSelectedItem(prev => ({ ...prev, reminders: updatedReminders }));\n    \n    {\n      dataContext.updateItemReminder(reminderId, { completed: true, completedDate: getTodayISO() });\n    }\n    \n    setAuditLog(prev => [...prev, {\n      type: 'reminder_completed',\n      timestamp: new Date().toISOString(),\n      description: `Reminder \"${reminder.title}\" completed for ${selectedItem.name}`,\n      user: currentUser.name,\n      itemId: selectedItem.id\n    }]);\n  }, [selectedItem, currentUser, dataContext]);\n\n  const uncompleteReminder = useCallback((reminderId) => {\n    if (!selectedItem) return;\n    \n    const reminder = (selectedItem.reminders || []).find(r => r.id === reminderId);\n    if (!reminder) return;\n    \n    const updatedReminders = (selectedItem.reminders || []).map(r =>\n      r.id === reminderId ? { ...r, completed: false, completedDate: null } : r\n    );\n    \n    setInventory(prev => updateById(prev, selectedItem.id, () => ({\n      reminders: updatedReminders\n    })));\n    setSelectedItem(prev => ({ ...prev, reminders: updatedReminders }));\n    \n    {\n      dataContext.updateItemReminder(reminderId, { completed: false, completedDate: null });\n    }\n  }, [selectedItem, dataContext]);\n\n  const deleteReminder = useCallback((reminderId) => {\n    if (!selectedItem) return;\n    \n    const reminder = (selectedItem.reminders || []).find(r => r.id === reminderId);\n    \n    showConfirm({\n      title: 'Delete Reminder',\n      message: `Are you sure you want to delete \"${reminder?.title || 'this reminder'}\"?`,\n      confirmText: 'Delete',\n      variant: 'danger',\n      onConfirm: () => {\n        const updatedReminders = (selectedItem.reminders || []).filter(r => r.id !== reminderId);\n        \n        setInventory(prev => updateById(prev, selectedItem.id, () => ({\n          reminders: updatedReminders\n        })));\n        setSelectedItem(prev => ({ ...prev, reminders: updatedReminders }));\n        \n        {\n          dataContext.deleteItemReminder(reminderId);\n        }\n      }\n    });\n  }, [selectedItem, dataContext, showConfirm, setInventory, setSelectedItem]);\n\n  return {\n    addReminder,\n    completeReminder,\n    uncompleteReminder,\n    deleteReminder,\n  };\n}\n","// ============================================================================\n// Package Handlers\n// Extracted from App.jsx  manages package CRUD\n// ============================================================================\nimport { useCallback } from 'react';\nimport { VIEWS } from '../../constants.js';\nimport { updateById, removeById } from '../../utils.js';\n\nexport function usePackageHandlers({\n  packages,\n  setPackages,\n  inventory,\n  selectedPackage,\n  setSelectedPackage,\n  setCurrentView,\n  categories,\n  showConfirm,\n  addChangeLog,\n}) {\n  const deletePackage = useCallback((id) => {\n    showConfirm({\n      title: 'Delete Package',\n      message: 'Are you sure you want to delete this package? This action cannot be undone.',\n      confirmText: 'Delete',\n      variant: 'danger',\n      onConfirm: () => {\n        setPackages(prev => removeById(prev, id));\n        if (selectedPackage?.id === id) {\n          setSelectedPackage(null);\n          setCurrentView(VIEWS.PACKAGES);\n        }\n      }\n    });\n  }, [selectedPackage, showConfirm, setPackages, setSelectedPackage, setCurrentView]);\n\n  const addItemToPackage = useCallback((packageId, itemId) => {\n    const pkg = packages.find(p => p.id === packageId);\n    const item = inventory.find(i => i.id === itemId);\n    \n    if (pkg && item && !pkg.items.includes(itemId)) {\n      setPackages(prev => updateById(prev, packageId, p => ({\n        items: [...p.items, itemId]\n      })));\n      \n      addChangeLog({\n        type: 'updated',\n        itemId: packageId,\n        itemType: 'package',\n        itemName: pkg.name,\n        description: `Added \"${item.name}\" to package \"${pkg.name}\"`,\n        changes: [{ \n          field: 'packageContents', \n          oldValue: null, \n          newValue: `+ ${item.name} (${item.id})` \n        }]\n      });\n    }\n  }, [packages, inventory, addChangeLog]);\n\n  const addPackage = useCallback(() => {\n    const newId = `pkg-${Date.now()}`;\n    const newPackage = {\n      id: newId,\n      name: 'New Package',\n      description: 'Package description',\n      category: categories[0] || 'General',\n      items: [],\n      notes: []\n    };\n    setPackages(prev => [...prev, newPackage]);\n    setSelectedPackage(newPackage);\n    setCurrentView(VIEWS.PACKAGE_DETAIL);\n    \n    addChangeLog({\n      type: 'created',\n      itemId: newId,\n      itemType: 'package',\n      itemName: 'New Package',\n      description: 'Created new package',\n      changes: [{ field: 'package', oldValue: null, newValue: 'New Package' }]\n    });\n  }, [categories, addChangeLog]);\n\n  return {\n    deletePackage,\n    addItemToPackage,\n    addPackage,\n  };\n}\n","// ============================================================================\n// Login Component\n// ============================================================================\n\nimport React, { memo, useState } from 'react';\nimport { colors, styles, spacing, borderRadius, typography } from '../theme.js';\nimport { Spinner } from '../components/Loading.jsx';\n\nfunction Login({ loginForm, setLoginForm, onLogin, isLoading, error }) {\n  const [showPassword, setShowPassword] = useState(false);\n  \n  return (\n    <div style={{\n      minHeight: '100vh',\n      background: colors.bgDark,\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      fontFamily: typography.fontFamily\n    }}>\n      <div style={{\n        ...styles.card,\n        width: '100%',\n        maxWidth: 400,\n        padding: spacing[8]\n      }}>\n        {/* Logo */}\n        <div style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          gap: spacing[3],\n          marginBottom: spacing[8]\n        }}>\n          <img \n            src=\"/moe.png\" \n            alt=\"SIMS Logo\"\n            style={{\n              width: 56,\n              height: 56,\n              borderRadius: borderRadius.xl,\n              objectFit: 'cover',\n            }}\n            onError={(e) => {\n              // Fallback to gradient icon if image fails to load\n              e.target.style.display = 'none';\n              e.target.nextSibling.style.display = 'flex';\n            }}\n          />\n          <div style={{\n            width: 56,\n            height: 56,\n            borderRadius: borderRadius.xl,\n            background: 'linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)',\n            display: 'none',\n            alignItems: 'center',\n            justifyContent: 'center',\n            flexShrink: 0,\n          }}>\n            <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <path d=\"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z\"/>\n              <polyline points=\"9 22 9 12 15 12 15 22\"/>\n            </svg>\n          </div>\n          <div>\n            <h1 style={{\n              margin: 0,\n              fontSize: typography.fontSize['2xl'],\n              fontWeight: typography.fontWeight.bold,\n              color: colors.textPrimary\n            }}>\n              SIMS\n            </h1>\n            <p style={{\n              margin: 0,\n              fontSize: typography.fontSize.xs,\n              color: colors.textMuted\n            }}>\n              Studio Inventory Management System\n            </p>\n          </div>\n        </div>\n        \n        {/* Error Message */}\n        {error && (\n          <div style={{\n            background: 'rgba(239, 68, 68, 0.1)',\n            border: '1px solid rgba(239, 68, 68, 0.3)',\n            borderRadius: borderRadius.md,\n            padding: spacing[3],\n            marginBottom: spacing[4],\n            fontSize: typography.fontSize.sm,\n            color: colors.danger,\n          }}>\n            {error}\n          </div>\n        )}\n\n        {/* Login Form */}\n        <form onSubmit={onLogin}>\n          <div style={{ marginBottom: spacing[4] }}>\n            <label style={styles.label}>Email</label>\n            <input\n              type=\"email\"\n              value={loginForm.email}\n              onChange={e => setLoginForm(prev => ({ ...prev, email: e.target.value }))}\n              placeholder=\"email@example.com\"\n              style={styles.input}\n              required\n              disabled={isLoading}\n              autoComplete=\"email\"\n            />\n          </div>\n\n          <div style={{ marginBottom: spacing[6] }}>\n            <label style={styles.label}>Password</label>\n            <div style={{ position: 'relative' }}>\n              <input\n                type={showPassword ? 'text' : 'password'}\n                value={loginForm.password}\n                onChange={e => setLoginForm(prev => ({ ...prev, password: e.target.value }))}\n                placeholder=\"Enter password\"\n                style={{ ...styles.input, paddingRight: 40 }}\n                required\n                disabled={isLoading}\n                autoComplete=\"current-password\"\n              />\n              <button\n                type=\"button\"\n                onClick={() => setShowPassword(!showPassword)}\n                style={{\n                  position: 'absolute',\n                  right: 8,\n                  top: '50%',\n                  transform: 'translateY(-50%)',\n                  background: 'none',\n                  border: 'none',\n                  color: colors.textMuted,\n                  cursor: 'pointer',\n                  padding: 4,\n                }}\n                tabIndex={-1}\n              >\n                {showPassword ? (\n                  <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                    <path d=\"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94\"/>\n                    <path d=\"M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19\"/>\n                    <line x1=\"1\" y1=\"1\" x2=\"23\" y2=\"23\"/>\n                  </svg>\n                ) : (\n                  <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                    <path d=\"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z\"/>\n                    <circle cx=\"12\" cy=\"12\" r=\"3\"/>\n                  </svg>\n                )}\n              </button>\n            </div>\n          </div>\n\n          <button \n            type=\"submit\" \n            disabled={isLoading}\n            style={{\n              ...styles.btn,\n              width: '100%',\n              justifyContent: 'center',\n              padding: `${spacing[3]}px ${spacing[4]}px`,\n              opacity: isLoading ? 0.7 : 1,\n              cursor: isLoading ? 'not-allowed' : 'pointer',\n            }}\n          >\n            {isLoading ? (\n              <>\n                <Spinner size={16} color=\"white\" />\n                <span style={{ marginLeft: 8 }}>Signing in...</span>\n              </>\n            ) : (\n              'Sign In'\n            )}\n          </button>\n        </form>\n\n        {/* Help text */}\n        <p style={{\n          textAlign: 'center',\n          color: colors.textMuted,\n          fontSize: typography.fontSize.xs,\n          marginTop: spacing[6]\n        }}>\n          Contact admin for access\n        </p>\n      </div>\n    </div>\n  );\n}\n\nexport default memo(Login);\n","// ============================================================================\n// Sidebar Navigation Component\n// ============================================================================\n\nimport React, { memo, useState, useCallback, useEffect, useRef } from 'react';\nimport {\n  Calendar, Package, QrCode, Settings,\n  BarChart3, Home, LogOut, Layers, ClipboardList, User, ChevronDown,\n  ScanLine, Upload, Download, Bell, Palette, ChevronLeft, ChevronRight, Search\n} from 'lucide-react';\nimport { VIEWS } from '../constants.js';\nimport { colors, spacing, borderRadius, typography, withOpacity } from '../theme.js';\nimport { useTheme } from '../contexts/ThemeContext.jsx';\nimport { usePermissions } from '../contexts/PermissionsContext.jsx';\nimport { announcePageChange } from '../utils/accessibility.js';\n\n// Navigation button component\nconst NavButton = memo(function NavButton({ icon: Icon, label, viewId, currentView, onClick, colorVar, collapsed }) {\n  const isActive = currentView === viewId;\n  // Use CSS variable directly - falls back to --primary if not set\n  const activeColor = colorVar ? `var(${colorVar}, var(--primary))` : 'var(--primary)';\n  \n  return (\n    <button\n      onClick={() => onClick(viewId)}\n      className=\"sidebar-nav-btn\"\n      title={collapsed ? label : undefined}\n      type=\"button\"\n      aria-label={collapsed ? label : undefined}\n      aria-current={isActive ? 'page' : undefined}\n      style={{\n        '--nav-active-color': activeColor,\n        display: 'flex',\n        alignItems: 'center',\n        gap: collapsed ? 0 : spacing[3],\n        width: '100%',\n        padding: `${spacing[3]}px ${collapsed ? spacing[3] : spacing[4]}px`,\n        background: isActive ? `color-mix(in srgb, ${activeColor} 20%, transparent)` : 'transparent',\n        border: 'none',\n        borderRadius: borderRadius.lg,\n        color: isActive ? activeColor : colors.textSecondary,\n        cursor: 'pointer',\n        textAlign: 'left',\n        fontSize: typography.fontSize.sm,\n        fontWeight: isActive ? typography.fontWeight.medium : typography.fontWeight.normal,\n        justifyContent: collapsed ? 'center' : 'flex-start',\n      }}\n    >\n      <Icon size={18} aria-hidden=\"true\" style={{ color: isActive ? activeColor : 'inherit', flexShrink: 0 }} />\n      <span className=\"sidebar-nav-label\" style={{\n        opacity: collapsed ? 0 : 1,\n        width: collapsed ? 0 : 'auto',\n        overflow: 'hidden',\n        whiteSpace: 'nowrap',\n      }}>\n        {label}\n      </span>\n    </button>\n  );\n});\n\n// Main navigation items with color keys and permission IDs\nconst mainNavItems = [\n  { icon: Home, label: 'Dashboard', viewId: VIEWS.DASHBOARD, colorVar: '--sidebar-item1', permissionId: 'dashboard' },\n  { icon: Package, label: 'Gear List', viewId: VIEWS.GEAR_LIST, colorVar: '--sidebar-item2', permissionId: 'gear_list' },\n  { icon: Layers, label: 'Packages', viewId: VIEWS.PACKAGES, colorVar: '--sidebar-item3', permissionId: 'pack_lists' },\n  { icon: ClipboardList, label: 'Pack Lists', viewId: VIEWS.PACK_LISTS, colorVar: '--sidebar-item4', permissionId: 'pack_lists' },\n  { icon: Calendar, label: 'Schedule', viewId: VIEWS.SCHEDULE, colorVar: '--sidebar-item5', permissionId: 'schedule' },\n  { icon: QrCode, label: 'Labels', viewId: VIEWS.LABELS, colorVar: '--sidebar-item6', permissionId: 'labels' },\n  { icon: User, label: 'Clients', viewId: VIEWS.CLIENTS, colorVar: '--sidebar-item1', permissionId: 'clients' },\n  { icon: Search, label: 'Search', viewId: VIEWS.SEARCH, colorVar: '--sidebar-item3', permissionId: 'search' },\n];\n\n// Admin navigation items\nconst adminNavItems = [\n  { icon: Settings, label: 'Admin Panel', viewId: VIEWS.ADMIN, colorVar: '--sidebar-item1', permissionId: 'admin_users' },\n  { icon: BarChart3, label: 'Reports', viewId: VIEWS.REPORTS, colorVar: '--sidebar-item2', permissionId: 'reports' },\n];\n\n// View ID to label mapping for announcements\nconst VIEW_LABELS = {\n  [VIEWS.DASHBOARD]: 'Dashboard',\n  [VIEWS.GEAR_LIST]: 'Gear List',\n  [VIEWS.GEAR_DETAIL]: 'Gear Details',\n  [VIEWS.PACKAGES]: 'Packages',\n  [VIEWS.PACK_LISTS]: 'Pack Lists',\n  [VIEWS.SCHEDULE]: 'Schedule',\n  [VIEWS.LABELS]: 'Labels',\n  [VIEWS.CLIENTS]: 'Clients',\n  [VIEWS.CLIENT_DETAIL]: 'Client Details',\n  [VIEWS.SEARCH]: 'Search',\n  [VIEWS.ADMIN]: 'Admin Panel',\n  [VIEWS.REPORTS]: 'Reports',\n  [VIEWS.ADD_ITEM]: 'Add Item',\n  [VIEWS.EDIT_SPECS]: 'Edit Specifications',\n  [VIEWS.EDIT_CATEGORIES]: 'Edit Categories',\n  [VIEWS.THEME_SELECTOR]: 'Theme Selector',\n  [VIEWS.USERS]: 'User Management',\n  [VIEWS.AUDIT_LOG]: 'Audit Log',\n  [VIEWS.MAINTENANCE_REPORT]: 'Maintenance Report',\n  [VIEWS.INSURANCE_REPORT]: 'Insurance Report',\n  [VIEWS.LOCATIONS_MANAGE]: 'Location Management',\n  [VIEWS.CUSTOMIZE_DASHBOARD]: 'Customize Dashboard',\n  [VIEWS.CUSTOMIZE_ITEM_DETAIL]: 'Customize Item Detail',\n  [VIEWS.RESERVATION_DETAIL]: 'Reservation Details',\n  [VIEWS.NOTIFICATIONS]: 'Notifications',\n};\n\nfunction Sidebar({ currentView, setCurrentView, user, onLogout, onOpenProfile, onOpenScanner, onOpenImport, onOpenExport, isOpen, onClose, collapsed, onToggleCollapse }) {\n  const [showUserMenu, setShowUserMenu] = useState(false);\n  const { themeId, availableThemes } = useTheme();\n  const { canView, canEdit } = usePermissions();\n  const userMenuRef = useRef(null);\n\n  // Filter nav items based on permissions\n  const visibleMainNavItems = mainNavItems.filter(item => canView(item.permissionId));\n  const visibleAdminNavItems = adminNavItems.filter(item => canView(item.permissionId));\n  \n  // Check if user can access any admin features\n  const hasAnyAdminAccess = visibleAdminNavItems.length > 0 || \n    canView('admin_users') || canView('admin_categories') || canView('admin_specs') || \n    canView('admin_locations') || canView('admin_roles') || canView('admin_audit');\n\n  // Close menus when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (userMenuRef.current && !userMenuRef.current.contains(event.target)) {\n        setShowUserMenu(false);\n      }\n    };\n\n    if (showUserMenu) {\n      document.addEventListener('mousedown', handleClickOutside);\n      return () => document.removeEventListener('mousedown', handleClickOutside);\n    }\n  }, [showUserMenu]);\n\n  // Announce view changes to screen readers\n  const previousViewRef = useRef(currentView);\n  useEffect(() => {\n    if (currentView !== previousViewRef.current) {\n      const viewLabel = VIEW_LABELS[currentView] || currentView;\n      announcePageChange(viewLabel);\n      previousViewRef.current = currentView;\n    }\n  }, [currentView]);\n\n  const handleNavClick = useCallback((viewId) => {\n    setCurrentView(viewId);\n  }, [setCurrentView]);\n\n  return (\n    <aside \n      className={`app-sidebar ${isOpen ? 'sidebar-open' : ''} ${collapsed ? 'collapsed' : ''}`} \n      role=\"navigation\"\n      aria-label=\"Main navigation\"\n      style={{\n        height: '100vh',\n        position: 'fixed',\n        left: 0,\n        top: 0,\n        background: colors.bgMedium,\n        borderRight: `1px solid ${colors.border}`,\n        display: 'flex',\n        flexDirection: 'column',\n      }}\n    >\n      {/* Collapse toggle button */}\n      {onToggleCollapse && (\n        <button\n          className=\"sidebar-collapse-btn\"\n          onClick={onToggleCollapse}\n          title={collapsed ? 'Expand sidebar' : 'Collapse sidebar'}\n          aria-label={collapsed ? 'Expand sidebar' : 'Collapse sidebar'}\n          aria-expanded={!collapsed}\n          type=\"button\"\n        >\n          {collapsed ? <ChevronRight size={14} aria-hidden=\"true\" /> : <ChevronLeft size={14} aria-hidden=\"true\" />}\n        </button>\n      )}\n      \n      {/* Logo */}\n      <div style={{\n        padding: collapsed ? spacing[3] : spacing[5],\n        borderBottom: `1px solid ${colors.borderLight}`,\n        transition: 'padding 0.3s ease',\n      }}>\n        <div className=\"sidebar-logo\" style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: collapsed ? 'center' : 'space-between',\n          transition: 'justify-content 0.3s ease',\n        }}>\n          <div style={{\n            display: 'flex',\n            alignItems: 'center',\n            gap: collapsed ? 0 : spacing[3],\n            transition: 'gap 0.3s ease',\n          }}>\n          <div style={{\n            width: 40,\n            height: 40,\n            borderRadius: borderRadius.lg,\n            overflow: 'hidden',\n            flexShrink: 0,\n          }}>\n            <img \n              src=\"/moe.png\" \n              alt=\"SIMS\" \n              style={{\n                width: '100%',\n                height: '100%',\n                objectFit: 'cover',\n              }}\n            />\n          </div>\n          <div className=\"sidebar-logo-text\" style={{\n            opacity: collapsed ? 0 : 1,\n            width: collapsed ? 0 : 'auto',\n            overflow: 'hidden',\n            whiteSpace: 'nowrap',\n            transition: 'opacity 0.2s ease, width 0.2s ease',\n          }}>\n            <h1 style={{\n              margin: 0,\n              fontSize: typography.fontSize.lg,\n              fontWeight: typography.fontWeight.bold,\n              color: colors.textPrimary\n            }}>\n              S.I.M.S.\n            </h1>\n            <p style={{\n              margin: 0,\n              fontSize: typography.fontSize.xs,\n              color: colors.textMuted,\n              lineHeight: 1.3\n            }}>\n              The SemiPro Inventory<br/>Management System\n            </p>\n          </div>\n          </div>\n          {/* Close button for mobile */}\n          {onClose && !collapsed && (\n            <button\n              className=\"sidebar-close-btn\"\n              onClick={onClose}\n              style={{\n                display: 'none', // CSS media query will show this\n                background: withOpacity(colors.textMuted, 10),\n                border: 'none',\n                borderRadius: borderRadius.md,\n                color: colors.textPrimary,\n                cursor: 'pointer',\n                padding: spacing[2],\n              }}\n              aria-label=\"Close menu\"\n            >\n              <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line>\n                <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line>\n              </svg>\n            </button>\n          )}\n        </div>\n      </div>\n\n      {/* Main Navigation */}\n      <nav style={{\n        flex: 1,\n        padding: spacing[3],\n        overflowY: 'auto'\n      }}>\n        <div style={{ marginBottom: spacing[4] }}>\n          {visibleMainNavItems.map(item => (\n            <NavButton\n              key={item.viewId}\n              icon={item.icon}\n              label={item.label}\n              viewId={item.viewId}\n              currentView={currentView}\n              onClick={handleNavClick}\n              colorVar={item.colorVar}\n              collapsed={collapsed}\n            />\n          ))}\n          \n          {/* Scan QR Code - in main nav */}\n          <button\n            onClick={onOpenScanner}\n            className=\"sidebar-nav-btn\"\n            title={collapsed ? 'Scan QR Code' : undefined}\n            style={{\n              display: 'flex',\n              alignItems: 'center',\n              gap: collapsed ? 0 : spacing[3],\n              width: '100%',\n              padding: `${spacing[3]}px ${collapsed ? spacing[3] : spacing[4]}px`,\n              background: 'transparent',\n              border: 'none',\n              borderRadius: borderRadius.lg,\n              color: colors.textSecondary,\n              cursor: 'pointer',\n              textAlign: 'left',\n              fontSize: typography.fontSize.sm,\n              transition: 'all 150ms ease',\n              justifyContent: collapsed ? 'center' : 'flex-start',\n            }}\n          >\n            <ScanLine size={18} style={{ flexShrink: 0 }} />\n            <span className=\"sidebar-nav-label\" style={{\n              opacity: collapsed ? 0 : 1,\n              width: collapsed ? 0 : 'auto',\n              overflow: 'hidden',\n              whiteSpace: 'nowrap',\n              transition: 'opacity 0.2s ease, width 0.2s ease',\n            }}>\n              Scan QR Code\n            </span>\n          </button>\n        </div>\n\n        {/* Admin Section */}\n        {hasAnyAdminAccess && (\n          <div style={{\n            borderTop: `1px solid ${colors.borderLight}`,\n            paddingTop: spacing[4]\n          }}>\n            <p className=\"sidebar-section-title\" style={{\n              fontSize: typography.fontSize.xs,\n              color: colors.textMuted,\n              textTransform: 'uppercase',\n              letterSpacing: '0.5px',\n              padding: `0 ${collapsed ? spacing[3] : spacing[4]}px`,\n              marginBottom: spacing[2],\n              opacity: collapsed ? 0 : 1,\n              height: collapsed ? 0 : 'auto',\n              overflow: 'hidden',\n              transition: 'opacity 0.2s ease, height 0.2s ease, padding 0.2s ease',\n            }}>\n              Admin\n            </p>\n            {visibleAdminNavItems.map(item => (\n              <NavButton\n                key={item.viewId}\n                icon={item.icon}\n                label={item.label}\n                viewId={item.viewId}\n                currentView={currentView}\n                onClick={handleNavClick}\n                colorVar={item.colorVar}\n                collapsed={collapsed}\n              />\n            ))}\n            \n            {/* Import CSV - Admin only */}\n            {canEdit('gear_list') && (\n            <button\n              onClick={onOpenImport}\n              className=\"sidebar-nav-btn\"\n              title={collapsed ? 'Import CSV' : undefined}\n              style={{\n                display: 'flex',\n                alignItems: 'center',\n                gap: collapsed ? 0 : spacing[3],\n                width: '100%',\n                padding: `${spacing[3]}px ${collapsed ? spacing[3] : spacing[4]}px`,\n                background: 'transparent',\n                border: 'none',\n                borderRadius: borderRadius.lg,\n                color: colors.textSecondary,\n                cursor: 'pointer',\n                textAlign: 'left',\n                fontSize: typography.fontSize.sm,\n                transition: 'all 150ms ease',\n                justifyContent: collapsed ? 'center' : 'flex-start',\n              }}\n            >\n              <Upload size={18} style={{ flexShrink: 0 }} />\n              <span className=\"sidebar-nav-label\" style={{\n                opacity: collapsed ? 0 : 1,\n                width: collapsed ? 0 : 'auto',\n                overflow: 'hidden',\n                whiteSpace: 'nowrap',\n                transition: 'opacity 0.2s ease, width 0.2s ease',\n              }}>\n                Import CSV\n              </span>\n            </button>\n            )}\n            \n            {/* Export Data - Admin only */}\n            {canView('gear_list') && (\n            <button\n              onClick={onOpenExport}\n              className=\"sidebar-nav-btn\"\n              title={collapsed ? 'Export Data' : undefined}\n              style={{\n                display: 'flex',\n                alignItems: 'center',\n                gap: collapsed ? 0 : spacing[3],\n                width: '100%',\n                padding: `${spacing[3]}px ${collapsed ? spacing[3] : spacing[4]}px`,\n                background: 'transparent',\n                border: 'none',\n                borderRadius: borderRadius.lg,\n                color: colors.textSecondary,\n                cursor: 'pointer',\n                textAlign: 'left',\n                fontSize: typography.fontSize.sm,\n                transition: 'all 150ms ease',\n                justifyContent: collapsed ? 'center' : 'flex-start',\n              }}\n            >\n              <Download size={18} style={{ flexShrink: 0 }} />\n              <span className=\"sidebar-nav-label\" style={{\n                opacity: collapsed ? 0 : 1,\n                width: collapsed ? 0 : 'auto',\n                overflow: 'hidden',\n                whiteSpace: 'nowrap',\n                transition: 'opacity 0.2s ease, width 0.2s ease',\n              }}>\n                Export Data\n              </span>\n            </button>\n            )}\n          </div>\n        )}\n      </nav>\n\n      {/* User Section */}\n      <div className=\"sidebar-user-section\" style={{\n        borderTop: `1px solid ${colors.borderLight}`,\n        padding: spacing[3],\n        display: 'flex',\n        justifyContent: collapsed ? 'center' : 'flex-start',\n      }}>\n        <div ref={userMenuRef} style={{ position: 'relative', width: collapsed ? 'auto' : '100%' }}>\n          <button\n            onClick={() => setShowUserMenu(!showUserMenu)}\n            title={collapsed ? user?.name : undefined}\n            style={{\n              display: 'flex',\n              alignItems: 'center',\n              gap: collapsed ? 0 : spacing[3],\n              width: collapsed ? 'auto' : '100%',\n              padding: spacing[3],\n              background: showUserMenu ? `${withOpacity(colors.primary, 10)}` : 'transparent',\n              border: 'none',\n              borderRadius: borderRadius.lg,\n              cursor: 'pointer',\n              textAlign: 'left',\n              justifyContent: collapsed ? 'center' : 'flex-start',\n            }}\n          >\n            {user?.profile?.logo ? (\n              <img\n                src={user.profile.logo}\n                alt={user?.name}\n                style={{\n                  width: 36,\n                  height: 36,\n                  borderRadius: borderRadius.md,\n                  objectFit: 'cover',\n                  flexShrink: 0,\n                }}\n              />\n            ) : (\n            <div style={{\n              width: 36,\n              height: 36,\n              borderRadius: borderRadius.md,\n              background: `linear-gradient(135deg, ${colors.primary}, ${colors.accent1})`,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              fontWeight: typography.fontWeight.semibold,\n              color: colors.textPrimary,\n              fontSize: typography.fontSize.sm,\n              flexShrink: 0,\n            }}>\n              {user?.name?.charAt(0) || '?'}\n            </div>\n            )}\n            <div className=\"sidebar-user-info\" style={{ \n              flex: 1, \n              minWidth: 0,\n              opacity: collapsed ? 0 : 1,\n              width: collapsed ? 0 : 'auto',\n              overflow: 'hidden',\n              transition: 'opacity 0.2s ease, width 0.2s ease',\n            }}>\n              <div style={{\n                fontWeight: typography.fontWeight.medium,\n                color: colors.textPrimary,\n                fontSize: typography.fontSize.sm,\n                whiteSpace: 'nowrap',\n                overflow: 'hidden',\n                textOverflow: 'ellipsis'\n              }}>\n                {user?.name}\n              </div>\n              <div style={{\n                fontSize: typography.fontSize.xs,\n                color: colors.textMuted,\n                textTransform: 'capitalize'\n              }}>\n                {user?.role?.name || user?.roleId || 'User'}\n              </div>\n            </div>\n            {!collapsed && (\n              <ChevronDown\n                size={16}\n                color={colors.textMuted}\n                style={{\n                  transform: showUserMenu ? 'rotate(180deg)' : 'rotate(0)',\n                  transition: 'transform 150ms ease'\n                }}\n              />\n            )}\n          </button>\n\n          {/* User Dropdown Menu */}\n          {showUserMenu && (\n            <div className=\"sidebar-user-menu\" style={{\n              position: 'absolute',\n              bottom: '100%',\n              left: collapsed ? '50%' : 0,\n              right: collapsed ? 'auto' : 0,\n              transform: collapsed ? 'translateX(-50%)' : 'none',\n              marginBottom: spacing[2],\n              background: colors.bgLight,\n              border: `1px solid ${colors.border}`,\n              borderRadius: borderRadius.lg,\n              overflow: 'hidden',\n              boxShadow: '0 4px 12px rgba(0,0,0,0.3)',\n              minWidth: collapsed ? 180 : 'auto',\n            }}>\n              <button\n                onClick={() => { onOpenProfile(); setShowUserMenu(false); }}\n                className=\"user-menu-item\"\n                style={{\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: spacing[2],\n                  width: '100%',\n                  padding: `${spacing[3]}px ${spacing[4]}px`,\n                  background: 'none',\n                  border: 'none',\n                  color: colors.textPrimary,\n                  cursor: 'pointer',\n                  fontSize: typography.fontSize.sm,\n                  textAlign: 'left'\n                }}\n              >\n                <User size={16} />\n                Profile Settings\n              </button>\n              \n              {/* Theme Selector */}\n              <button\n                onClick={() => { setCurrentView(VIEWS.THEME_SELECTOR); setShowUserMenu(false); }}\n                className=\"user-menu-item\"\n                style={{\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'space-between',\n                  gap: spacing[2],\n                  width: '100%',\n                  padding: `${spacing[3]}px ${spacing[4]}px`,\n                  background: 'none',\n                  border: 'none',\n                  borderTop: `1px solid ${colors.borderLight}`,\n                  color: colors.textPrimary,\n                  cursor: 'pointer',\n                  fontSize: typography.fontSize.sm,\n                  textAlign: 'left'\n                }}\n              >\n                <span style={{ display: 'flex', alignItems: 'center', gap: spacing[2] }}>\n                  <Palette size={16} />\n                  Theme\n                </span>\n                <span style={{ \n                  fontSize: typography.fontSize.xs, \n                  color: colors.textMuted,\n                  textTransform: 'capitalize'\n                }}>\n                  {availableThemes.find(t => t.id === themeId)?.name || 'Dark'}\n                </span>\n              </button>\n              \n              <button\n                onClick={() => { setCurrentView(VIEWS.NOTIFICATIONS); setShowUserMenu(false); }}\n                className=\"user-menu-item\"\n                style={{\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: spacing[2],\n                  width: '100%',\n                  padding: `${spacing[3]}px ${spacing[4]}px`,\n                  background: 'none',\n                  border: 'none',\n                  borderTop: `1px solid ${colors.borderLight}`,\n                  color: colors.textPrimary,\n                  cursor: 'pointer',\n                  fontSize: typography.fontSize.sm,\n                  textAlign: 'left'\n                }}\n              >\n                <Bell size={16} />\n                Notification Settings\n              </button>\n              <button\n                onClick={onLogout}\n                className=\"user-menu-item\"\n                style={{\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: spacing[2],\n                  width: '100%',\n                  padding: `${spacing[3]}px ${spacing[4]}px`,\n                  background: 'none',\n                  border: 'none',\n                  borderTop: `1px solid ${colors.borderLight}`,\n                  color: colors.danger,\n                  cursor: 'pointer',\n                  fontSize: typography.fontSize.sm,\n                  textAlign: 'left'\n                }}\n              >\n                <LogOut size={16} />\n                Sign Out\n              </button>\n            </div>\n          )}\n        </div>\n      </div>\n    </aside>\n  );\n}\n\nexport default memo(Sidebar);\n","// ============================================================================\n// Mobile Header Component\n// Hamburger menu + logo + user dropdown for mobile viewports\n// ============================================================================\n\nimport { useState } from 'react';\nimport { colors, spacing, typography, borderRadius } from '../theme.js';\nimport { VIEWS, MODALS } from '../constants.js';\n\nexport default function MobileHeader({\n  currentUser,\n  onOpenSidebar,\n  onOpenModal,\n  onSetView,\n  onLogout,\n}) {\n  const [menuOpen, setMenuOpen] = useState(false);\n\n  return (\n    <div className=\"mobile-header\">\n      <button\n        onClick={onOpenSidebar}\n        style={{\n          background: 'transparent',\n          border: 'none',\n          borderRadius: borderRadius.md,\n          padding: '8px',\n          cursor: 'pointer',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          color: colors.textPrimary,\n        }}\n        aria-label=\"Open menu\"\n      >\n        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n          <line x1=\"3\" y1=\"12\" x2=\"21\" y2=\"12\"></line>\n          <line x1=\"3\" y1=\"6\" x2=\"21\" y2=\"6\"></line>\n          <line x1=\"3\" y1=\"18\" x2=\"21\" y2=\"18\"></line>\n        </svg>\n      </button>\n      <div style={{ \n        display: 'flex', \n        alignItems: 'center', \n        gap: 8,\n        flex: 1,\n      }}>\n        <img \n          src=\"/moe.png\" \n          alt=\"\" \n          style={{ width: 28, height: 28, borderRadius: borderRadius.md }}\n          onError={(e) => e.target.style.display = 'none'}\n        />\n        <span style={{ fontWeight: typography.fontWeight.semibold, fontSize: typography.fontSize.lg, color: colors.textPrimary }}>SIMS</span>\n      </div>\n      {currentUser && (\n        <div style={{ position: 'relative' }}>\n          <button\n            onClick={() => setMenuOpen(!menuOpen)}\n            style={{\n              width: 36,\n              height: 36,\n              borderRadius: '50%',\n              background: colors.primary,\n              border: 'none',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              color: colors.bgDark,\n              fontWeight: typography.fontWeight.semibold,\n              fontSize: typography.fontSize.base,\n              cursor: 'pointer',\n            }}\n            aria-label=\"User menu\"\n          >\n            {currentUser.name?.charAt(0).toUpperCase() || 'U'}\n          </button>\n          {menuOpen && (\n            <>\n              <div \n                style={{\n                  position: 'fixed',\n                  top: 0,\n                  left: 0,\n                  right: 0,\n                  bottom: 0,\n                  zIndex: 999,\n                }}\n                onClick={() => setMenuOpen(false)}\n              />\n              <div style={{\n                position: 'absolute',\n                top: '100%',\n                right: 0,\n                marginTop: 8,\n                background: colors.bgMedium,\n                border: `1px solid ${colors.border}`,\n                borderRadius: borderRadius.xl,\n                padding: spacing[2],\n                minWidth: 180,\n                zIndex: 1000,\n                boxShadow: '0 4px 20px rgba(0,0,0,0.3)',\n              }}>\n                <div style={{\n                  padding: `${spacing[2]}px ${spacing[3]}px`,\n                  borderBottom: `1px solid ${colors.borderLight}`,\n                  marginBottom: spacing[2],\n                }}>\n                  <div style={{ fontWeight: typography.fontWeight.semibold, color: colors.textPrimary }}>{currentUser.name}</div>\n                  <div style={{ fontSize: typography.fontSize.sm, color: colors.textMuted }}>{currentUser.email}</div>\n                </div>\n                <button\n                  onClick={() => {\n                    setMenuOpen(false);\n                    onOpenModal(MODALS.PROFILE);\n                  }}\n                  style={{\n                    width: '100%',\n                    padding: `${spacing[2]}px ${spacing[3]}px`,\n                    background: 'transparent',\n                    border: 'none',\n                    borderRadius: borderRadius.md,\n                    color: colors.textPrimary,\n                    textAlign: 'left',\n                    cursor: 'pointer',\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: spacing[2],\n                  }}\n                >\n                  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                    <path d=\"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2\"/>\n                    <circle cx=\"12\" cy=\"7\" r=\"4\"/>\n                  </svg>\n                  Profile\n                </button>\n                <button\n                  onClick={() => {\n                    setMenuOpen(false);\n                    onSetView(VIEWS.THEME_SELECTOR);\n                  }}\n                  style={{\n                    width: '100%',\n                    padding: `${spacing[2]}px ${spacing[3]}px`,\n                    background: 'transparent',\n                    border: 'none',\n                    borderRadius: borderRadius.md,\n                    color: colors.textPrimary,\n                    textAlign: 'left',\n                    cursor: 'pointer',\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: spacing[2],\n                  }}\n                >\n                  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                    <circle cx=\"12\" cy=\"12\" r=\"3\"/>\n                    <path d=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\"/>\n                  </svg>\n                  Theme\n                </button>\n                <div style={{ \n                  borderTop: `1px solid ${colors.borderLight}`,\n                  marginTop: spacing[2],\n                  paddingTop: spacing[2],\n                }}>\n                  <button\n                    onClick={() => {\n                      setMenuOpen(false);\n                      onLogout();\n                    }}\n                    style={{\n                      width: '100%',\n                      padding: `${spacing[2]}px ${spacing[3]}px`,\n                      background: 'transparent',\n                      border: 'none',\n                      borderRadius: borderRadius.md,\n                      color: colors.danger,\n                      textAlign: 'left',\n                      cursor: 'pointer',\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: spacing[2],\n                    }}\n                  >\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                      <path d=\"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4\"/>\n                      <polyline points=\"16 17 21 12 16 7\"/>\n                      <line x1=\"21\" y1=\"12\" x2=\"9\" y2=\"12\"/>\n                    </svg>\n                    Sign Out\n                  </button>\n                </div>\n              </div>\n            </>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n","// ============================================================================\n// Dashboard Component\n// Supports collapsible sections with user-customizable order and visibility\n// ============================================================================\n\nimport React, { memo, useState, useMemo, useEffect } from 'react';\nimport {\n  Package, CheckCircle, Clock, AlertTriangle, Calendar,\n  ChevronRight, Search, Bell, TrendingDown, Layout\n} from 'lucide-react';\nimport { STATUS, DASHBOARD_SECTIONS } from '../constants.js';\nimport { colors, styles, spacing, borderRadius, typography, withOpacity} from '../theme.js';\nimport { formatDate, getStatusColor, getTodayISO, isReminderDue } from '../utils.js';\nimport { Badge, StatCard, SearchInput, Button, CollapsibleSection } from '../components/ui.jsx';\nimport { usePermissions } from '../contexts/PermissionsContext.jsx';\n\n// Panel color CSS variables for dashboard sections\nconst PANEL_COLORS = {\n  stats: 'var(--panel-stats)',\n  search: 'var(--panel-search)',\n  alerts: 'var(--panel-alerts)',\n  reminders: 'var(--panel-reminders)',\n  lowStock: 'var(--panel-lowstock)',\n  reservations: 'var(--panel-reservations)',\n};\n\nfunction Dashboard({\n  inventory = [],\n  categorySettings = {},\n  layoutPrefs,\n  onViewItem,\n  onViewReservation,\n  onFilteredView,\n  onViewAlerts,\n  onViewOverdue,\n  onViewLowStock,\n  onViewReservations,\n  onCustomizeLayout,\n  onToggleCollapse,\n}) {\n  const [quickSearch, setQuickSearch] = useState('');\n  \n  // Permissions\n  const { canEdit } = usePermissions();\n  const canEditDashboard = canEdit('dashboard');\n  \n  // Local state for collapsed sections (for immediate UI response)\n  const [collapsedSections, setCollapsedSections] = useState(() => {\n    const initial = {};\n    Object.values(DASHBOARD_SECTIONS).forEach(s => {\n      initial[s.id] = layoutPrefs?.sections?.[s.id]?.collapsed || false;\n    });\n    return initial;\n  });\n\n  // Sync with layoutPrefs when they change externally\n  useEffect(() => {\n    if (layoutPrefs?.sections) {\n      setCollapsedSections(prev => {\n        const updated = { ...prev };\n        Object.keys(layoutPrefs.sections).forEach(id => {\n          if (layoutPrefs.sections[id]?.collapsed !== undefined) {\n            updated[id] = layoutPrefs.sections[id].collapsed;\n          }\n        });\n        return updated;\n      });\n    }\n  }, [layoutPrefs]);\n\n  // Get section preferences with defaults\n  const getSectionPref = (sectionId) => {\n    const defaultSection = Object.values(DASHBOARD_SECTIONS).find(s => s.id === sectionId);\n    const pref = layoutPrefs?.sections?.[sectionId];\n    return {\n      visible: pref?.visible !== false,\n      order: pref?.order ?? defaultSection?.order ?? 99,\n    };\n  };\n\n  // Check if section should be shown\n  const showSection = (sectionId) => getSectionPref(sectionId).visible;\n  \n  // Check if section is collapsed (use local state)\n  const isCollapsed = (sectionId) => collapsedSections[sectionId] || false;\n  \n  // Handle collapse toggle - update local state immediately, then notify parent\n  const toggleCollapse = (sectionId) => {\n    setCollapsedSections(prev => ({\n      ...prev,\n      [sectionId]: !prev[sectionId]\n    }));\n    // Also notify parent to persist\n    if (onToggleCollapse) {\n      onToggleCollapse('dashboard', sectionId);\n    }\n  };\n\n  // Get sections sorted by order\n  const sectionOrder = useMemo(() => {\n    const sections = ['stats', 'quickSearch', 'alerts', 'reminders', 'lowStock', 'reservations'];\n    return sections\n      .filter(id => showSection(id))\n      .map(id => ({ id, order: getSectionPref(id).order }))\n      .sort((a, b) => a.order - b.order)\n      .map(s => s.id);\n  }, [layoutPrefs]);\n\n  // Computed stats\n  const stats = useMemo(() => {\n    const today = getTodayISO();\n    \n    // Get all due reminders across all items\n    const dueReminders = inventory.flatMap(item => \n      (item.reminders || [])\n        .filter(r => isReminderDue(r))\n        .map(r => ({ ...r, item }))\n    );\n\n    // Get low stock items\n    const lowStockItems = inventory.filter(item => {\n      const settings = categorySettings?.[item.category];\n      if (!settings?.trackQuantity) return false;\n      \n      // Only consider items that have a quantity defined\n      if (item.quantity === undefined || item.quantity === null) return false;\n      \n      const quantity = item.quantity;\n      const threshold = item.reorderPoint || settings.lowStockThreshold || 0;\n      \n      return threshold > 0 && quantity <= threshold;\n    });\n    \n    return {\n      total: inventory.length,\n      available: inventory.filter(i => i.status === STATUS.AVAILABLE).length,\n      checkedOut: inventory.filter(i => i.status === STATUS.CHECKED_OUT).length,\n      alerts: inventory.filter(i => i.status === STATUS.NEEDS_ATTENTION),\n      overdue: inventory.filter(i =>\n        i.status === STATUS.CHECKED_OUT && i.dueBack && i.dueBack < today\n      ),\n      dueReminders,\n      lowStockItems\n    };\n  }, [inventory, categorySettings]);\n\n  // Upcoming reservations\n  const upcomingReservations = useMemo(() => {\n    return inventory\n      .flatMap(i => (i.reservations || []).map(r => ({ ...r, item: i })))\n      .filter(r => new Date(r.start) >= new Date())\n      .sort((a, b) => new Date(a.start) - new Date(b.start))\n      .slice(0, 6);\n  }, [inventory]);\n\n  // Quick search results\n  const searchResults = useMemo(() => {\n    if (!quickSearch.trim()) return [];\n    const q = quickSearch.toLowerCase();\n    return inventory\n      .filter(item =>\n        item.name.toLowerCase().includes(q) ||\n        item.id.toLowerCase().includes(q) ||\n        item.brand.toLowerCase().includes(q)\n      )\n      .slice(0, 5);\n  }, [inventory, quickSearch]);\n\n  // Render sections\n  const renderSection = (sectionId) => {\n    switch (sectionId) {\n      case 'stats':\n        return (\n          <CollapsibleSection\n            key=\"stats\"\n            title=\"Statistics\"\n            icon={Package}\n            badge={stats.total}\n            badgeColor={PANEL_COLORS.stats}\n            headerColor={PANEL_COLORS.stats}\n            collapsed={isCollapsed('stats')}\n            onToggleCollapse={() => toggleCollapse('stats')}\n          >\n            <div style={{\n              display: 'grid',\n              gridTemplateColumns: 'repeat(auto-fit, minmax(140px, 1fr))',\n              gap: spacing[3],\n            }}>\n              <StatCard\n                icon={Package}\n                value={stats.total}\n                label=\"Total Items\"\n                color={PANEL_COLORS.stats}\n                onClick={() => onFilteredView('all', 'all')}\n              />\n              <StatCard\n                icon={CheckCircle}\n                value={stats.available}\n                label=\"Available\"\n                color={colors.available}\n                onClick={() => onFilteredView('all', STATUS.AVAILABLE)}\n              />\n              <StatCard\n                icon={Clock}\n                value={stats.checkedOut}\n                label=\"Checked Out\"\n                color={colors.checkedOut}\n                onClick={() => onFilteredView('all', STATUS.CHECKED_OUT)}\n              />\n              <StatCard\n                icon={AlertTriangle}\n                value={stats.overdue.length}\n                label=\"Overdue\"\n                color={colors.danger}\n                onClick={onViewOverdue}\n              />\n            </div>\n          </CollapsibleSection>\n        );\n\n      case 'quickSearch':\n        return (\n          <CollapsibleSection\n            key=\"quickSearch\"\n            title=\"Quick Gear Search\"\n            headerColor={PANEL_COLORS.search}\n            icon={Search}\n            collapsed={isCollapsed('quickSearch')}\n            onToggleCollapse={() => toggleCollapse('quickSearch')}\n          >\n            <SearchInput\n              value={quickSearch}\n              onChange={setQuickSearch}\n              onClear={() => setQuickSearch('')}\n              placeholder=\"Search by name, ID, or brand...\"\n            />\n\n            {searchResults.length > 0 && (\n              <div style={{ marginTop: spacing[3] }}>\n                {searchResults.map(item => (\n                  <div\n                    key={item.id}\n                    onClick={() => onViewItem(item.id)}\n                    style={{\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: spacing[3],\n                      padding: spacing[3],\n                      borderRadius: borderRadius.md,\n                      cursor: 'pointer',\n                      marginBottom: spacing[2],\n                      background: withOpacity(PANEL_COLORS.search, 15),\n                      border: `1px solid ${withOpacity(PANEL_COLORS.search, 40)}`,\n                    }}\n                  >\n                    <div style={{\n                      width: 36,\n                      height: 36,\n                      borderRadius: borderRadius.sm,\n                      background: withOpacity(PANEL_COLORS.search, 25),\n                      display: 'flex',\n                      alignItems: 'center',\n                      justifyContent: 'center',\n                      color: colors.textMuted,\n                      fontSize: typography.fontSize.xs\n                    }}>\n                      {item.image ? (\n                        <img src={item.image} alt=\"\" style={{\n                          width: '100%',\n                          height: '100%',\n                          objectFit: 'cover',\n                          borderRadius: borderRadius.sm\n                        }} />\n                      ) : 'No img'}\n                    </div>\n                    <div style={{ flex: 1 }}>\n                      <div style={{\n                        fontSize: typography.fontSize.sm,\n                        fontWeight: typography.fontWeight.medium,\n                        color: colors.textPrimary\n                      }}>\n                        {item.name}\n                      </div>\n                      <div style={{\n                        fontSize: typography.fontSize.xs,\n                        color: colors.textMuted\n                      }}>\n                        {item.id}  {item.category}\n                      </div>\n                    </div>\n                    <Badge text={item.status} color={getStatusColor(item.status)} />\n                  </div>\n                ))}\n              </div>\n            )}\n\n            {quickSearch && searchResults.length === 0 && (\n              <p style={{\n                color: colors.textMuted,\n                textAlign: 'center',\n                fontSize: typography.fontSize.sm,\n                padding: spacing[4],\n                margin: 0\n              }}>\n                No items found\n              </p>\n            )}\n\n            {!quickSearch && (\n              <p style={{\n                color: colors.textMuted,\n                textAlign: 'center',\n                fontSize: typography.fontSize.sm,\n                padding: spacing[4],\n                margin: 0\n              }}>\n                Start typing to search inventory\n              </p>\n            )}\n          </CollapsibleSection>\n        );\n\n      case 'alerts':\n        return (\n          <CollapsibleSection\n            key=\"alerts\"\n            title=\"Alerts\"\n            icon={AlertTriangle}\n            badge={stats.alerts.length || null}\n            badgeColor={PANEL_COLORS.alerts}\n            headerColor={PANEL_COLORS.alerts}\n            collapsed={isCollapsed('alerts')}\n            onToggleCollapse={() => toggleCollapse('alerts')}\n            action={stats.alerts.length > 0 ? (\n              <button\n                onClick={(e) => { e.stopPropagation(); onViewAlerts(); }}\n                style={{ ...styles.btnSec, padding: `${spacing[1]}px ${spacing[2]}px`, fontSize: typography.fontSize.xs }}\n              >\n                View All\n              </button>\n            ) : null}\n            padding={false}\n          >\n            {stats.alerts.length === 0 ? (\n              <div style={{ padding: spacing[4], color: colors.textMuted, fontSize: typography.fontSize.sm, textAlign: 'center' }}>\n                No alerts\n              </div>\n            ) : (\n              <div style={{ padding: spacing[4], maxHeight: 240, overflowY: 'auto' }}>\n                {stats.alerts.map(item => (\n                  <div\n                    key={item.id}\n                    onClick={() => onViewItem(item.id)}\n                    style={{\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: spacing[3],\n                      padding: spacing[3],\n                      borderRadius: borderRadius.md,\n                      cursor: 'pointer',\n                      marginBottom: spacing[2],\n                      background: withOpacity(PANEL_COLORS.alerts, 15),\n                      border: `1px solid ${withOpacity(PANEL_COLORS.alerts, 40)}`,\n                    }}\n                  >\n                    <AlertTriangle size={16} color={PANEL_COLORS.alerts} />\n                    <div style={{ flex: 1 }}>\n                      <div style={{ fontSize: typography.fontSize.sm, color: colors.textPrimary }}>\n                        {item.name}\n                      </div>\n                      <div style={{ fontSize: typography.fontSize.xs, color: PANEL_COLORS.alerts }}>\n                        Needs attention  {item.category}\n                      </div>\n                    </div>\n                    <ChevronRight size={16} color={colors.textMuted} />\n                  </div>\n                ))}\n              </div>\n            )}\n          </CollapsibleSection>\n        );\n\n      case 'reminders':\n        return (\n          <CollapsibleSection\n            key=\"reminders\"\n            title=\"Due Reminders\"\n            icon={Bell}\n            badge={stats.dueReminders.length || null}\n            badgeColor={PANEL_COLORS.reminders}\n            headerColor={PANEL_COLORS.reminders}\n            collapsed={isCollapsed('reminders')}\n            onToggleCollapse={() => toggleCollapse('reminders')}\n            padding={false}\n          >\n            {stats.dueReminders.length === 0 ? (\n              <div style={{ padding: spacing[4], color: colors.textMuted, fontSize: typography.fontSize.sm, textAlign: 'center' }}>\n                No due reminders\n              </div>\n            ) : (\n              <div style={{ padding: spacing[4], maxHeight: 240, overflowY: 'auto' }}>\n                {stats.dueReminders.map(reminder => (\n                  <div\n                    key={reminder.id}\n                    onClick={() => onViewItem(reminder.item.id)}\n                    style={{\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: spacing[3],\n                      padding: spacing[3],\n                      borderRadius: borderRadius.md,\n                      cursor: 'pointer',\n                      marginBottom: spacing[2],\n                      background: withOpacity(PANEL_COLORS.reminders, 15),\n                      border: `1px solid ${withOpacity(PANEL_COLORS.reminders, 40)}`,\n                    }}\n                  >\n                    <Bell size={16} color={PANEL_COLORS.reminders} />\n                    <div style={{ flex: 1 }}>\n                      <div style={{ fontSize: typography.fontSize.sm, color: colors.textPrimary }}>\n                        {reminder.title}\n                      </div>\n                      <div style={{ fontSize: typography.fontSize.xs, color: PANEL_COLORS.reminders }}>\n                        {reminder.item.name}  Due {formatDate(reminder.dueDate)}\n                      </div>\n                    </div>\n                    <ChevronRight size={16} color={colors.textMuted} />\n                  </div>\n                ))}\n              </div>\n            )}\n          </CollapsibleSection>\n        );\n\n      case 'lowStock':\n        return (\n          <CollapsibleSection\n            key=\"lowStock\"\n            title=\"Low Stock Items\"\n            icon={TrendingDown}\n            badge={stats.lowStockItems.length || null}\n            badgeColor={PANEL_COLORS.lowStock}\n            headerColor={PANEL_COLORS.lowStock}\n            collapsed={isCollapsed('lowStock')}\n            onToggleCollapse={() => toggleCollapse('lowStock')}\n            action={stats.lowStockItems.length > 0 ? (\n              <button\n                onClick={(e) => { e.stopPropagation(); onViewLowStock(); }}\n                style={{ ...styles.btnSec, padding: `${spacing[1]}px ${spacing[2]}px`, fontSize: typography.fontSize.xs }}\n              >\n                View All\n              </button>\n            ) : null}\n            padding={false}\n          >\n            {stats.lowStockItems.length === 0 ? (\n              <div style={{ padding: spacing[4], color: colors.textMuted, fontSize: typography.fontSize.sm, textAlign: 'center' }}>\n                No low stock items\n              </div>\n            ) : (\n              <div style={{ padding: spacing[4], maxHeight: 200, overflowY: 'auto' }}>\n                {stats.lowStockItems.map(item => (\n                  <div\n                    key={item.id}\n                    onClick={() => onViewItem(item.id)}\n                    style={{\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: spacing[3],\n                      padding: spacing[3],\n                      borderRadius: borderRadius.md,\n                      cursor: 'pointer',\n                      marginBottom: spacing[2],\n                      background: withOpacity(PANEL_COLORS.lowStock, 15),\n                      border: `1px solid ${withOpacity(PANEL_COLORS.lowStock, 40)}`,\n                    }}\n                  >\n                    <TrendingDown size={16} color={PANEL_COLORS.lowStock} />\n                    <div style={{ flex: 1 }}>\n                      <div style={{ fontSize: typography.fontSize.sm, color: colors.textPrimary }}>\n                        {item.name}\n                      </div>\n                      <div style={{ fontSize: typography.fontSize.xs, color: PANEL_COLORS.lowStock }}>\n                        {item.quantity || 0} remaining (min: {item.reorderPoint || categorySettings?.[item.category]?.lowStockThreshold || 0})\n                      </div>\n                    </div>\n                    <Badge text={item.category} color={PANEL_COLORS.lowStock} size=\"xs\" />\n                    <ChevronRight size={16} color={colors.textMuted} />\n                  </div>\n                ))}\n              </div>\n            )}\n          </CollapsibleSection>\n        );\n\n      case 'reservations':\n        return (\n          <CollapsibleSection\n            key=\"reservations\"\n            title=\"Upcoming Reservations\"\n            icon={Calendar}\n            badge={upcomingReservations.length}\n            badgeColor={PANEL_COLORS.reservations}\n            headerColor={PANEL_COLORS.reservations}\n            collapsed={isCollapsed('reservations')}\n            onToggleCollapse={() => toggleCollapse('reservations')}\n            action={\n              <button\n                onClick={(e) => { e.stopPropagation(); onViewReservations(); }}\n                style={{ ...styles.btnSec, padding: `${spacing[1]}px ${spacing[2]}px`, fontSize: typography.fontSize.xs }}\n              >\n                View All\n              </button>\n            }\n            padding={false}\n          >\n            <div style={{ padding: spacing[4], maxHeight: 240, overflowY: 'auto' }}>\n              {upcomingReservations.length === 0 ? (\n                <p style={{ color: colors.textMuted, textAlign: 'center', margin: 0 }}>\n                  No upcoming reservations\n                </p>\n              ) : (\n                <div style={{\n                  display: 'grid',\n                  gridTemplateColumns: 'repeat(auto-fill, minmax(220px, 1fr))',\n                  gap: spacing[3]\n                }}>\n                  {upcomingReservations.map(r => (\n                    <div\n                      key={r.id}\n                      onClick={() => onViewReservation ? onViewReservation(r, r.item) : onViewItem(r.item.id)}\n                      style={{\n                        display: 'flex',\n                        alignItems: 'center',\n                        gap: spacing[3],\n                        padding: spacing[3],\n                        borderRadius: borderRadius.md,\n                        background: withOpacity(PANEL_COLORS.reservations, 15),\n                        border: `1px solid ${withOpacity(PANEL_COLORS.reservations, 40)}`,\n                        cursor: 'pointer'\n                      }}\n                    >\n                      <div style={{\n                        width: 40,\n                        height: 40,\n                        borderRadius: borderRadius.sm,\n                        background: withOpacity(PANEL_COLORS.reservations, 25),\n                        display: 'flex',\n                        alignItems: 'center',\n                        justifyContent: 'center',\n                        color: colors.textMuted,\n                        fontSize: typography.fontSize.xs,\n                        flexShrink: 0\n                      }}>\n                        {r.item.image ? (\n                          <img src={r.item.image} alt=\"\" style={{\n                            width: '100%',\n                            height: '100%',\n                            objectFit: 'cover',\n                            borderRadius: borderRadius.sm\n                          }} />\n                        ) : 'img'}\n                      </div>\n                      <div style={{ flex: 1, minWidth: 0 }}>\n                        <div style={{\n                          fontSize: typography.fontSize.sm,\n                          color: colors.textPrimary,\n                          overflow: 'hidden',\n                          textOverflow: 'ellipsis',\n                          whiteSpace: 'nowrap'\n                        }}>\n                          {r.item.name}\n                        </div>\n                        <div style={{\n                          fontSize: typography.fontSize.xs,\n                          color: PANEL_COLORS.reservations\n                        }}>\n                          {r.project}  {formatDate(r.start)}\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          </CollapsibleSection>\n        );\n\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <>\n      {/* Header */}\n      <div className=\"page-header\">\n        <h2 className=\"page-title\">Dashboard</h2>\n        {onCustomizeLayout && (\n          <Button variant=\"secondary\" onClick={onCustomizeLayout} icon={Layout}>\n            Customize\n          </Button>\n        )}\n      </div>\n\n      {/* Render sections in order */}\n      <div style={{ display: 'flex', flexDirection: 'column', gap: spacing[4] }}>\n        {sectionOrder.map(sectionId => renderSection(sectionId))}\n      </div>\n    </>\n  );\n}\n\nexport default memo(Dashboard);\n","// =============================================================================\n// SIMS Storage Service\n// Handles file uploads to Supabase Storage with thumbnail generation\n// =============================================================================\n\nimport { getSupabase } from './supabase.js';\n\nimport { error as logError } from './logger.js';\n\n// Storage bucket name\nconst BUCKET_NAME = 'equipment-images';\n\n// Maximum file size (5MB)\nconst MAX_FILE_SIZE = 5 * 1024 * 1024;\n\n// Allowed image types\nconst ALLOWED_TYPES = ['image/jpeg', 'image/png', 'image/webp', 'image/gif'];\n\n// Image size settings\nconst FULL_SIZE_MAX = 1200; // Max dimension for full-size images\nconst THUMBNAIL_SIZE = 200; // Thumbnail dimension (square crop)\n\n/**\n * Resize an image using canvas\n * @param {Blob|File} imageBlob - The image to resize\n * @param {number} maxSize - Maximum dimension\n * @param {boolean} square - Whether to crop to square\n * @returns {Promise<Blob>}\n */\nasync function resizeImage(imageBlob, maxSize, square = false) {\n  return new Promise((resolve, reject) => {\n    const img = new Image();\n    const url = URL.createObjectURL(imageBlob);\n    \n    img.onload = () => {\n      URL.revokeObjectURL(url);\n      \n      let width = img.width;\n      let height = img.height;\n      let sx = 0, sy = 0, sWidth = width, sHeight = height;\n      \n      if (square) {\n        // Crop to square from center\n        const minDim = Math.min(width, height);\n        sx = (width - minDim) / 2;\n        sy = (height - minDim) / 2;\n        sWidth = sHeight = minDim;\n        width = height = maxSize;\n      } else {\n        // Maintain aspect ratio\n        if (width > height) {\n          if (width > maxSize) {\n            height = Math.round((height * maxSize) / width);\n            width = maxSize;\n          }\n        } else {\n          if (height > maxSize) {\n            width = Math.round((width * maxSize) / height);\n            height = maxSize;\n          }\n        }\n      }\n      \n      const canvas = document.createElement('canvas');\n      canvas.width = width;\n      canvas.height = height;\n      \n      const ctx = canvas.getContext('2d');\n      ctx.imageSmoothingEnabled = true;\n      ctx.imageSmoothingQuality = 'high';\n      ctx.drawImage(img, sx, sy, sWidth, sHeight, 0, 0, width, height);\n      \n      canvas.toBlob(\n        (blob) => {\n          if (blob) {\n            resolve(blob);\n          } else {\n            reject(new Error('Failed to create image blob'));\n          }\n        },\n        'image/jpeg',\n        0.85 // Quality\n      );\n    };\n    \n    img.onerror = () => {\n      URL.revokeObjectURL(url);\n      reject(new Error('Failed to load image'));\n    };\n    \n    img.src = url;\n  });\n}\n\n// Helper to convert file to base64 (fallback)\nfunction fileToBase64(file) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = () => resolve({ url: reader.result, path: null, thumbnailUrl: reader.result });\n    reader.onerror = () => reject(new Error('Failed to read file'));\n    reader.readAsDataURL(file);\n  });\n}\n\n/**\n * Storage service for handling file uploads\n */\nexport const storageService = {\n  /**\n   * Upload an image file to Supabase Storage (with thumbnail)\n   * @param {File} file - The file to upload\n   * @param {string} itemId - The item ID (used for organizing files)\n   * @returns {Promise<{url: string, path: string, thumbnailUrl: string} | null>}\n   */\n  async uploadImage(file, itemId) {\n    const supabase = await getSupabase();\n    if (!supabase) {\n      // Fall back to base64 if Supabase not available\n      return fileToBase64(file);\n    }\n\n    // Validate file\n    if (!file) {\n      throw new Error('No file provided');\n    }\n\n    if (!ALLOWED_TYPES.includes(file.type)) {\n      throw new Error(`Invalid file type. Allowed: ${ALLOWED_TYPES.join(', ')}`);\n    }\n\n    if (file.size > MAX_FILE_SIZE) {\n      throw new Error(`File too large. Maximum size: ${MAX_FILE_SIZE / 1024 / 1024}MB`);\n    }\n\n    // Generate unique filename base\n    const timestamp = Date.now();\n    const basePath = `${itemId}/${timestamp}`;\n    \n    try {\n      // Resize full image (if needed) and create thumbnail\n      const [fullBlob, thumbBlob] = await Promise.all([\n        resizeImage(file, FULL_SIZE_MAX, false),\n        resizeImage(file, THUMBNAIL_SIZE, true)\n      ]);\n\n      // Upload both images in parallel\n      const [fullResult, thumbResult] = await Promise.all([\n        supabase.storage\n          .from(BUCKET_NAME)\n          .upload(`${basePath}.jpg`, fullBlob, {\n            contentType: 'image/jpeg',\n            cacheControl: '31536000', // 1 year cache\n            upsert: false,\n          }),\n        supabase.storage\n          .from(BUCKET_NAME)\n          .upload(`${basePath}_thumb.jpg`, thumbBlob, {\n            contentType: 'image/jpeg',\n            cacheControl: '31536000',\n            upsert: false,\n          })\n      ]);\n\n      if (fullResult.error) {\n        logError('Full image upload error:', fullResult.error);\n        throw new Error(`Upload failed: ${fullResult.error.message}`);\n      }\n\n      if (thumbResult.error) {\n        logError('Thumbnail upload error:', thumbResult.error);\n        // Continue even if thumbnail fails - full image is more important\n      }\n\n      // Get public URLs\n      const { data: fullUrlData } = supabase.storage\n        .from(BUCKET_NAME)\n        .getPublicUrl(fullResult.data.path);\n\n      const { data: thumbUrlData } = supabase.storage\n        .from(BUCKET_NAME)\n        .getPublicUrl(thumbResult.data?.path || fullResult.data.path);\n\n      return {\n        url: fullUrlData.publicUrl,\n        path: fullResult.data.path,\n        thumbnailUrl: thumbUrlData.publicUrl,\n      };\n    } catch (resizeError) {\n      logError('Image processing error:', resizeError);\n      // Fall back to uploading original without resize\n      const extension = file.name.split('.').pop() || 'jpg';\n      const filename = `${basePath}.${extension}`;\n\n      const { data, error } = await supabase.storage\n        .from(BUCKET_NAME)\n        .upload(filename, file, {\n          cacheControl: '3600',\n          upsert: false,\n        });\n\n      if (error) {\n        throw new Error(`Upload failed: ${error.message}`);\n      }\n\n      const { data: urlData } = supabase.storage\n        .from(BUCKET_NAME)\n        .getPublicUrl(data.path);\n\n      return {\n        url: urlData.publicUrl,\n        path: data.path,\n        thumbnailUrl: urlData.publicUrl, // Same as full if resize failed\n      };\n    }\n  },\n\n  /**\n   * Upload an image from a data URL (base64)\n   * @param {string} dataUrl - The base64 data URL\n   * @param {string} itemId - The item ID\n   * @returns {Promise<{url: string, path: string, thumbnailUrl: string} | null>}\n   */\n  async uploadFromDataUrl(dataUrl, itemId) {\n    const supabase = await getSupabase();\n    if (!supabase) {\n      return { url: dataUrl, path: null, thumbnailUrl: dataUrl };\n    }\n\n    // Convert data URL to blob\n    const response = await fetch(dataUrl);\n    const blob = await response.blob();\n    \n    // Create a File object\n    const extension = dataUrl.includes('image/png') ? 'png' : \n                     dataUrl.includes('image/webp') ? 'webp' : \n                     dataUrl.includes('image/gif') ? 'gif' : 'jpg';\n    const file = new File([blob], `image.${extension}`, { type: blob.type });\n    \n    return this.uploadImage(file, itemId);\n  },\n\n  /**\n   * Delete an image from Supabase Storage (including thumbnail)\n   * @param {string} path - The storage path of the image\n   * @returns {Promise<boolean>}\n   */\n  async deleteImage(path) {\n    if (!path) {\n      return true;\n    }\n    \n    const supabase = await getSupabase();\n    if (!supabase) {\n      return true;\n    }\n\n    // Also try to delete thumbnail\n    const thumbPath = path.replace(/\\.(jpg|jpeg|png|webp|gif)$/i, '_thumb.jpg');\n    const pathsToDelete = [path];\n    if (thumbPath !== path) {\n      pathsToDelete.push(thumbPath);\n    }\n\n    const { error } = await supabase.storage\n      .from(BUCKET_NAME)\n      .remove(pathsToDelete);\n\n    if (error) {\n      logError('Delete error:', error);\n      return false;\n    }\n\n    return true;\n  },\n\n  /**\n   * Delete all images for an item\n   * @param {string} itemId - The item ID\n   * @returns {Promise<boolean>}\n   */\n  async deleteItemImages(itemId) {\n    const supabase = await getSupabase();\n    if (!supabase) {\n      return true;\n    }\n\n    // List all files in the item's folder\n    const { data: files, error: listError } = await supabase.storage\n      .from(BUCKET_NAME)\n      .list(itemId);\n\n    if (listError) {\n      logError('List error:', listError);\n      return false;\n    }\n\n    if (!files || files.length === 0) {\n      return true;\n    }\n\n    // Delete all files\n    const paths = files.map(f => `${itemId}/${f.name}`);\n    const { error } = await supabase.storage\n      .from(BUCKET_NAME)\n      .remove(paths);\n\n    if (error) {\n      logError('Delete error:', error);\n      return false;\n    }\n\n    return true;\n  },\n\n  /**\n   * Get a signed URL for private access (if bucket is not public)\n   * @param {string} path - The storage path\n   * @param {number} expiresIn - Seconds until expiration (default 1 hour)\n   * @returns {Promise<string | null>}\n   */\n  async getSignedUrl(path, expiresIn = 3600) {\n    if (!path) {\n      return null;\n    }\n    \n    const supabase = await getSupabase();\n    if (!supabase) {\n      return null;\n    }\n\n    const { data, error } = await supabase.storage\n      .from(BUCKET_NAME)\n      .createSignedUrl(path, expiresIn);\n\n    if (error) {\n      logError('Signed URL error:', error);\n      return null;\n    }\n\n    return data.signedUrl;\n  },\n\n  /**\n   * Check if the storage bucket exists and is accessible\n   * @returns {Promise<boolean>}\n   */\n  async checkBucket() {\n    const supabase = await getSupabase();\n    if (!supabase) {\n      return false;\n    }\n\n    try {\n      const { data, error } = await supabase.storage.getBucket(BUCKET_NAME);\n      return !error && !!data;\n    } catch {\n      return false;\n    }\n  },\n\n  /**\n   * Initialize storage bucket (run once during setup)\n   * Note: This requires admin/service role key, not anon key\n   * @returns {Promise<boolean>}\n   */\n  async initBucket() {\n    const supabase = await getSupabase();\n    if (!supabase) {\n      return false;\n    }\n\n    try {\n      // Check if bucket exists\n      const { data: existing } = await supabase.storage.getBucket(BUCKET_NAME);\n      \n      if (existing) {\n        return true;\n      }\n\n      // Create bucket (requires service role key)\n      const { error } = await supabase.storage.createBucket(BUCKET_NAME, {\n        public: true,\n        fileSizeLimit: MAX_FILE_SIZE,\n        allowedMimeTypes: ALLOWED_TYPES,\n      });\n\n      if (error) {\n        logError('Bucket creation error:', error);\n        return false;\n      }\n\n      return true;\n    } catch (err) {\n      logError('Bucket init error:', err);\n      return false;\n    }\n  },\n};\n\n/**\n * Helper to check if a URL is a data URL (base64)\n */\nexport function isDataUrl(url) {\n  return url && url.startsWith('data:');\n}\n\n/**\n * Helper to check if a URL is a Supabase Storage URL\n */\nexport function isStorageUrl(url) {\n  return url && (\n    url.includes('supabase.co/storage') || \n    url.includes('supabase.in/storage')\n  );\n}\n\n/**\n * Helper to extract storage path from URL\n */\nexport function getStoragePathFromUrl(url) {\n  if (!isStorageUrl(url)) return null;\n  \n  try {\n    const urlObj = new URL(url);\n    const pathMatch = urlObj.pathname.match(/\\/storage\\/v1\\/object\\/public\\/([^?]+)/);\n    return pathMatch ? pathMatch[1].replace(`${BUCKET_NAME}/`, '') : null;\n  } catch {\n    return null;\n  }\n}\n\n/**\n * Get thumbnail URL from full image URL\n * @param {string} url - The full image URL\n * @returns {string} - The thumbnail URL (or original if not a storage URL)\n */\nexport function getThumbnailUrl(url) {\n  if (!url) return url;\n  \n  // If it's a data URL, return as-is\n  if (isDataUrl(url)) return url;\n  \n  // If it's already a thumbnail, return as-is\n  if (url.includes('_thumb.')) return url;\n  \n  // If it's a Supabase storage URL, convert to thumbnail URL\n  if (isStorageUrl(url)) {\n    return url.replace(/\\.(jpg|jpeg|png|webp|gif)(\\?|$)/i, '_thumb.jpg$2');\n  }\n  \n  return url;\n}\n\nexport default storageService;\n","// =============================================================================\n// OptimizedImage Component\n// Displays thumbnails for fast loading, with option for full-size images\n// =============================================================================\n\nimport React, { useState, useRef, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { getThumbnailUrl } from '../lib/index.js';\nimport { colors, borderRadius } from '../theme.js';\n\n/**\n * OptimizedImage - Displays images with thumbnail/full-size optimization\n * \n * Features:\n * - Lazy loading with IntersectionObserver\n * - Thumbnail display for list views (fast loading)\n * - Full-size display for detail views\n * - Loading placeholder\n * - Error fallback\n * - Smooth fade-in transition\n */\nexport function OptimizedImage({\n  src,\n  alt = '',\n  size = 'thumbnail', // 'thumbnail' | 'full'\n  width,\n  height,\n  style = {},\n  className = '',\n  objectFit = 'cover',\n  placeholder = null,\n  onLoad,\n  onError,\n  lazy = true,\n}) {\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [hasError, setHasError] = useState(false);\n  const [isInView, setIsInView] = useState(!lazy);\n  const imgRef = useRef(null);\n  const containerRef = useRef(null);\n\n  // Get the appropriate URL based on size\n  const imageUrl = size === 'thumbnail' ? getThumbnailUrl(src) : src;\n\n  // Intersection Observer for lazy loading\n  useEffect(() => {\n    if (!lazy || isInView) return;\n\n    const observer = new IntersectionObserver(\n      ([entry]) => {\n        if (entry.isIntersecting) {\n          setIsInView(true);\n          observer.disconnect();\n        }\n      },\n      {\n        rootMargin: '50px', // Start loading slightly before in view\n        threshold: 0.01,\n      }\n    );\n\n    if (containerRef.current) {\n      observer.observe(containerRef.current);\n    }\n\n    return () => observer.disconnect();\n  }, [lazy, isInView]);\n\n  // Reset state when src changes\n  useEffect(() => {\n    setIsLoaded(false);\n    setHasError(false);\n  }, [src]);\n\n  const handleLoad = (e) => {\n    setIsLoaded(true);\n    onLoad?.(e);\n  };\n\n  const handleError = (e) => {\n    setHasError(true);\n    onError?.(e);\n    \n    // If thumbnail failed, try full-size as fallback\n    if (size === 'thumbnail' && imageUrl !== src) {\n      const img = e.target;\n      img.src = src;\n    }\n  };\n\n  // Default placeholder\n  const defaultPlaceholder = (\n    <div\n      style={{\n        width: width || '100%',\n        height: height || '100%',\n        backgroundColor: colors.surfaceHover,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        color: colors.textMuted,\n        fontSize: '12px',\n      }}\n    >\n      {hasError ? '' : ''}\n    </div>\n  );\n\n  const containerStyle = {\n    width: width || '100%',\n    height: height || '100%',\n    position: 'relative',\n    overflow: 'hidden',\n    backgroundColor: colors.surfaceHover,\n    borderRadius: borderRadius.md,\n    ...style,\n  };\n\n  const imageStyle = {\n    width: '100%',\n    height: '100%',\n    objectFit,\n    opacity: isLoaded ? 1 : 0,\n    transition: 'opacity 0.2s ease-in-out',\n  };\n\n  // No image provided\n  if (!src) {\n    return (\n      <div ref={containerRef} style={containerStyle} className={className}>\n        {placeholder || defaultPlaceholder}\n      </div>\n    );\n  }\n\n  return (\n    <div ref={containerRef} style={containerStyle} className={className}>\n      {/* Placeholder while loading */}\n      {!isLoaded && !hasError && (\n        <div\n          style={{\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            right: 0,\n            bottom: 0,\n          }}\n        >\n          {placeholder || defaultPlaceholder}\n        </div>\n      )}\n\n      {/* Error state */}\n      {hasError && !isLoaded && (\n        <div\n          style={{\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            right: 0,\n            bottom: 0,\n          }}\n        >\n          {placeholder || defaultPlaceholder}\n        </div>\n      )}\n\n      {/* Actual image - only load when in view */}\n      {isInView && (\n        <img\n          ref={imgRef}\n          src={imageUrl}\n          alt={alt}\n          style={imageStyle}\n          onLoad={handleLoad}\n          onError={handleError}\n          loading={lazy ? 'lazy' : 'eager'}\n          decoding=\"async\"\n        />\n      )}\n    </div>\n  );\n}\n\nOptimizedImage.propTypes = {\n  src: PropTypes.string,\n  alt: PropTypes.string,\n  size: PropTypes.oneOf(['thumbnail', 'full']),\n  width: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  style: PropTypes.object,\n  className: PropTypes.string,\n  objectFit: PropTypes.oneOf(['cover', 'contain', 'fill', 'none', 'scale-down']),\n  placeholder: PropTypes.node,\n  onLoad: PropTypes.func,\n  onError: PropTypes.func,\n  lazy: PropTypes.bool,\n};\n\nexport default OptimizedImage;\n","// ============================================================================\n// Custom Select Component\n// Styled dropdown that works consistently across browsers\n// Uses React Portal to escape stacking context issues (e.g., backdrop-filter)\n// ============================================================================\n\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { createPortal } from 'react-dom';\nimport {colors, typography, borderRadius} from '../theme.js';\nimport { ChevronDown } from 'lucide-react';\n\nexport function Select({ \n  value, \n  onChange, \n  options = [], \n  placeholder = 'Select...',\n  style = {},\n  disabled = false,\n  'aria-label': ariaLabel,\n}) {\n  const [isOpen, setIsOpen] = useState(false);\n  const [highlightedIndex, setHighlightedIndex] = useState(-1);\n  const [dropdownPosition, setDropdownPosition] = useState({ top: 0, left: 0, width: 0, direction: 'down' });\n  const containerRef = useRef(null);\n  const listRef = useRef(null);\n\n  // Find the selected option\n  const selectedOption = options.find(opt => \n    (typeof opt === 'object' ? opt.value : opt) === value\n  );\n  \n  const displayValue = selectedOption \n    ? (typeof selectedOption === 'object' ? selectedOption.label : selectedOption)\n    : placeholder;\n\n  // Calculate dropdown position relative to viewport\n  const updateDropdownPosition = useCallback(() => {\n    if (!containerRef.current) return;\n    \n    const rect = containerRef.current.getBoundingClientRect();\n    const spaceBelow = window.innerHeight - rect.bottom;\n    const spaceAbove = rect.top;\n    const dropdownHeight = Math.min(options.length * 36 + 8, 200);\n    \n    // Open upward if not enough space below but enough above\n    const direction = (spaceBelow < dropdownHeight && spaceAbove > dropdownHeight) ? 'up' : 'down';\n    \n    setDropdownPosition({\n      top: direction === 'down' ? rect.bottom + 4 : rect.top - dropdownHeight - 4,\n      left: rect.left,\n      width: rect.width,\n      direction\n    });\n  }, [options.length]);\n\n  // Close on click outside\n  useEffect(() => {\n    if (!isOpen) return;\n    \n    const handleClickOutside = (e) => {\n      if (containerRef.current && !containerRef.current.contains(e.target)) {\n        // Also check if click is in the portal dropdown\n        if (listRef.current && listRef.current.contains(e.target)) {\n          return;\n        }\n        setIsOpen(false);\n      }\n    };\n    \n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, [isOpen]);\n\n  // Update position when opening and on scroll/resize\n  useEffect(() => {\n    if (isOpen) {\n      updateDropdownPosition();\n      \n      const handleScrollOrResize = () => updateDropdownPosition();\n      window.addEventListener('scroll', handleScrollOrResize, true);\n      window.addEventListener('resize', handleScrollOrResize);\n      \n      return () => {\n        window.removeEventListener('scroll', handleScrollOrResize, true);\n        window.removeEventListener('resize', handleScrollOrResize);\n      };\n    }\n  }, [isOpen, updateDropdownPosition]);\n\n  // Keyboard navigation\n  const handleKeyDown = useCallback((e) => {\n    if (disabled) return;\n\n    switch (e.key) {\n      case 'Enter':\n      case ' ':\n        e.preventDefault();\n        if (isOpen && highlightedIndex >= 0) {\n          const opt = options[highlightedIndex];\n          const val = typeof opt === 'object' ? opt.value : opt;\n          onChange({ target: { value: val } });\n          setIsOpen(false);\n        } else {\n          setIsOpen(true);\n        }\n        break;\n      case 'Escape':\n        setIsOpen(false);\n        break;\n      case 'ArrowDown':\n        e.preventDefault();\n        if (!isOpen) {\n          setIsOpen(true);\n        } else {\n          setIsKeyboardNav(true);\n          setHighlightedIndex(prev => \n            prev < options.length - 1 ? prev + 1 : 0\n          );\n        }\n        break;\n      case 'ArrowUp':\n        e.preventDefault();\n        if (isOpen) {\n          setIsKeyboardNav(true);\n          setHighlightedIndex(prev => \n            prev > 0 ? prev - 1 : options.length - 1\n          );\n        }\n        break;\n      case 'Tab':\n        setIsOpen(false);\n        break;\n    }\n  }, [isOpen, highlightedIndex, options, onChange, disabled]);\n\n  // Scroll highlighted option into view (only for keyboard navigation)\n  const [isKeyboardNav, setIsKeyboardNav] = useState(false);\n  \n  useEffect(() => {\n    if (isOpen && highlightedIndex >= 0 && listRef.current && isKeyboardNav) {\n      const highlightedEl = listRef.current.children[highlightedIndex];\n      if (highlightedEl) {\n        highlightedEl.scrollIntoView({ block: 'nearest' });\n      }\n      setIsKeyboardNav(false);\n    }\n  }, [highlightedIndex, isOpen, isKeyboardNav]);\n\n  // Reset highlighted index when opening\n  useEffect(() => {\n    if (isOpen) {\n      const currentIndex = options.findIndex(opt => \n        (typeof opt === 'object' ? opt.value : opt) === value\n      );\n      setHighlightedIndex(currentIndex >= 0 ? currentIndex : 0);\n    }\n  }, [isOpen, options, value]);\n\n  const handleSelect = (opt) => {\n    const val = typeof opt === 'object' ? opt.value : opt;\n    onChange({ target: { value: val } });\n    setIsOpen(false);\n  };\n\n  // Render dropdown via portal to escape stacking context\n  const dropdown = isOpen && createPortal(\n    <ul\n      ref={listRef}\n      role=\"listbox\"\n      aria-activedescendant={highlightedIndex >= 0 ? `option-${highlightedIndex}` : undefined}\n      style={{\n        position: 'fixed',\n        top: dropdownPosition.top,\n        left: dropdownPosition.left,\n        width: dropdownPosition.width,\n        padding: 4,\n        background: colors.bgMedium,\n        border: `1px solid ${colors.border}`,\n        borderRadius: borderRadius.lg,\n        boxShadow: '0 4px 12px rgba(0, 0, 0, 0.3)',\n        zIndex: 99999,\n        maxHeight: 200,\n        overflowY: 'auto',\n        listStyle: 'none',\n        margin: 0,\n        fontFamily: 'system-ui, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif',\n      }}\n    >\n      {options.map((opt, index) => {\n        const optValue = typeof opt === 'object' ? opt.value : opt;\n        const optLabel = typeof opt === 'object' ? opt.label : opt;\n        const isSelected = optValue === value;\n        const isHighlighted = index === highlightedIndex;\n        \n        return (\n          <li\n            key={optValue}\n            id={`option-${index}`}\n            role=\"option\"\n            aria-selected={isSelected}\n            onClick={() => handleSelect(opt)}\n            onMouseEnter={() => setHighlightedIndex(index)}\n            style={{\n              padding: '10px 16px',\n              borderRadius: borderRadius.md,\n              cursor: 'pointer',\n              color: colors.textPrimary,\n              fontSize: typography.fontSize.base,\n              fontFamily: 'inherit',\n              background: isHighlighted \n                ? `rgba(106, 154, 184, 0.2)` \n                : isSelected \n                  ? `rgba(106, 154, 184, 0.1)` \n                  : 'transparent',\n              fontWeight: isSelected ? 600 : 400,\n              transition: 'background 0.15s ease',\n            }}\n          >\n            {optLabel}\n          </li>\n        );\n      })}\n    </ul>,\n    document.body\n  );\n\n  return (\n    <div \n      ref={containerRef}\n      style={{ position: 'relative', ...style }}\n    >\n      {/* Trigger button */}\n      <button\n        type=\"button\"\n        onClick={() => !disabled && setIsOpen(!isOpen)}\n        onKeyDown={handleKeyDown}\n        disabled={disabled}\n        aria-haspopup=\"listbox\"\n        aria-expanded={isOpen}\n        aria-label={ariaLabel}\n        style={{\n          width: '100%',\n          padding: '12px 16px',\n          paddingRight: 40,\n          background: 'var(--input-bg, rgba(106, 154, 184, 0.1))',\n          border: `1px solid ${colors.border}`,\n          borderRadius: borderRadius.lg,\n          color: selectedOption ? colors.textPrimary : colors.textMuted,\n          fontSize: typography.fontSize.base,\n          textAlign: 'left',\n          cursor: disabled ? 'not-allowed' : 'pointer',\n          opacity: disabled ? 0.6 : 1,\n          position: 'relative',\n          display: 'flex',\n          alignItems: 'center',\n          boxSizing: 'border-box',\n          transition: 'border-color 150ms ease, box-shadow 150ms ease',\n          outline: 'none',\n          ...(isOpen && { \n            borderColor: colors.primary,\n            boxShadow: `0 0 0 2px rgba(106, 154, 184, 0.2)`\n          }),\n        }}\n      >\n        {displayValue}\n        <ChevronDown \n          size={16} \n          style={{ \n            position: 'absolute', \n            right: 12, \n            top: '50%', \n            transform: 'translateY(-50%)',\n            color: colors.textMuted,\n            transition: 'transform 0.2s ease',\n            ...(isOpen && { transform: 'translateY(-50%) rotate(180deg)' }),\n          }} \n        />\n      </button>\n\n      {/* Dropdown rendered via portal */}\n      {dropdown}\n    </div>\n  );\n}\n\nexport default Select;\n","// ============================================================================\n// Gear List Component (formerly Inventory)\n// Optimized for large datasets with pagination and debounced search\n// Supports bulk selection for batch operations\n// Supports saved filter views\n// ============================================================================\n\nimport React, { memo, useMemo, useState, useCallback, useEffect } from 'react';\nimport { Search, Plus, Grid, List, CheckSquare, Square, MinusSquare, X, Bookmark, BookmarkPlus, Trash2, ChevronDown } from 'lucide-react';\nimport { colors, styles, spacing, borderRadius, typography, withOpacity, zIndex } from '../theme.js';\nimport { getStatusColor, filterBySearch, filterByCategory, filterByStatus, generateId } from '../utils.js';\nimport { Badge, Card, Button, SearchInput, Pagination } from '../components/ui.jsx';\nimport { OptimizedImage } from '../components/OptimizedImage.jsx';\nimport { Select } from '../components/Select.jsx';\nimport { useDebounce, usePagination } from '../hooks/index.js';\nimport { usePermissions, ViewOnlyBanner } from '../contexts/PermissionsContext.jsx';\n\n// Items per page options\nconst PAGE_SIZE_OPTIONS = [25, 50, 100, 250, 500];\nconst DEFAULT_PAGE_SIZE = 25;\nconst SAVED_VIEWS_KEY = 'sims-saved-filter-views';\n\n// Checkbox component for consistent styling\nconst Checkbox = memo(function Checkbox({ checked, indeterminate, onChange, size = 20 }) {\n  const Icon = indeterminate ? MinusSquare : checked ? CheckSquare : Square;\n  return (\n    <button\n      onClick={(e) => {\n        e.stopPropagation();\n        onChange(!checked);\n      }}\n      style={{\n        background: 'none',\n        border: 'none',\n        padding: 0,\n        cursor: 'pointer',\n        color: checked || indeterminate ? colors.primary : colors.textMuted,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n      }}\n    >\n      <Icon size={size} />\n    </button>\n  );\n});\n\n// Saved Views Dropdown Component\nconst SavedViewsDropdown = memo(function SavedViewsDropdown({ \n  savedViews, \n  currentFilters,\n  onLoadView, \n  onSaveView, \n  onDeleteView,\n  hasActiveFilters,\n}) {\n  const [isOpen, setIsOpen] = useState(false);\n  const [showSaveDialog, setShowSaveDialog] = useState(false);\n  const [newViewName, setNewViewName] = useState('');\n  const dropdownRef = React.useRef(null);\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (e) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(e.target)) {\n        setIsOpen(false);\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  const handleSave = () => {\n    if (newViewName.trim()) {\n      onSaveView(newViewName.trim());\n      setNewViewName('');\n      setShowSaveDialog(false);\n    }\n  };\n\n  const handleKeyDown = (e) => {\n    if (e.key === 'Enter') {\n      handleSave();\n    } else if (e.key === 'Escape') {\n      setShowSaveDialog(false);\n      setNewViewName('');\n    }\n  };\n\n  return (\n    <div ref={dropdownRef} style={{ position: 'relative' }}>\n      <button\n        onClick={() => setIsOpen(!isOpen)}\n        className=\"btn-secondary\"\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          gap: spacing[2],\n          cursor: 'pointer',\n          minWidth: 140,\n          fontWeight: 500,\n        }}\n      >\n        <Bookmark size={16} />\n        <span>Saved Views</span>\n        <ChevronDown size={16} style={{ marginLeft: 'auto' }} />\n      </button>\n\n      {isOpen && (\n        <div style={{\n          position: 'absolute',\n          top: '100%',\n          left: 0,\n          marginTop: spacing[1],\n          background: colors.bgLight,\n          border: `1px solid ${colors.border}`,\n          borderRadius: borderRadius.lg,\n          boxShadow: '0 4px 12px rgba(0,0,0,0.15)',\n          minWidth: 250,\n          maxHeight: 350,\n          overflowY: 'auto',\n          zIndex: zIndex.dropdown,\n        }}>\n          {/* Save Current View */}\n          {hasActiveFilters && (\n            <div style={{ \n              padding: spacing[2], \n              borderBottom: `1px solid ${colors.border}`,\n            }}>\n              {showSaveDialog ? (\n                <div style={{ display: 'flex', gap: spacing[2] }}>\n                  <input\n                    type=\"text\"\n                    value={newViewName}\n                    onChange={e => setNewViewName(e.target.value)}\n                    onKeyDown={handleKeyDown}\n                    placeholder=\"View name...\"\n                    autoFocus\n                    style={{\n                      ...styles.input,\n                      flex: 1,\n                      padding: `${spacing[1]}px ${spacing[2]}px`,\n                      fontSize: typography.fontSize.sm,\n                    }}\n                  />\n                  <button\n                    onClick={handleSave}\n                    disabled={!newViewName.trim()}\n                    style={{\n                      background: colors.primary,\n                      color: 'white',\n                      border: 'none',\n                      borderRadius: borderRadius.md,\n                      padding: `${spacing[1]}px ${spacing[2]}px`,\n                      cursor: newViewName.trim() ? 'pointer' : 'not-allowed',\n                      opacity: newViewName.trim() ? 1 : 0.5,\n                    }}\n                  >\n                    Save\n                  </button>\n                </div>\n              ) : (\n                <button\n                  onClick={() => setShowSaveDialog(true)}\n                  style={{\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: spacing[2],\n                    width: '100%',\n                    padding: `${spacing[2]}px`,\n                    background: `${withOpacity(colors.primary, 15)}`,\n                    border: 'none',\n                    borderRadius: borderRadius.md,\n                    cursor: 'pointer',\n                    color: colors.primary,\n                    fontSize: typography.fontSize.sm,\n                    fontWeight: typography.fontWeight.medium,\n                  }}\n                >\n                  <BookmarkPlus size={16} />\n                  Save Current Filters\n                </button>\n              )}\n            </div>\n          )}\n\n          {/* Saved Views List */}\n          {savedViews.length > 0 ? (\n            <div style={{ padding: spacing[1] }}>\n              {savedViews.map(view => (\n                <div\n                  key={view.id}\n                  className=\"list-item-hover\"\n                  style={{\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: spacing[2],\n                    padding: `${spacing[2]}px ${spacing[2]}px`,\n                    borderRadius: borderRadius.md,\n                    cursor: 'pointer',\n                  }}\n                >\n                  <div \n                    style={{ flex: 1 }}\n                    onClick={() => {\n                      onLoadView(view);\n                      setIsOpen(false);\n                    }}\n                  >\n                    <div style={{ \n                      fontWeight: typography.fontWeight.medium,\n                      color: colors.textPrimary,\n                      fontSize: typography.fontSize.sm,\n                    }}>\n                      {view.name}\n                    </div>\n                    <div style={{ \n                      fontSize: typography.fontSize.xs, \n                      color: colors.textMuted,\n                      marginTop: 2,\n                    }}>\n                      {[\n                        view.filters.search && `\"${view.filters.search}\"`,\n                        view.filters.category !== 'all' && view.filters.category,\n                        view.filters.status !== 'all' && view.filters.status,\n                      ].filter(Boolean).join('  ') || 'No filters'}\n                    </div>\n                  </div>\n                  <button\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      onDeleteView(view.id);\n                    }}\n                    className=\"hover-danger\"\n                    style={{\n                      background: 'none',\n                      border: 'none',\n                      padding: spacing[1],\n                      cursor: 'pointer',\n                      color: colors.textMuted,\n                      borderRadius: borderRadius.sm,\n                      display: 'flex',\n                      alignItems: 'center',\n                    }}\n                    title=\"Delete view\"\n                  >\n                    <Trash2 size={14} />\n                  </button>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div style={{ \n              padding: spacing[4], \n              textAlign: 'center',\n              color: colors.textMuted,\n              fontSize: typography.fontSize.sm,\n            }}>\n              {hasActiveFilters \n                ? 'No saved views yet. Save your current filters above!'\n                : 'No saved views. Apply filters and save them for quick access.'\n              }\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n});\n\n// Memoized grid item component for performance\nconst GridItem = memo(function GridItem({ item, onViewItem, selectionMode, isSelected, onToggleSelect }) {\n  return (\n    <Card\n      onClick={() => selectionMode ? onToggleSelect(item.id) : onViewItem(item.id)}\n      padding={false}\n      style={{\n        cursor: 'pointer',\n        overflow: 'hidden',\n        aspectRatio: '1 / 1',\n        display: 'flex',\n        flexDirection: 'column',\n        outline: isSelected ? `2px solid ${colors.primary}` : 'none',\n        outlineOffset: '-2px',\n      }}\n    >\n      {/* Image area - 60% height */}\n      <div style={{ flex: '0 0 60%', overflow: 'hidden', position: 'relative' }}>\n        {selectionMode && (\n          <div \n            style={{ \n              position: 'absolute', \n              top: spacing[2], \n              left: spacing[2], \n              zIndex: zIndex.base + 1,\n              background: colors.bgLight,\n              borderRadius: borderRadius.sm,\n              padding: 2,\n            }}\n            onClick={(e) => e.stopPropagation()}\n          >\n            <Checkbox checked={isSelected} onChange={() => onToggleSelect(item.id)} size={22} />\n          </div>\n        )}\n        {item.image ? (\n          <OptimizedImage\n            src={item.image}\n            alt={item.name}\n            size=\"thumbnail\"\n            style={{ width: '100%', height: '100%' }}\n            objectFit=\"cover\"\n          />\n        ) : (\n          <div style={{\n            width: '100%',\n            height: '100%',\n            background: `${withOpacity(colors.primary, 10)}`,\n            display: 'flex',\n            flexDirection: 'column',\n            alignItems: 'center',\n            justifyContent: 'center',\n            color: colors.textMuted\n          }}>\n            <svg width={28} height={28} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n              <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"/>\n              <circle cx=\"8.5\" cy=\"8.5\" r=\"1.5\"/>\n              <polyline points=\"21 15 16 10 5 21\"/>\n            </svg>\n            <span style={{ fontSize: typography.fontSize.xs, marginTop: spacing[1] }}>No Image</span>\n          </div>\n        )}\n      </div>\n\n      {/* Info area - 40% height */}\n      <div style={{\n        flex: 1,\n        padding: spacing[3],\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'space-between'\n      }}>\n        <div>\n          <div style={{\n            display: 'flex',\n            gap: spacing[1],\n            marginBottom: spacing[1],\n            flexWrap: 'wrap'\n          }}>\n            <Badge text={item.id} color={colors.primary} size=\"xs\" />\n            <Badge text={item.status} color={getStatusColor(item.status)} size=\"xs\" />\n          </div>\n          <h4 style={{\n            margin: 0,\n            fontSize: typography.fontSize.sm,\n            color: colors.textPrimary,\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            whiteSpace: 'nowrap'\n          }}>\n            {item.name}\n          </h4>\n        </div>\n        <div style={{\n          fontSize: typography.fontSize.xs,\n          color: colors.textMuted\n        }}>\n          {item.brand}\n        </div>\n      </div>\n    </Card>\n  );\n});\n\n// Memoized list item component for performance\nconst ListItem = memo(function ListItem({ item, onViewItem, selectionMode, isSelected, onToggleSelect }) {\n  return (\n    <Card\n      onClick={() => selectionMode ? onToggleSelect(item.id) : onViewItem(item.id)}\n      style={{\n        cursor: 'pointer',\n        padding: spacing[3],\n        display: 'flex',\n        alignItems: 'center',\n        gap: spacing[3],\n        outline: isSelected ? `2px solid ${colors.primary}` : 'none',\n        outlineOffset: '-2px',\n      }}\n    >\n      {selectionMode && (\n        <div onClick={(e) => e.stopPropagation()}>\n          <Checkbox checked={isSelected} onChange={() => onToggleSelect(item.id)} size={22} />\n        </div>\n      )}\n      {item.image ? (\n        <OptimizedImage\n          src={item.image}\n          alt={item.name}\n          size=\"thumbnail\"\n          width={56}\n          height={56}\n          style={{ borderRadius: borderRadius.md }}\n          objectFit=\"cover\"\n        />\n      ) : (\n        <div style={{\n          width: 56,\n          height: 56,\n          borderRadius: borderRadius.md,\n          background: `${withOpacity(colors.primary, 10)}`,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          color: colors.textMuted,\n          fontSize: typography.fontSize.xs\n        }}>\n          No img\n        </div>\n      )}\n      <div style={{ flex: 1 }}>\n        <div style={{\n          display: 'flex',\n          gap: spacing[1],\n          marginBottom: spacing[1]\n        }}>\n          <Badge text={item.id} color={colors.primary} />\n          <Badge text={item.status} color={getStatusColor(item.status)} />\n          <Badge text={item.category} color={colors.accent2} />\n        </div>\n        <div style={{\n          fontWeight: typography.fontWeight.medium,\n          color: colors.textPrimary\n        }}>\n          {item.name}\n        </div>\n        <div style={{\n          fontSize: typography.fontSize.sm,\n          color: colors.textMuted\n        }}>\n          {item.brand}\n        </div>\n      </div>\n    </Card>\n  );\n});\n\n// Selection toolbar component\nconst SelectionToolbar = memo(function SelectionToolbar({ \n  selectedCount, \n  totalCount, \n  onSelectAll, \n  onDeselectAll, \n  onCancel,\n  onBulkAction,\n  allSelected,\n  someSelected,\n}) {\n  return (\n    <div style={{\n      display: 'flex',\n      alignItems: 'center',\n      gap: spacing[3],\n      padding: spacing[3],\n      background: `${withOpacity(colors.primary, 15)}`,\n      borderRadius: borderRadius.lg,\n      marginBottom: spacing[4],\n      flexWrap: 'wrap',\n    }}>\n      {/* Select all checkbox */}\n      <div style={{ display: 'flex', alignItems: 'center', gap: spacing[2] }}>\n        <Checkbox \n          checked={allSelected} \n          indeterminate={someSelected && !allSelected}\n          onChange={() => allSelected ? onDeselectAll() : onSelectAll()} \n        />\n        <span style={{ fontSize: typography.fontSize.sm, color: colors.textPrimary }}>\n          {selectedCount} of {totalCount} selected\n        </span>\n      </div>\n\n      {/* Bulk action buttons */}\n      {selectedCount > 0 && (\n        <div style={{ display: 'flex', gap: spacing[2], flex: 1, justifyContent: 'center', flexWrap: 'wrap' }}>\n          <Button size=\"sm\" variant=\"secondary\" onClick={() => onBulkAction('status')}>\n            Change Status\n          </Button>\n          <Button size=\"sm\" variant=\"secondary\" onClick={() => onBulkAction('location')}>\n            Update Location\n          </Button>\n          <Button size=\"sm\" variant=\"secondary\" onClick={() => onBulkAction('category')}>\n            Change Category\n          </Button>\n          <Button size=\"sm\" variant=\"secondary\" danger onClick={() => onBulkAction('delete')}>\n            Delete\n          </Button>\n        </div>\n      )}\n\n      {/* Cancel button */}\n      <Button size=\"sm\" variant=\"secondary\" onClick={onCancel} icon={X}>\n        Exit Selection\n      </Button>\n    </div>\n  );\n});\n\nfunction GearList({\n  inventory,\n  categories,\n  categorySettings,\n  searchQuery,\n  setSearchQuery,\n  categoryFilter,\n  setCategoryFilter,\n  statusFilter,\n  setStatusFilter,\n  isGridView,\n  setIsGridView,\n  onViewItem,\n  onAddItem,\n  onBulkAction, // New prop for handling bulk actions\n}) {\n  // Permissions\n  const { canEdit } = usePermissions();\n  const canEditGearList = canEdit('gear_list');\n\n  // Page size state with localStorage persistence\n  const [pageSize, setPageSize] = useState(() => {\n    const saved = localStorage.getItem('sims-gear-list-page-size');\n    return saved ? parseInt(saved, 10) : DEFAULT_PAGE_SIZE;\n  });\n\n  // Selection state\n  const [selectionMode, setSelectionMode] = useState(false);\n  const [selectedIds, setSelectedIds] = useState(new Set());\n\n  // Saved views state with localStorage persistence\n  const [savedViews, setSavedViews] = useState(() => {\n    try {\n      const saved = localStorage.getItem(SAVED_VIEWS_KEY);\n      return saved ? JSON.parse(saved) : [];\n    } catch {\n      return [];\n    }\n  });\n\n  // Save views to localStorage when they change\n  useEffect(() => {\n    localStorage.setItem(SAVED_VIEWS_KEY, JSON.stringify(savedViews));\n  }, [savedViews]);\n\n  // Check if any filters are active\n  const hasActiveFilters = searchQuery || categoryFilter !== 'all' || statusFilter !== 'all';\n\n  // Current filters object\n  const currentFilters = useMemo(() => ({\n    search: searchQuery,\n    category: categoryFilter,\n    status: statusFilter,\n  }), [searchQuery, categoryFilter, statusFilter]);\n\n  // Save current filters as a new view\n  const saveCurrentView = useCallback((name) => {\n    const newView = {\n      id: generateId(),\n      name,\n      filters: { ...currentFilters },\n      createdAt: new Date().toISOString(),\n    };\n    setSavedViews(prev => [...prev, newView]);\n  }, [currentFilters]);\n\n  // Load a saved view\n  const loadView = useCallback((view) => {\n    setSearchQuery(view.filters.search || '');\n    setCategoryFilter(view.filters.category || 'all');\n    setStatusFilter(view.filters.status || 'all');\n  }, [setSearchQuery, setCategoryFilter, setStatusFilter]);\n\n  // Delete a saved view\n  const deleteView = useCallback((viewId) => {\n    setSavedViews(prev => prev.filter(v => v.id !== viewId));\n  }, []);\n\n  // Save page size to localStorage\n  useEffect(() => {\n    localStorage.setItem('sims-gear-list-page-size', pageSize.toString());\n  }, [pageSize]);\n\n  // Debounce search for performance with large datasets\n  const debouncedSearch = useDebounce(searchQuery, 200);\n\n  // Filter inventory with debounced search\n  const filteredItems = useMemo(() => {\n    // First, filter out kits - GearList only shows individual items\n    let result = inventory.filter(item => !item.isKit);\n    \n    result = filterBySearch(result, debouncedSearch, ['name', 'brand', 'id']);\n    result = filterByCategory(result, categoryFilter);\n    \n    // Handle low-stock filter specially - needs categorySettings\n    if (statusFilter === 'low-stock') {\n      result = result.filter(item => {\n        const settings = categorySettings?.[item.category];\n        if (!settings?.trackQuantity) return false;\n        \n        // Only consider items that have a quantity defined\n        if (item.quantity === undefined || item.quantity === null) return false;\n        \n        const quantity = item.quantity;\n        const threshold = item.reorderPoint || settings.lowStockThreshold || 0;\n        return threshold > 0 && quantity <= threshold;\n      });\n    } else {\n      result = filterByStatus(result, statusFilter);\n    }\n    \n    return result;\n  }, [inventory, debouncedSearch, categoryFilter, statusFilter, categorySettings]);\n\n  // Filtered item IDs for selection operations\n  const filteredIds = useMemo(() => new Set(filteredItems.map(i => i.id)), [filteredItems]);\n\n  // Clear selection when exiting selection mode or when filters change\n  useEffect(() => {\n    if (!selectionMode) {\n      setSelectedIds(new Set());\n    }\n  }, [selectionMode]);\n\n  // Clear invalid selections when filters change\n  useEffect(() => {\n    setSelectedIds(prev => {\n      const validIds = new Set([...prev].filter(id => filteredIds.has(id)));\n      return validIds.size !== prev.size ? validIds : prev;\n    });\n  }, [filteredIds]);\n\n  // Selection helpers\n  const toggleSelect = useCallback((id) => {\n    setSelectedIds(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(id)) {\n        newSet.delete(id);\n      } else {\n        newSet.add(id);\n      }\n      return newSet;\n    });\n  }, []);\n\n  const selectAll = useCallback(() => {\n    setSelectedIds(new Set(filteredItems.map(i => i.id)));\n  }, [filteredItems]);\n\n  const deselectAll = useCallback(() => {\n    setSelectedIds(new Set());\n  }, []);\n\n  const handleBulkAction = useCallback((action) => {\n    if (onBulkAction && selectedIds.size > 0) {\n      onBulkAction(action, [...selectedIds]);\n    }\n  }, [onBulkAction, selectedIds]);\n\n  // Selection stats\n  const selectedCount = selectedIds.size;\n  const allSelected = selectedCount === filteredItems.length && filteredItems.length > 0;\n  const someSelected = selectedCount > 0;\n\n  // Pagination\n  const {\n    page,\n    totalPages,\n    paginatedItems,\n    goToPage,\n  } = usePagination(filteredItems, pageSize);\n\n  // Reset to page 1 when filters change\n  useMemo(() => {\n    goToPage(1);\n  }, [debouncedSearch, categoryFilter, statusFilter, pageSize]);\n\n  return (\n    <>\n      {/* View-only banner */}\n      {!canEditGearList && <ViewOnlyBanner functionId=\"gear_list\" />}\n\n      {/* Header */}\n      <div className=\"page-header\">\n        <div style={{ display: 'flex', alignItems: 'center', gap: spacing[3] }}>\n          <div>\n            <h2 className=\"page-title\">Gear List</h2>\n            <p style={{ margin: `${spacing[1]}px 0 0`, color: colors.textMuted, fontSize: typography.fontSize.sm }}>\n              {filteredItems.length} {filteredItems.length === 1 ? 'item' : 'items'} \n              {hasActiveFilters && ` (filtered)`}\n            </p>\n          </div>\n          {canEditGearList && (\n            <Button onClick={onAddItem} icon={Plus}>\n              Add Item\n            </Button>\n          )}\n        </div>\n        <div style={{ display: 'flex', gap: spacing[2], alignItems: 'center' }}>\n          {/* Saved Views Dropdown */}\n          <SavedViewsDropdown\n            savedViews={savedViews}\n            currentFilters={currentFilters}\n            onLoadView={loadView}\n            onSaveView={saveCurrentView}\n            onDeleteView={deleteView}\n            hasActiveFilters={hasActiveFilters}\n          />\n          {canEditGearList && !selectionMode ? (\n            <Button variant=\"secondary\" onClick={() => setSelectionMode(true)} icon={CheckSquare}>\n              Multiple Selection\n            </Button>\n          ) : selectionMode ? (\n            <Button variant=\"secondary\" onClick={() => setSelectionMode(false)} icon={X}>\n              Cancel Selection\n            </Button>\n          ) : null}\n        </div>\n      </div>\n\n      {/* Selection Toolbar */}\n      {selectionMode && (\n        <SelectionToolbar\n          selectedCount={selectedCount}\n          totalCount={filteredItems.length}\n          onSelectAll={selectAll}\n          onDeselectAll={deselectAll}\n          onCancel={() => setSelectionMode(false)}\n          onBulkAction={handleBulkAction}\n          allSelected={allSelected}\n          someSelected={someSelected}\n        />\n      )}\n\n      {/* Filters */}\n      <div style={{\n        display: 'flex',\n        gap: spacing[3],\n        marginBottom: spacing[5],\n        flexWrap: 'wrap',\n        alignItems: 'center',\n        justifyContent: 'space-between',\n      }}>\n        {/* Search - left side */}\n        <div style={{ minWidth: 200, maxWidth: 400, flex: '1 1 200px' }}>\n          <SearchInput\n            value={searchQuery}\n            onChange={setSearchQuery}\n            onClear={() => setSearchQuery('')}\n            placeholder=\"Search items...\"\n          />\n        </div>\n\n        {/* Right side controls */}\n        <div style={{ display: 'flex', gap: spacing[3], alignItems: 'center', flexWrap: 'wrap', marginLeft: 'auto' }}>\n          {/* Clear Filters Button */}\n          {hasActiveFilters && (\n            <button\n              onClick={() => {\n                setSearchQuery('');\n                setCategoryFilter('all');\n                setStatusFilter('all');\n              }}\n              style={{\n                ...styles.btnSec,\n                display: 'flex',\n                alignItems: 'center',\n                gap: spacing[1],\n                padding: '12px 14px',\n                fontSize: typography.fontSize.sm,\n                color: colors.textMuted,\n              }}\n              title=\"Clear all filters\"\n            >\n              <X size={14} />\n              Clear\n            </button>\n          )}\n\n          {/* Category Filter */}\n          <Select\n            value={categoryFilter}\n            onChange={e => setCategoryFilter(e.target.value)}\n            options={[\n              { value: 'all', label: 'All Categories' },\n              ...categories.map(c => ({ value: c, label: c }))\n            ]}\n            style={{ minWidth: 150 }}\n            aria-label=\"Filter by category\"\n          />\n\n          {/* Status Filter */}\n          <Select\n            value={statusFilter}\n            onChange={e => setStatusFilter(e.target.value)}\n            options={[\n              { value: 'all', label: 'All Status' },\n              { value: 'available', label: 'Available' },\n              { value: 'checked-out', label: 'Checked Out' },\n              { value: 'reserved', label: 'Reserved' },\n              { value: 'needs-attention', label: 'Needs Attention' },\n              { value: 'missing', label: 'Missing' },\n              { value: 'overdue', label: 'Overdue' },\n              { value: 'low-stock', label: 'Low Stock' },\n            ]}\n            style={{ minWidth: 140 }}\n            aria-label=\"Filter by status\"\n          />\n\n          {/* View Toggle */}\n          <div style={{\n            display: 'flex',\n            background: `${withOpacity(colors.primary, 15)}`,\n            borderRadius: borderRadius.lg\n          }}>\n            <button\n              onClick={() => setIsGridView(true)}\n              style={{\n                ...styles.btnSec,\n                border: 'none',\n                padding: '12px 14px',\n                background: isGridView ? `${withOpacity(colors.primary, 30)}` : 'transparent',\n                color: isGridView ? colors.primary : colors.textSecondary,\n              }}\n            >\n              <Grid size={18} />\n            </button>\n            <button\n              onClick={() => setIsGridView(false)}\n              style={{\n                ...styles.btnSec,\n                border: 'none',\n                padding: '12px 14px',\n                background: !isGridView ? `${withOpacity(colors.primary, 30)}` : 'transparent',\n                color: !isGridView ? colors.primary : colors.textSecondary,\n              }}\n            >\n              <List size={18} />\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Grid View - Square Items */}\n      {isGridView ? (\n        <div style={{\n          display: 'grid',\n          gridTemplateColumns: 'repeat(auto-fill, minmax(180px, 1fr))',\n          gap: spacing[4]\n        }}>\n          {paginatedItems.map(item => (\n            <GridItem \n              key={item.id} \n              item={item} \n              onViewItem={onViewItem}\n              selectionMode={selectionMode}\n              isSelected={selectedIds.has(item.id)}\n              onToggleSelect={toggleSelect}\n            />\n          ))}\n        </div>\n      ) : (\n        /* List View */\n        <div style={{ display: 'flex', flexDirection: 'column', gap: spacing[2] }}>\n          {paginatedItems.map(item => (\n            <ListItem \n              key={item.id} \n              item={item} \n              onViewItem={onViewItem}\n              selectionMode={selectionMode}\n              isSelected={selectedIds.has(item.id)}\n              onToggleSelect={toggleSelect}\n            />\n          ))}\n        </div>\n      )}\n\n      {/* Empty State */}\n      {filteredItems.length === 0 && (\n        <div style={{\n          textAlign: 'center',\n          padding: spacing[10],\n          color: colors.textMuted\n        }}>\n          No items found matching your criteria\n        </div>\n      )}\n\n      {/* Pagination */}\n      {filteredItems.length > 0 && (\n        <div style={{ \n          display: 'flex', \n          alignItems: 'center', \n          justifyContent: 'space-between',\n          flexWrap: 'wrap',\n          gap: spacing[3],\n          marginTop: spacing[5],\n        }}>\n          {/* Page size selector */}\n          <div style={{ display: 'flex', alignItems: 'center', gap: spacing[2] }}>\n            <span style={{ fontSize: typography.fontSize.sm, color: colors.textMuted }}>Show:</span>\n            <Select\n              value={pageSize}\n              onChange={e => setPageSize(parseInt(e.target.value, 10))}\n              options={PAGE_SIZE_OPTIONS.map(size => ({ value: size, label: String(size) }))}\n              style={{ width: 80 }}\n              aria-label=\"Items per page\"\n            />\n            <span style={{ fontSize: typography.fontSize.sm, color: colors.textMuted }}>items</span>\n          </div>\n\n          <Pagination\n            page={page}\n            totalPages={totalPages}\n            totalItems={filteredItems.length}\n            pageSize={pageSize}\n            onPageChange={goToPage}\n          />\n        </div>\n      )}\n    </>\n  );\n}\n\nexport default memo(GearList);\n","// ============================================================================\n// Notes Section Component\n// Reusable threaded notes with replies\n// ============================================================================\n\nimport React, { memo, useState, useCallback } from 'react';\nimport { Plus, Reply, Trash2, ChevronDown, ChevronRight } from 'lucide-react';\nimport { colors, styles, spacing, borderRadius, typography, withOpacity} from '../theme.js';\nimport { formatDate } from '../utils.js';\n\n// Single note component with replies\nconst Note = memo(function Note({\n  note,\n  depth = 0,\n  onReply,\n  onDelete,\n  user,\n  panelColor\n}) {\n  const [isExpanded, setIsExpanded] = useState(true);\n  const [showReplyInput, setShowReplyInput] = useState(false);\n  const [replyText, setReplyText] = useState('');\n\n  const handleSubmitReply = useCallback(() => {\n    if (replyText.trim()) {\n      onReply(note.id, replyText);\n      setReplyText('');\n      setShowReplyInput(false);\n    }\n  }, [note.id, replyText, onReply]);\n\n  const handleKeyDown = useCallback((e) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSubmitReply();\n    }\n  }, [handleSubmitReply]);\n\n  if (note.deleted) {\n    return (\n      <div style={{\n        padding: spacing[3],\n        marginLeft: depth * spacing[5],\n        color: colors.textMuted,\n        fontStyle: 'italic',\n        fontSize: typography.fontSize.sm\n      }}>\n        [Note deleted]\n      </div>\n    );\n  }\n\n  const hasReplies = note.replies && note.replies.length > 0;\n  const itemColor = panelColor && panelColor.length > 0 ? panelColor : colors.primary;\n\n  return (\n    <div style={{ marginLeft: depth * spacing[5] }}>\n      <div style={{\n        padding: spacing[3],\n        background: `${withOpacity(itemColor, 20)}`,\n        border: `1px solid ${withOpacity(itemColor, 50)}`,\n        borderRadius: borderRadius.md,\n        borderLeft: depth > 0 ? `3px solid ${itemColor}` : `1px solid ${withOpacity(itemColor, 50)}`,\n        marginBottom: spacing[2]\n      }}>\n        {/* Note Header */}\n        <div style={{\n          display: 'flex',\n          alignItems: 'center',\n          gap: spacing[2],\n          marginBottom: spacing[2]\n        }}>\n          {hasReplies && (\n            <button\n              onClick={() => setIsExpanded(!isExpanded)}\n              style={{\n                background: 'none',\n                border: 'none',\n                color: colors.textMuted,\n                cursor: 'pointer',\n                padding: 0,\n                display: 'flex'\n              }}\n            >\n              {isExpanded ? <ChevronDown size={14} /> : <ChevronRight size={14} />}\n            </button>\n          )}\n          <span style={{\n            fontWeight: typography.fontWeight.medium,\n            color: colors.textPrimary,\n            fontSize: typography.fontSize.sm\n          }}>\n            {note.user}\n          </span>\n          <span style={{\n            fontSize: typography.fontSize.xs,\n            color: colors.textMuted\n          }}>\n            {formatDate(note.date)}\n          </span>\n        </div>\n\n        {/* Note Content */}\n        <p style={{\n          margin: 0,\n          color: colors.textSecondary,\n          fontSize: typography.fontSize.sm,\n          lineHeight: 1.5\n        }}>\n          {note.text}\n        </p>\n\n        {/* Note Actions */}\n        <div style={{\n          display: 'flex',\n          gap: spacing[2],\n          marginTop: spacing[2]\n        }}>\n          <button\n            onClick={() => setShowReplyInput(!showReplyInput)}\n            style={{\n              display: 'flex',\n              alignItems: 'center',\n              gap: spacing[1],\n              background: 'none',\n              border: 'none',\n              color: colors.textMuted,\n              cursor: 'pointer',\n              fontSize: typography.fontSize.xs,\n              padding: spacing[1]\n            }}\n          >\n            <Reply size={12} />\n            Reply\n          </button>\n          <button\n            onClick={() => onDelete(note.id)}\n            style={{\n              display: 'flex',\n              alignItems: 'center',\n              gap: spacing[1],\n              background: 'none',\n              border: 'none',\n              color: colors.textMuted,\n              cursor: 'pointer',\n              fontSize: typography.fontSize.xs,\n              padding: spacing[1]\n            }}\n          >\n            <Trash2 size={12} />\n            Delete\n          </button>\n        </div>\n\n        {/* Reply Input */}\n        {showReplyInput && (\n          <div style={{\n            display: 'flex',\n            gap: spacing[2],\n            marginTop: spacing[3]\n          }}>\n            <input\n              value={replyText}\n              onChange={e => setReplyText(e.target.value)}\n              onKeyDown={handleKeyDown}\n              placeholder=\"Write a reply...\"\n              style={{\n                ...styles.input,\n                flex: 1,\n                padding: spacing[2],\n                fontSize: typography.fontSize.sm\n              }}\n              autoFocus\n            />\n            <button\n              onClick={handleSubmitReply}\n              disabled={!replyText.trim()}\n              style={{\n                ...styles.btn,\n                padding: spacing[2],\n                opacity: replyText.trim() ? 1 : 0.5\n              }}\n            >\n              Reply\n            </button>\n          </div>\n        )}\n      </div>\n\n      {/* Nested Replies */}\n      {hasReplies && isExpanded && (\n        <div>\n          {note.replies.map(reply => (\n            <Note\n              key={reply.id}\n              note={reply}\n              depth={depth + 1}\n              onReply={onReply}\n              onDelete={onDelete}\n              user={user}\n              panelColor={panelColor}\n            />\n          ))}\n        </div>\n      )}\n    </div>\n  );\n});\n\n// Main Notes Section Component\nfunction NotesSection({\n  notes = [],\n  onAddNote,\n  onReply,\n  onDelete,\n  user,\n  panelColor\n}) {\n  const [newNoteText, setNewNoteText] = useState('');\n\n  const handleSubmitNote = useCallback(() => {\n    if (newNoteText.trim()) {\n      onAddNote(newNoteText);\n      setNewNoteText('');\n    }\n  }, [newNoteText, onAddNote]);\n\n  const handleKeyDown = useCallback((e) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSubmitNote();\n    }\n  }, [handleSubmitNote]);\n\n  // Filter out deleted notes at the root level for display count\n  const visibleNotes = notes.filter(n => !n.deleted);\n\n  return (\n    <>\n      <div style={{ padding: spacing[4] }}>\n        {/* Add Note Input */}\n        <div style={{\n          display: 'flex',\n          gap: spacing[2],\n          marginBottom: spacing[4]\n        }}>\n          <input\n            value={newNoteText}\n            onChange={e => setNewNoteText(e.target.value)}\n            onKeyDown={handleKeyDown}\n            placeholder=\"Add a note...\"\n            style={{\n              ...styles.input,\n              flex: 1,\n              padding: spacing[2],\n              fontSize: typography.fontSize.sm\n            }}\n          />\n          <button\n            onClick={handleSubmitNote}\n            disabled={!newNoteText.trim()}\n            style={{\n              ...styles.btn,\n              padding: spacing[2],\n              opacity: newNoteText.trim() ? 1 : 0.5\n            }}\n          >\n            <Plus size={16} />\n          </button>\n        </div>\n\n        {/* Notes List */}\n        <div style={{ maxHeight: 300, overflowY: 'auto' }}>\n          {notes.length === 0 ? (\n            <p style={{\n              color: colors.textMuted,\n              textAlign: 'center',\n              fontSize: typography.fontSize.sm,\n              padding: spacing[4]\n            }}>\n              No notes yet\n            </p>\n          ) : (\n            notes.map(note => (\n              <Note\n                key={note.id}\n                note={note}\n                onReply={onReply}\n                onDelete={onDelete}\n                user={user}\n                panelColor={panelColor}\n              />\n            ))\n          )}\n        </div>\n      </div>\n    </>\n  );\n}\n\nexport default memo(NotesSection);\n","// =============================================================================\n// DatePicker Component\n// Custom themed date picker with calendar popup\n// =============================================================================\n\nimport React, { useState, useRef, useEffect, useCallback, memo } from 'react';\nimport PropTypes from 'prop-types';\nimport { Calendar, ChevronLeft, ChevronRight } from 'lucide-react';\nimport { colors, spacing, borderRadius, typography } from '../theme.js';\n\n// =============================================================================\n// Helper Functions\n// =============================================================================\n\nconst MONTH_NAMES = [\n  'January', 'February', 'March', 'April', 'May', 'June',\n  'July', 'August', 'September', 'October', 'November', 'December'\n];\n\nconst DAY_NAMES = ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'];\n\nfunction getDaysInMonth(year, month) {\n  return new Date(year, month + 1, 0).getDate();\n}\n\nfunction getFirstDayOfMonth(year, month) {\n  return new Date(year, month, 1).getDay();\n}\n\nfunction formatDate(date) {\n  if (!date) return '';\n  const d = new Date(date);\n  const year = d.getFullYear();\n  const month = String(d.getMonth() + 1).padStart(2, '0');\n  const day = String(d.getDate()).padStart(2, '0');\n  return `${year}-${month}-${day}`;\n}\n\nfunction parseDate(dateString) {\n  if (!dateString) return null;\n  const [year, month, day] = dateString.split('-').map(Number);\n  return new Date(year, month - 1, day);\n}\n\nfunction formatDisplayDate(dateString) {\n  if (!dateString) return '';\n  const date = parseDate(dateString);\n  if (!date || isNaN(date.getTime())) return '';\n  return date.toLocaleDateString('en-US', { \n    month: 'short', \n    day: 'numeric', \n    year: 'numeric' \n  });\n}\n\nfunction isSameDay(date1, date2) {\n  if (!date1 || !date2) return false;\n  return date1.getFullYear() === date2.getFullYear() &&\n         date1.getMonth() === date2.getMonth() &&\n         date1.getDate() === date2.getDate();\n}\n\nfunction isToday(date) {\n  return isSameDay(date, new Date());\n}\n\n// =============================================================================\n// Styles\n// =============================================================================\n\nconst styles = {\n  container: {\n    position: 'relative',\n    width: '100%',\n  },\n  inputWrapper: {\n    position: 'relative',\n    display: 'flex',\n    alignItems: 'center',\n  },\n  input: {\n    width: '100%',\n    padding: `${spacing[3]}px ${spacing[4]}px`,\n    paddingRight: '44px',\n    background: `color-mix(in srgb, ${colors.primary} 10%, transparent)`,\n    border: `1px solid ${colors.border}`,\n    borderRadius: borderRadius.lg,\n    color: colors.textPrimary,\n    fontSize: typography.fontSize.sm,\n    fontFamily: 'inherit',\n    outline: 'none',\n    boxSizing: 'border-box',\n    minHeight: '46px',\n    cursor: 'pointer',\n    transition: 'border-color 150ms ease, box-shadow 150ms ease',\n  },\n  inputFocused: {\n    borderColor: colors.primary,\n    boxShadow: `0 0 0 2px color-mix(in srgb, ${colors.primary} 20%, transparent)`,\n  },\n  inputError: {\n    borderColor: colors.danger,\n  },\n  inputDisabled: {\n    opacity: 0.6,\n    cursor: 'not-allowed',\n  },\n  icon: {\n    position: 'absolute',\n    right: '12px',\n    pointerEvents: 'none',\n    color: colors.textMuted,\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    transition: 'color 150ms ease',\n  },\n  iconActive: {\n    color: colors.primary,\n  },\n  placeholder: {\n    color: colors.textMuted,\n  },\n  // Calendar popup styles\n  popup: {\n    position: 'absolute',\n    top: 'calc(100% + 4px)',\n    left: 0,\n    zIndex: 1000,\n    background: colors.bgCard,\n    border: `1px solid ${colors.border}`,\n    borderRadius: borderRadius.lg,\n    boxShadow: '0 10px 40px rgba(0, 0, 0, 0.4)',\n    padding: spacing[3],\n    minWidth: '280px',\n    animation: 'fadeIn 150ms ease',\n  },\n  popupAbove: {\n    top: 'auto',\n    bottom: 'calc(100% + 4px)',\n  },\n  popupLeft: {\n    left: 'auto',\n    right: 0,\n  },\n  header: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    marginBottom: spacing[3],\n    paddingBottom: spacing[2],\n    borderBottom: `1px solid ${colors.border}`,\n  },\n  headerTitle: {\n    fontSize: typography.fontSize.base,\n    fontWeight: typography.fontWeight.semibold,\n    color: colors.textPrimary,\n  },\n  navButton: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    width: '32px',\n    height: '32px',\n    background: 'transparent',\n    border: 'none',\n    borderRadius: borderRadius.md,\n    color: colors.textSecondary,\n    cursor: 'pointer',\n    transition: 'background 150ms ease, color 150ms ease',\n  },\n  navButtonHover: {\n    background: `color-mix(in srgb, ${colors.primary} 15%, transparent)`,\n    color: colors.primary,\n  },\n  weekDays: {\n    display: 'grid',\n    gridTemplateColumns: 'repeat(7, 1fr)',\n    gap: '2px',\n    marginBottom: spacing[2],\n  },\n  weekDay: {\n    textAlign: 'center',\n    fontSize: typography.fontSize.xs,\n    fontWeight: typography.fontWeight.medium,\n    color: colors.textMuted,\n    padding: `${spacing[1]}px 0`,\n  },\n  days: {\n    display: 'grid',\n    gridTemplateColumns: 'repeat(7, 1fr)',\n    gap: '2px',\n  },\n  day: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    width: '36px',\n    height: '36px',\n    fontSize: typography.fontSize.sm,\n    color: colors.textPrimary,\n    background: 'transparent',\n    border: 'none',\n    borderRadius: borderRadius.md,\n    cursor: 'pointer',\n    transition: 'background 150ms ease, color 150ms ease, transform 100ms ease',\n  },\n  dayHover: {\n    background: `color-mix(in srgb, ${colors.primary} 15%, transparent)`,\n  },\n  daySelected: {\n    background: colors.primary,\n    color: '#ffffff',\n    fontWeight: typography.fontWeight.semibold,\n  },\n  dayToday: {\n    border: `2px solid ${colors.primary}`,\n    fontWeight: typography.fontWeight.semibold,\n  },\n  dayOtherMonth: {\n    color: colors.textMuted,\n    opacity: 0.5,\n  },\n  dayDisabled: {\n    color: colors.textMuted,\n    opacity: 0.3,\n    cursor: 'not-allowed',\n  },\n  footer: {\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginTop: spacing[3],\n    paddingTop: spacing[2],\n    borderTop: `1px solid ${colors.border}`,\n  },\n  todayButton: {\n    padding: `${spacing[1]}px ${spacing[3]}px`,\n    fontSize: typography.fontSize.sm,\n    color: colors.primary,\n    background: 'transparent',\n    border: 'none',\n    borderRadius: borderRadius.md,\n    cursor: 'pointer',\n    transition: 'background 150ms ease',\n  },\n  clearButton: {\n    padding: `${spacing[1]}px ${spacing[3]}px`,\n    fontSize: typography.fontSize.sm,\n    color: colors.textMuted,\n    background: 'transparent',\n    border: 'none',\n    borderRadius: borderRadius.md,\n    cursor: 'pointer',\n    transition: 'color 150ms ease',\n  },\n};\n\n// =============================================================================\n// DatePicker Component\n// =============================================================================\n\nconst DatePicker = memo(function DatePicker({\n  value,\n  onChange,\n  min,\n  max,\n  disabled = false,\n  error = false,\n  placeholder = 'Select date',\n  clearable = true,\n  showTodayButton = true,\n  className = '',\n  style = {},\n  'aria-label': ariaLabel,\n  id,\n}) {\n  const [isOpen, setIsOpen] = useState(false);\n  const [viewDate, setViewDate] = useState(() => {\n    const date = value ? parseDate(value) : new Date();\n    return { year: date.getFullYear(), month: date.getMonth() };\n  });\n  const [hoveredDay, setHoveredDay] = useState(null);\n  const [hoveredNav, setHoveredNav] = useState(null);\n  const [isFocused, setIsFocused] = useState(false);\n  const [openAbove, setOpenAbove] = useState(false);\n  const [openLeft, setOpenLeft] = useState(false);\n  \n  const containerRef = useRef(null);\n  const inputRef = useRef(null);\n  const popupRef = useRef(null);\n\n  const selectedDate = value ? parseDate(value) : null;\n\n  // Check if popup should open above or to the left\n  useEffect(() => {\n    if (isOpen && containerRef.current) {\n      const rect = containerRef.current.getBoundingClientRect();\n      const spaceBelow = window.innerHeight - rect.bottom;\n      const spaceAbove = rect.top;\n      const spaceRight = window.innerWidth - rect.left;\n      \n      setOpenAbove(spaceBelow < 350 && spaceAbove > spaceBelow);\n      // Popup is ~300px wide, check if it would overflow\n      setOpenLeft(spaceRight < 320);\n    }\n  }, [isOpen]);\n\n  // Close on outside click\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const handleClickOutside = (e) => {\n      if (containerRef.current && !containerRef.current.contains(e.target)) {\n        setIsOpen(false);\n      }\n    };\n\n    const handleEscape = (e) => {\n      if (e.key === 'Escape') {\n        setIsOpen(false);\n        inputRef.current?.focus();\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    document.addEventListener('keydown', handleEscape);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n      document.removeEventListener('keydown', handleEscape);\n    };\n  }, [isOpen]);\n\n  // Update view date when value changes\n  useEffect(() => {\n    if (value) {\n      const date = parseDate(value);\n      if (date && !isNaN(date.getTime())) {\n        setViewDate({ year: date.getFullYear(), month: date.getMonth() });\n      }\n    }\n  }, [value]);\n\n  const handleInputClick = useCallback(() => {\n    if (!disabled) {\n      setIsOpen(prev => !prev);\n    }\n  }, [disabled]);\n\n  const handlePrevMonth = useCallback(() => {\n    setViewDate(prev => {\n      if (prev.month === 0) {\n        return { year: prev.year - 1, month: 11 };\n      }\n      return { ...prev, month: prev.month - 1 };\n    });\n  }, []);\n\n  const handleNextMonth = useCallback(() => {\n    setViewDate(prev => {\n      if (prev.month === 11) {\n        return { year: prev.year + 1, month: 0 };\n      }\n      return { ...prev, month: prev.month + 1 };\n    });\n  }, []);\n\n  const handleSelectDay = useCallback((day, isCurrentMonth) => {\n    let year = viewDate.year;\n    let month = viewDate.month;\n    \n    if (!isCurrentMonth) {\n      if (day > 15) {\n        // Previous month\n        month--;\n        if (month < 0) {\n          month = 11;\n          year--;\n        }\n      } else {\n        // Next month\n        month++;\n        if (month > 11) {\n          month = 0;\n          year++;\n        }\n      }\n    }\n    \n    const date = new Date(year, month, day);\n    const dateString = formatDate(date);\n    \n    // Check min/max constraints\n    if (min && dateString < min) return;\n    if (max && dateString > max) return;\n    \n    onChange({ target: { value: dateString } });\n    setIsOpen(false); // Auto-close on selection\n  }, [viewDate, onChange, min, max]);\n\n  const handleToday = useCallback(() => {\n    const today = new Date();\n    const dateString = formatDate(today);\n    \n    // Check min/max constraints\n    if (min && dateString < min) return;\n    if (max && dateString > max) return;\n    \n    onChange({ target: { value: dateString } });\n    setIsOpen(false);\n  }, [onChange, min, max]);\n\n  const handleClear = useCallback(() => {\n    onChange({ target: { value: '' } });\n    setIsOpen(false);\n  }, [onChange]);\n\n  // Generate calendar days\n  const renderDays = () => {\n    const { year, month } = viewDate;\n    const daysInMonth = getDaysInMonth(year, month);\n    const firstDay = getFirstDayOfMonth(year, month);\n    const daysInPrevMonth = getDaysInMonth(year, month - 1);\n    \n    const days = [];\n    \n    // Previous month days\n    for (let i = firstDay - 1; i >= 0; i--) {\n      const day = daysInPrevMonth - i;\n      days.push({ day, isCurrentMonth: false, isPrev: true });\n    }\n    \n    // Current month days\n    for (let day = 1; day <= daysInMonth; day++) {\n      days.push({ day, isCurrentMonth: true });\n    }\n    \n    // Next month days\n    const remainingDays = 42 - days.length; // 6 rows * 7 days\n    for (let day = 1; day <= remainingDays; day++) {\n      days.push({ day, isCurrentMonth: false, isNext: true });\n    }\n    \n    return days.map((d, index) => {\n      let dayYear = year;\n      let dayMonth = month;\n      \n      if (d.isPrev) {\n        dayMonth--;\n        if (dayMonth < 0) { dayMonth = 11; dayYear--; }\n      } else if (d.isNext) {\n        dayMonth++;\n        if (dayMonth > 11) { dayMonth = 0; dayYear++; }\n      }\n      \n      const date = new Date(dayYear, dayMonth, d.day);\n      const dateString = formatDate(date);\n      const isSelected = selectedDate && isSameDay(date, selectedDate);\n      const isTodayDate = isToday(date);\n      const isDisabled = (min && dateString < min) || (max && dateString > max);\n      const isHovered = hoveredDay === index;\n      \n      const dayStyle = {\n        ...styles.day,\n        ...(d.isCurrentMonth ? {} : styles.dayOtherMonth),\n        ...(isDisabled ? styles.dayDisabled : {}),\n        ...(isHovered && !isDisabled && !isSelected ? styles.dayHover : {}),\n        ...(isTodayDate && !isSelected ? styles.dayToday : {}),\n        ...(isSelected ? styles.daySelected : {}),\n      };\n      \n      return (\n        <button\n          key={index}\n          type=\"button\"\n          style={dayStyle}\n          onClick={() => !isDisabled && handleSelectDay(d.day, d.isCurrentMonth)}\n          onMouseEnter={() => setHoveredDay(index)}\n          onMouseLeave={() => setHoveredDay(null)}\n          disabled={isDisabled}\n          tabIndex={isOpen ? 0 : -1}\n          aria-label={date.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' })}\n          aria-selected={isSelected}\n          aria-current={isTodayDate ? 'date' : undefined}\n        >\n          {d.day}\n        </button>\n      );\n    });\n  };\n\n  const inputStyle = {\n    ...styles.input,\n    ...(isFocused || isOpen ? styles.inputFocused : {}),\n    ...(error ? styles.inputError : {}),\n    ...(disabled ? styles.inputDisabled : {}),\n    ...style,\n  };\n\n  const displayValue = formatDisplayDate(value);\n\n  return (\n    <div ref={containerRef} style={{ ...styles.container, ...style }} className={className}>\n      <div style={styles.inputWrapper}>\n        <input\n          ref={inputRef}\n          type=\"text\"\n          id={id}\n          value={displayValue}\n          placeholder={placeholder}\n          onClick={handleInputClick}\n          onFocus={() => setIsFocused(true)}\n          onBlur={() => setIsFocused(false)}\n          onKeyDown={(e) => {\n            if (e.key === 'Enter' || e.key === ' ') {\n              e.preventDefault();\n              setIsOpen(true);\n            }\n          }}\n          readOnly\n          disabled={disabled}\n          style={inputStyle}\n          aria-label={ariaLabel}\n          aria-haspopup=\"dialog\"\n          aria-expanded={isOpen}\n        />\n        <div style={{ ...styles.icon, ...(isOpen ? styles.iconActive : {}) }}>\n          <Calendar size={18} />\n        </div>\n      </div>\n\n      {isOpen && (\n        <div \n          ref={popupRef}\n          style={{ ...styles.popup, ...(openAbove ? styles.popupAbove : {}), ...(openLeft ? styles.popupLeft : {}) }}\n          role=\"dialog\"\n          aria-label=\"Choose date\"\n        >\n          {/* Header */}\n          <div style={styles.header}>\n            <button\n              type=\"button\"\n              style={{\n                ...styles.navButton,\n                ...(hoveredNav === 'prev' ? styles.navButtonHover : {}),\n              }}\n              onClick={handlePrevMonth}\n              onMouseEnter={() => setHoveredNav('prev')}\n              onMouseLeave={() => setHoveredNav(null)}\n              aria-label=\"Previous month\"\n            >\n              <ChevronLeft size={20} />\n            </button>\n            <span style={styles.headerTitle}>\n              {MONTH_NAMES[viewDate.month]} {viewDate.year}\n            </span>\n            <button\n              type=\"button\"\n              style={{\n                ...styles.navButton,\n                ...(hoveredNav === 'next' ? styles.navButtonHover : {}),\n              }}\n              onClick={handleNextMonth}\n              onMouseEnter={() => setHoveredNav('next')}\n              onMouseLeave={() => setHoveredNav(null)}\n              aria-label=\"Next month\"\n            >\n              <ChevronRight size={20} />\n            </button>\n          </div>\n\n          {/* Week days header */}\n          <div style={styles.weekDays}>\n            {DAY_NAMES.map(day => (\n              <div key={day} style={styles.weekDay}>{day}</div>\n            ))}\n          </div>\n\n          {/* Days grid */}\n          <div style={styles.days}>\n            {renderDays()}\n          </div>\n\n          {/* Footer */}\n          {(showTodayButton || clearable) && (\n            <div style={styles.footer}>\n              {clearable && value ? (\n                <button\n                  type=\"button\"\n                  style={styles.clearButton}\n                  onClick={handleClear}\n                  onMouseEnter={(e) => e.target.style.color = colors.danger}\n                  onMouseLeave={(e) => e.target.style.color = colors.textMuted}\n                >\n                  Clear\n                </button>\n              ) : <span />}\n              {showTodayButton && (\n                <button\n                  type=\"button\"\n                  style={styles.todayButton}\n                  onClick={handleToday}\n                  onMouseEnter={(e) => e.target.style.background = `color-mix(in srgb, ${colors.primary} 15%, transparent)`}\n                  onMouseLeave={(e) => e.target.style.background = 'transparent'}\n                >\n                  Today\n                </button>\n              )}\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n});\n\nDatePicker.propTypes = {\n  value: PropTypes.string,\n  onChange: PropTypes.func.isRequired,\n  min: PropTypes.string,\n  max: PropTypes.string,\n  disabled: PropTypes.bool,\n  error: PropTypes.bool,\n  placeholder: PropTypes.string,\n  clearable: PropTypes.bool,\n  showTodayButton: PropTypes.bool,\n  className: PropTypes.string,\n  style: PropTypes.object,\n  'aria-label': PropTypes.string,\n  id: PropTypes.string,\n};\n\nexport { DatePicker };\nexport default DatePicker;\n","// ============================================================================\n// Reminders Section Component\n// Allows users to set one-time or recurring reminders for items\n// ============================================================================\n\nimport React, { memo, useState, useCallback } from 'react';\nimport { Bell, Plus, Trash2, Calendar, RefreshCw, AlertTriangle, CheckCircle } from 'lucide-react';\nimport { colors, styles, spacing, borderRadius, typography, withOpacity} from '../theme.js';\nimport { formatDate, generateId, getTodayISO, getNextDueDate, isReminderDue } from '../utils.js';\nimport { Button } from './ui.jsx';\nimport { Select } from './Select.jsx';\nimport { DatePicker } from './DatePicker.jsx';\n\n// Recurrence options\nconst RECURRENCE_OPTIONS = [\n  { value: 'none', label: 'One-time' },\n  { value: 'weekly', label: 'Weekly' },\n  { value: 'biweekly', label: 'Every 2 weeks' },\n  { value: 'monthly', label: 'Monthly' },\n  { value: 'quarterly', label: 'Quarterly' },\n  { value: 'biannual', label: 'Every 6 months' },\n  { value: 'yearly', label: 'Yearly' }\n];\n\n// Individual Reminder Item\nconst ReminderItem = memo(function ReminderItem({ \n  reminder, \n  onComplete,\n  onUncomplete,\n  onDelete,\n  panelColor\n}) {\n  const today = getTodayISO();\n  const isCompleted = reminder.completed;\n  const isDue = !isCompleted && reminder.dueDate <= today;\n  const isPast = !isCompleted && reminder.dueDate < today;\n  \n  // Use CSS variables with withOpacity for dynamic colors\n  const effectivePanelColor = panelColor && panelColor.length > 0 ? panelColor : colors.primary;\n  \n  // Determine background/border colors based on state\n  let bgColor, borderColor, iconBgColor;\n  if (isCompleted) {\n    bgColor = withOpacity(colors.available, 20);\n    borderColor = withOpacity(colors.available, 50);\n    iconBgColor = withOpacity(colors.available, 25);\n  } else if (isDue) {\n    bgColor = withOpacity(colors.needsAttention, 20);\n    borderColor = withOpacity(colors.needsAttention, 50);\n    iconBgColor = withOpacity(colors.needsAttention, 25);\n  } else {\n    bgColor = withOpacity(effectivePanelColor, 20);\n    borderColor = withOpacity(effectivePanelColor, 50);\n    iconBgColor = withOpacity(effectivePanelColor, 25);\n  }\n  \n  return (\n    <div style={{\n      background: bgColor,\n      border: `1px solid ${borderColor}`,\n      borderRadius: borderRadius.md,\n      padding: spacing[3],\n      marginBottom: spacing[2],\n      opacity: isCompleted ? 0.7 : 1\n    }}>\n      <div style={{ display: 'flex', alignItems: 'flex-start', gap: spacing[3] }}>\n        {/* Status icon */}\n        <div style={{\n          width: 32,\n          height: 32,\n          borderRadius: borderRadius.md,\n          background: iconBgColor,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          flexShrink: 0\n        }}>\n          {isCompleted ? (\n            <CheckCircle size={16} color={colors.available} />\n          ) : isDue ? (\n            <AlertTriangle size={16} color={colors.needsAttention} />\n          ) : (\n            <Bell size={16} color={effectivePanelColor} />\n          )}\n        </div>\n        \n        {/* Content */}\n        <div style={{ flex: 1, minWidth: 0 }}>\n          <div style={{\n            fontSize: typography.fontSize.sm,\n            fontWeight: typography.fontWeight.medium,\n            color: isCompleted ? colors.textMuted : colors.textPrimary,\n            marginBottom: spacing[1],\n            textDecoration: isCompleted ? 'line-through' : 'none'\n          }}>\n            {reminder.title}\n          </div>\n          \n          {reminder.description && (\n            <div style={{\n              fontSize: typography.fontSize.xs,\n              color: colors.textSecondary,\n              marginBottom: spacing[1]\n            }}>\n              {reminder.description}\n            </div>\n          )}\n          \n          <div style={{\n            display: 'flex',\n            alignItems: 'center',\n            gap: spacing[2],\n            flexWrap: 'wrap'\n          }}>\n            {isCompleted ? (\n              <span style={{\n                fontSize: typography.fontSize.xs,\n                color: colors.available,\n                fontWeight: typography.fontWeight.medium\n              }}>\n                <CheckCircle size={10} style={{ marginRight: 4, verticalAlign: 'middle' }} />\n                Completed {reminder.completedDate ? formatDate(reminder.completedDate) : ''}\n              </span>\n            ) : (\n              <span style={{\n                fontSize: typography.fontSize.xs,\n                color: isDue ? colors.needsAttention : colors.textMuted,\n                fontWeight: isDue ? typography.fontWeight.medium : typography.fontWeight.normal\n              }}>\n                <Calendar size={10} style={{ marginRight: 4, verticalAlign: 'middle' }} />\n                {isPast ? 'Overdue: ' : isDue ? 'Due: ' : ''}{formatDate(reminder.dueDate)}\n              </span>\n            )}\n            \n            {reminder.recurrence !== 'none' && (\n              <span style={{\n                fontSize: typography.fontSize.xs,\n                color: colors.primary,\n                display: 'flex',\n                alignItems: 'center',\n                gap: 2\n              }}>\n                <RefreshCw size={10} />\n                {RECURRENCE_OPTIONS.find(o => o.value === reminder.recurrence)?.label}\n              </span>\n            )}\n          </div>\n        </div>\n        \n        {/* Actions */}\n        <div style={{ display: 'flex', gap: spacing[1], flexShrink: 0 }}>\n          {isCompleted ? (\n            <button\n              onClick={() => onUncomplete(reminder.id)}\n              title=\"Mark incomplete\"\n              style={{\n                ...styles.btnSec,\n                padding: spacing[1],\n                fontSize: typography.fontSize.xs,\n              }}\n            >\n              \n            </button>\n          ) : (\n            <button\n              onClick={() => onComplete(reminder.id)}\n              title=\"Mark complete\"\n              style={{\n                ...styles.btn,\n                padding: spacing[1],\n                fontSize: typography.fontSize.xs,\n                background: colors.success\n              }}\n            >\n              \n            </button>\n          )}\n          <button\n            onClick={() => onDelete(reminder.id)}\n            title=\"Delete reminder\"\n            style={{\n              ...styles.btnSec,\n              padding: spacing[1],\n              color: colors.danger\n            }}\n          >\n            <Trash2 size={14} />\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n});\n\n// Add Reminder Form\nconst AddReminderForm = memo(function AddReminderForm({ onAdd, onCancel }) {\n  const [form, setForm] = useState({\n    title: '',\n    description: '',\n    dueDate: '',\n    recurrence: 'none'\n  });\n  const [touched, setTouched] = useState({});\n  \n  const handleChange = (field, value) => {\n    setForm(prev => ({ ...prev, [field]: value }));\n  };\n  \n  const handleSubmit = () => {\n    if (!form.title.trim() || !form.dueDate) return;\n    \n    onAdd({\n      id: generateId(),\n      title: form.title.trim(),\n      description: form.description.trim(),\n      dueDate: form.dueDate,\n      recurrence: form.recurrence,\n      completed: false,\n      createdAt: getTodayISO()\n    });\n  };\n  \n  const isValid = form.title.trim() && form.dueDate;\n  const showTitleError = touched.title && !form.title.trim();\n  const showDateError = touched.dueDate && !form.dueDate;\n  \n  return (\n    <div style={{\n      padding: spacing[3],\n      background: withOpacity(colors.primary, 10),\n      borderRadius: borderRadius.md,\n      border: `1px solid ${withOpacity(colors.primary, 30)}`,\n      marginBottom: spacing[3]\n    }}>\n      <div style={{ marginBottom: spacing[3] }}>\n        <label style={{ ...styles.label, color: showTitleError ? colors.danger : undefined }}>\n          Reminder Title *\n        </label>\n        <input\n          type=\"text\"\n          value={form.title}\n          onChange={e => handleChange('title', e.target.value)}\n          onBlur={() => setTouched(prev => ({ ...prev, title: true }))}\n          placeholder=\"e.g., Sensor cleaning due\"\n          style={{\n            ...styles.input,\n            borderColor: showTitleError ? colors.danger : undefined\n          }}\n        />\n      </div>\n      \n      <div style={{ marginBottom: spacing[3] }}>\n        <label style={styles.label}>Description (optional)</label>\n        <input\n          type=\"text\"\n          value={form.description}\n          onChange={e => handleChange('description', e.target.value)}\n          placeholder=\"Additional details...\"\n          style={styles.input}\n        />\n      </div>\n      \n      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: spacing[3], marginBottom: spacing[3] }}>\n        <div>\n          <label style={{ ...styles.label, color: showDateError ? colors.danger : undefined }}>\n            Due Date *\n          </label>\n          <DatePicker\n            value={form.dueDate}\n            onChange={e => handleChange('dueDate', e.target.value)}\n            min={getTodayISO()}\n            error={showDateError}\n            placeholder=\"Select due date\"\n            aria-label=\"Due date\"\n          />\n        </div>\n        \n        <div>\n          <label style={styles.label}>Recurrence</label>\n          <Select\n            value={form.recurrence}\n            onChange={e => handleChange('recurrence', e.target.value)}\n            options={RECURRENCE_OPTIONS}\n            aria-label=\"Recurrence\"\n          />\n        </div>\n      </div>\n      \n      <div style={{ display: 'flex', gap: spacing[2], justifyContent: 'flex-end' }}>\n        <Button variant=\"secondary\" size=\"sm\" onClick={onCancel}>Cancel</Button>\n        <Button size=\"sm\" onClick={handleSubmit} disabled={!isValid} icon={Plus}>\n          Add Reminder\n        </Button>\n      </div>\n    </div>\n  );\n});\n\n// Main Reminders Section\nfunction RemindersSection({\n  reminders = [],\n  onAddReminder,\n  onCompleteReminder,\n  onUncompleteReminder,\n  onDeleteReminder,\n  panelColor\n}) {\n  const [showAddForm, setShowAddForm] = useState(false);\n  \n  const handleAdd = useCallback((reminder) => {\n    onAddReminder(reminder);\n    setShowAddForm(false);\n  }, [onAddReminder]);\n  \n  // Sort reminders: incomplete due first, then incomplete not due, then completed\n  const sortedReminders = [...reminders]\n    .sort((a, b) => {\n      // Completed items go to the bottom\n      if (a.completed && !b.completed) return 1;\n      if (!a.completed && b.completed) return -1;\n      \n      // For incomplete items, due first\n      if (!a.completed && !b.completed) {\n        const aDue = isReminderDue(a);\n        const bDue = isReminderDue(b);\n        if (aDue && !bDue) return -1;\n        if (!aDue && bDue) return 1;\n      }\n      \n      // Then by date\n      return new Date(a.dueDate) - new Date(b.dueDate);\n    });\n  \n  const activeReminders = sortedReminders.filter(r => !r.completed);\n  const dueCount = activeReminders.filter(r => isReminderDue(r)).length;\n  \n  return (\n    <>\n      <div style={{ padding: spacing[4] }}>\n        {/* Add button or form */}\n        {!showAddForm ? (\n          <Button\n            variant=\"secondary\"\n            onClick={() => setShowAddForm(true)}\n            icon={Plus}\n            style={{ width: '100%', justifyContent: 'center', marginBottom: sortedReminders.length > 0 ? spacing[3] : 0 }}\n          >\n            Add Reminder\n          </Button>\n        ) : (\n          <AddReminderForm\n            onAdd={handleAdd}\n            onCancel={() => setShowAddForm(false)}\n          />\n        )}\n        \n        {/* Reminders list */}\n        {sortedReminders.length > 0 ? (\n          <div style={{ maxHeight: 300, overflowY: 'auto' }}>\n            {sortedReminders.map(reminder => (\n              <ReminderItem\n                key={reminder.id}\n                reminder={reminder}\n                onComplete={onCompleteReminder}\n                onUncomplete={onUncompleteReminder}\n                onDelete={onDeleteReminder}\n                panelColor={panelColor}\n              />\n            ))}\n          </div>\n        ) : !showAddForm && (\n          <p style={{\n            color: colors.textMuted,\n            textAlign: 'center',\n            fontSize: typography.fontSize.sm,\n            margin: `${spacing[4]}px 0 0`\n          }}>\n            No reminders set\n          </p>\n        )}\n      </div>\n    </>\n  );\n}\n\nexport default memo(RemindersSection);\n","// ============================================================================\n// Maintenance Section Component\n// Displays maintenance history and allows adding new maintenance records\n// ============================================================================\n\nimport React, { memo, useState } from 'react';\nimport { Wrench, Plus, Check, Clock, AlertTriangle, DollarSign, Building2, Calendar, ChevronDown, ChevronUp } from 'lucide-react';\nimport { MAINTENANCE_STATUS } from '../constants.js';\nimport { colors, spacing, borderRadius, typography, withOpacity} from '../theme.js';\nimport { formatDate, formatMoney } from '../utils.js';\nimport { Badge, Button } from './ui.jsx';\n\n// Get status color for maintenance\nconst getMaintenanceStatusColor = (status) => {\n  switch (status) {\n    case MAINTENANCE_STATUS.COMPLETED: return colors.available;\n    case MAINTENANCE_STATUS.IN_PROGRESS: return colors.checkedOut;\n    case MAINTENANCE_STATUS.SCHEDULED: return colors.primary;\n    case MAINTENANCE_STATUS.CANCELLED: return colors.textMuted;\n    default: return colors.textMuted;\n  }\n};\n\n// Get status icon\nconst getMaintenanceStatusIcon = (status) => {\n  switch (status) {\n    case MAINTENANCE_STATUS.COMPLETED: return Check;\n    case MAINTENANCE_STATUS.IN_PROGRESS: return Clock;\n    case MAINTENANCE_STATUS.SCHEDULED: return Calendar;\n    case MAINTENANCE_STATUS.CANCELLED: return AlertTriangle;\n    default: return Wrench;\n  }\n};\n\n// Format status for display\nconst formatStatus = (status) => {\n  switch (status) {\n    case MAINTENANCE_STATUS.COMPLETED: return 'Completed';\n    case MAINTENANCE_STATUS.IN_PROGRESS: return 'In Progress';\n    case MAINTENANCE_STATUS.SCHEDULED: return 'Scheduled';\n    case MAINTENANCE_STATUS.CANCELLED: return 'Cancelled';\n    default: return status;\n  }\n};\n\n// Single maintenance entry component\nconst MaintenanceEntry = memo(function MaintenanceEntry({ entry, onComplete, onEdit, panelColor }) {\n  const [expanded, setExpanded] = useState(false);\n  const StatusIcon = getMaintenanceStatusIcon(entry.status);\n  const statusColor = getMaintenanceStatusColor(entry.status);\n  const isCompleted = entry.status === MAINTENANCE_STATUS.COMPLETED;\n  const isScheduled = entry.status === MAINTENANCE_STATUS.SCHEDULED;\n  const isInProgress = entry.status === MAINTENANCE_STATUS.IN_PROGRESS;\n  \n  // Ensure we have a valid hex color for opacity\n  const effectivePanelColor = panelColor && panelColor.length > 0 ? panelColor : colors.primary;\n\n  return (\n    <div\n      style={{\n        background: `${withOpacity(effectivePanelColor, 20)}`,\n        border: `1px solid ${withOpacity(effectivePanelColor, 50)}`,\n        borderLeft: `3px solid ${statusColor}`,\n        borderRadius: borderRadius.lg,\n        marginBottom: spacing[3],\n        overflow: 'hidden',\n      }}\n    >\n      {/* Header - always visible */}\n      <div\n        onClick={() => setExpanded(!expanded)}\n        style={{\n          padding: spacing[3],\n          cursor: 'pointer',\n          display: 'flex',\n          alignItems: 'center',\n          gap: spacing[3],\n        }}\n      >\n        <div\n          style={{\n            width: 36,\n            height: 36,\n            borderRadius: borderRadius.md,\n            background: withOpacity(statusColor, 20),\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            color: statusColor,\n          }}\n        >\n          <StatusIcon size={18} />\n        </div>\n        \n        <div style={{ flex: 1, minWidth: 0 }}>\n          <div style={{ display: 'flex', alignItems: 'center', gap: spacing[2], marginBottom: spacing[1] }}>\n            <Badge text={entry.type} color={statusColor} size=\"xs\" />\n            <Badge text={formatStatus(entry.status)} color={statusColor} size=\"xs\" />\n            {entry.warrantyWork && (\n              <Badge text=\"Warranty\" color={colors.available} size=\"xs\" />\n            )}\n          </div>\n          <div\n            style={{\n              fontSize: typography.fontSize.sm,\n              color: colors.textPrimary,\n              fontWeight: typography.fontWeight.medium,\n              whiteSpace: 'nowrap',\n              overflow: 'hidden',\n              textOverflow: 'ellipsis',\n            }}\n          >\n            {entry.description || entry.type}\n          </div>\n          <div style={{ fontSize: typography.fontSize.xs, color: colors.textMuted }}>\n            {isCompleted && entry.completedDate\n              ? `Completed ${formatDate(entry.completedDate)}`\n              : entry.scheduledDate\n              ? `Scheduled ${formatDate(entry.scheduledDate)}`\n              : formatDate(entry.createdAt)}\n            {entry.cost > 0 && (\n              <span style={{ color: colors.textSecondary }}>  {formatMoney(entry.cost)}</span>\n            )}\n          </div>\n        </div>\n\n        <div style={{ color: colors.textMuted }}>\n          {expanded ? <ChevronUp size={18} /> : <ChevronDown size={18} />}\n        </div>\n      </div>\n\n      {/* Expanded details */}\n      {expanded && (\n        <div\n          style={{\n            padding: spacing[3],\n            paddingTop: 0,\n            borderTop: `1px solid ${colors.borderLight}`,\n          }}\n        >\n          <div style={{ paddingTop: spacing[3] }}>\n            {/* Vendor info */}\n            {entry.vendor && (\n              <div style={{ display: 'flex', alignItems: 'center', gap: spacing[2], marginBottom: spacing[2] }}>\n                <Building2 size={14} color={colors.textMuted} />\n                <span style={{ fontSize: typography.fontSize.sm, color: colors.textSecondary }}>\n                  {entry.vendor}\n                  {entry.vendorContact && `  ${entry.vendorContact}`}\n                </span>\n              </div>\n            )}\n\n            {/* Cost */}\n            {entry.cost > 0 && (\n              <div style={{ display: 'flex', alignItems: 'center', gap: spacing[2], marginBottom: spacing[2] }}>\n                <DollarSign size={14} color={colors.textMuted} />\n                <span style={{ fontSize: typography.fontSize.sm, color: colors.textSecondary }}>\n                  {formatMoney(entry.cost)}\n                  {entry.warrantyWork && ' (Warranty covered)'}\n                </span>\n              </div>\n            )}\n\n            {/* Dates */}\n            <div style={{ display: 'flex', alignItems: 'center', gap: spacing[2], marginBottom: spacing[2] }}>\n              <Calendar size={14} color={colors.textMuted} />\n              <span style={{ fontSize: typography.fontSize.sm, color: colors.textSecondary }}>\n                {entry.scheduledDate && `Scheduled: ${formatDate(entry.scheduledDate)}`}\n                {entry.scheduledDate && entry.completedDate && '  '}\n                {entry.completedDate && `Completed: ${formatDate(entry.completedDate)}`}\n              </span>\n            </div>\n\n            {/* Notes */}\n            {entry.notes && (\n              <div\n                style={{\n                  marginTop: spacing[2],\n                  padding: spacing[2],\n                  background: colors.bgCard,\n                  borderRadius: borderRadius.md,\n                  fontSize: typography.fontSize.sm,\n                  color: colors.textSecondary,\n                  fontStyle: 'italic',\n                }}\n              >\n                \"{entry.notes}\"\n              </div>\n            )}\n\n            {/* Actions */}\n            {(isScheduled || isInProgress) && (\n              <div style={{ display: 'flex', gap: spacing[2], marginTop: spacing[3] }}>\n                {isScheduled && (\n                  <Button\n                    size=\"sm\"\n                    variant=\"secondary\"\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      onComplete(entry.id, MAINTENANCE_STATUS.IN_PROGRESS);\n                    }}\n                  >\n                    Start Work\n                  </Button>\n                )}\n                {isInProgress && (\n                  <Button\n                    size=\"sm\"\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      onComplete(entry.id, MAINTENANCE_STATUS.COMPLETED);\n                    }}\n                    icon={Check}\n                  >\n                    Mark Complete\n                  </Button>\n                )}\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n});\n\n// Main component\nfunction MaintenanceSection({ \n  maintenanceHistory = [], \n  onAddMaintenance, \n  onUpdateMaintenance,\n  onCompleteMaintenance,\n  panelColor\n}) {\n  // Get computed color for use with opacity\n  const effectivePanelColor = panelColor && panelColor.length > 0 ? panelColor : colors.primary;\n  \n  // Calculate totals\n  const totalCost = maintenanceHistory\n    .filter(m => m.status === MAINTENANCE_STATUS.COMPLETED && !m.warrantyWork)\n    .reduce((sum, m) => sum + (Number(m.cost) || 0), 0);\n  \n  const pendingCount = maintenanceHistory.filter(\n    m => m.status === MAINTENANCE_STATUS.SCHEDULED || m.status === MAINTENANCE_STATUS.IN_PROGRESS\n  ).length;\n\n  // Sort: pending first, then by date descending\n  const sortedHistory = [...maintenanceHistory].sort((a, b) => {\n    // Pending items first\n    const aIsPending = a.status === MAINTENANCE_STATUS.SCHEDULED || a.status === MAINTENANCE_STATUS.IN_PROGRESS;\n    const bIsPending = b.status === MAINTENANCE_STATUS.SCHEDULED || b.status === MAINTENANCE_STATUS.IN_PROGRESS;\n    if (aIsPending && !bIsPending) return -1;\n    if (!aIsPending && bIsPending) return 1;\n    \n    // Then by date\n    const aDate = a.completedDate || a.scheduledDate || a.createdAt;\n    const bDate = b.completedDate || b.scheduledDate || b.createdAt;\n    return new Date(bDate) - new Date(aDate);\n  });\n\n  const content = (\n    <>\n      <div style={{ padding: spacing[4] }}>\n        {/* Summary stats */}\n        {maintenanceHistory.length > 0 && (\n          <div\n            style={{\n              display: 'flex',\n              gap: spacing[4],\n              marginBottom: spacing[4],\n              padding: spacing[3],\n              background: `${withOpacity(effectivePanelColor, 15)}`,\n              borderRadius: borderRadius.md,\n            }}\n          >\n            <div style={{ textAlign: 'center', flex: 1 }}>\n              <div\n                style={{\n                  fontSize: typography.fontSize.lg,\n                  fontWeight: typography.fontWeight.bold,\n                  color: colors.primary,\n                }}\n              >\n                {maintenanceHistory.length}\n              </div>\n              <div style={{ fontSize: typography.fontSize.xs, color: colors.textMuted }}>\n                Total Records\n              </div>\n            </div>\n            <div style={{ textAlign: 'center', flex: 1 }}>\n              <div\n                style={{\n                  fontSize: typography.fontSize.lg,\n                  fontWeight: typography.fontWeight.bold,\n                  color: pendingCount > 0 ? colors.checkedOut : colors.textMuted,\n                }}\n              >\n                {pendingCount}\n              </div>\n              <div style={{ fontSize: typography.fontSize.xs, color: colors.textMuted }}>\n                Pending\n              </div>\n            </div>\n            <div style={{ textAlign: 'center', flex: 1 }}>\n              <div\n                style={{\n                  fontSize: typography.fontSize.lg,\n                  fontWeight: typography.fontWeight.bold,\n                  color: colors.available,\n                }}\n              >\n                {formatMoney(totalCost)}\n              </div>\n              <div style={{ fontSize: typography.fontSize.xs, color: colors.textMuted }}>\n                Total Cost\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Add Record Button - always at top */}\n        <Button\n          variant=\"secondary\"\n          onClick={onAddMaintenance}\n          icon={Plus}\n          style={{ width: '100%', justifyContent: 'center', marginBottom: sortedHistory.length > 0 ? spacing[3] : 0 }}\n        >\n          Add Record\n        </Button>\n\n        {/* Maintenance entries */}\n        <div style={{ maxHeight: 400, overflowY: 'auto' }}>\n          {sortedHistory.length === 0 ? (\n            <div style={{ textAlign: 'center', padding: spacing[4], color: colors.textMuted }}>\n              <p style={{ margin: 0, fontSize: typography.fontSize.sm }}>\n                No maintenance records yet\n              </p>\n            </div>\n          ) : (\n            sortedHistory.map((entry) => (\n              <MaintenanceEntry\n                key={entry.id}\n                entry={entry}\n                onComplete={onCompleteMaintenance}\n                onEdit={onUpdateMaintenance}\n                panelColor={panelColor}\n              />\n            ))\n          )}\n        </div>\n      </div>\n    </>\n  );\n\n  return content;\n}\n\nexport default memo(MaintenanceSection);\n","// ============================================================================\n// Item Timeline Component\n// Displays a unified chronological history of all item events\n// ============================================================================\n\nimport React, { memo, useState, useMemo } from 'react';\nimport { \n  Clock, CheckCircle, RefreshCw, Wrench, MessageSquare, Calendar, \n  Bell, AlertTriangle, DollarSign, ChevronDown, ChevronUp, Filter\n} from 'lucide-react';\nimport { colors, styles, spacing, borderRadius, typography, withOpacity} from '../theme.js';\nimport { formatDate, formatDateTime, formatMoney } from '../utils.js';\nimport { Badge, Card, CardHeader, Button } from './ui.jsx';\nimport { Select } from './Select.jsx';\n\n// Event type configuration\nconst EVENT_TYPES = {\n  checkout: {\n    icon: CheckCircle,\n    color: colors.checkedOut,\n    label: 'Checked Out',\n    category: 'checkout'\n  },\n  checkin: {\n    icon: RefreshCw,\n    color: colors.available,\n    label: 'Returned',\n    category: 'checkout'\n  },\n  maintenance_scheduled: {\n    icon: Wrench,\n    color: colors.primary,\n    label: 'Maintenance Scheduled',\n    category: 'maintenance'\n  },\n  maintenance_started: {\n    icon: Wrench,\n    color: colors.checkedOut,\n    label: 'Maintenance Started',\n    category: 'maintenance'\n  },\n  maintenance_completed: {\n    icon: Wrench,\n    color: colors.available,\n    label: 'Maintenance Completed',\n    category: 'maintenance'\n  },\n  note_added: {\n    icon: MessageSquare,\n    color: colors.accent1,\n    label: 'Note Added',\n    category: 'notes'\n  },\n  reservation_created: {\n    icon: Calendar,\n    color: colors.primary,\n    label: 'Reservation Created',\n    category: 'reservations'\n  },\n  reminder_created: {\n    icon: Bell,\n    color: colors.accent2,\n    label: 'Reminder Set',\n    category: 'reminders'\n  },\n  reminder_completed: {\n    icon: Bell,\n    color: colors.available,\n    label: 'Reminder Completed',\n    category: 'reminders'\n  },\n  condition_changed: {\n    icon: AlertTriangle,\n    color: colors.danger,\n    label: 'Condition Changed',\n    category: 'status'\n  },\n  value_updated: {\n    icon: DollarSign,\n    color: colors.accent1,\n    label: 'Value Updated',\n    category: 'value'\n  },\n};\n\n// Single timeline event component\nconst TimelineEvent = memo(function TimelineEvent({ event, isLast }) {\n  const [expanded, setExpanded] = useState(false);\n  const config = EVENT_TYPES[event.type] || {\n    icon: Clock,\n    color: colors.textMuted,\n    label: event.type,\n    category: 'other'\n  };\n  const Icon = config.icon;\n\n  return (\n    <div style={{ display: 'flex', gap: spacing[3] }}>\n      {/* Timeline line and dot */}\n      <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', width: 24 }}>\n        <div\n          style={{\n            width: 32,\n            height: 32,\n            borderRadius: '50%',\n            background: withOpacity(config.color, 20),\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            color: config.color,\n            flexShrink: 0,\n          }}\n        >\n          <Icon size={16} />\n        </div>\n        {!isLast && (\n          <div\n            style={{\n              width: 2,\n              flex: 1,\n              background: colors.borderLight,\n              marginTop: spacing[1],\n              marginBottom: spacing[1],\n            }}\n          />\n        )}\n      </div>\n\n      {/* Event content */}\n      <div\n        style={{\n          flex: 1,\n          paddingBottom: isLast ? 0 : spacing[4],\n        }}\n      >\n        <div\n          onClick={() => event.details && setExpanded(!expanded)}\n          style={{\n            background: colors.bgCard,\n            border: `1px solid ${colors.borderLight}`,\n            borderRadius: borderRadius.lg,\n            padding: spacing[3],\n            cursor: event.details ? 'pointer' : 'default',\n          }}\n        >\n          {/* Header */}\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: spacing[1] }}>\n            <div style={{ display: 'flex', alignItems: 'center', gap: spacing[2] }}>\n              <Badge text={config.label} color={config.color} size=\"xs\" />\n              {event.important && (\n                <span style={{ color: colors.danger, fontSize: typography.fontSize.xs }}></span>\n              )}\n            </div>\n            <div style={{ display: 'flex', alignItems: 'center', gap: spacing[2] }}>\n              <span style={{ fontSize: typography.fontSize.xs, color: colors.textMuted }}>\n                {formatDateTime(event.date)}\n              </span>\n              {event.details && (\n                <span style={{ color: colors.textMuted }}>\n                  {expanded ? <ChevronUp size={14} /> : <ChevronDown size={14} />}\n                </span>\n              )}\n            </div>\n          </div>\n\n          {/* Summary */}\n          <div style={{ fontSize: typography.fontSize.sm, color: colors.textPrimary }}>\n            {event.summary}\n          </div>\n\n          {/* User */}\n          {event.user && (\n            <div style={{ fontSize: typography.fontSize.xs, color: colors.textMuted, marginTop: spacing[1] }}>\n              By: {event.user}\n            </div>\n          )}\n\n          {/* Expanded details */}\n          {expanded && event.details && (\n            <div\n              style={{\n                marginTop: spacing[3],\n                paddingTop: spacing[3],\n                borderTop: `1px solid ${colors.borderLight}`,\n              }}\n            >\n              {Object.entries(event.details).map(([key, value]) => (\n                <div key={key} style={{ display: 'flex', justifyContent: 'space-between', marginBottom: spacing[1] }}>\n                  <span style={{ fontSize: typography.fontSize.xs, color: colors.textMuted, textTransform: 'capitalize' }}>\n                    {key.replace(/([A-Z])/g, ' $1').trim()}\n                  </span>\n                  <span style={{ fontSize: typography.fontSize.xs, color: colors.textSecondary }}>\n                    {typeof value === 'number' && key.toLowerCase().includes('cost') \n                      ? formatMoney(value) \n                      : String(value)}\n                  </span>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n});\n\n// Main Timeline component\nfunction ItemTimeline({ item }) {\n  const [filter, setFilter] = useState('all');\n  const [showAll, setShowAll] = useState(false);\n\n  // Build unified timeline from all item data\n  const allEvents = useMemo(() => {\n    const events = [];\n\n    // Add checkout history events\n    if (item.checkoutHistory) {\n      item.checkoutHistory.forEach(entry => {\n        if (entry.type === 'checkout') {\n          events.push({\n            id: `checkout-${entry.id}`,\n            type: 'checkout',\n            date: entry.checkedOutDate,\n            summary: `Checked out to ${entry.borrowerName}${entry.project ? ` for ${entry.project}` : ''}`,\n            user: entry.borrowerName,\n            details: {\n              project: entry.project,\n              dueDate: entry.dueDate,\n              notes: entry.notes,\n            },\n          });\n        } else if (entry.type === 'return') {\n          events.push({\n            id: `return-${entry.id}`,\n            type: 'checkin',\n            date: entry.returnDate,\n            summary: `Returned by ${entry.returnedBy}${entry.conditionChanged ? ' - condition changed' : ''}`,\n            user: entry.returnedBy,\n            important: entry.damageReported,\n            details: entry.damageReported ? {\n              conditionAtReturn: entry.conditionAtReturn,\n              damageReported: 'Yes',\n              damageDescription: entry.damageDescription,\n            } : null,\n          });\n        }\n      });\n    }\n\n    // Add maintenance history events\n    if (item.maintenanceHistory) {\n      (item.maintenanceHistory || []).forEach(record => {\n        // Add scheduled event\n        if (record.scheduledDate) {\n          events.push({\n            id: `maint-sched-${record.id}`,\n            type: 'maintenance_scheduled',\n            date: record.createdAt || record.scheduledDate,\n            summary: `${record.type}: ${record.description}`,\n            details: {\n              vendor: record.vendor,\n              estimatedCost: record.cost,\n              scheduledFor: record.scheduledDate,\n            },\n          });\n        }\n\n        // Add completed event if completed\n        if (record.status === 'completed' && record.completedDate) {\n          events.push({\n            id: `maint-done-${record.id}`,\n            type: 'maintenance_completed',\n            date: record.completedDate,\n            summary: `${record.type} completed${record.vendor ? ` by ${record.vendor}` : ''}`,\n            details: {\n              description: record.description,\n              cost: record.cost,\n              warrantyWork: record.warrantyWork ? 'Yes' : 'No',\n              notes: record.notes,\n            },\n          });\n        }\n      });\n    }\n\n    // Add notes events\n    if (item.notes) {\n      (item.notes || []).filter(n => !n.deleted).forEach(note => {\n        events.push({\n          id: `note-${note.id}`,\n          type: 'note_added',\n          date: note.date,\n          summary: note.text.length > 100 ? note.text.substring(0, 100) + '...' : note.text,\n          user: note.user,\n        });\n      });\n    }\n\n    // Add reservation events\n    if (item.reservations) {\n      (item.reservations || []).forEach(res => {\n        events.push({\n          id: `res-${res.id}`,\n          type: 'reservation_created',\n          date: res.start, // Use start date as the event date\n          summary: `Reserved for ${res.project} (${formatDate(res.start)} - ${formatDate(res.end)})`,\n          user: res.user,\n          details: {\n            project: res.project,\n            projectType: res.projectType,\n            startDate: res.start,\n            endDate: res.end,\n            location: res.location,\n          },\n        });\n      });\n    }\n\n    // Add reminder events\n    if (item.reminders) {\n      (item.reminders || []).forEach(rem => {\n        events.push({\n          id: `rem-${rem.id}`,\n          type: rem.completed ? 'reminder_completed' : 'reminder_created',\n          date: rem.completed ? rem.completedAt || rem.dueDate : rem.createdAt || rem.dueDate,\n          summary: rem.title + (rem.description ? `: ${rem.description}` : ''),\n          details: {\n            dueDate: rem.dueDate,\n            recurrence: rem.recurrence,\n            completed: rem.completed ? 'Yes' : 'No',\n          },\n        });\n      });\n    }\n\n    // Sort by date descending (newest first)\n    events.sort((a, b) => new Date(b.date) - new Date(a.date));\n\n    return events;\n  }, [item]);\n\n  // Filter events\n  const filteredEvents = useMemo(() => {\n    if (filter === 'all') return allEvents;\n    return allEvents.filter(e => {\n      const config = EVENT_TYPES[e.type];\n      return config && config.category === filter;\n    });\n  }, [allEvents, filter]);\n\n  // Limit display unless \"show all\" is clicked\n  const displayedEvents = showAll ? filteredEvents : filteredEvents.slice(0, 5);\n\n  const filterOptions = [\n    { value: 'all', label: 'All Events' },\n    { value: 'checkout', label: 'Checkouts' },\n    { value: 'maintenance', label: 'Maintenance' },\n    { value: 'notes', label: 'Notes' },\n    { value: 'reservations', label: 'Reservations' },\n    { value: 'reminders', label: 'Reminders' },\n  ];\n\n  return (\n    <Card padding={false}>\n      <CardHeader\n        title=\"Item Timeline\"\n        icon={Clock}\n        action={\n          <Select\n            value={filter}\n            onChange={e => setFilter(e.target.value)}\n            options={filterOptions}\n            style={{ width: 120 }}\n            aria-label=\"Filter timeline\"\n          />\n        }\n      />\n      <div style={{ padding: spacing[4] }}>\n        {displayedEvents.length === 0 ? (\n          <div style={{ textAlign: 'center', padding: spacing[6], color: colors.textMuted }}>\n            <Clock size={32} style={{ marginBottom: spacing[2], opacity: 0.3 }} />\n            <p style={{ margin: 0, fontSize: typography.fontSize.sm }}>\n              No events recorded yet\n            </p>\n          </div>\n        ) : (\n          <>\n            {displayedEvents.map((event, idx) => (\n              <TimelineEvent\n                key={event.id}\n                event={event}\n                isLast={idx === displayedEvents.length - 1}\n              />\n            ))}\n            \n            {filteredEvents.length > 5 && !showAll && (\n              <button\n                onClick={() => setShowAll(true)}\n                style={{\n                  ...styles.btnSec,\n                  width: '100%',\n                  marginTop: spacing[3],\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  gap: spacing[2],\n                }}\n              >\n                <ChevronDown size={16} />\n                Show Full Timeline ({filteredEvents.length} events)\n              </button>\n            )}\n            \n            {showAll && filteredEvents.length > 5 && (\n              <button\n                onClick={() => setShowAll(false)}\n                style={{\n                  ...styles.btnSec,\n                  width: '100%',\n                  marginTop: spacing[3],\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  gap: spacing[2],\n                }}\n              >\n                <ChevronUp size={16} />\n                Hide Full Timeline\n              </button>\n            )}\n          </>\n        )}\n      </div>\n    </Card>\n  );\n}\n\nexport default memo(ItemTimeline);\n","// ============================================================================\n// Depreciation Calculator Component\n// Calculates and displays item depreciation using multiple methods\n// ============================================================================\n\nimport React, { memo, useState, useMemo } from 'react';\nimport { TrendingDown, Info, ChevronDown, ChevronUp } from 'lucide-react';\nimport { colors, styles, spacing, borderRadius, typography, withOpacity} from '../theme.js';\nimport { formatMoney, calculateDepreciation, DEFAULT_USEFUL_LIFE, DEPRECIATION_METHODS } from '../utils.js';\nimport { Badge, Card, CardHeader, Button } from './ui.jsx';\nimport { Select } from './Select.jsx';\n\n// Depreciation Calculator Component\nfunction DepreciationCalculator({ item, onUpdateValue }) {\n  const [method, setMethod] = useState(DEPRECIATION_METHODS.STRAIGHT_LINE);\n  const [usefulLife, setUsefulLife] = useState(\n    DEFAULT_USEFUL_LIFE[item.category] || 5\n  );\n  const [salvagePercent, setSalvagePercent] = useState(10); // 10% salvage value default\n  const [showSchedule, setShowSchedule] = useState(false);\n  const [showInfo, setShowInfo] = useState(false);\n\n  const salvageValue = (item.purchasePrice * salvagePercent) / 100;\n\n  const depreciation = useMemo(() => {\n    if (!item.purchasePrice || !item.purchaseDate) {\n      return null;\n    }\n    return calculateDepreciation(\n      item.purchasePrice,\n      item.purchaseDate,\n      usefulLife,\n      salvageValue,\n      method\n    );\n  }, [item.purchasePrice, item.purchaseDate, usefulLife, salvageValue, method]);\n\n  if (!item.purchasePrice || !item.purchaseDate) {\n    return (\n      <Card padding={false}>\n        <CardHeader title=\"Depreciation\" icon={TrendingDown} />\n        <div style={{ padding: spacing[4], textAlign: 'center', color: colors.textMuted }}>\n          <p style={{ margin: 0, fontSize: typography.fontSize.sm }}>\n            Purchase price and date required to calculate depreciation.\n          </p>\n        </div>\n      </Card>\n    );\n  }\n\n  const methodLabels = {\n    [DEPRECIATION_METHODS.STRAIGHT_LINE]: 'Straight Line',\n    [DEPRECIATION_METHODS.DECLINING_BALANCE]: 'Declining Balance (150%)',\n    [DEPRECIATION_METHODS.DOUBLE_DECLINING]: 'Double Declining (200%)',\n  };\n\n  return (\n    <Card padding={false}>\n      <CardHeader \n        title=\"Depreciation Calculator\" \n        icon={TrendingDown}\n        action={\n          <button\n            onClick={() => setShowInfo(!showInfo)}\n            style={{\n              background: 'none',\n              border: 'none',\n              color: colors.textMuted,\n              cursor: 'pointer',\n              padding: spacing[1],\n            }}\n          >\n            <Info size={16} />\n          </button>\n        }\n      />\n      <div style={{ padding: spacing[4] }}>\n        {/* Info panel */}\n        {showInfo && (\n          <div\n            style={{\n              background: `${withOpacity(colors.primary, 10)}`,\n              borderRadius: borderRadius.md,\n              padding: spacing[3],\n              marginBottom: spacing[4],\n              fontSize: typography.fontSize.xs,\n              color: colors.textSecondary,\n            }}\n          >\n            <strong style={{ color: colors.textPrimary }}>Depreciation Methods:</strong>\n            <ul style={{ margin: `${spacing[2]}px 0 0 0`, paddingLeft: spacing[4] }}>\n              <li><strong>Straight Line:</strong> Equal depreciation each year</li>\n              <li><strong>Declining Balance:</strong> 150% of straight-line rate applied to remaining value</li>\n              <li><strong>Double Declining:</strong> 200% of straight-line rate (accelerated)</li>\n            </ul>\n          </div>\n        )}\n\n        {/* Configuration */}\n        <div className=\"responsive-three-col\" style={{ display: 'grid', gap: spacing[3], marginBottom: spacing[4] }}>\n          <div>\n            <label style={{ ...styles.label, fontSize: typography.fontSize.xs }}>Method</label>\n            <Select\n              value={method}\n              onChange={e => setMethod(e.target.value)}\n              options={Object.entries(methodLabels).map(([value, label]) => ({ value, label }))}\n              aria-label=\"Depreciation method\"\n            />\n          </div>\n          <div>\n            <label style={{ ...styles.label, fontSize: typography.fontSize.xs }}>Useful Life (years)</label>\n            <input\n              type=\"number\"\n              value={usefulLife}\n              onChange={e => setUsefulLife(Math.max(1, parseInt(e.target.value) || 1))}\n              min=\"1\"\n              max=\"30\"\n              style={{ ...styles.input, fontSize: typography.fontSize.sm, padding: spacing[2] }}\n            />\n          </div>\n          <div>\n            <label style={{ ...styles.label, fontSize: typography.fontSize.xs }}>Salvage Value (%)</label>\n            <input\n              type=\"number\"\n              value={salvagePercent}\n              onChange={e => setSalvagePercent(Math.max(0, Math.min(100, parseInt(e.target.value) || 0)))}\n              min=\"0\"\n              max=\"100\"\n              style={{ ...styles.input, fontSize: typography.fontSize.sm, padding: spacing[2] }}\n            />\n          </div>\n        </div>\n\n        {/* Results */}\n        {depreciation && (\n          <>\n            {/* Value comparison */}\n            <div\n              className=\"responsive-three-col\"\n              style={{\n                display: 'grid',\n                gap: spacing[3],\n                marginBottom: spacing[4],\n                padding: spacing[3],\n                background: colors.bgDark,\n                borderRadius: borderRadius.lg,\n              }}\n            >\n              <div style={{ textAlign: 'center' }}>\n                <div style={{ fontSize: typography.fontSize.xs, color: colors.textMuted, marginBottom: spacing[1] }}>\n                  Purchase Price\n                </div>\n                <div style={{ fontSize: typography.fontSize.lg, fontWeight: typography.fontWeight.bold, color: colors.textPrimary }}>\n                  {formatMoney(item.purchasePrice)}\n                </div>\n              </div>\n              <div style={{ textAlign: 'center' }}>\n                <div style={{ fontSize: typography.fontSize.xs, color: colors.textMuted, marginBottom: spacing[1] }}>\n                  Calculated Value\n                </div>\n                <div style={{ fontSize: typography.fontSize.lg, fontWeight: typography.fontWeight.bold, color: colors.primary }}>\n                  {formatMoney(depreciation.currentValue)}\n                </div>\n              </div>\n              <div style={{ textAlign: 'center' }}>\n                <div style={{ fontSize: typography.fontSize.xs, color: colors.textMuted, marginBottom: spacing[1] }}>\n                  Current Value\n                </div>\n                <div style={{ fontSize: typography.fontSize.lg, fontWeight: typography.fontWeight.bold, color: colors.available }}>\n                  {formatMoney(item.currentValue)}\n                </div>\n              </div>\n            </div>\n\n            {/* Stats row */}\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: spacing[2], marginBottom: spacing[4] }}>\n              <div style={{ padding: spacing[2], background: `${withOpacity(colors.danger, 10)}`, borderRadius: borderRadius.md, textAlign: 'center' }}>\n                <div style={{ fontSize: typography.fontSize.xs, color: colors.textMuted }}>Total Depreciation</div>\n                <div style={{ fontSize: typography.fontSize.sm, fontWeight: typography.fontWeight.semibold, color: colors.danger }}>\n                  {formatMoney(depreciation.totalDepreciation)}\n                </div>\n              </div>\n              <div style={{ padding: spacing[2], background: `${withOpacity(colors.primary, 10)}`, borderRadius: borderRadius.md, textAlign: 'center' }}>\n                <div style={{ fontSize: typography.fontSize.xs, color: colors.textMuted }}>Annual</div>\n                <div style={{ fontSize: typography.fontSize.sm, fontWeight: typography.fontWeight.semibold, color: colors.primary }}>\n                  {formatMoney(depreciation.annualDepreciation)}\n                </div>\n              </div>\n              <div style={{ padding: spacing[2], background: `${withOpacity(colors.accent1, 10)}`, borderRadius: borderRadius.md, textAlign: 'center' }}>\n                <div style={{ fontSize: typography.fontSize.xs, color: colors.textMuted }}>Age</div>\n                <div style={{ fontSize: typography.fontSize.sm, fontWeight: typography.fontWeight.semibold, color: colors.accent1 }}>\n                  {depreciation.ageInYears.toFixed(1)} yrs\n                </div>\n              </div>\n              <div style={{ padding: spacing[2], background: `${withOpacity(colors.accent2, 10)}`, borderRadius: borderRadius.md, textAlign: 'center' }}>\n                <div style={{ fontSize: typography.fontSize.xs, color: colors.textMuted }}>% Depreciated</div>\n                <div style={{ fontSize: typography.fontSize.sm, fontWeight: typography.fontWeight.semibold, color: colors.accent2 }}>\n                  {depreciation.percentDepreciated.toFixed(1)}%\n                </div>\n              </div>\n            </div>\n\n            {/* Depreciation bar */}\n            <div style={{ marginBottom: spacing[4] }}>\n              <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: spacing[1] }}>\n                <span style={{ fontSize: typography.fontSize.xs, color: colors.textMuted }}>Depreciation Progress</span>\n                <span style={{ fontSize: typography.fontSize.xs, color: colors.textMuted }}>\n                  Salvage: {formatMoney(salvageValue)}\n                </span>\n              </div>\n              <div\n                style={{\n                  height: 8,\n                  background: colors.borderLight,\n                  borderRadius: borderRadius.full,\n                  overflow: 'hidden',\n                }}\n              >\n                <div\n                  style={{\n                    height: '100%',\n                    width: `${Math.min(depreciation.percentDepreciated, 100)}%`,\n                    background: `linear-gradient(90deg, ${colors.danger}, ${colors.accent1})`,\n                    borderRadius: borderRadius.full,\n                    transition: 'width 0.3s ease',\n                  }}\n                />\n              </div>\n            </div>\n\n            {/* Update value button */}\n            {Math.abs(item.currentValue - depreciation.currentValue) > 1 && onUpdateValue && (\n              <Button\n                variant=\"secondary\"\n                size=\"sm\"\n                fullWidth\n                onClick={() => onUpdateValue(Math.round(depreciation.currentValue))}\n                style={{ marginBottom: spacing[4] }}\n              >\n                Update Current Value to {formatMoney(depreciation.currentValue)}\n              </Button>\n            )}\n\n            {/* Schedule toggle */}\n            <button\n              onClick={() => setShowSchedule(!showSchedule)}\n              style={{\n                width: '100%',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'space-between',\n                padding: spacing[2],\n                background: 'none',\n                border: `1px solid ${colors.borderLight}`,\n                borderRadius: borderRadius.md,\n                cursor: 'pointer',\n                color: colors.textSecondary,\n                fontSize: typography.fontSize.sm,\n              }}\n            >\n              <span>Depreciation Schedule</span>\n              {showSchedule ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\n            </button>\n\n            {/* Schedule table */}\n            {showSchedule && (\n              <div style={{ marginTop: spacing[3], overflowX: 'auto' }}>\n                <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: typography.fontSize.xs }}>\n                  <thead>\n                    <tr style={{ borderBottom: `1px solid ${colors.borderLight}` }}>\n                      <th style={{ padding: spacing[2], textAlign: 'left', color: colors.textMuted }}>Year</th>\n                      <th style={{ padding: spacing[2], textAlign: 'right', color: colors.textMuted }}>Start Value</th>\n                      <th style={{ padding: spacing[2], textAlign: 'right', color: colors.textMuted }}>Depreciation</th>\n                      <th style={{ padding: spacing[2], textAlign: 'right', color: colors.textMuted }}>End Value</th>\n                      <th style={{ padding: spacing[2], textAlign: 'right', color: colors.textMuted }}>Accumulated</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {depreciation.schedule.map((row, idx) => {\n                      const isCurrent = row.year === Math.ceil(depreciation.ageInYears);\n                      return (\n                        <tr\n                          key={row.year}\n                          style={{\n                            borderBottom: `1px solid ${colors.borderLight}`,\n                            background: isCurrent ? `${withOpacity(colors.primary, 10)}` : 'transparent',\n                          }}\n                        >\n                          <td style={{ padding: spacing[2], color: colors.textPrimary }}>\n                            {row.year}\n                            {isCurrent && <Badge text=\"Current\" color={colors.primary} size=\"xs\" style={{ marginLeft: spacing[1] }} />}\n                          </td>\n                          <td style={{ padding: spacing[2], textAlign: 'right', color: colors.textSecondary }}>\n                            {formatMoney(row.startValue)}\n                          </td>\n                          <td style={{ padding: spacing[2], textAlign: 'right', color: colors.danger }}>\n                            -{formatMoney(row.depreciation)}\n                          </td>\n                          <td style={{ padding: spacing[2], textAlign: 'right', color: colors.textPrimary, fontWeight: typography.fontWeight.medium }}>\n                            {formatMoney(row.endValue)}\n                          </td>\n                          <td style={{ padding: spacing[2], textAlign: 'right', color: colors.textMuted }}>\n                            {formatMoney(row.accumulated)}\n                          </td>\n                        </tr>\n                      );\n                    })}\n                  </tbody>\n                </table>\n              </div>\n            )}\n          </>\n        )}\n      </div>\n    </Card>\n  );\n}\n\nexport default memo(DepreciationCalculator);\n","// ============================================================================\n// Item Detail Component\n// Supports collapsible sections with user-customizable order and visibility\n// ============================================================================\n\nimport React, { memo, useMemo, useState, useEffect } from 'react';\nimport { CheckCircle, RefreshCw, Edit, QrCode, Trash2, Calendar, Plus, Upload, Layout, DollarSign, Clock, Bell, Wrench, MessageSquare, History, Settings, Package, ChevronDown, ChevronUp, Eye } from 'lucide-react';\nimport { colors, styles, spacing, borderRadius, typography, withOpacity} from '../theme.js';\nimport { formatDate, formatMoney, getStatusColor, getConditionColor } from '../utils.js';\nimport { ITEM_DETAIL_SECTIONS } from '../constants.js';\nimport { Badge, Card, Button, CollapsibleSection, BackButton } from '../components/ui.jsx';\nimport { OptimizedImage } from '../components/OptimizedImage.jsx';\nimport { Select } from '../components/Select.jsx';\nimport NotesSection from '../components/NotesSection.jsx';\nimport RemindersSection from '../components/RemindersSection.jsx';\nimport MaintenanceSection from '../components/MaintenanceSection.jsx';\nimport ItemTimeline from '../components/ItemTimeline.jsx';\nimport DepreciationCalculator from '../components/DepreciationCalculator.jsx';\nimport { usePermissions } from '../contexts/PermissionsContext.jsx';\n\n// Panel color mapping for item detail sections (CSS variables)\nconst SECTION_COLORS = {\n  specs: 'var(--sidebar-item1)',\n  reservations: 'var(--panel-reservations)',\n  notes: 'var(--sidebar-item3)',\n  reminders: 'var(--panel-reminders)',\n  maintenance: 'var(--sidebar-item5)',\n  depreciation: 'var(--sidebar-item6)',\n  timeline: 'var(--sidebar-item2)',\n  addToKit: 'var(--sidebar-item4)',\n};\n\n// Helper to create item style with panel-colored background\nconst getItemStyle = (panelColor) => ({\n  background: withOpacity(panelColor, 20),\n  border: `1px solid ${withOpacity(panelColor, 50)}`,\n  borderRadius: borderRadius.md,\n  padding: spacing[3],\n  marginBottom: spacing[2],\n});\n\n// Default item border style (fallback)\nconst itemBorderStyle = {\n  background: colors.bgLight,\n  border: `1px solid ${colors.borderLight}`,\n  borderRadius: borderRadius.md,\n  padding: spacing[3],\n  marginBottom: spacing[2],\n};\n\n// Add to Kit/Package Section Component - add item to packages\nconst AddToKitSection = memo(function AddToKitSection({ item, packages, onAddToPackage, panelColor }) {\n  const [selectedPackageId, setSelectedPackageId] = useState('');\n  const effectivePanelColor = panelColor && panelColor.length > 0 ? panelColor : colors.primary;\n  const itemStyle = getItemStyle(effectivePanelColor);\n  \n  // Find packages that contain this item\n  const containingPackages = useMemo(() => {\n    return (packages || []).filter(pkg => pkg.items && pkg.items.includes(item.id));\n  }, [packages, item.id]);\n  \n  // Find packages that don't contain this item yet\n  const availablePackages = useMemo(() => {\n    return (packages || []).filter(pkg => !pkg.items || !pkg.items.includes(item.id));\n  }, [packages, item.id]);\n  \n  const handleAddToPackage = () => {\n    if (selectedPackageId && onAddToPackage) {\n      onAddToPackage(selectedPackageId, item.id);\n      setSelectedPackageId('');\n    }\n  };\n  \n  return (\n    <div style={{ padding: spacing[3] }}>\n      {/* Show packages this item is already in */}\n      {containingPackages.length > 0 && (\n        <div style={{ marginBottom: spacing[3] }}>\n          <div style={{ \n            fontSize: typography.fontSize.sm, \n            color: colors.textSecondary,\n            marginBottom: spacing[2]\n          }}>\n            This item is included in:\n          </div>\n          {containingPackages.map(pkg => (\n            <div key={pkg.id} style={itemStyle}>\n              <div style={{ display: 'flex', alignItems: 'center', gap: spacing[2] }}>\n                <Package size={18} color={effectivePanelColor} />\n                <div style={{ flex: 1 }}>\n                  <div style={{ \n                    fontSize: typography.fontSize.sm, \n                    fontWeight: typography.fontWeight.medium,\n                    color: colors.textPrimary \n                  }}>\n                    {pkg.name}\n                  </div>\n                  <div style={{ fontSize: typography.fontSize.xs, color: colors.textMuted }}>\n                    {pkg.id}  {pkg.items?.length || 0} items\n                  </div>\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n      \n      {/* Add to package dropdown */}\n      {availablePackages.length === 0 ? (\n        containingPackages.length === 0 && (\n          <div style={{ \n            textAlign: 'center', \n            padding: spacing[4],\n            color: colors.textMuted,\n            fontSize: typography.fontSize.sm \n          }}>\n            No kits or packages available.\n          </div>\n        )\n      ) : (\n        <div>\n          <div style={{ \n            fontSize: typography.fontSize.sm, \n            color: colors.textSecondary,\n            marginBottom: spacing[2]\n          }}>\n            Add to a kit or package:\n          </div>\n          <div style={{ display: 'flex', gap: spacing[2], alignItems: 'flex-start' }}>\n            <Select\n              value={selectedPackageId}\n              onChange={(e) => setSelectedPackageId(e.target.value)}\n              options={[\n                { value: '', label: 'Select a kit/package...' },\n                ...availablePackages.map(pkg => ({ \n                  value: pkg.id, \n                  label: `${pkg.name} (${pkg.items?.length || 0} items)` \n                }))\n              ]}\n              style={{ flex: 1 }}\n              aria-label=\"Select kit or package\"\n            />\n            <Button onClick={handleAddToPackage} disabled={!selectedPackageId} icon={Plus}>\n              Add\n            </Button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n});\n\n// Required Accessories Section Component\nconst RequiredAccessoriesSection = memo(function RequiredAccessoriesSection({ \n  item, \n  inventory, \n  onAddAccessory, \n  onRemoveAccessory, \n  onViewItem,\n  panelColor \n}) {\n  const [showAddPanel, setShowAddPanel] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [selectedIds, setSelectedIds] = useState([]);\n  \n  const effectivePanelColor = panelColor && panelColor.length > 0 ? panelColor : colors.primary;\n  const itemStyle = getItemStyle(effectivePanelColor);\n  \n  // Get current required accessories\n  const requiredAccessories = useMemo(() => {\n    if (!item.requiredAccessories) return [];\n    return item.requiredAccessories\n      .map(id => inventory.find(i => i.id === id))\n      .filter(Boolean);\n  }, [item.requiredAccessories, inventory]);\n  \n  // Get available items to add (exclude self and already added)\n  const availableItems = useMemo(() => {\n    const existingIds = new Set(item.requiredAccessories || []);\n    existingIds.add(item.id);\n    \n    return inventory.filter(i => {\n      if (existingIds.has(i.id)) return false;\n      if (i.isKit) return false; // Don't add kits as accessories\n      if (searchQuery) {\n        const q = searchQuery.toLowerCase();\n        return i.name.toLowerCase().includes(q) || i.id.toLowerCase().includes(q);\n      }\n      return true;\n    });\n  }, [inventory, item.id, item.requiredAccessories, searchQuery]);\n  \n  const handleToggleSelect = (id) => {\n    setSelectedIds(prev => \n      prev.includes(id) ? prev.filter(i => i !== id) : [...prev, id]\n    );\n  };\n  \n  const handleAddSelected = () => {\n    if (selectedIds.length > 0 && onAddAccessory) {\n      onAddAccessory(item.id, selectedIds);\n      setSelectedIds([]);\n      setShowAddPanel(false);\n      setSearchQuery('');\n    }\n  };\n  \n  return (\n    <div style={{ padding: spacing[3] }}>\n      {/* Current required accessories */}\n      {requiredAccessories.length > 0 ? (\n        <div style={{ marginBottom: spacing[3] }}>\n          {requiredAccessories.map(acc => (\n            <div key={acc.id} style={itemStyle}>\n              <div style={{ display: 'flex', alignItems: 'center', gap: spacing[2] }}>\n                <div \n                  style={{ flex: 1, cursor: 'pointer' }}\n                  onClick={() => onViewItem?.(acc.id)}\n                >\n                  <div style={{ \n                    fontSize: typography.fontSize.sm, \n                    fontWeight: typography.fontWeight.medium,\n                    color: colors.textPrimary \n                  }}>\n                    {acc.name}\n                  </div>\n                  <div style={{ fontSize: typography.fontSize.xs, color: colors.textMuted }}>\n                    {acc.id}  {acc.category}\n                  </div>\n                </div>\n                <Badge text={acc.status} color={getStatusColor(acc.status)} size=\"sm\" />\n                {onRemoveAccessory && (\n                  <button\n                    onClick={() => onRemoveAccessory(item.id, acc.id)}\n                    style={{ \n                      background: 'none', \n                      border: 'none', \n                      color: colors.textMuted, \n                      cursor: 'pointer',\n                      padding: spacing[1],\n                    }}\n                  >\n                    <Trash2 size={14} />\n                  </button>\n                )}\n              </div>\n            </div>\n          ))}\n        </div>\n      ) : (\n        <p style={{ \n          color: colors.textMuted, \n          textAlign: 'center', \n          fontSize: typography.fontSize.sm,\n          margin: `0 0 ${spacing[3]}px`,\n          padding: spacing[3],\n        }}>\n          No required accessories defined\n        </p>\n      )}\n      \n      {/* Add accessories panel */}\n      {showAddPanel ? (\n        <div style={{ \n          background: withOpacity(effectivePanelColor, 10),\n          borderRadius: borderRadius.md,\n          padding: spacing[3],\n          border: `1px solid ${withOpacity(effectivePanelColor, 30)}`,\n        }}>\n          <div style={{ marginBottom: spacing[2] }}>\n            <input\n              type=\"text\"\n              value={searchQuery}\n              onChange={e => setSearchQuery(e.target.value)}\n              placeholder=\"Search items...\"\n              style={{ ...styles.input, width: '100%' }}\n            />\n          </div>\n          <div style={{ maxHeight: 200, overflowY: 'auto', marginBottom: spacing[2] }}>\n            {availableItems.slice(0, 50).map(i => (\n              <label \n                key={i.id}\n                style={{ \n                  display: 'flex', \n                  alignItems: 'center', \n                  gap: spacing[2],\n                  padding: spacing[2],\n                  cursor: 'pointer',\n                  borderRadius: borderRadius.sm,\n                  background: selectedIds.includes(i.id) ? withOpacity(effectivePanelColor, 20) : 'transparent',\n                }}\n              >\n                <input\n                  type=\"checkbox\"\n                  checked={selectedIds.includes(i.id)}\n                  onChange={() => handleToggleSelect(i.id)}\n                />\n                <div style={{ flex: 1 }}>\n                  <div style={{ fontSize: typography.fontSize.sm, color: colors.textPrimary }}>{i.name}</div>\n                  <div style={{ fontSize: typography.fontSize.xs, color: colors.textMuted }}>{i.id}</div>\n                </div>\n              </label>\n            ))}\n            {availableItems.length === 0 && (\n              <p style={{ color: colors.textMuted, textAlign: 'center', padding: spacing[2] }}>\n                No items found\n              </p>\n            )}\n          </div>\n          <div style={{ display: 'flex', gap: spacing[2], justifyContent: 'flex-end' }}>\n            <Button variant=\"secondary\" onClick={() => { setShowAddPanel(false); setSelectedIds([]); setSearchQuery(''); }}>\n              Cancel\n            </Button>\n            <Button onClick={handleAddSelected} disabled={selectedIds.length === 0} icon={Plus}>\n              Add ({selectedIds.length})\n            </Button>\n          </div>\n        </div>\n      ) : (\n        <Button variant=\"secondary\" onClick={() => setShowAddPanel(true)} icon={Plus} fullWidth>\n          Add Required Accessory\n        </Button>\n      )}\n    </div>\n  );\n});\n\nfunction ItemDetail({ \n  item, inventory, packages, specs, categorySettings, layoutPrefs, \n  onBack, backLabel = 'Back to Gear List',\n  onCheckout, onCheckin, onEdit, onDelete, onShowQR, \n  onAddReservation, onDeleteReservation, \n  onAddNote, onReplyNote, onDeleteNote, \n  onSelectImage, onViewReservation, \n  onAddReminder, onCompleteReminder, onUncompleteReminder, onDeleteReminder, \n  onAddMaintenance, onUpdateMaintenance, onCompleteMaintenance, \n  onUpdateValue, \n  onAddAccessory, onRemoveAccessory,\n  onSetAsKit, onAddToKit, onAddToPackage, onRemoveFromKit, onClearKit, onViewItem, \n  onCustomizeLayout, onToggleCollapse, \n  user \n}) {\n  const { canEdit } = usePermissions();\n  const canEditItems = canEdit('item_details');\n  const [specsExpanded, setSpecsExpanded] = useState(false);\n\n  const isCheckedOut = item?.status === 'checked-out';\n  const categorySpecs = item ? (specs[item.category] || []) : [];\n  \n  // Get category settings for quantity display\n  const currentCategorySettings = (item && categorySettings?.[item.category]) || { \n    trackQuantity: false, \n    trackSerialNumbers: true \n  };\n  \n  const [collapsedSections, setCollapsedSections] = useState(() => {\n    const initial = {};\n    Object.values(ITEM_DETAIL_SECTIONS).forEach(s => {\n      initial[s.id] = layoutPrefs?.sections?.[s.id]?.collapsed || false;\n    });\n    return initial;\n  });\n\n  useEffect(() => {\n    if (layoutPrefs?.sections) {\n      setCollapsedSections(prev => {\n        const updated = { ...prev };\n        Object.keys(layoutPrefs.sections).forEach(id => {\n          if (layoutPrefs.sections[id]?.collapsed !== undefined) {\n            updated[id] = layoutPrefs.sections[id].collapsed;\n          }\n        });\n        return updated;\n      });\n    }\n  }, [layoutPrefs]);\n\n  const getSectionPref = (sectionId) => {\n    const defaultSection = Object.values(ITEM_DETAIL_SECTIONS).find(s => s.id === sectionId);\n    const pref = layoutPrefs?.sections?.[sectionId];\n    return {\n      visible: pref?.visible !== false,\n      order: pref?.order ?? defaultSection?.order ?? 99,\n    };\n  };\n\n  const showSection = (sectionId) => getSectionPref(sectionId).visible;\n  const isCollapsed = (sectionId) => collapsedSections[sectionId] || false;\n  \n  const toggleCollapse = (sectionId) => {\n    setCollapsedSections(prev => ({ ...prev, [sectionId]: !prev[sectionId] }));\n    if (onToggleCollapse) {\n      onToggleCollapse('itemDetail', sectionId);\n    }\n  };\n\n  const allSpecs = useMemo(() => {\n    if (!item) return [];\n    const baseSpecs = [\n      { name: 'Location', value: item.location || '-' },\n      { name: 'Serial Number', value: item.serialNumber || '-' },\n    ];\n    \n    // Add quantity info if category tracks it\n    if (currentCategorySettings.trackQuantity) {\n      baseSpecs.push(\n        { name: 'Quantity', value: item.quantity ?? 1 },\n        { name: 'Reorder Point', value: item.reorderPoint ?? 0 }\n      );\n    }\n    \n    // Add category-specific specs\n    const catSpecs = categorySpecs.map(spec => ({ \n      name: spec.name, \n      value: item.specs?.[spec.name] || '-' \n    }));\n    \n    return [...baseSpecs, ...catSpecs];\n  }, [item, categorySpecs, currentCategorySettings]);\n\n  const sortedSections = useMemo(() => {\n    const sectionIds = ['specifications', 'reservations', 'notes', 'reminders', 'addToKit', 'maintenance', 'timeline', 'checkoutHistory', 'value', 'depreciation'];\n    return sectionIds\n      .filter(id => getSectionPref(id).visible)\n      .map(id => ({ id, order: getSectionPref(id).order }))\n      .sort((a, b) => a.order - b.order)\n      .map(s => s.id);\n  }, [layoutPrefs]);\n\n  if (!item) return null;\n\n  const renderSection = (sectionId) => {\n    switch (sectionId) {\n      case 'specifications':\n        return (\n          <CollapsibleSection\n            key=\"specifications\"\n            title=\"Specifications\"\n            icon={Settings}\n            headerColor={SECTION_COLORS.specs}\n            collapsed={isCollapsed('specifications')}\n            onToggleCollapse={() => toggleCollapse('specifications')}\n          >\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: spacing[3] }}>\n              {(specsExpanded ? allSpecs : allSpecs.slice(0, 10)).map((spec) => (\n                <div key={spec.name}>\n                  <div style={{ fontSize: typography.fontSize.xs, color: colors.textMuted, textTransform: 'uppercase', marginBottom: spacing[1] }}>\n                    {spec.name}\n                  </div>\n                  <div style={{ color: colors.textPrimary, fontSize: typography.fontSize.sm }}>\n                    {spec.value}\n                  </div>\n                </div>\n              ))}\n            </div>\n            {allSpecs.length > 10 && (\n              <button\n                onClick={() => setSpecsExpanded(!specsExpanded)}\n                style={{\n                  ...styles.btnSec,\n                  width: '100%',\n                  marginTop: spacing[3],\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  gap: spacing[2],\n                }}\n              >\n                {specsExpanded ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\n                {specsExpanded ? 'Hide Full Specs' : 'Show Full Specs'}\n              </button>\n            )}\n          </CollapsibleSection>\n        );\n      \n      case 'reservations':\n        const reservationsColor = SECTION_COLORS.reservations;\n        return (\n          <CollapsibleSection\n            key=\"reservations\"\n            title=\"Reservations\"\n            icon={Calendar}\n            badge={item.reservations?.length || 0}\n            badgeColor={reservationsColor}\n            headerColor={reservationsColor}\n            collapsed={isCollapsed('reservations')}\n            onToggleCollapse={() => toggleCollapse('reservations')}\n            action={canEditItems && <button onClick={onAddReservation} style={{ ...styles.btn, padding: `${spacing[1]}px ${spacing[2]}px`, fontSize: typography.fontSize.xs }}><Plus size={12} /></button>}\n          >\n            <div style={{ maxHeight: 220, overflowY: 'auto' }}>\n              {!item.reservations || item.reservations.length === 0 ? (\n                <p style={{ color: colors.textMuted, textAlign: 'center', fontSize: typography.fontSize.sm, margin: 0, padding: spacing[3] }}>No reservations</p>\n              ) : item.reservations.map(r => (\n                <div key={r.id} onClick={() => onViewReservation?.(r)} style={{ ...getItemStyle(reservationsColor), cursor: 'pointer' }}>\n                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                    <div>\n                      <div style={{ fontSize: typography.fontSize.sm, fontWeight: typography.fontWeight.medium, color: colors.textPrimary }}>{r.project}</div>\n                      <div style={{ fontSize: typography.fontSize.xs, color: colors.primary }}>{formatDate(r.start)}  {formatDate(r.end)}</div>\n                    </div>\n                    {canEditItems && (\n                      <button onClick={(e) => { e.stopPropagation(); onDeleteReservation(item.id, r.id); }} style={{ background: 'none', border: 'none', color: colors.textMuted, cursor: 'pointer', padding: spacing[1] }}>\n                        <Trash2 size={14} />\n                      </button>\n                    )}\n                  </div>\n                </div>\n              ))}\n            </div>\n          </CollapsibleSection>\n        );\n      \n      case 'notes':\n        const notesColor = SECTION_COLORS.notes;\n        return (\n          <CollapsibleSection\n            key=\"notes\"\n            title=\"Notes\"\n            icon={MessageSquare}\n            badge={(item.notes || []).length}\n            badgeColor={notesColor}\n            headerColor={notesColor}\n            collapsed={isCollapsed('notes')}\n            onToggleCollapse={() => toggleCollapse('notes')}\n            padding={false}\n          >\n            <NotesSection notes={item.notes || []} onAddNote={onAddNote} onReply={onReplyNote} onDelete={onDeleteNote} user={user} panelColor={notesColor} />\n          </CollapsibleSection>\n        );\n      \n      case 'reminders':\n        const remindersColor = SECTION_COLORS.reminders;\n        return (\n          <CollapsibleSection\n            key=\"reminders\"\n            title=\"Reminders\"\n            icon={Bell}\n            badge={(item.reminders || []).length}\n            badgeColor={remindersColor}\n            headerColor={remindersColor}\n            collapsed={isCollapsed('reminders')}\n            onToggleCollapse={() => toggleCollapse('reminders')}\n            padding={false}\n          >\n            <RemindersSection reminders={item.reminders || []} onAddReminder={onAddReminder} onCompleteReminder={onCompleteReminder} onUncompleteReminder={onUncompleteReminder} onDeleteReminder={onDeleteReminder} panelColor={remindersColor} />\n          </CollapsibleSection>\n        );\n      \n      case 'requiredAccessories':\n        const accessoriesColor = SECTION_COLORS.addToKit;\n        return (\n          <CollapsibleSection\n            key=\"requiredAccessories\"\n            title=\"Required Accessories\"\n            icon={Settings}\n            badge={(item.requiredAccessories || []).length}\n            badgeColor={accessoriesColor}\n            headerColor={accessoriesColor}\n            collapsed={isCollapsed('requiredAccessories')}\n            onToggleCollapse={() => toggleCollapse('requiredAccessories')}\n            padding={false}\n          >\n            <RequiredAccessoriesSection \n              item={item} \n              inventory={inventory} \n              onAddAccessory={onAddAccessory} \n              onRemoveAccessory={onRemoveAccessory}\n              onViewItem={onViewItem}\n              panelColor={accessoriesColor} \n            />\n          </CollapsibleSection>\n        );\n      \n      case 'packages':\n        const packagesColor = SECTION_COLORS.addToKit;\n        const packagesContainingItem = (packages || []).filter(pkg => pkg.items && pkg.items.includes(item.id)).length;\n        return (\n          <CollapsibleSection\n            key=\"packages\"\n            title=\"Packages\"\n            icon={Package}\n            badge={packagesContainingItem}\n            badgeColor={packagesColor}\n            headerColor={packagesColor}\n            collapsed={isCollapsed('packages')}\n            onToggleCollapse={() => toggleCollapse('packages')}\n            padding={false}\n          >\n            <AddToKitSection item={item} packages={packages} onAddToPackage={onAddToPackage} panelColor={packagesColor} />\n          </CollapsibleSection>\n        );\n      \n      case 'maintenance':\n        const maintenanceColor = SECTION_COLORS.maintenance;\n        return (\n          <CollapsibleSection\n            key=\"maintenance\"\n            title=\"Maintenance\"\n            icon={Wrench}\n            badge={(item.maintenanceHistory || []).length}\n            badgeColor={maintenanceColor}\n            headerColor={maintenanceColor}\n            collapsed={isCollapsed('maintenance')}\n            onToggleCollapse={() => toggleCollapse('maintenance')}\n            padding={false}\n          >\n            <MaintenanceSection maintenanceHistory={item.maintenanceHistory || []} onAddMaintenance={onAddMaintenance} onUpdateMaintenance={onUpdateMaintenance} onCompleteMaintenance={onCompleteMaintenance} panelColor={maintenanceColor} />\n          </CollapsibleSection>\n        );\n      \n      case 'timeline':\n        return (\n          <CollapsibleSection\n            key=\"timeline\"\n            title=\"Item Timeline\"\n            icon={History}\n            headerColor={SECTION_COLORS.timeline}\n            collapsed={isCollapsed('timeline')}\n            onToggleCollapse={() => toggleCollapse('timeline')}\n            padding={false}\n          >\n            <ItemTimeline item={item} />\n          </CollapsibleSection>\n        );\n      \n      case 'checkoutHistory':\n        if (!item.checkoutHistory || item.checkoutHistory.length === 0) return null;\n        const checkoutColor = SECTION_COLORS.timeline;\n        return (\n          <CollapsibleSection\n            key=\"checkoutHistory\"\n            title=\"Checkout History\"\n            icon={Clock}\n            badge={item.checkoutHistory.length}\n            badgeColor={checkoutColor}\n            headerColor={checkoutColor}\n            collapsed={isCollapsed('checkoutHistory')}\n            onToggleCollapse={() => toggleCollapse('checkoutHistory')}\n          >\n            <div style={{ maxHeight: 220, overflowY: 'auto' }}>\n              {[...item.checkoutHistory].reverse().slice(0, 8).map((entry, idx) => (\n                <div key={entry.id || idx} style={getItemStyle(checkoutColor)}>\n                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: spacing[1] }}>\n                    <Badge text={entry.type === 'checkout' ? 'Out' : 'In'} color={entry.type === 'checkout' ? colors.checkedOut : colors.available} size=\"xs\" />\n                    <span style={{ fontSize: typography.fontSize.xs, color: colors.textMuted }}>{entry.type === 'checkout' ? entry.checkedOutDate : entry.returnDate}</span>\n                  </div>\n                  <div style={{ fontSize: typography.fontSize.sm, color: colors.textPrimary }}>\n                    {entry.type === 'checkout' ? entry.borrowerName : `Returned by ${entry.returnedBy}`}\n                  </div>\n                </div>\n              ))}\n            </div>\n          </CollapsibleSection>\n        );\n      \n      case 'value':\n        const valueColor = SECTION_COLORS.depreciation;\n        return (\n          <CollapsibleSection\n            key=\"value\"\n            title=\"Value & Purchase\"\n            icon={DollarSign}\n            badge={formatMoney(item.currentValue)}\n            badgeColor={valueColor}\n            headerColor={valueColor}\n            collapsed={isCollapsed('value')}\n            onToggleCollapse={() => toggleCollapse('value')}\n          >\n            <div style={{ display: 'flex', flexDirection: 'column', gap: spacing[2] }}>\n              <div style={getItemStyle(valueColor)}>\n                <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                  <span style={{ color: colors.textSecondary, fontSize: typography.fontSize.sm }}>Purchase Price</span>\n                  <span style={{ color: colors.textPrimary, fontSize: typography.fontSize.sm }}>{formatMoney(item.purchasePrice)}</span>\n                </div>\n              </div>\n              <div style={getItemStyle(valueColor)}>\n                <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                  <span style={{ color: colors.textSecondary, fontSize: typography.fontSize.sm }}>Current Value</span>\n                  <span style={{ color: colors.available, fontWeight: typography.fontWeight.semibold, fontSize: typography.fontSize.sm }}>{formatMoney(item.currentValue)}</span>\n                </div>\n              </div>\n              <div style={getItemStyle(valueColor)}>\n                <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                  <span style={{ color: colors.textSecondary, fontSize: typography.fontSize.sm }}>Purchase Date</span>\n                  <span style={{ color: colors.textPrimary, fontSize: typography.fontSize.sm }}>{formatDate(item.purchaseDate)}</span>\n                </div>\n              </div>\n            </div>\n          </CollapsibleSection>\n        );\n      \n      case 'depreciation':\n        return (\n          <CollapsibleSection\n            key=\"depreciation\"\n            title=\"Depreciation\"\n            headerColor={SECTION_COLORS.depreciation}\n            collapsed={isCollapsed('depreciation')}\n            onToggleCollapse={() => toggleCollapse('depreciation')}\n            padding={false}\n          >\n            <DepreciationCalculator item={item} onUpdateValue={onUpdateValue} />\n          </CollapsibleSection>\n        );\n      \n      default:\n        return null;\n    }\n  };\n\n  const leftColumnSections = sortedSections.filter((_, idx) => idx % 2 === 0);\n  const rightColumnSections = sortedSections.filter((_, idx) => idx % 2 === 1);\n\n  return (\n    <>\n      {/* Header */}\n      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: spacing[5] }}>\n        <BackButton onClick={onBack}>{backLabel}</BackButton>\n        {onCustomizeLayout && (\n          <Button variant=\"secondary\" size=\"sm\" onClick={onCustomizeLayout} icon={Layout}>\n            Customize\n          </Button>\n        )}\n      </div>\n\n      {/* Full-width Item Header Card */}\n      <Card padding={false} style={{ marginBottom: spacing[5], overflow: 'hidden' }}>\n        <div className=\"item-detail-header\" style={{ display: 'flex', minHeight: 280 }}>\n          {/* Image */}\n          <div \n            className=\"item-detail-image\" \n            onClick={onSelectImage} \n            style={{ \n              width: 320,\n              minWidth: 320,\n              background: `${withOpacity(colors.primary, 10)}`, \n              display: 'flex', \n              flexDirection: 'column', \n              alignItems: 'center', \n              justifyContent: 'center', \n              cursor: 'pointer' \n            }}\n          >\n            {item.image ? (\n              <OptimizedImage \n                src={item.image} \n                alt={item.name} \n                size=\"full\"\n                style={{ width: '100%', height: '100%' }} \n                objectFit=\"cover\"\n                lazy={false}\n              />\n            ) : (\n              <>\n                <Upload size={48} color={colors.textMuted} />\n                <span style={{ color: colors.textMuted, fontSize: typography.fontSize.sm, marginTop: spacing[2] }}>Click to add image</span>\n              </>\n            )}\n          </div>\n\n          {/* Info */}\n          <div className=\"item-detail-info\" style={{ flex: 1, padding: spacing[6], display: 'flex', flexDirection: 'column', justifyContent: 'center' }}>\n            <div style={{ display: 'flex', gap: spacing[2], marginBottom: spacing[4], flexWrap: 'wrap' }}>\n              <Badge text={item.id} color={colors.primary} />\n              <Badge text={item.status} color={getStatusColor(item.status)} />\n              <Badge text={item.condition} color={getConditionColor(item.condition)} />\n              <Badge text={item.category} color={colors.accent2} />\n            </div>\n            \n            <h1 style={{ margin: `0 0 ${spacing[2]}px`, fontSize: typography.fontSize['3xl'], color: colors.textPrimary }}>\n              {item.name}\n            </h1>\n            <p style={{ color: colors.textSecondary, margin: `0 0 ${spacing[5]}px`, fontSize: typography.fontSize.lg }}>\n              {item.brand}\n            </p>\n            \n            <div style={{ display: 'flex', gap: spacing[3], flexWrap: 'wrap' }}>\n              {canEditItems && (\n                isCheckedOut ? (\n                  <Button onClick={() => onCheckin(item.id)} icon={RefreshCw}>Check In</Button>\n                ) : (\n                  <Button onClick={() => onCheckout(item.id)} icon={CheckCircle}>Check Out</Button>\n                )\n              )}\n              {canEditItems && <Button variant=\"secondary\" onClick={() => onEdit(item)} icon={Edit}>Edit</Button>}\n              <Button variant=\"secondary\" onClick={onShowQR} icon={QrCode}>QR Code</Button>\n            </div>\n            \n            {!canEditItems && (\n              <div style={{ marginTop: spacing[4], padding: spacing[3], background: `${withOpacity(colors.primary, 10)}`, borderRadius: borderRadius.md, fontSize: typography.fontSize.sm, color: colors.primary }}>\n                You have view-only access to this item.\n              </div>\n            )}\n            \n            {isCheckedOut && item.checkedOutTo && (\n              <div style={{ marginTop: spacing[4], padding: spacing[3], background: `${withOpacity(colors.checkedOut, 15)}`, borderRadius: borderRadius.md, fontSize: typography.fontSize.sm }}>\n                <span style={{ color: colors.textMuted }}>Checked out to </span>\n                <span style={{ color: colors.textPrimary, fontWeight: typography.fontWeight.medium }}>{item.checkedOutTo}</span>\n                <span style={{ color: colors.textMuted }}> on {formatDate(item.checkedOutDate)}</span>\n                {item.dueBack && (<><span style={{ color: colors.textMuted }}>  Due </span><span style={{ color: colors.danger }}>{formatDate(item.dueBack)}</span></>)}\n              </div>\n            )}\n          </div>\n        </div>\n      </Card>\n\n      {/* Two-column layout for sections */}\n      <div className=\"responsive-two-col\" style={{ display: 'grid', gap: spacing[5] }}>\n        <div style={{ display: 'flex', flexDirection: 'column', gap: spacing[4] }}>\n          {leftColumnSections.map(sectionId => renderSection(sectionId))}\n        </div>\n        <div style={{ display: 'flex', flexDirection: 'column', gap: spacing[4] }}>\n          {rightColumnSections.map(sectionId => renderSection(sectionId))}\n        </div>\n      </div>\n    </>\n  );\n}\n\nexport default memo(ItemDetail);\n","// =============================================================================\n// MultiSelectDropdown Component\n// Dropdown with multiple checkbox selections\n// =============================================================================\n\nimport React, { useState, useRef, useEffect, useCallback, memo } from 'react';\nimport { createPortal } from 'react-dom';\nimport PropTypes from 'prop-types';\nimport { ChevronDown, Check, X } from 'lucide-react';\nimport { colors, spacing, borderRadius, typography } from '../theme.js';\n\nconst MultiSelectDropdown = memo(function MultiSelectDropdown({\n  label,\n  options = [],\n  selectedValues = [],\n  onChange,\n  placeholder = 'Select...',\n  renderOption,\n  className = '',\n  style = {},\n}) {\n  const [isOpen, setIsOpen] = useState(false);\n  const [dropdownPosition, setDropdownPosition] = useState({ top: 0, left: 0, width: 0 });\n  const containerRef = useRef(null);\n  const dropdownRef = useRef(null);\n\n  // Calculate dropdown position\n  const updateDropdownPosition = useCallback(() => {\n    if (!containerRef.current) return;\n    \n    const rect = containerRef.current.getBoundingClientRect();\n    const spaceBelow = window.innerHeight - rect.bottom;\n    const dropdownHeight = Math.min(options.length * 40 + 8, 280);\n    \n    const direction = spaceBelow < dropdownHeight ? 'up' : 'down';\n    \n    setDropdownPosition({\n      top: direction === 'down' ? rect.bottom + 4 : rect.top - dropdownHeight - 4,\n      left: rect.left,\n      width: rect.width,\n    });\n  }, [options.length]);\n\n  // Close on outside click\n  useEffect(() => {\n    if (!isOpen) return;\n    \n    const handleClickOutside = (e) => {\n      if (containerRef.current && !containerRef.current.contains(e.target)) {\n        if (dropdownRef.current && dropdownRef.current.contains(e.target)) {\n          return;\n        }\n        setIsOpen(false);\n      }\n    };\n\n    const handleEscape = (e) => {\n      if (e.key === 'Escape') {\n        setIsOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    document.addEventListener('keydown', handleEscape);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n      document.removeEventListener('keydown', handleEscape);\n    };\n  }, [isOpen]);\n\n  // Update position when open\n  useEffect(() => {\n    if (isOpen) {\n      updateDropdownPosition();\n      \n      const handleScrollOrResize = () => updateDropdownPosition();\n      window.addEventListener('scroll', handleScrollOrResize, true);\n      window.addEventListener('resize', handleScrollOrResize);\n      \n      return () => {\n        window.removeEventListener('scroll', handleScrollOrResize, true);\n        window.removeEventListener('resize', handleScrollOrResize);\n      };\n    }\n  }, [isOpen, updateDropdownPosition]);\n\n  const toggleOption = useCallback((value) => {\n    if (selectedValues.includes(value)) {\n      onChange(selectedValues.filter(v => v !== value));\n    } else {\n      onChange([...selectedValues, value]);\n    }\n  }, [selectedValues, onChange]);\n\n  const clearAll = useCallback((e) => {\n    e.stopPropagation();\n    onChange([]);\n  }, [onChange]);\n\n  const displayText = selectedValues.length === 0 \n    ? placeholder \n    : selectedValues.length === 1\n      ? options.find(o => o.value === selectedValues[0])?.label || selectedValues[0]\n      : `${selectedValues.length} selected`;\n\n  const styles = {\n    container: {\n      position: 'relative',\n      ...style,\n    },\n    trigger: {\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'space-between',\n      gap: spacing[2],\n      width: '100%',\n      padding: '12px 16px',\n      paddingRight: 40,\n      background: 'var(--input-bg, rgba(106, 154, 184, 0.1))',\n      border: `1px solid ${colors.border}`,\n      borderRadius: borderRadius.lg,\n      color: selectedValues.length > 0 ? colors.textPrimary : colors.textMuted,\n      fontSize: typography.fontSize.base,\n      fontFamily: 'system-ui, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif',\n      cursor: 'pointer',\n      textAlign: 'left',\n      position: 'relative',\n      boxSizing: 'border-box',\n      transition: 'border-color 150ms ease, box-shadow 150ms ease',\n      outline: 'none',\n    },\n    triggerOpen: {\n      borderColor: colors.primary,\n      boxShadow: `0 0 0 2px color-mix(in srgb, ${colors.primary} 20%, transparent)`,\n    },\n    triggerContent: {\n      display: 'flex',\n      alignItems: 'center',\n      gap: spacing[2],\n      flex: 1,\n      overflow: 'hidden',\n    },\n    clearButton: {\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      padding: spacing[1],\n      background: 'transparent',\n      border: 'none',\n      borderRadius: borderRadius.sm,\n      color: colors.textMuted,\n      cursor: 'pointer',\n      transition: 'color 150ms ease',\n      position: 'absolute',\n      right: 36,\n      top: '50%',\n      transform: 'translateY(-50%)',\n      zIndex: 1,\n    },\n    chevronWrapper: {\n      position: 'absolute',\n      right: 12,\n      top: '50%',\n      transform: `translateY(-50%) ${isOpen ? 'rotate(180deg)' : 'rotate(0deg)'}`,\n      transition: 'transform 150ms ease',\n      pointerEvents: 'none',\n      color: colors.textMuted,\n    },\n    dropdown: {\n      position: 'fixed',\n      top: dropdownPosition.top,\n      left: dropdownPosition.left,\n      width: dropdownPosition.width,\n      padding: 4,\n      background: colors.bgMedium,\n      border: `1px solid ${colors.border}`,\n      borderRadius: borderRadius.lg,\n      boxShadow: '0 4px 12px rgba(0, 0, 0, 0.3)',\n      maxHeight: '280px',\n      overflowY: 'auto',\n      zIndex: 99999,\n      fontFamily: 'system-ui, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif',\n    },\n    option: {\n      display: 'flex',\n      alignItems: 'center',\n      gap: spacing[2],\n      padding: `${spacing[2]}px ${spacing[3]}px`,\n      borderRadius: borderRadius.md,\n      cursor: 'pointer',\n      transition: 'background 150ms ease',\n      color: colors.textPrimary,\n      fontSize: typography.fontSize.sm,\n    },\n    checkbox: {\n      width: '18px',\n      height: '18px',\n      borderRadius: borderRadius.sm,\n      border: `2px solid ${colors.border}`,\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      flexShrink: 0,\n      transition: 'all 150ms ease',\n      background: 'transparent',\n    },\n    checkboxChecked: {\n      background: colors.primary,\n      borderColor: colors.primary,\n    },\n    label: {\n      display: 'block',\n      marginBottom: spacing[1],\n      fontSize: typography.fontSize.sm,\n      fontWeight: typography.fontWeight.medium,\n      color: colors.textSecondary,\n    },\n  };\n\n  // Render dropdown via portal to escape stacking context\n  const dropdown = isOpen && createPortal(\n    <div ref={dropdownRef} style={styles.dropdown}>\n      {options.map((option) => {\n        const isSelected = selectedValues.includes(option.value);\n        return (\n          <div\n            key={option.value}\n            onClick={() => toggleOption(option.value)}\n            style={styles.option}\n            onMouseEnter={(e) => e.currentTarget.style.background = `color-mix(in srgb, ${colors.primary} 15%, transparent)`}\n            onMouseLeave={(e) => e.currentTarget.style.background = 'transparent'}\n          >\n            <div style={{ ...styles.checkbox, ...(isSelected ? styles.checkboxChecked : {}) }}>\n              {isSelected && <Check size={12} color=\"#fff\" />}\n            </div>\n            {renderOption ? renderOption(option) : (\n              <span>{option.label}</span>\n            )}\n          </div>\n        );\n      })}\n    </div>,\n    document.body\n  );\n\n  return (\n    <div ref={containerRef} style={styles.container} className={className}>\n      {label && <label style={styles.label}>{label}</label>}\n      \n      <button\n        type=\"button\"\n        onClick={() => setIsOpen(prev => !prev)}\n        style={{ ...styles.trigger, ...(isOpen ? styles.triggerOpen : {}) }}\n      >\n        <span style={styles.triggerContent}>\n          {displayText}\n        </span>\n        {selectedValues.length > 0 && (\n          <button\n            type=\"button\"\n            style={styles.clearButton}\n            onClick={clearAll}\n            onMouseEnter={(e) => e.currentTarget.style.color = colors.danger}\n            onMouseLeave={(e) => e.currentTarget.style.color = colors.textMuted}\n            aria-label=\"Clear selection\"\n          >\n            <X size={14} />\n          </button>\n        )}\n        <span style={styles.chevronWrapper}>\n          <ChevronDown size={16} />\n        </span>\n      </button>\n\n      {dropdown}\n    </div>\n  );\n});\n\nMultiSelectDropdown.propTypes = {\n  label: PropTypes.string,\n  options: PropTypes.arrayOf(PropTypes.shape({\n    value: PropTypes.string.isRequired,\n    label: PropTypes.string.isRequired,\n  })).isRequired,\n  selectedValues: PropTypes.arrayOf(PropTypes.string),\n  onChange: PropTypes.func.isRequired,\n  placeholder: PropTypes.string,\n  renderOption: PropTypes.func,\n  className: PropTypes.string,\n  style: PropTypes.object,\n};\n\nexport { MultiSelectDropdown };\nexport default MultiSelectDropdown;\n","// ============================================================================\n// Search View Component\n// ============================================================================\n\nimport React, { memo, useMemo, useCallback } from 'react';\nimport { Search, Eye, X, Filter } from 'lucide-react';\nimport { STATUS } from '../constants.js';\nimport { colors, styles, spacing, borderRadius, typography, withOpacity} from '../theme.js';\nimport { getStatusColor } from '../utils.js';\nimport { Badge, Card, Button, SearchInput } from '../components/ui.jsx';\nimport { OptimizedImage } from '../components/OptimizedImage.jsx';\nimport { MultiSelectDropdown } from '../components/MultiSelectDropdown.jsx';\n\nconst ALL_STATUSES = Object.values(STATUS);\n\nfunction SearchView({\n  inventory,\n  categories,\n  searchQuery,\n  setSearchQuery,\n  selectedCategories,\n  setSelectedCategories,\n  selectedStatuses,\n  setSelectedStatuses,\n  onViewItem\n}) {\n  // Filter inventory\n  const filteredItems = useMemo(() => {\n    let result = inventory;\n\n    if (searchQuery.trim()) {\n      const q = searchQuery.toLowerCase();\n      result = result.filter(i =>\n        i.name.toLowerCase().includes(q) ||\n        i.brand.toLowerCase().includes(q) ||\n        i.id.toLowerCase().includes(q)\n      );\n    }\n\n    if (selectedCategories.length > 0) {\n      result = result.filter(i => selectedCategories.includes(i.category));\n    }\n\n    if (selectedStatuses.length > 0) {\n      result = result.filter(i => selectedStatuses.includes(i.status));\n    }\n\n    return result;\n  }, [inventory, searchQuery, selectedCategories, selectedStatuses]);\n\n  const clearAllFilters = useCallback(() => {\n    setSearchQuery('');\n    setSelectedCategories([]);\n    setSelectedStatuses([]);\n  }, [setSearchQuery, setSelectedCategories, setSelectedStatuses]);\n\n  const hasFilters = searchQuery.trim() || selectedCategories.length > 0 || selectedStatuses.length > 0;\n\n  // Prepare options for dropdowns\n  const categoryOptions = useMemo(() => \n    categories.map(cat => ({ value: cat, label: cat })),\n    [categories]\n  );\n\n  const statusOptions = useMemo(() => \n    ALL_STATUSES.map(status => ({ value: status, label: status })),\n    []\n  );\n\n  // Custom render for status options with badge\n  const renderStatusOption = useCallback((option) => (\n    <Badge text={option.label} color={getStatusColor(option.value)} size=\"sm\" />\n  ), []);\n\n  return (\n    <>\n      <div className=\"page-header\">\n        <h2 className=\"page-title\">Search</h2>\n      </div>\n\n      {/* Filters Bar */}\n      <Card style={{ marginBottom: spacing[4], padding: spacing[3] }}>\n        <div style={{ display: 'flex', gap: spacing[3], alignItems: 'flex-end', flexWrap: 'wrap' }}>\n          {/* Search Input */}\n          <div style={{ flex: '1 1 250px', minWidth: '200px' }}>\n            <label style={{ \n              display: 'block', \n              marginBottom: spacing[1], \n              fontSize: typography.fontSize.sm, \n              fontWeight: typography.fontWeight.medium, \n              color: colors.textSecondary \n            }}>\n              Search\n            </label>\n            <SearchInput\n              value={searchQuery}\n              onChange={setSearchQuery}\n              onClear={() => setSearchQuery('')}\n              placeholder=\"Search by name, brand, or ID...\"\n            />\n          </div>\n\n          {/* Category Filter */}\n          <div style={{ flex: '0 1 200px', minWidth: '160px' }}>\n            <MultiSelectDropdown\n              label=\"Categories\"\n              options={categoryOptions}\n              selectedValues={selectedCategories}\n              onChange={setSelectedCategories}\n              placeholder=\"All categories\"\n            />\n          </div>\n\n          {/* Status Filter */}\n          <div style={{ flex: '0 1 200px', minWidth: '160px' }}>\n            <MultiSelectDropdown\n              label=\"Status\"\n              options={statusOptions}\n              selectedValues={selectedStatuses}\n              onChange={setSelectedStatuses}\n              placeholder=\"All statuses\"\n              renderOption={renderStatusOption}\n            />\n          </div>\n\n          {/* Clear Filters */}\n          {hasFilters && (\n            <Button \n              variant=\"secondary\" \n              onClick={clearAllFilters} \n              icon={X}\n              style={{ flexShrink: 0 }}\n            >\n              Clear\n            </Button>\n          )}\n        </div>\n\n        {/* Active filter summary */}\n        {hasFilters && (\n          <div style={{ \n            marginTop: spacing[3], \n            paddingTop: spacing[3], \n            borderTop: `1px solid ${colors.borderLight}`,\n            display: 'flex',\n            alignItems: 'center',\n            gap: spacing[2],\n            flexWrap: 'wrap',\n          }}>\n            <Filter size={14} color={colors.textMuted} />\n            <span style={{ fontSize: typography.fontSize.sm, color: colors.textMuted }}>\n              Showing {filteredItems.length} of {inventory.length} items\n            </span>\n            {selectedCategories.length > 0 && (\n              <Badge text={`${selectedCategories.length} categor${selectedCategories.length > 1 ? 'ies' : 'y'}`} color={colors.accent2} size=\"sm\" />\n            )}\n            {selectedStatuses.length > 0 && (\n              <Badge text={`${selectedStatuses.length} status${selectedStatuses.length > 1 ? 'es' : ''}`} color={colors.primary} size=\"sm\" />\n            )}\n          </div>\n        )}\n      </Card>\n\n      {/* Results */}\n      <div style={{ marginBottom: spacing[3], color: colors.textMuted, fontSize: typography.fontSize.sm }}>\n        {filteredItems.length} results\n      </div>\n      \n      <div style={{ display: 'flex', flexDirection: 'column', gap: spacing[2] }}>\n        {filteredItems.map(item => (\n          <Card key={item.id} style={{ padding: spacing[3], display: 'flex', alignItems: 'center', gap: spacing[3] }}>\n            <div onClick={() => onViewItem(item.id)} style={{ flex: 1, display: 'flex', alignItems: 'center', gap: spacing[3], cursor: 'pointer' }}>\n              {item.image ? (\n                <OptimizedImage \n                  src={item.image} \n                  alt={item.name} \n                  size=\"thumbnail\"\n                  width={48} \n                  height={48} \n                  style={{ borderRadius: borderRadius.md }}\n                  objectFit=\"cover\"\n                />\n              ) : (\n                <div style={{ width: 48, height: 48, borderRadius: borderRadius.md, background: `${withOpacity(colors.primary, 10)}`, display: 'flex', alignItems: 'center', justifyContent: 'center', color: colors.textMuted, fontSize: typography.fontSize.xs }}>No img</div>\n              )}\n              <div style={{ flex: 1 }}>\n                <div style={{ display: 'flex', gap: spacing[1], marginBottom: spacing[1], flexWrap: 'wrap' }}>\n                  <Badge text={item.id} color={colors.primary} />\n                  <Badge text={item.status} color={getStatusColor(item.status)} />\n                  <Badge text={item.category} color={colors.accent2} />\n                </div>\n                <div style={{ fontWeight: typography.fontWeight.medium, color: colors.textPrimary }}>{item.name}</div>\n                <div style={{ fontSize: typography.fontSize.sm, color: colors.textMuted }}>{item.brand}</div>\n              </div>\n            </div>\n            <button onClick={() => onViewItem(item.id)} className=\"btn-secondary\" style={{ padding: spacing[2] }}>\n              <Eye size={16} />\n            </button>\n          </Card>\n        ))}\n      </div>\n      \n      {filteredItems.length === 0 && (\n        <Card style={{ textAlign: 'center', padding: spacing[10] }}>\n          <Search size={48} color={colors.textMuted} style={{ marginBottom: spacing[3], opacity: 0.5 }} />\n          <div style={{ color: colors.textMuted }}>No items found matching your filters</div>\n          {hasFilters && (\n            <Button variant=\"secondary\" onClick={clearAllFilters} style={{ marginTop: spacing[3] }}>\n              Clear Filters\n            </Button>\n          )}\n        </Card>\n      )}\n    </>\n  );\n}\n\nexport default memo(SearchView);\n","// ============================================================================\n// App View Renderer\n// Renders the active view based on currentView from NavigationContext.\n// Reads state from contexts; receives assembled handlers from App.\n// ============================================================================\n\nimport { lazy, Suspense } from 'react';\nimport { VIEWS, MODALS } from './constants.js';\nimport { error as logError } from './lib/logger.js';\nimport { useNavigationContext } from './contexts/NavigationContext.jsx';\nimport { useFilterContext } from './contexts/FilterContext.jsx';\nimport { useModalContext } from './contexts/ModalContext.jsx';\nimport { useData } from './lib/DataContext.jsx';\nimport { PermissionGate } from './contexts/PermissionsContext.jsx';\nimport { ViewLoading } from './components/Loading.jsx';\nimport { generateId } from './utils.js';\n\n// Core (eagerly loaded)\nimport Dashboard from './views/Dashboard.jsx';\nimport GearList from './views/GearList.jsx';\nimport ItemDetail from './views/ItemDetail.jsx';\nimport SearchView from './views/SearchView.jsx';\n\n// Lazy views\nconst LabelsView = lazy(() => import('./views/LabelsView.jsx'));\nconst PackagesView = lazy(() => import('./views/PackagesView.jsx'));\nconst PackListsView = lazy(() => import('./views/PackListsView.jsx'));\nconst ReservationDetail = lazy(() => import('./views/ReservationDetail.jsx'));\nconst ScheduleView = lazy(() => import('./views/ScheduleView.jsx'));\nconst NotificationSettings = lazy(() => import('./views/NotificationSettings.jsx'));\nconst LocationsManager = lazy(() => import('./views/LocationsManager.jsx'));\nconst LayoutCustomize = lazy(() => import('./views/LayoutCustomize.jsx'));\nconst ThemeSelector = lazy(() => import('./views/ThemeSelector.jsx'));\nconst ClientsView = lazy(() => import('./views/ClientsView.jsx'));\nconst RolesManager = lazy(() => import('./views/RolesManager.jsx'));\nconst ChangeLog = lazy(() => import('./views/ChangeLog.jsx'));\n\nconst AdminPanel = lazy(() => import('./views/AdminView.jsx').then(m => ({ default: m.AdminPanel })));\nconst UsersPanel = lazy(() => import('./views/UsersView.jsx').then(m => ({ default: m.UsersPanel })));\nconst ReportsPanel = lazy(() => import('./views/ReportsView.jsx').then(m => ({ default: m.ReportsPanel })));\nconst AuditLogPanel = lazy(() => import('./views/AuditLogView.jsx').then(m => ({ default: m.AuditLogPanel })));\nconst MaintenanceReportPanel = lazy(() => import('./views/MaintenanceReportView.jsx').then(m => ({ default: m.MaintenanceReportPanel })));\nconst InsuranceReportPanel = lazy(() => import('./views/InsuranceReportView.jsx').then(m => ({ default: m.InsuranceReportPanel })));\n\nconst ItemFormPage = lazy(() => import('./views/AdminPages.jsx').then(m => ({ default: m.ItemFormPage })));\nconst SpecsPage = lazy(() => import('./views/AdminPages.jsx').then(m => ({ default: m.SpecsPage })));\nconst CategoriesPage = lazy(() => import('./views/AdminPages.jsx').then(m => ({ default: m.CategoriesPage })));\n\nexport default function AppViews({ handlers, currentUser, categorySettings, changeLog }) {\n  // Read state from contexts\n  const {\n    currentView, setCurrentView,\n    selectedItem, setSelectedItem,\n    selectedPackage, setSelectedPackage,\n    selectedPackList, setSelectedPackList,\n    selectedReservation, setSelectedReservation,\n    selectedReservationItem,\n    itemBackContext, setItemBackContext,\n  } = useNavigationContext();\n\n  const {\n    searchQuery, setSearchQuery,\n    categoryFilter, setCategoryFilter,\n    statusFilter, setStatusFilter,\n    selectedCategories, setSelectedCategories,\n    selectedStatuses, setSelectedStatuses,\n    isGridView, setIsGridView,\n    scheduleView, setScheduleView,\n    scheduleMode, setScheduleMode,\n    scheduleDate, setScheduleDate,\n    selectedIds, setSelectedIds,\n  } = useFilterContext();\n\n  const {\n    editingItemId,\n    editingReservationId, setEditingReservationId,\n    itemForm, setItemForm,\n    reservationForm, setReservationForm,\n    showConfirm,\n  } = useModalContext();\n\n  const {\n    inventory, setInventory, packages, setPackages, users, setUsers,\n    roles, setRoles, specs, setSpecs, locations, setLocations,\n    categories, setCategories, auditLog, clients, setClients,\n    packLists, setPackLists,\n  } = useData();\n\n  // Destructure handlers\n  const {\n    navigateToItem, navigateToReservation,\n    navigateToFilteredSearch, navigateToAlerts, navigateToOverdue,\n    navigateToLowStock, navigateToReservations,\n    handleToggleCollapse, handleSaveLayoutPrefs,\n    createItem, deleteItem, openEditItem, handleBulkAction,\n    openCheckoutModal, openCheckinModal, openMaintenanceModal,\n    openMaintenanceEditModal,\n    itemNoteHandlers, clientNoteHandlers, reservationNoteHandlers,\n    addReminder, completeReminder, uncompleteReminder, deleteReminder,\n    openEditReservation, deleteReservation, saveReservation,\n    setItemAsKit, addItemsToKit, removeItemFromKit, clearKitItems,\n    addRequiredAccessories, removeRequiredAccessory, selectImage,\n    addItemToPackage, updateMaintenanceStatus, updateUserProfile,\n    addAuditLog, setCategorySettings, resetItemForm, resetReservationForm,\n    openModal, closeModal,\n  } = handlers;\n\n  return (\n    <div style={{ flex: 1, minHeight: 0 }}>\n      {currentView === VIEWS.DASHBOARD && (\n        <Dashboard\n          inventory={inventory}\n          categorySettings={categorySettings}\n          layoutPrefs={currentUser?.layoutPrefs?.dashboard}\n          onViewItem={navigateToItem}\n          onViewReservation={navigateToReservation}\n          onFilteredView={navigateToFilteredSearch}\n          onViewAlerts={navigateToAlerts}\n          onViewOverdue={navigateToOverdue}\n          onViewLowStock={navigateToLowStock}\n          onViewReservations={navigateToReservations}\n          onCustomizeLayout={() => setCurrentView(VIEWS.CUSTOMIZE_DASHBOARD)}\n          onToggleCollapse={handleToggleCollapse}\n        />\n      )}\n\n      {currentView === VIEWS.GEAR_LIST && (\n        <GearList\n          inventory={inventory}\n          categories={categories}\n          categorySettings={categorySettings}\n          searchQuery={searchQuery}\n          setSearchQuery={setSearchQuery}\n          categoryFilter={categoryFilter}\n          setCategoryFilter={setCategoryFilter}\n          statusFilter={statusFilter}\n          setStatusFilter={setStatusFilter}\n          isGridView={isGridView}\n          setIsGridView={setIsGridView}\n          onViewItem={navigateToItem}\n          onAddItem={() => { resetItemForm(); setCurrentView(VIEWS.ADD_ITEM); }}\n          onBulkAction={handleBulkAction}\n        />\n      )}\n\n      {currentView === VIEWS.GEAR_DETAIL && selectedItem && (\n        <ItemDetail\n          item={selectedItem}\n          inventory={inventory}\n          packages={packages}\n          specs={specs}\n          categorySettings={categorySettings}\n          layoutPrefs={currentUser?.layoutPrefs?.itemDetail}\n          onBack={() => {\n            if (itemBackContext?.returnTo === 'package' && itemBackContext.packageId) {\n              const pkg = packages.find(p => p.id === itemBackContext.packageId);\n              if (pkg) {\n                setSelectedPackage(pkg);\n                setCurrentView(VIEWS.PACKAGES);\n              }\n            } else if (itemBackContext?.returnTo === 'packList' && itemBackContext.packListId) {\n              const list = packLists.find(pl => pl.id === itemBackContext.packListId);\n              if (list) {\n                setSelectedPackList(list);\n                setCurrentView(VIEWS.PACK_LISTS);\n              }\n            } else {\n              setCurrentView(VIEWS.GEAR_LIST);\n            }\n            setItemBackContext(null);\n          }}\n          backLabel={itemBackContext?.backLabel || 'Back to Gear List'}\n          onCheckout={openCheckoutModal}\n          onCheckin={openCheckinModal}\n          onEdit={openEditItem}\n          onDelete={deleteItem}\n          onShowQR={() => openModal(MODALS.QR_CODE)}\n          onAddReservation={() => { resetReservationForm(); setEditingReservationId(null); openModal(MODALS.ADD_RESERVATION); }}\n          onDeleteReservation={deleteReservation}\n          onAddNote={itemNoteHandlers.add}\n          onReplyNote={itemNoteHandlers.reply}\n          onDeleteNote={itemNoteHandlers.delete}\n          onAddReminder={addReminder}\n          onCompleteReminder={completeReminder}\n          onUncompleteReminder={uncompleteReminder}\n          onDeleteReminder={deleteReminder}\n          onAddMaintenance={openMaintenanceModal}\n          onUpdateMaintenance={openMaintenanceEditModal}\n          onCompleteMaintenance={updateMaintenanceStatus}\n          onUpdateValue={(newValue) => {\n            setInventory(prev => prev.map(i => i.id === selectedItem.id ? { ...i, currentValue: newValue } : i));\n            setSelectedItem(prev => ({ ...prev, currentValue: newValue }));\n          }}\n          onSetAsKit={setItemAsKit}\n          onAddToKit={addItemsToKit}\n          onAddToPackage={addItemToPackage}\n          onRemoveFromKit={removeItemFromKit}\n          onClearKit={clearKitItems}\n          onAddAccessory={addRequiredAccessories}\n          onRemoveAccessory={removeRequiredAccessory}\n          onViewItem={navigateToItem}\n          onSelectImage={() => selectedItem?.image ? openModal(MODALS.IMAGE_PREVIEW) : openModal(MODALS.IMAGE_SELECT)}\n          onViewReservation={(r) => navigateToReservation(r, selectedItem)}\n          onCustomizeLayout={() => setCurrentView(VIEWS.CUSTOMIZE_ITEM_DETAIL)}\n          onToggleCollapse={handleToggleCollapse}\n          user={currentUser}\n        />\n      )}\n\n      {currentView === VIEWS.PACKAGES && (\n        <Suspense fallback={<ViewLoading message=\"Loading Packages...\" />}>\n          <PackagesView\n            packages={packages}\n            setPackages={setPackages}\n            inventory={inventory}\n            onViewItem={navigateToItem}\n            initialSelectedPackage={selectedPackage}\n            onPackageSelect={setSelectedPackage}\n          />\n        </Suspense>\n      )}\n\n      {currentView === VIEWS.PACK_LISTS && (\n        <Suspense fallback={<ViewLoading message=\"Loading Pack Lists...\" />}>\n          <PackListsView\n            packLists={packLists}\n            setPackLists={setPackLists}\n            inventory={inventory}\n            packages={packages}\n            categorySettings={categorySettings}\n            onViewItem={navigateToItem}\n            addAuditLog={addAuditLog}\n            currentUser={currentUser}\n            initialSelectedList={selectedPackList}\n            onListSelect={setSelectedPackList}\n          />\n        </Suspense>\n      )}\n\n      {currentView === VIEWS.SCHEDULE && (\n        <Suspense fallback={<ViewLoading message=\"Loading Schedule...\" />}>\n          <ScheduleView\n            inventory={inventory}\n            scheduleView={scheduleView}\n            setScheduleView={setScheduleView}\n            scheduleDate={scheduleDate}\n            setScheduleDate={setScheduleDate}\n            scheduleMode={scheduleMode}\n            setScheduleMode={setScheduleMode}\n            onViewItem={navigateToItem}\n            onViewReservation={navigateToReservation}\n            onAddReservation={() => { resetReservationForm(); setEditingReservationId(null); openModal(MODALS.ADD_RESERVATION); }}\n          />\n        </Suspense>\n      )}\n\n      {currentView === VIEWS.SEARCH && (\n        <SearchView\n          inventory={inventory}\n          categories={categories}\n          searchQuery={searchQuery}\n          setSearchQuery={setSearchQuery}\n          selectedCategories={selectedCategories}\n          setSelectedCategories={setSelectedCategories}\n          selectedStatuses={selectedStatuses}\n          setSelectedStatuses={setSelectedStatuses}\n          onViewItem={navigateToItem}\n        />\n      )}\n\n      {currentView === VIEWS.LABELS && (\n        <Suspense fallback={<ViewLoading message=\"Loading Labels...\" />}>\n          <LabelsView inventory={inventory} packages={packages} user={currentUser} />\n        </Suspense>\n      )}\n\n      {currentView === VIEWS.CLIENTS && (\n        <Suspense fallback={<ViewLoading message=\"Loading Clients...\" />}>\n          <ClientsView\n            clients={clients}\n            inventory={inventory}\n            onUpdateClients={setClients}\n            onViewReservation={navigateToReservation}\n            onAddNote={clientNoteHandlers.add}\n            onReplyNote={clientNoteHandlers.reply}\n            onDeleteNote={clientNoteHandlers.delete}\n            user={currentUser}\n            addAuditLog={addAuditLog}\n          />\n        </Suspense>\n      )}\n\n      {currentView === VIEWS.RESERVATION_DETAIL && selectedReservation && (\n        <Suspense fallback={<ViewLoading message=\"Loading Reservation...\" />}>\n          <ReservationDetail\n            reservation={selectedReservation}\n            item={selectedReservationItem}\n            onBack={() => setCurrentView(selectedItem ? VIEWS.GEAR_DETAIL : VIEWS.SCHEDULE)}\n            onEdit={() => openEditReservation(selectedReservation)}\n            onDelete={() => {\n              const itemId = selectedReservationItem?.id || selectedItem?.id || selectedReservation?.itemId;\n              const resId = selectedReservation?.id;\n              if (itemId && resId) {\n                deleteReservation(itemId, resId);\n              } else {\n                logError('Cannot delete: missing item or reservation ID', { itemId, resId });\n                alert('Unable to cancel reservation  missing reference. Please go back and try again.');\n              }\n            }}\n            onAddNote={reservationNoteHandlers.add}\n            onReplyNote={reservationNoteHandlers.reply}\n            onDeleteNote={reservationNoteHandlers.delete}\n            user={currentUser}\n            onViewItem={navigateToItem}\n          />\n        </Suspense>\n      )}\n\n      <PermissionGate permission=\"admin_users\">\n        {currentView === VIEWS.ADMIN && (\n          <Suspense fallback={<ViewLoading message=\"Loading Admin Panel...\" />}>\n            <AdminPanel setCurrentView={setCurrentView} />\n          </Suspense>\n        )}\n      </PermissionGate>\n\n      <PermissionGate permission=\"gear_list\" requireEdit>\n        {currentView === VIEWS.ADD_ITEM && (\n          <Suspense fallback={<ViewLoading message=\"Loading Item Form...\" />}>\n            <ItemFormPage\n              isEdit={false}\n              itemForm={itemForm}\n              setItemForm={setItemForm}\n              specs={specs}\n              categories={categories}\n              categorySettings={categorySettings}\n              locations={locations}\n              inventory={inventory}\n              onSave={createItem}\n              onBack={() => setCurrentView(VIEWS.GEAR_LIST)}\n            />\n          </Suspense>\n        )}\n      </PermissionGate>\n\n      <PermissionGate permission=\"admin_specs\">\n        {currentView === VIEWS.EDIT_SPECS && (\n          <Suspense fallback={<ViewLoading message=\"Loading Specs Editor...\" />}>\n            <SpecsPage\n              specs={specs}\n              onSave={(newSpecs) => setSpecs(newSpecs)}\n              onBack={() => setCurrentView(VIEWS.ADMIN)}\n            />\n          </Suspense>\n        )}\n      </PermissionGate>\n\n      <PermissionGate permission=\"admin_categories\">\n        {currentView === VIEWS.EDIT_CATEGORIES && (\n          <Suspense fallback={<ViewLoading message=\"Loading Categories...\" />}>\n            <CategoriesPage\n              categories={categories}\n              inventory={inventory}\n              specs={specs}\n              categorySettings={categorySettings}\n              onSave={(newCategories, newSpecs, newSettings) => {\n                setCategories(newCategories);\n                setSpecs(newSpecs);\n                setCategorySettings(newSettings);\n              }}\n              onBack={() => setCurrentView(VIEWS.ADMIN)}\n            />\n          </Suspense>\n        )}\n      </PermissionGate>\n\n      {currentView === VIEWS.CUSTOMIZE_DASHBOARD && (\n        <Suspense fallback={<ViewLoading message=\"Loading Layout Editor...\" />}>\n          <LayoutCustomize\n            context=\"dashboard\"\n            layoutPrefs={currentUser?.layoutPrefs}\n            onSave={handleSaveLayoutPrefs}\n            onBack={() => setCurrentView(VIEWS.DASHBOARD)}\n          />\n        </Suspense>\n      )}\n\n      {currentView === VIEWS.CUSTOMIZE_ITEM_DETAIL && (\n        <Suspense fallback={<ViewLoading message=\"Loading Layout Editor...\" />}>\n          <LayoutCustomize\n            context=\"itemDetail\"\n            layoutPrefs={currentUser?.layoutPrefs}\n            onSave={handleSaveLayoutPrefs}\n            onBack={() => setCurrentView(VIEWS.GEAR_DETAIL)}\n          />\n        </Suspense>\n      )}\n\n      {currentView === VIEWS.THEME_SELECTOR && (\n        <Suspense fallback={<ViewLoading message=\"Loading Themes...\" />}>\n          <ThemeSelector onBack={() => setCurrentView(VIEWS.DASHBOARD)} />\n        </Suspense>\n      )}\n\n      <PermissionGate permission=\"admin_users\">\n        {currentView === VIEWS.USERS && (\n          <Suspense fallback={<ViewLoading message=\"Loading Users...\" />}>\n            <UsersPanel\n              users={users}\n              currentUserId={currentUser?.id}\n              onAddUser={() => openModal(MODALS.ADD_USER)}\n              onDeleteUser={(userId) => {\n                const userToDelete = users.find(u => u.id === userId);\n                showConfirm({\n                  title: 'Delete User',\n                  message: 'Are you sure you want to delete this user? This action cannot be undone.',\n                  confirmText: 'Delete',\n                  variant: 'danger',\n                  onConfirm: () => {\n                    setUsers(prev => prev.filter(u => u.id !== userId));\n                    addAuditLog({\n                      type: 'user_deleted',\n                      description: `User deleted: ${userToDelete?.name || userId}`,\n                      user: currentUser?.name || 'Unknown',\n                      itemId: userId\n                    });\n                  }\n                });\n              }}\n              onBack={() => setCurrentView(VIEWS.ADMIN)}\n            />\n          </Suspense>\n        )}\n      </PermissionGate>\n\n      <PermissionGate permission=\"reports\">\n        {currentView === VIEWS.REPORTS && (\n          <Suspense fallback={<ViewLoading message=\"Loading Reports...\" />}>\n            <ReportsPanel\n              inventory={inventory}\n              currentUser={currentUser}\n              onExport={() => openModal(MODALS.EXPORT)}\n              onBack={() => setCurrentView(VIEWS.ADMIN)}\n            />\n          </Suspense>\n        )}\n      </PermissionGate>\n\n      <PermissionGate permission=\"admin_audit\">\n        {currentView === VIEWS.AUDIT_LOG && (\n          <Suspense fallback={<ViewLoading message=\"Loading Audit Log...\" />}>\n            <AuditLogPanel \n              auditLog={auditLog} \n              onBack={() => setCurrentView(VIEWS.ADMIN)}\n            />\n          </Suspense>\n        )}\n      </PermissionGate>\n\n      <PermissionGate permission=\"reports\">\n        {currentView === VIEWS.MAINTENANCE_REPORT && (\n          <Suspense fallback={<ViewLoading message=\"Loading Maintenance Report...\" />}>\n            <MaintenanceReportPanel\n              inventory={inventory}\n              currentUser={currentUser}\n              onViewItem={navigateToItem}\n              onBack={() => setCurrentView(VIEWS.ADMIN)}\n            />\n          </Suspense>\n        )}\n      </PermissionGate>\n\n      <PermissionGate permission=\"reports\">\n        {currentView === VIEWS.INSURANCE_REPORT && (\n          <Suspense fallback={<ViewLoading message=\"Loading Insurance Report...\" />}>\n            <InsuranceReportPanel\n              inventory={inventory}\n              categories={categories}\n              currentUser={currentUser}\n              onViewItem={navigateToItem}\n              onBack={() => setCurrentView(VIEWS.ADMIN)}\n            />\n          </Suspense>\n        )}\n      </PermissionGate>\n\n      <PermissionGate permission=\"admin_locations\">\n        {currentView === VIEWS.LOCATIONS_MANAGE && (\n          <Suspense fallback={<ViewLoading message=\"Loading Locations...\" />}>\n            <LocationsManager\n              locations={locations}\n              inventory={inventory}\n              onSave={(newLocations) => setLocations(newLocations)}\n              onClose={() => setCurrentView(VIEWS.ADMIN)}\n            />\n          </Suspense>\n        )}\n      </PermissionGate>\n\n      <PermissionGate permission=\"admin_audit\">\n        {currentView === VIEWS.CHANGE_LOG && (\n          <Suspense fallback={<ViewLoading message=\"Loading Change Log...\" />}>\n            <ChangeLog\n              changeLog={changeLog}\n              inventory={inventory}\n              packages={packages}\n              onViewItem={navigateToItem}\n              onBack={() => setCurrentView(VIEWS.ADMIN)}\n            />\n          </Suspense>\n        )}\n      </PermissionGate>\n\n      <PermissionGate permission=\"admin_roles\">\n        {currentView === VIEWS.ROLES_MANAGE && (\n          <Suspense fallback={<ViewLoading message=\"Loading Roles...\" />}>\n            <RolesManager\n              roles={roles}\n              users={users}\n              onSaveRole={(roleData) => {\n                if (roleData.id) {\n                  setRoles(prev => prev.map(r => r.id === roleData.id ? roleData : r));\n                } else {\n                  const newRole = { ...roleData, id: `role_${generateId()}` };\n                  setRoles(prev => [...prev, newRole]);\n                }\n              }}\n              onDeleteRole={(roleId) => {\n                setRoles(prev => prev.filter(r => r.id !== roleId));\n                setUsers(prev => prev.map(u => \n                  u.roleId === roleId ? { ...u, roleId: 'role_user' } : u\n                ));\n              }}\n              onAssignUsers={(roleId, userIds) => {\n                setUsers(prev => prev.map(u => \n                  userIds.includes(u.id) ? { ...u, roleId } : u\n                ));\n              }}\n              onBack={() => setCurrentView(VIEWS.ADMIN)}\n            />\n          </Suspense>\n        )}\n      </PermissionGate>\n\n      {currentView === VIEWS.NOTIFICATIONS && (\n        <Suspense fallback={<ViewLoading message=\"Loading Notifications...\" />}>\n          <NotificationSettings\n            preferences={currentUser?.notificationPreferences}\n            isAdmin={currentUser?.roleId === 'role_admin'}\n            onSave={handlers.saveNotificationPreferences}\n            onClose={() => setCurrentView(VIEWS.DASHBOARD)}\n          />\n        </Suspense>\n      )}\n    </div>\n  );\n}\n","// ============================================================================\n// App Modal Renderer\n// Renders the active modal based on activeModal from ModalContext.\n// ============================================================================\n\nimport { lazy, Suspense } from 'react';\nimport { VIEWS, MODALS } from './constants.js';\nimport { generateItemCode } from './utils.js';\nimport { useNavigationContext } from './contexts/NavigationContext.jsx';\nimport { useModalContext } from './contexts/ModalContext.jsx';\nimport { useData } from './lib/DataContext.jsx';\nimport { ModalLoading } from './components/Loading.jsx';\nimport { ConfirmDialog } from './components/ui.jsx';\n\n// Lazy-loaded modals\nconst ItemModal = lazy(() => import('./modals/ItemModal.jsx').then(m => ({ default: m.ItemModal })));\nconst ReservationModal = lazy(() => import('./modals/ReservationModal.jsx').then(m => ({ default: m.ReservationModal })));\nconst QRModal = lazy(() => import('./modals/QRModal.jsx').then(m => ({ default: m.QRModal })));\nconst ExportModal = lazy(() => import('./modals/ExportModal.jsx').then(m => ({ default: m.ExportModal })));\nconst ProfileModal = lazy(() => import('./modals/ProfileModal.jsx'));\nconst ImageSelectorModal = lazy(() => import('./modals/ImageSelectorModal.jsx').then(m => ({ default: m.ImageSelectorModal })));\nconst QRScannerModal = lazy(() => import('./modals/QRScannerModal.jsx').then(m => ({ default: m.QRScannerModal })));\nconst CSVImportModal = lazy(() => import('./modals/CSVImportModal.jsx').then(m => ({ default: m.CSVImportModal })));\nconst DatabaseExportModal = lazy(() => import('./modals/DatabaseExportModal.jsx').then(m => ({ default: m.DatabaseExportModal })));\nconst CheckOutModal = lazy(() => import('./modals/CheckOutModal.jsx').then(m => ({ default: m.CheckOutModal })));\nconst CheckInModal = lazy(() => import('./modals/CheckInModal.jsx').then(m => ({ default: m.CheckInModal })));\nconst MaintenanceModal = lazy(() => import('./modals/MaintenanceModal.jsx').then(m => ({ default: m.MaintenanceModal })));\nconst BulkStatusModal = lazy(() => import('./modals/BulkModals.jsx').then(m => ({ default: m.BulkStatusModal })));\nconst BulkLocationModal = lazy(() => import('./modals/BulkModals.jsx').then(m => ({ default: m.BulkLocationModal })));\nconst BulkCategoryModal = lazy(() => import('./modals/BulkModals.jsx').then(m => ({ default: m.BulkCategoryModal })));\nconst BulkDeleteModal = lazy(() => import('./modals/BulkModals.jsx').then(m => ({ default: m.BulkDeleteModal })));\nconst AddUserModal = lazy(() => import('./modals/AddUserModal.jsx').then(m => ({ default: m.AddUserModal })));\nconst ImagePreviewModal = lazy(() => import('./modals/ImagePreviewModal.jsx'));\n\nexport default function AppModals({ handlers, currentUser, categorySettings }) {\n  // Read state from contexts\n  const {\n    selectedItem, setSelectedItem,\n    selectedReservationItem,\n    setCurrentView,\n  } = useNavigationContext();\n\n  const {\n    activeModal,\n    editingItemId,\n    editingReservationId, setEditingReservationId,\n    itemForm, setItemForm,\n    reservationForm, setReservationForm,\n    confirmDialog,\n    handleConfirm,\n    closeConfirm,\n  } = useModalContext();\n\n  const {\n    inventory, setInventory, packages, users, setUsers,\n    specs, locations, categories, auditLog, packLists, clients,\n  } = useData();\n\n  // Destructure handlers\n  const {\n    createItem, updateItem, deleteItem,\n    saveReservation, selectImage, exportData,\n    updateUserProfile, addAuditLog,\n    openModal, closeModal,\n    // Checkout/checkin\n    checkoutItem, checkinItemData,\n    openCheckoutModal, openCheckinModal,\n    processCheckout, processCheckin,\n    // Maintenance\n    maintenanceItem, editingMaintenanceRecord, setEditingMaintenanceRecord,\n    saveMaintenance,\n    // Bulk actions\n    bulkActionIds, setBulkActionIds,\n    applyBulkStatus, applyBulkLocation, applyBulkCategory, applyBulkDelete,\n  } = handlers;\n\n  return (\n    <>\n      {/* Modals - All lazy loaded with Suspense */}\n      <Suspense fallback={<ModalLoading />}>\n        {activeModal === MODALS.ADD_ITEM && (\n          <ItemModal\n            isEdit={false}\n            itemForm={itemForm}\n            setItemForm={setItemForm}\n            specs={specs}\n            categories={categories}\n            categorySettings={categorySettings}\n            locations={locations}\n            inventory={inventory}\n            onSave={createItem}\n            onClose={closeModal}\n          />\n        )}\n\n        {activeModal === MODALS.EDIT_ITEM && (\n          <ItemModal\n            isEdit={true}\n            itemId={editingItemId}\n            itemForm={itemForm}\n            setItemForm={setItemForm}\n            specs={specs}\n            categories={categories}\n            categorySettings={categorySettings}\n            locations={locations}\n            inventory={inventory}\n            onSave={updateItem}\n            onClose={closeModal}\n            onDelete={deleteItem}\n          />\n        )}\n\n        {activeModal === MODALS.ADD_RESERVATION && (\n          <ReservationModal\n            key={editingReservationId || 'new-reservation'}\n            isEdit={!!editingReservationId}\n            reservationForm={reservationForm}\n            setReservationForm={setReservationForm}\n            onSave={saveReservation}\n            onClose={() => { closeModal(); setEditingReservationId(null); }}\n            clients={clients}\n            inventory={inventory}\n            item={editingReservationId ? (selectedItem || selectedReservationItem) : null}\n            editingReservationId={editingReservationId}\n          />\n        )}\n\n        {activeModal === MODALS.QR_CODE && selectedItem && (\n          <QRModal item={selectedItem} onClose={closeModal} />\n        )}\n\n        {activeModal === MODALS.EXPORT && (\n          <ExportModal\n            onExport={exportData}\n            onClose={closeModal}\n            user={currentUser}\n          />\n        )}\n\n        {activeModal === MODALS.PROFILE && (\n          <ProfileModal\n            user={currentUser}\n            onSave={updateUserProfile}\n            onClose={closeModal}\n          />\n        )}\n\n        {activeModal === MODALS.IMAGE_SELECT && (\n          <ImageSelectorModal\n            images={[]}\n            currentImage={selectedItem?.image}\n            itemId={selectedItem?.id}\n            onSelect={selectImage}\n            onClose={closeModal}\n          />\n        )}\n\n        {activeModal === MODALS.IMAGE_PREVIEW && selectedItem?.image && (\n          <ImagePreviewModal\n            imageSrc={selectedItem.image}\n            itemName={selectedItem.name}\n            onReplace={() => {\n              closeModal();\n              // Small delay so the first modal closes before the next opens\n              setTimeout(() => openModal(MODALS.IMAGE_SELECT), 50);\n            }}\n            onRemove={() => {\n              selectImage(null);\n              closeModal();\n            }}\n            onClose={closeModal}\n          />\n        )}\n\n        {activeModal === MODALS.QR_SCANNER && (\n          <QRScannerModal\n            inventory={inventory}\n            onItemFound={(item) => {\n              closeModal();\n              setSelectedItem(item);\n              setCurrentView(VIEWS.GEAR_DETAIL);\n            }}\n            onQuickCheckout={(item) => {\n              closeModal();\n              // Use openCheckoutModal which properly sets internal state\n              // (fixes bug: setCheckoutItem was not exposed by useCheckoutHandlers)\n              openCheckoutModal(item.id);\n            }}\n            onQuickCheckin={(item) => {\n              closeModal();\n              // Use openCheckinModal which properly sets internal state\n              openCheckinModal(item.id);\n            }}\n            onClose={closeModal}\n          />\n        )}\n\n        {activeModal === MODALS.CSV_IMPORT && (\n          <CSVImportModal\n            categories={categories}\n            specs={specs}\n            onImport={(items) => {\n              const newItems = items.map(item => ({\n                ...item,\n                id: generateItemCode(item.category, inventory.map(i => i.id)),\n                image: null,\n              }));\n              setInventory(prev => [...prev, ...newItems]);\n              addAuditLog({\n                type: 'csv_import',\n                description: `Imported ${newItems.length} items from CSV`,\n                user: currentUser?.name || 'Unknown'\n              });\n            }}\n            onClose={closeModal}\n          />\n        )}\n\n        {activeModal === MODALS.DATABASE_EXPORT && (\n          <DatabaseExportModal\n            inventory={inventory}\n            packages={packages}\n            users={users}\n            categories={categories}\n            specs={specs}\n            auditLog={auditLog}\n            packLists={packLists}\n            onClose={closeModal}\n          />\n        )}\n\n        {activeModal === MODALS.CHECK_OUT && checkoutItem && (\n          <CheckOutModal\n            item={checkoutItem}\n            users={users}\n            currentUser={currentUser}\n            onCheckOut={processCheckout}\n            onClose={closeModal}\n          />\n        )}\n\n        {activeModal === MODALS.CHECK_IN && checkinItemData && (\n          <CheckInModal\n            item={checkinItemData}\n            currentUser={currentUser}\n            onCheckIn={processCheckin}\n            onClose={closeModal}\n          />\n        )}\n\n        {activeModal === MODALS.MAINTENANCE && maintenanceItem && (\n          <MaintenanceModal\n            item={maintenanceItem}\n            editingRecord={editingMaintenanceRecord}\n            onSave={saveMaintenance}\n            onClose={() => { closeModal(); setEditingMaintenanceRecord(null); }}\n          />\n        )}\n\n        {activeModal === MODALS.ADD_USER && (\n          <AddUserModal\n            existingEmails={users.map(u => u.email.toLowerCase())}\n            onSave={(newUser) => {\n              setUsers(prev => [...prev, newUser]);\n              addAuditLog({\n                type: 'user_created',\n                description: `New user created: ${newUser.name} (${newUser.role?.name || newUser.roleId || 'User'})`,\n                user: currentUser?.name || 'Unknown',\n                itemId: newUser.id\n              });\n              closeModal();\n            }}\n            onClose={closeModal}\n          />\n        )}\n\n        {/* Bulk Action Modals */}\n        {activeModal === MODALS.BULK_STATUS && (\n          <BulkStatusModal\n            selectedIds={bulkActionIds}\n            inventory={inventory}\n            onApply={applyBulkStatus}\n            onClose={() => { closeModal(); setBulkActionIds([]); }}\n          />\n        )}\n\n        {activeModal === MODALS.BULK_LOCATION && (\n          <BulkLocationModal\n            selectedIds={bulkActionIds}\n            locations={locations}\n            onApply={applyBulkLocation}\n            onClose={() => { closeModal(); setBulkActionIds([]); }}\n          />\n        )}\n\n        {activeModal === MODALS.BULK_CATEGORY && (\n          <BulkCategoryModal\n            selectedIds={bulkActionIds}\n            categories={categories}\n            onApply={applyBulkCategory}\n            onClose={() => { closeModal(); setBulkActionIds([]); }}\n          />\n        )}\n\n        {activeModal === MODALS.BULK_DELETE && (\n          <BulkDeleteModal\n            selectedIds={bulkActionIds}\n            inventory={inventory}\n            onConfirm={applyBulkDelete}\n            onClose={() => { closeModal(); setBulkActionIds([]); }}\n          />\n        )}\n      </Suspense>\n\n      {/* Confirm Dialog */}\n      <ConfirmDialog\n        isOpen={confirmDialog.isOpen}\n        title={confirmDialog.title}\n        message={confirmDialog.message}\n        confirmText={confirmDialog.confirmText}\n        cancelText={confirmDialog.cancelText}\n        danger={confirmDialog.variant === 'danger'}\n        onConfirm={handleConfirm}\n        onCancel={closeConfirm}\n      />\n    </>\n  );\n}\n","// ============================================================================\n// SIMS Main Application Component\n// Orchestrates auth, hooks, and state  delegates rendering to sub-components.\n// ============================================================================\n\nimport { useState, useCallback, useEffect, useMemo } from 'react';\nimport { VIEWS, MODALS, STATUS, EMPTY_ITEM_FORM, EMPTY_RESERVATION_FORM, DEFAULT_SPECS, CATEGORIES as DEFAULT_CATEGORIES, DEFAULT_CATEGORY_SETTINGS, DEFAULT_LAYOUT_PREFS, DEFAULT_ROLES } from './constants.js';\nimport { colors } from './theme.js';\nimport { updateById, findById } from './utils.js';\nimport { useTheme } from './contexts/ThemeContext.jsx';\nimport { PermissionsProvider } from './contexts/PermissionsContext.jsx';\nimport { useAuth } from './lib/AuthContext.jsx';\nimport { useData } from './lib/DataContext.jsx';\nimport { FullPageLoading } from './components/Loading.jsx';\nimport { SkipLink } from './components/ui.jsx';\nimport { log, error as logError } from './lib/logger.js';\n\n// Custom hooks for state management\nimport { useInventoryActions } from './hooks/index.js';\nimport { useCheckoutHandlers, useKitHandlers, useReservationHandlers, useNoteHandlers, useReminderHandlers, usePackageHandlers } from './hooks/handlers/index.js';\n\n// Contexts\nimport { useNavigationContext } from './contexts/NavigationContext.jsx';\nimport { useFilterContext } from './contexts/FilterContext.jsx';\nimport { useModalContext } from './contexts/ModalContext.jsx';\nimport { useSidebarContext } from './contexts/SidebarContext.jsx';\n\n// Core components (always needed)\nimport Login from './views/Login.jsx';\nimport Sidebar from './components/Sidebar.jsx';\n\n// Extracted sub-components\nimport MobileHeader from './components/MobileHeader.jsx';\nimport AppViews from './AppViews.jsx';\nimport AppModals from './AppModals.jsx';\n\nexport default function App() {\n  // ============================================================================\n  // Theme\n  // ============================================================================\n  const { currentTheme } = useTheme();\n\n  // ============================================================================\n  // Auth & Data Contexts\n  // ============================================================================\n  const auth = useAuth();\n  const dataContext = useData();\n\n  const {\n    inventory, setInventory,\n    packages, setPackages,\n    setUsers,\n    roles: contextRoles,\n    specs: contextSpecs,\n    categories: contextCategories,\n    setAuditLog,\n    setClients,\n  } = dataContext;\n\n  // Apply defaults for data that may not be loaded yet\n  const roles = contextRoles?.length ? contextRoles : DEFAULT_ROLES;\n  const specs = contextSpecs && Object.keys(contextSpecs).length ? contextSpecs : DEFAULT_SPECS;\n  const categories = contextCategories?.length ? contextCategories : DEFAULT_CATEGORIES;\n\n  // Local-only state (not persisted to DB yet)\n  const [categorySettings, setCategorySettings] = useState(DEFAULT_CATEGORY_SETTINGS);\n  const [changeLog, setChangeLog] = useState([]);\n\n  // ============================================================================\n  // Auth State\n  // ============================================================================\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n  const [currentUser, setCurrentUser] = useState(null);\n  const [loginForm, setLoginForm] = useState({ email: '', password: '' });\n\n  // Sync auth state with context\n  useEffect(() => {\n    if (auth.isAuthenticated && auth.userProfile) {\n      log('[App] User authenticated:', auth.userProfile.email);\n      setIsLoggedIn(true);\n      setCurrentUser({\n        ...auth.userProfile,\n        layoutPrefs: auth.userProfile.layoutPrefs || DEFAULT_LAYOUT_PREFS,\n      });\n    } else if (!auth.loading && !auth.isAuthenticated) {\n      setIsLoggedIn(false);\n      setCurrentUser(null);\n    }\n  }, [auth.isAuthenticated, auth.userProfile, auth.loading]);\n\n  // ============================================================================\n  // Context Hooks\n  // ============================================================================\n  const { sidebarOpen, setSidebarOpen, sidebarCollapsed, setSidebarCollapsed } = useSidebarContext();\n\n  const {\n    currentView, setCurrentView,\n    selectedItem, setSelectedItem,\n    selectedPackage, setSelectedPackage,\n    setSelectedPackList,\n    selectedReservation, setSelectedReservation,\n    selectedReservationItem, setSelectedReservationItem,\n    setItemBackContext,\n  } = useNavigationContext();\n\n  const {\n    setSearchQuery,\n    setCategoryFilter,\n    setStatusFilter,\n    setScheduleDate,\n    selectedIds,\n  } = useFilterContext();\n\n  const {\n    setActiveModal,\n    editingItemId, setEditingItemId,\n    editingReservationId, setEditingReservationId,\n    itemForm, setItemForm,\n    reservationForm, setReservationForm,\n    showConfirm,\n  } = useModalContext();\n\n  // ============================================================================\n  // Auth Handlers\n  // ============================================================================\n  const handleLogin = useCallback(async (e) => {\n    e.preventDefault();\n    const { user, error } = await auth.signIn(loginForm.email, loginForm.password);\n    if (error) { logError('Login failed:', error); return; }\n    if (user) {\n      log('[App] Login successful');\n      setIsLoggedIn(true);\n      setCurrentUser({ ...user, layoutPrefs: user.layoutPrefs || DEFAULT_LAYOUT_PREFS });\n      if (dataContext.refreshData) dataContext.refreshData();\n    }\n  }, [auth, loginForm, dataContext]);\n\n  const handleLogout = useCallback(async () => {\n    await auth.signOut();\n    setIsLoggedIn(false);\n    setCurrentUser(null);\n  }, [auth]);\n\n  // ============================================================================\n  // Layout Handlers\n  // ============================================================================\n  const handleSaveLayoutPrefs = useCallback((newPrefs) => {\n    setCurrentUser(prev => ({ ...prev, layoutPrefs: newPrefs }));\n    setUsers(prev => updateById(prev, currentUser?.id, { layoutPrefs: newPrefs }));\n  }, [currentUser?.id]);\n\n  const handleToggleCollapse = useCallback((view, sectionId) => {\n    setCurrentUser(prev => {\n      if (!prev) return prev;\n      const newPrefs = structuredClone(prev.layoutPrefs || {});\n      if (!newPrefs[view]) newPrefs[view] = { sections: {} };\n      if (!newPrefs[view].sections) newPrefs[view].sections = {};\n      if (!newPrefs[view].sections[sectionId]) {\n        newPrefs[view].sections[sectionId] = { visible: true, collapsed: false, order: 0 };\n      }\n      newPrefs[view].sections[sectionId].collapsed = !newPrefs[view].sections[sectionId].collapsed;\n      return { ...prev, layoutPrefs: newPrefs };\n    });\n  }, []);\n\n  // ============================================================================\n  // Navigation Handlers\n  // ============================================================================\n  const navigateToItem = useCallback((id, context = null) => {\n    const item = findById(inventory, id);\n    if (item) {\n      setSelectedItem(item);\n      setInventory(prev => updateById(prev, id, existingItem => ({\n        ...existingItem,\n        viewCount: (existingItem.viewCount || 0) + 1\n      })));\n      setCurrentView(VIEWS.GEAR_DETAIL);\n      setActiveModal(null);\n      setItemBackContext(context);\n      window.scrollTo(0, 0);\n\n      dataContext.getItemWithDetails(id)\n        .then(itemWithDetails => {\n          if (itemWithDetails) {\n            setSelectedItem(itemWithDetails);\n            setInventory(prev => updateById(prev, id, itemWithDetails));\n          }\n        })\n        .catch(err => logError('Failed to load item details:', err));\n    }\n  }, [inventory, dataContext]);\n\n  const navigateToReservation = useCallback((reservation, item) => {\n    setSelectedReservation(reservation);\n    setSelectedReservationItem(item);\n    setCurrentView(VIEWS.RESERVATION_DETAIL);\n    window.scrollTo(0, 0);\n  }, []);\n\n  const navigateToFilteredSearch = useCallback((catFilter, statFilter) => {\n    setCategoryFilter(catFilter);\n    setStatusFilter(statFilter);\n    setSearchQuery('');\n    setCurrentView(VIEWS.GEAR_LIST);\n  }, []);\n\n  const navigateToAlerts = useCallback(() => {\n    setCategoryFilter('all');\n    setStatusFilter(STATUS.NEEDS_ATTENTION);\n    setSearchQuery('');\n    setCurrentView(VIEWS.GEAR_LIST);\n  }, []);\n\n  const navigateToOverdue = useCallback(() => {\n    setCategoryFilter('all');\n    setStatusFilter(STATUS.OVERDUE);\n    setSearchQuery('');\n    setCurrentView(VIEWS.GEAR_LIST);\n  }, []);\n\n  const navigateToLowStock = useCallback(() => {\n    setCategoryFilter('all');\n    setStatusFilter('low-stock');\n    setSearchQuery('');\n    setCurrentView(VIEWS.GEAR_LIST);\n  }, []);\n\n  const navigateToReservations = useCallback(() => {\n    setCurrentView(VIEWS.SCHEDULE);\n  }, []);\n\n  const handleNavigate = useCallback((viewId) => {\n    setActiveModal(null);\n    if (viewId === VIEWS.GEAR_LIST) {\n      setCategoryFilter('all');\n      setStatusFilter('all');\n      setSearchQuery('');\n    }\n    if (viewId === VIEWS.PACKAGES) setSelectedPackage(null);\n    if (viewId === VIEWS.PACK_LISTS) setSelectedPackList(null);\n    if (viewId === VIEWS.SCHEDULE) {\n      const today = new Date();\n      setScheduleDate(`${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`);\n    }\n    setCurrentView(viewId);\n  }, [setScheduleDate]);\n\n  // ============================================================================\n  // Form Helpers\n  // ============================================================================\n  const resetItemForm = useCallback(() => setItemForm(EMPTY_ITEM_FORM), []);\n  const resetReservationForm = useCallback(() => setReservationForm(EMPTY_RESERVATION_FORM), []);\n  const openModal = useCallback((modalId) => setActiveModal(modalId), []);\n  const closeModal = useCallback(() => setActiveModal(null), []);\n\n  // ============================================================================\n  // Inventory Actions\n  // ============================================================================\n  const inventoryActions = useInventoryActions({\n    dataContext, setInventory, setSelectedItem, setCurrentView, setAuditLog, setChangeLog, showConfirm,\n    inventory, selectedItem, currentUser, currentView, specs,\n    editingItemId, setEditingItemId, itemForm, setItemForm, resetItemForm, closeModal, openModal,\n  });\n\n  const {\n    createItem, updateItem, deleteItem,\n    bulkActionIds, setBulkActionIds, handleBulkAction,\n    applyBulkStatus, applyBulkLocation, applyBulkCategory, applyBulkDelete,\n    openEditItem, addChangeLog,\n  } = inventoryActions;\n\n  // Audit Log Helper\n  const addAuditLog = useCallback((entry) => {\n    dataContext.addAuditLog(entry);\n  }, [dataContext]);\n\n  // ============================================================================\n  // Domain Handler Hooks\n  // ============================================================================\n  const {\n    checkoutItem, checkinItemData,\n    openCheckoutModal, openCheckinModal, processCheckout, processCheckin,\n    maintenanceItem, setMaintenanceItem, editingMaintenanceRecord, setEditingMaintenanceRecord,\n    openMaintenanceModal, saveMaintenance, updateMaintenanceStatus,\n  } = useCheckoutHandlers({\n    inventory, setInventory, selectedItem, setSelectedItem,\n    dataContext, currentUser, openModal, closeModal, addAuditLog, addChangeLog,\n  });\n\n  const {\n    setItemAsKit, addItemsToKit, removeItemFromKit, clearKitItems,\n    addRequiredAccessories, removeRequiredAccessory, selectImage,\n  } = useKitHandlers({\n    inventory, setInventory, selectedItem, setSelectedItem,\n    dataContext, currentUser, closeModal, addAuditLog, addChangeLog,\n  });\n\n  const {\n    saveReservation, openEditReservation, deleteReservation,\n  } = useReservationHandlers({\n    inventory, setInventory, selectedItem, setSelectedItem,\n    dataContext, openModal, closeModal, addChangeLog, addAuditLog, currentUser,\n    reservationForm, setReservationForm,\n    editingReservationId, setEditingReservationId,\n    selectedReservationItem, selectedReservation, setSelectedReservation,\n    setCurrentView, resetReservationForm, navigateToReservation, showConfirm,\n  });\n\n  const {\n    itemNoteHandlers, reservationNoteHandlers, clientNoteHandlers,\n  } = useNoteHandlers({\n    selectedItem, setSelectedItem, setInventory,\n    selectedPackage, setSelectedPackage,\n    selectedReservation, setSelectedReservation, selectedReservationItem,\n    setPackages, setClients, setAuditLog, dataContext, currentUser,\n  });\n\n  const {\n    addReminder, completeReminder, uncompleteReminder, deleteReminder,\n  } = useReminderHandlers({\n    selectedItem, setSelectedItem, setInventory,\n    setAuditLog, dataContext, currentUser, showConfirm,\n  });\n\n  const {\n    addItemToPackage,\n  } = usePackageHandlers({\n    packages, setPackages, inventory,\n    selectedPackage, setSelectedPackage, setCurrentView,\n    categories, showConfirm, addChangeLog,\n  });\n\n  // ============================================================================\n  // Remaining Handlers\n  // ============================================================================\n  const updateUserProfile = useCallback(async (updatedUser) => {\n    setUsers(prev => updateById(prev, updatedUser.id, updatedUser));\n    if (currentUser.id === updatedUser.id) setCurrentUser(updatedUser);\n    // Persist to database\n    try {\n      const { usersService } = await import('./lib/services.js');\n      await usersService.update(updatedUser.id, { profile: updatedUser.profile });\n    } catch (err) {\n      console.error('Failed to save profile:', err);\n    }\n    // Audit log\n    addAuditLog({\n      type: 'profile_updated',\n      description: `${updatedUser.name || 'User'} updated their profile`,\n    });\n  }, [currentUser, addAuditLog]);\n\n  const exportData = useCallback((options) => {\n    const items = selectedIds.length\n      ? inventory.filter(i => selectedIds.includes(i.id))\n      : inventory;\n    if (options.format === 'csv') {\n      const headers = options.columns.join(',');\n      const rows = items.map(i =>\n        options.columns.map(col => col === 'value' ? i.currentValue : i[col] || '').join(',')\n      );\n      const csv = headers + '\\n' + rows.join('\\n');\n      const a = document.createElement('a');\n      a.href = 'data:text/csv;charset=utf-8,' + encodeURIComponent(csv);\n      a.download = 'inventory.csv';\n      a.click();\n    }\n  }, [inventory, selectedIds]);\n\n  const saveNotificationPreferences = useCallback(async (prefs) => {\n    try {\n      await dataContext.saveNotificationPreferences(currentUser.id, prefs);\n    } catch (err) {\n      logError('Failed to save notification preferences:', err);\n    }\n    setUsers(prev => updateById(prev, currentUser.id, { notificationPreferences: prefs }));\n    setCurrentUser(prev => ({ ...prev, notificationPreferences: prefs }));\n  }, [dataContext, currentUser]);\n\n  const openMaintenanceEditModal = useCallback((record) => {\n    setEditingMaintenanceRecord(record);\n    setMaintenanceItem(selectedItem);\n    openModal(MODALS.MAINTENANCE);\n  }, [selectedItem, setEditingMaintenanceRecord, setMaintenanceItem, openModal]);\n\n  const handleMobileNavigate = useCallback((view) => {\n    setSidebarOpen(false);\n    handleNavigate(view);\n  }, [handleNavigate]);\n\n  // ============================================================================\n  // Handler Objects (passed to AppViews and AppModals)\n  // ============================================================================\n  const viewHandlers = useMemo(() => ({\n    navigateToItem, navigateToReservation,\n    navigateToFilteredSearch, navigateToAlerts, navigateToOverdue,\n    navigateToLowStock, navigateToReservations,\n    handleToggleCollapse, handleSaveLayoutPrefs,\n    createItem, deleteItem, openEditItem, handleBulkAction,\n    openCheckoutModal, openCheckinModal, openMaintenanceModal,\n    openMaintenanceEditModal,\n    itemNoteHandlers, clientNoteHandlers, reservationNoteHandlers,\n    addReminder, completeReminder, uncompleteReminder, deleteReminder,\n    openEditReservation, deleteReservation, saveReservation,\n    setItemAsKit, addItemsToKit, removeItemFromKit, clearKitItems,\n    addRequiredAccessories, removeRequiredAccessory, selectImage,\n    addItemToPackage, updateMaintenanceStatus, updateUserProfile,\n    addAuditLog, setCategorySettings, resetItemForm, resetReservationForm,\n    openModal, closeModal,\n    saveNotificationPreferences,\n  }), [\n    navigateToItem, navigateToReservation,\n    navigateToFilteredSearch, navigateToAlerts, navigateToOverdue,\n    navigateToLowStock, navigateToReservations,\n    handleToggleCollapse, handleSaveLayoutPrefs,\n    createItem, deleteItem, openEditItem, handleBulkAction,\n    openCheckoutModal, openCheckinModal, openMaintenanceModal,\n    openMaintenanceEditModal,\n    itemNoteHandlers, clientNoteHandlers, reservationNoteHandlers,\n    addReminder, completeReminder, uncompleteReminder, deleteReminder,\n    openEditReservation, deleteReservation, saveReservation,\n    setItemAsKit, addItemsToKit, removeItemFromKit, clearKitItems,\n    addRequiredAccessories, removeRequiredAccessory, selectImage,\n    addItemToPackage, updateMaintenanceStatus, updateUserProfile,\n    addAuditLog, setCategorySettings, resetItemForm, resetReservationForm,\n    openModal, closeModal,\n    saveNotificationPreferences,\n  ]);\n\n  const modalHandlers = useMemo(() => ({\n    createItem, updateItem, deleteItem, saveReservation, selectImage,\n    exportData, updateUserProfile, addAuditLog, openModal, closeModal,\n    checkoutItem, checkinItemData,\n    openCheckoutModal, openCheckinModal, processCheckout, processCheckin,\n    maintenanceItem, editingMaintenanceRecord, setEditingMaintenanceRecord,\n    saveMaintenance,\n    bulkActionIds, setBulkActionIds,\n    applyBulkStatus, applyBulkLocation, applyBulkCategory, applyBulkDelete,\n  }), [\n    createItem, updateItem, deleteItem, saveReservation, selectImage,\n    exportData, updateUserProfile, addAuditLog, openModal, closeModal,\n    checkoutItem, checkinItemData,\n    openCheckoutModal, openCheckinModal, processCheckout, processCheckin,\n    maintenanceItem, editingMaintenanceRecord, setEditingMaintenanceRecord,\n    saveMaintenance,\n    bulkActionIds, setBulkActionIds,\n    applyBulkStatus, applyBulkLocation, applyBulkCategory, applyBulkDelete,\n  ]);\n\n  // ============================================================================\n  // Loading / Login\n  // ============================================================================\n  if (auth.loading || dataContext.loading) {\n    return <FullPageLoading message=\"Loading SIMS...\" />;\n  }\n\n  if (!isLoggedIn) {\n    return (\n      <div style={{\n        minHeight: '100vh',\n        backgroundColor: colors.bgDark,\n        backgroundImage: currentTheme.backgroundImage || 'none',\n        backgroundRepeat: 'repeat',\n        backgroundAttachment: 'fixed',\n        cursor: currentTheme.cursor || 'default',\n      }}>\n        <Login\n          loginForm={loginForm}\n          setLoginForm={setLoginForm}\n          onLogin={handleLogin}\n          isLoading={auth.loading}\n          error={auth.error?.message}\n        />\n      </div>\n    );\n  }\n\n  // ============================================================================\n  // Main Layout\n  // ============================================================================\n  return (\n    <PermissionsProvider currentUser={currentUser} roles={roles}>\n      <div className={`app-wrapper ${sidebarCollapsed ? 'sidebar-is-collapsed' : ''}`} style={{\n        display: 'flex',\n        minHeight: '100vh',\n        fontFamily: 'system-ui, -apple-system, sans-serif',\n        color: colors.textPrimary,\n        backgroundColor: colors.bgDark,\n        backgroundImage: currentTheme.backgroundImage || 'none',\n        backgroundRepeat: 'repeat',\n        backgroundAttachment: 'fixed',\n        cursor: currentTheme.cursor || 'default',\n      }}>\n        <SkipLink targetId=\"main-content\" />\n\n        {/* Mobile sidebar overlay */}\n        <div\n          className={`sidebar-overlay ${sidebarOpen ? 'visible' : ''}`}\n          onClick={() => setSidebarOpen(false)}\n          aria-hidden=\"true\"\n        />\n\n        <Sidebar\n          currentView={currentView}\n          setCurrentView={handleMobileNavigate}\n          user={currentUser}\n          onLogout={handleLogout}\n          onOpenProfile={() => { setSidebarOpen(false); openModal(MODALS.PROFILE); }}\n          onOpenScanner={() => { setSidebarOpen(false); openModal(MODALS.QR_SCANNER); }}\n          onOpenImport={() => { setSidebarOpen(false); openModal(MODALS.CSV_IMPORT); }}\n          onOpenExport={() => { setSidebarOpen(false); openModal(MODALS.DATABASE_EXPORT); }}\n          isOpen={sidebarOpen}\n          onClose={() => setSidebarOpen(false)}\n          collapsed={sidebarCollapsed}\n          onToggleCollapse={() => setSidebarCollapsed(!sidebarCollapsed)}\n        />\n\n        <main\n          id=\"main-content\"\n          className={`app-main ${sidebarCollapsed ? 'sidebar-collapsed' : ''}`}\n          role=\"main\"\n          tabIndex={-1}\n          style={{\n            flex: 1,\n            minHeight: '100vh',\n            boxSizing: 'border-box',\n            display: 'flex',\n            flexDirection: 'column',\n            overflow: 'auto',\n          }}\n        >\n          <MobileHeader\n            currentUser={currentUser}\n            onOpenSidebar={() => setSidebarOpen(true)}\n            onOpenModal={openModal}\n            onSetView={setCurrentView}\n            onLogout={handleLogout}\n          />\n\n          <AppViews\n            handlers={viewHandlers}\n            currentUser={currentUser}\n            categorySettings={categorySettings}\n            changeLog={changeLog}\n          />\n        </main>\n\n        <AppModals\n          handlers={modalHandlers}\n          currentUser={currentUser}\n          categorySettings={categorySettings}\n        />\n      </div>\n    </PermissionsProvider>\n  );\n}\n","// =============================================================================\n// PWA Context Provider\n// Provides PWA functionality (install prompt, offline status, service worker)\n// =============================================================================\n\nimport React, { createContext, useContext, useMemo } from 'react';\nimport { usePWA, InstallStatus } from '../hooks/usePWA.js';\n\n// Create context\nconst PWAContext = createContext(null);\n\n/**\n * PWA Provider Component\n * Wraps the app to provide PWA functionality throughout\n */\nexport function PWAProvider({ children }) {\n  const pwa = usePWA();\n  \n  // Memoize context value to prevent unnecessary re-renders\n  const contextValue = useMemo(() => pwa, [\n    pwa.isOnline,\n    pwa.installStatus,\n    pwa.swStatus,\n    pwa.updateAvailable,\n    pwa.notificationsEnabled,\n  ]);\n  \n  return (\n    <PWAContext.Provider value={contextValue}>\n      {children}\n    </PWAContext.Provider>\n  );\n}\n\n/**\n * Hook to access PWA context\n * @returns {Object} PWA state and methods\n */\nexport function usePWAContext() {\n  const context = useContext(PWAContext);\n  \n  if (!context) {\n    // Return a fallback if not in provider (for testing or SSR)\n    return {\n      isOnline: true,\n      installStatus: InstallStatus.IDLE,\n      canInstall: false,\n      isInstalled: false,\n      isStandalone: false,\n      promptInstall: () => Promise.resolve({ outcome: 'unavailable' }),\n      dismissInstall: () => {},\n      swStatus: 'idle',\n      swRegistration: null,\n      updateAvailable: false,\n      updateServiceWorker: () => {},\n      checkForUpdates: () => Promise.resolve(false),\n      clearCache: () => Promise.resolve(),\n      notificationsEnabled: false,\n      requestNotificationPermission: () => Promise.resolve(false),\n      sendNotification: () => null,\n    };\n  }\n  \n  return context;\n}\n\n// Re-export InstallStatus for convenience\nexport { InstallStatus };\n\nexport default PWAProvider;\n","// =============================================================================\n// Error Boundary Component\n// Catches JavaScript errors and displays fallback UI\n// =============================================================================\n\nimport React from 'react';\n\n// Error Boundary must be a class component\nexport class ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false, error: null, errorInfo: null };\n  }\n\n  static getDerivedStateFromError(error) {\n    // Update state so next render shows fallback UI\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    // Log error to console (could also send to error reporting service)\n    console.error('ErrorBoundary caught an error:', error, errorInfo);\n    this.setState({ errorInfo });\n    \n    // TODO: Send to error reporting service like Sentry\n    // if (typeof window !== 'undefined' && window.Sentry) {\n    //   window.Sentry.captureException(error);\n    // }\n  }\n\n  handleReset = () => {\n    this.setState({ hasError: false, error: null, errorInfo: null });\n    // Optionally reload the page\n    // window.location.reload();\n  };\n\n  render() {\n    if (this.state.hasError) {\n      // Custom fallback UI\n      if (this.props.fallback) {\n        return this.props.fallback;\n      }\n\n      return (\n        <div style={styles.container}>\n          <div style={styles.card}>\n            <div style={styles.iconContainer}>\n              <svg \n                width=\"64\" \n                height=\"64\" \n                viewBox=\"0 0 24 24\" \n                fill=\"none\" \n                stroke=\"#ef4444\" \n                strokeWidth=\"2\"\n                strokeLinecap=\"round\" \n                strokeLinejoin=\"round\"\n              >\n                <circle cx=\"12\" cy=\"12\" r=\"10\"/>\n                <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\"/>\n                <line x1=\"12\" y1=\"16\" x2=\"12.01\" y2=\"16\"/>\n              </svg>\n            </div>\n            \n            <h1 style={styles.title}>Something went wrong</h1>\n            \n            <p style={styles.message}>\n              We're sorry, but something unexpected happened. \n              Please try refreshing the page or contact support if the problem persists.\n            </p>\n\n            {process.env.NODE_ENV === 'development' && this.state.error && (\n              <details style={styles.details}>\n                <summary style={styles.summary}>Error Details (Development Only)</summary>\n                <pre style={styles.errorText}>\n                  {this.state.error.toString()}\n                  {this.state.errorInfo?.componentStack}\n                </pre>\n              </details>\n            )}\n\n            <div style={styles.actions}>\n              <button onClick={this.handleReset} style={styles.buttonSecondary}>\n                Try Again\n              </button>\n              <button onClick={() => window.location.reload()} style={styles.buttonPrimary}>\n                Reload Page\n              </button>\n            </div>\n          </div>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\n// Styles\nconst styles = {\n  container: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    minHeight: '100vh',\n    padding: '20px',\n    backgroundColor: '#1a1a2e',\n    fontFamily: 'system-ui, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif',\n  },\n  card: {\n    backgroundColor: '#16213e',\n    borderRadius: '16px',\n    padding: '40px',\n    maxWidth: '500px',\n    width: '100%',\n    textAlign: 'center',\n    boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.5)',\n  },\n  iconContainer: {\n    marginBottom: '24px',\n  },\n  title: {\n    color: '#ffffff',\n    fontSize: '24px',\n    fontWeight: '600',\n    margin: '0 0 16px 0',\n  },\n  message: {\n    color: '#94a3b8',\n    fontSize: '16px',\n    lineHeight: '1.6',\n    margin: '0 0 24px 0',\n  },\n  details: {\n    backgroundColor: '#0f172a',\n    borderRadius: '8px',\n    padding: '16px',\n    marginBottom: '24px',\n    textAlign: 'left',\n  },\n  summary: {\n    color: '#f59e0b',\n    cursor: 'pointer',\n    fontSize: '14px',\n    fontWeight: '500',\n  },\n  errorText: {\n    color: '#ef4444',\n    fontSize: '12px',\n    overflow: 'auto',\n    maxHeight: '200px',\n    marginTop: '12px',\n    whiteSpace: 'pre-wrap',\n    wordBreak: 'break-word',\n  },\n  actions: {\n    display: 'flex',\n    gap: '12px',\n    justifyContent: 'center',\n  },\n  buttonPrimary: {\n    backgroundColor: '#6366f1',\n    color: '#ffffff',\n    border: 'none',\n    borderRadius: '8px',\n    padding: '12px 24px',\n    fontSize: '14px',\n    fontWeight: '500',\n    cursor: 'pointer',\n    transition: 'background-color 0.2s',\n  },\n  buttonSecondary: {\n    backgroundColor: 'transparent',\n    color: '#94a3b8',\n    border: '1px solid #334155',\n    borderRadius: '8px',\n    padding: '12px 24px',\n    fontSize: '14px',\n    fontWeight: '500',\n    cursor: 'pointer',\n    transition: 'all 0.2s',\n  },\n};\n\n// Functional wrapper for easier use with hooks\nexport function withErrorBoundary(Component, fallback = null) {\n  return function WrappedComponent(props) {\n    return (\n      <ErrorBoundary fallback={fallback}>\n        <Component {...props} />\n      </ErrorBoundary>\n    );\n  };\n}\n\n// Section-level error boundary with simpler UI\nexport function SectionErrorBoundary({ children, name = 'This section' }) {\n  return (\n    <ErrorBoundary\n      fallback={\n        <div style={{\n          padding: '40px',\n          textAlign: 'center',\n          color: '#94a3b8',\n          backgroundColor: '#16213e',\n          borderRadius: '8px',\n          margin: '20px',\n        }}>\n          <p style={{ margin: '0 0 12px 0' }}>\n            {name} encountered an error and couldn't load.\n          </p>\n          <button\n            onClick={() => window.location.reload()}\n            style={{\n              backgroundColor: '#334155',\n              color: '#ffffff',\n              border: 'none',\n              borderRadius: '6px',\n              padding: '8px 16px',\n              fontSize: '14px',\n              cursor: 'pointer',\n            }}\n          >\n            Reload Page\n          </button>\n        </div>\n      }\n    >\n      {children}\n    </ErrorBoundary>\n  );\n}\n\nexport default ErrorBoundary;\n","import React from 'react'\nimport ReactDOM from 'react-dom/client'\nimport { SpeedInsights } from '@vercel/speed-insights/react'\nimport App from './App.jsx'\nimport { ThemeProvider } from './contexts/ThemeContext.jsx'\nimport { AuthProvider } from './lib/AuthContext.jsx'\nimport { DataProvider } from './lib/DataContext.jsx'\nimport { PWAProvider } from './lib/PWAContext.jsx'\nimport { ErrorBoundary } from './components/ErrorBoundary.jsx'\nimport { SidebarProvider } from './contexts/SidebarContext.jsx'\nimport { ModalProvider } from './contexts/ModalContext.jsx'\nimport { FilterProvider } from './contexts/FilterContext.jsx'\nimport { NavigationProviderWithData } from './contexts/NavigationContext.jsx'\nimport './index.css'\n\n// Handle stale chunk errors after deployments  force one reload to get fresh assets\nwindow.addEventListener('error', (event) => {\n  if (\n    event.message?.includes('Failed to fetch dynamically imported module') ||\n    event.message?.includes('Importing a module script failed') ||\n    event.error?.name === 'ChunkLoadError'\n  ) {\n    const reloaded = sessionStorage.getItem('chunk-reload');\n    if (!reloaded) {\n      sessionStorage.setItem('chunk-reload', '1');\n      window.location.reload();\n    }\n  }\n});\n// Clear the reload flag on successful load so future deploys can trigger it again\nsessionStorage.removeItem('chunk-reload');\n\nReactDOM.createRoot(document.getElementById('root')).render(\n  <React.StrictMode>\n    <ErrorBoundary>\n      <ThemeProvider>\n        <PWAProvider>\n          <AuthProvider>\n            <DataProvider>\n              <SidebarProvider>\n                <ModalProvider>\n                  <FilterProvider>\n                    <NavigationProviderWithData>\n                      <App />\n                      <SpeedInsights />\n                    </NavigationProviderWithData>\n                  </FilterProvider>\n                </ModalProvider>\n              </SidebarProvider>\n            </DataProvider>\n          </AuthProvider>\n        </PWAProvider>\n      </ThemeProvider>\n    </ErrorBoundary>\n  </React.StrictMode>,\n)\n"],"file":"index-TtmnPN12.js"}