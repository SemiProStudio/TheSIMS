import{q as M,j as e,a,c as i,t as d,B as k,C as w,i as _,w as p,s as W,S as C,e as O}from"./index-TtmnPN12.js";import{a as f,M as B,q as I,k as P,s as N,S as A,d as G,g as L,C as T}from"./vendor-icons-B6HpBdFH.js";import"./vendor-react-DwPMHwnM.js";const z=f.memo(function({checked:o,onChange:m,disabled:l=!1}){return e.jsx("button",{onClick:()=>!l&&m(!o),disabled:l,style:{width:44,height:24,borderRadius:12,border:"none",background:o?i.primary:i.bgLight,position:"relative",cursor:l?"not-allowed":"pointer",transition:"background 0.2s ease",opacity:l?.5:1},children:e.jsx("div",{style:{width:20,height:20,borderRadius:"50%",background:i.textPrimary,position:"absolute",top:2,left:o?22:2,transition:"left 0.2s ease",boxShadow:"0 1px 3px rgba(0,0,0,0.3)"}})})}),h=f.memo(function({icon:o,title:m,description:l,checked:g,onChange:s,disabled:n=!1,children:y}){return e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:a[3],padding:`${a[3]}px 0`,borderBottom:`1px solid ${i.borderLight}`},children:[o&&e.jsx("div",{style:{width:36,height:36,borderRadius:_.md,background:`${p(i.primary,15)}`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(o,{size:18,color:i.primary})}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:l||y?a[1]:0},children:[e.jsx("span",{style:{fontWeight:d.fontWeight.medium,color:n?i.textMuted:i.textPrimary},children:m}),e.jsx(z,{checked:g,onChange:s,disabled:n})]}),l&&e.jsx("p",{style:{margin:0,fontSize:d.fontSize.sm,color:i.textMuted,lineHeight:1.4},children:l}),y&&g&&e.jsx("div",{style:{marginTop:a[3]},children:y})]})]})}),x=f.memo(function({title:o,icon:m,children:l,defaultOpen:g=!0}){const[s,n]=f.useState(g);return e.jsxs("div",{style:{marginBottom:a[4]},children:[e.jsxs("button",{onClick:()=>n(!s),style:{display:"flex",alignItems:"center",gap:a[2],width:"100%",padding:`${a[3]}px 0`,background:"none",border:"none",cursor:"pointer",color:i.textPrimary},children:[m&&e.jsx(m,{size:18,color:i.primary}),e.jsx("span",{style:{flex:1,textAlign:"left",fontWeight:d.fontWeight.semibold,fontSize:d.fontSize.base},children:o}),s?e.jsx(L,{size:18}):e.jsx(T,{size:18})]}),s&&e.jsx("div",{style:{paddingLeft:m?26:0},children:l})]})}),E=f.memo(function({selectedDays:o,onChange:m}){const l=[{value:1,label:"1 day"},{value:2,label:"2 days"},{value:3,label:"3 days"},{value:5,label:"5 days"},{value:7,label:"1 week"}],g=s=>{o.includes(s)?m(o.filter(n=>n!==s)):m([...o,s].sort((n,y)=>n-y))};return e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:a[2]},children:l.map(s=>e.jsx("button",{onClick:()=>g(s.value),style:{padding:`${a[1]}px ${a[3]}px`,borderRadius:_.full,border:`1px solid ${o.includes(s.value)?i.primary:i.border}`,background:o.includes(s.value)?`${p(i.primary,20)}`:"transparent",color:o.includes(s.value)?i.primary:i.textSecondary,cursor:"pointer",fontSize:d.fontSize.sm,fontWeight:o.includes(s.value)?d.fontWeight.medium:d.fontWeight.normal},children:s.label},s.value))})});function D({preferences:r,onSave:o,onClose:m,isAdmin:l=!1}){const{canView:g}=M(),s=g("admin_notifications")||l,[n,y]=f.useState({email_enabled:r?.email_enabled??!0,due_date_reminders:r?.due_date_reminders??!0,due_date_reminder_days:r?.due_date_reminder_days??[1,3],overdue_notifications:r?.overdue_notifications??!0,reservation_confirmations:r?.reservation_confirmations??!0,reservation_reminders:r?.reservation_reminders??!0,reservation_reminder_days:r?.reservation_reminder_days??1,maintenance_reminders:r?.maintenance_reminders??!0,checkout_confirmations:r?.checkout_confirmations??!0,checkin_confirmations:r?.checkin_confirmations??!0,admin_low_stock_alerts:r?.admin_low_stock_alerts??!1,admin_damage_reports:r?.admin_damage_reports??!0,admin_overdue_summary:r?.admin_overdue_summary??!1,admin_overdue_summary_frequency:r?.admin_overdue_summary_frequency??"daily"}),[v,b]=f.useState(!1),[j,S]=f.useState(!1),c=f.useCallback((t,q)=>{y($=>({...$,[t]:q})),b(!0)},[]),R=async()=>{S(!0);try{await o(n),b(!1)}catch(t){O("Failed to save notification settings:",t)}finally{S(!1)}},u=!n.email_enabled;return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:a[6]},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,color:i.textPrimary},children:"Notification Settings"}),e.jsx("p",{style:{margin:`${a[1]}px 0 0`,color:i.textMuted,fontSize:d.fontSize.sm},children:"Manage how and when you receive notifications"})]}),m&&e.jsx(k,{variant:"secondary",onClick:m,children:"Close"})]}),e.jsx(w,{style:{marginBottom:a[5]},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:a[4]},children:[e.jsx("div",{style:{width:48,height:48,borderRadius:_.lg,background:n.email_enabled?`${p(i.primary,20)}`:i.bgLight,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(B,{size:24,color:n.email_enabled?i.primary:i.textMuted})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:d.fontWeight.semibold,color:i.textPrimary,marginBottom:a[1]},children:"Email Notifications"}),e.jsx("p",{style:{margin:0,fontSize:d.fontSize.sm,color:i.textMuted},children:n.email_enabled?"You will receive email notifications based on your preferences below":"All email notifications are currently disabled"})]}),e.jsx(z,{checked:n.email_enabled,onChange:t=>c("email_enabled",t)})]})}),e.jsxs(w,{padding:!1,children:[e.jsxs("div",{style:{padding:a[4]},children:[e.jsxs(x,{title:"Due Date Reminders",icon:I,defaultOpen:!0,children:[e.jsx(h,{title:"Remind me before due dates",description:"Get notified before equipment is due back",checked:n.due_date_reminders,onChange:t=>c("due_date_reminders",t),disabled:u,children:e.jsxs("div",{children:[e.jsx("label",{style:{...W.label,marginBottom:a[2]},children:"Send reminders:"}),e.jsx(E,{selectedDays:n.due_date_reminder_days,onChange:t=>c("due_date_reminder_days",t)}),e.jsx("p",{style:{margin:`${a[2]}px 0 0`,fontSize:d.fontSize.xs,color:i.textMuted},children:"before the due date"})]})}),e.jsx(h,{title:"Overdue notifications",description:"Get notified when equipment becomes overdue",checked:n.overdue_notifications,onChange:t=>c("overdue_notifications",t),disabled:u})]}),e.jsxs(x,{title:"Reservations",icon:P,defaultOpen:!0,children:[e.jsx(h,{title:"Reservation confirmations",description:"Receive confirmation when reservations are created",checked:n.reservation_confirmations,onChange:t=>c("reservation_confirmations",t),disabled:u}),e.jsx(h,{title:"Reservation reminders",description:"Get reminded before your reservations start",checked:n.reservation_reminders,onChange:t=>c("reservation_reminders",t),disabled:u,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:a[2]},children:[e.jsx("label",{style:{color:i.textSecondary,fontSize:d.fontSize.sm},children:"Remind me"}),e.jsx(C,{value:n.reservation_reminder_days,onChange:t=>c("reservation_reminder_days",parseInt(t.target.value)),options:[{value:1,label:"1 day"},{value:2,label:"2 days"},{value:3,label:"3 days"},{value:7,label:"1 week"}],style:{width:100},"aria-label":"Reminder days"}),e.jsx("label",{style:{color:i.textSecondary,fontSize:d.fontSize.sm},children:"before"})]})})]}),e.jsxs(x,{title:"Checkout & Returns",icon:N,defaultOpen:!0,children:[e.jsx(h,{title:"Checkout confirmations",description:"Receive confirmation when you check out equipment",checked:n.checkout_confirmations,onChange:t=>c("checkout_confirmations",t),disabled:u}),e.jsx(h,{title:"Return confirmations",description:"Receive confirmation when equipment is returned",checked:n.checkin_confirmations,onChange:t=>c("checkin_confirmations",t),disabled:u})]}),e.jsx(x,{title:"Maintenance",icon:A,defaultOpen:!0,children:e.jsx(h,{title:"Maintenance reminders",description:"Get notified when maintenance tasks are due",checked:n.maintenance_reminders,onChange:t=>c("maintenance_reminders",t),disabled:u})}),s&&e.jsxs(x,{title:"Admin Notifications",icon:G,defaultOpen:!1,children:[e.jsx(h,{title:"Damage reports",description:"Get notified when damage is reported during check-in",checked:n.admin_damage_reports,onChange:t=>c("admin_damage_reports",t),disabled:u}),e.jsx(h,{title:"Overdue summary",description:"Receive periodic summaries of all overdue items",checked:n.admin_overdue_summary,onChange:t=>c("admin_overdue_summary",t),disabled:u,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:a[2]},children:[e.jsx("label",{style:{color:i.textSecondary,fontSize:d.fontSize.sm},children:"Frequency:"}),e.jsx(C,{value:n.admin_overdue_summary_frequency,onChange:t=>c("admin_overdue_summary_frequency",t.target.value),options:[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"}],style:{width:100},"aria-label":"Summary frequency"})]})}),e.jsx(h,{title:"Low stock alerts",description:"Get notified when consumable items are running low",checked:n.admin_low_stock_alerts,onChange:t=>c("admin_low_stock_alerts",t),disabled:u})]})]}),e.jsxs("div",{style:{padding:a[4],borderTop:`1px solid ${i.borderLight}`,display:"flex",justifyContent:"flex-end",gap:a[3]},children:[v&&e.jsx("span",{style:{display:"flex",alignItems:"center",color:i.textMuted,fontSize:d.fontSize.sm},children:"You have unsaved changes"}),e.jsx(k,{onClick:R,disabled:!v||j,children:j?"Saving...":"Save Preferences"})]})]}),e.jsxs("div",{style:{marginTop:a[5],padding:a[4],background:`${p(i.primary,10)}`,borderRadius:_.lg,fontSize:d.fontSize.sm,color:i.textSecondary},children:[e.jsx("strong",{style:{color:i.textPrimary},children:"ðŸ’¡ Note:"})," Email notifications require your Supabase project to be configured with an email service (like Resend). Notifications are processed by Edge Functions running on a schedule."]})]})}const V=f.memo(D);export{V as default};
//# sourceMappingURL=NotificationSettings-BJh_EgPE.js.map
