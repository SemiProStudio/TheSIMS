{"version":3,"file":"NotificationSettings-BJh_EgPE.js","sources":["../../views/NotificationSettings.jsx"],"sourcesContent":["// ============================================================================\n// Notification Settings Component\n// User preferences for email notifications\n// ============================================================================\n\nimport React, { memo, useState, useCallback } from 'react';\nimport { Mail, Calendar, Clock, AlertTriangle, CheckCircle, Settings, ChevronDown, ChevronRight } from 'lucide-react';\nimport { colors, styles, spacing, borderRadius, typography, withOpacity} from '../theme.js';\nimport { Card, Button } from '../components/ui.jsx';\nimport { Select } from '../components/Select.jsx';\nimport { usePermissions } from '../contexts/PermissionsContext.jsx';\n\nimport { error as logError } from '../lib/logger.js';\n\n// Toggle switch component\nconst Toggle = memo(function Toggle({ checked, onChange, disabled = false }) {\n  return (\n    <button\n      onClick={() => !disabled && onChange(!checked)}\n      disabled={disabled}\n      style={{\n        width: 44,\n        height: 24,\n        borderRadius: 12,\n        border: 'none',\n        background: checked ? colors.primary : colors.bgLight,\n        position: 'relative',\n        cursor: disabled ? 'not-allowed' : 'pointer',\n        transition: 'background 0.2s ease',\n        opacity: disabled ? 0.5 : 1,\n      }}\n    >\n      <div\n        style={{\n          width: 20,\n          height: 20,\n          borderRadius: '50%',\n          background: colors.textPrimary,\n          position: 'absolute',\n          top: 2,\n          left: checked ? 22 : 2,\n          transition: 'left 0.2s ease',\n          boxShadow: '0 1px 3px rgba(0,0,0,0.3)',\n        }}\n      />\n    </button>\n  );\n});\n\n// Setting row component\nconst SettingRow = memo(function SettingRow({ \n  icon: Icon, \n  title, \n  description, \n  checked, \n  onChange, \n  disabled = false,\n  children \n}) {\n  return (\n    <div style={{\n      display: 'flex',\n      alignItems: 'flex-start',\n      gap: spacing[3],\n      padding: `${spacing[3]}px 0`,\n      borderBottom: `1px solid ${colors.borderLight}`,\n    }}>\n      {Icon && (\n        <div style={{\n          width: 36,\n          height: 36,\n          borderRadius: borderRadius.md,\n          background: `${withOpacity(colors.primary, 15)}`,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          flexShrink: 0,\n        }}>\n          <Icon size={18} color={colors.primary} />\n        </div>\n      )}\n      <div style={{ flex: 1 }}>\n        <div style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'space-between',\n          marginBottom: description || children ? spacing[1] : 0,\n        }}>\n          <span style={{\n            fontWeight: typography.fontWeight.medium,\n            color: disabled ? colors.textMuted : colors.textPrimary,\n          }}>\n            {title}\n          </span>\n          <Toggle checked={checked} onChange={onChange} disabled={disabled} />\n        </div>\n        {description && (\n          <p style={{\n            margin: 0,\n            fontSize: typography.fontSize.sm,\n            color: colors.textMuted,\n            lineHeight: 1.4,\n          }}>\n            {description}\n          </p>\n        )}\n        {children && checked && (\n          <div style={{ marginTop: spacing[3] }}>\n            {children}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n});\n\n// Collapsible section\nconst Section = memo(function Section({ title, icon: Icon, children, defaultOpen = true }) {\n  const [isOpen, setIsOpen] = useState(defaultOpen);\n  \n  return (\n    <div style={{ marginBottom: spacing[4] }}>\n      <button\n        onClick={() => setIsOpen(!isOpen)}\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          gap: spacing[2],\n          width: '100%',\n          padding: `${spacing[3]}px 0`,\n          background: 'none',\n          border: 'none',\n          cursor: 'pointer',\n          color: colors.textPrimary,\n        }}\n      >\n        {Icon && <Icon size={18} color={colors.primary} />}\n        <span style={{\n          flex: 1,\n          textAlign: 'left',\n          fontWeight: typography.fontWeight.semibold,\n          fontSize: typography.fontSize.base,\n        }}>\n          {title}\n        </span>\n        {isOpen ? <ChevronDown size={18} /> : <ChevronRight size={18} />}\n      </button>\n      {isOpen && (\n        <div style={{ paddingLeft: Icon ? 26 : 0 }}>\n          {children}\n        </div>\n      )}\n    </div>\n  );\n});\n\n// Multi-select chips for reminder days\nconst DaySelector = memo(function DaySelector({ selectedDays, onChange }) {\n  const options = [\n    { value: 1, label: '1 day' },\n    { value: 2, label: '2 days' },\n    { value: 3, label: '3 days' },\n    { value: 5, label: '5 days' },\n    { value: 7, label: '1 week' },\n  ];\n  \n  const toggleDay = (day) => {\n    if (selectedDays.includes(day)) {\n      onChange(selectedDays.filter(d => d !== day));\n    } else {\n      onChange([...selectedDays, day].sort((a, b) => a - b));\n    }\n  };\n  \n  return (\n    <div style={{ display: 'flex', flexWrap: 'wrap', gap: spacing[2] }}>\n      {options.map(opt => (\n        <button\n          key={opt.value}\n          onClick={() => toggleDay(opt.value)}\n          style={{\n            padding: `${spacing[1]}px ${spacing[3]}px`,\n            borderRadius: borderRadius.full,\n            border: `1px solid ${selectedDays.includes(opt.value) ? colors.primary : colors.border}`,\n            background: selectedDays.includes(opt.value) ? `${withOpacity(colors.primary, 20)}` : 'transparent',\n            color: selectedDays.includes(opt.value) ? colors.primary : colors.textSecondary,\n            cursor: 'pointer',\n            fontSize: typography.fontSize.sm,\n            fontWeight: selectedDays.includes(opt.value) ? typography.fontWeight.medium : typography.fontWeight.normal,\n          }}\n        >\n          {opt.label}\n        </button>\n      ))}\n    </div>\n  );\n});\n\n// Main component\nfunction NotificationSettings({ \n  preferences, \n  onSave, \n  onClose,\n  isAdmin: isAdminProp = false  // Keep prop for backwards compatibility but prefer permissions\n}) {\n  // Use permissions system to determine admin access\n  const { canView } = usePermissions();\n  const isAdmin = canView('admin_notifications') || isAdminProp;\n  \n  // Initialize state from preferences or defaults\n  const [settings, setSettings] = useState({\n    email_enabled: preferences?.email_enabled ?? true,\n    \n    // Due date reminders\n    due_date_reminders: preferences?.due_date_reminders ?? true,\n    due_date_reminder_days: preferences?.due_date_reminder_days ?? [1, 3],\n    overdue_notifications: preferences?.overdue_notifications ?? true,\n    \n    // Reservation notifications\n    reservation_confirmations: preferences?.reservation_confirmations ?? true,\n    reservation_reminders: preferences?.reservation_reminders ?? true,\n    reservation_reminder_days: preferences?.reservation_reminder_days ?? 1,\n    \n    // Maintenance notifications\n    maintenance_reminders: preferences?.maintenance_reminders ?? true,\n    \n    // Checkout notifications\n    checkout_confirmations: preferences?.checkout_confirmations ?? true,\n    checkin_confirmations: preferences?.checkin_confirmations ?? true,\n    \n    // Admin notifications\n    admin_low_stock_alerts: preferences?.admin_low_stock_alerts ?? false,\n    admin_damage_reports: preferences?.admin_damage_reports ?? true,\n    admin_overdue_summary: preferences?.admin_overdue_summary ?? false,\n    admin_overdue_summary_frequency: preferences?.admin_overdue_summary_frequency ?? 'daily',\n  });\n  \n  const [hasChanges, setHasChanges] = useState(false);\n  const [saving, setSaving] = useState(false);\n  \n  const updateSetting = useCallback((key, value) => {\n    setSettings(prev => ({ ...prev, [key]: value }));\n    setHasChanges(true);\n  }, []);\n  \n  const handleSave = async () => {\n    setSaving(true);\n    try {\n      await onSave(settings);\n      setHasChanges(false);\n    } catch (err) {\n      logError('Failed to save notification settings:', err);\n    } finally {\n      setSaving(false);\n    }\n  };\n  \n  const emailDisabled = !settings.email_enabled;\n  \n  return (\n    <div>\n      {/* Header */}\n      <div style={{\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'space-between',\n        marginBottom: spacing[6],\n      }}>\n        <div>\n          <h2 style={{ margin: 0, color: colors.textPrimary }}>Notification Settings</h2>\n          <p style={{ margin: `${spacing[1]}px 0 0`, color: colors.textMuted, fontSize: typography.fontSize.sm }}>\n            Manage how and when you receive notifications\n          </p>\n        </div>\n        {onClose && (\n          <Button variant=\"secondary\" onClick={onClose}>\n            Close\n          </Button>\n        )}\n      </div>\n      \n      {/* Master email toggle */}\n      <Card style={{ marginBottom: spacing[5] }}>\n        <div style={{\n          display: 'flex',\n          alignItems: 'center',\n          gap: spacing[4],\n        }}>\n          <div style={{\n            width: 48,\n            height: 48,\n            borderRadius: borderRadius.lg,\n            background: settings.email_enabled ? `${withOpacity(colors.primary, 20)}` : colors.bgLight,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n          }}>\n            <Mail size={24} color={settings.email_enabled ? colors.primary : colors.textMuted} />\n          </div>\n          <div style={{ flex: 1 }}>\n            <div style={{\n              fontWeight: typography.fontWeight.semibold,\n              color: colors.textPrimary,\n              marginBottom: spacing[1],\n            }}>\n              Email Notifications\n            </div>\n            <p style={{\n              margin: 0,\n              fontSize: typography.fontSize.sm,\n              color: colors.textMuted,\n            }}>\n              {settings.email_enabled \n                ? 'You will receive email notifications based on your preferences below'\n                : 'All email notifications are currently disabled'}\n            </p>\n          </div>\n          <Toggle \n            checked={settings.email_enabled} \n            onChange={(val) => updateSetting('email_enabled', val)} \n          />\n        </div>\n      </Card>\n      \n      {/* Notification categories */}\n      <Card padding={false}>\n        <div style={{ padding: spacing[4] }}>\n          \n          {/* Due Date Reminders */}\n          <Section title=\"Due Date Reminders\" icon={Clock} defaultOpen={true}>\n            <SettingRow\n              title=\"Remind me before due dates\"\n              description=\"Get notified before equipment is due back\"\n              checked={settings.due_date_reminders}\n              onChange={(val) => updateSetting('due_date_reminders', val)}\n              disabled={emailDisabled}\n            >\n              <div>\n                <label style={{\n                  ...styles.label,\n                  marginBottom: spacing[2],\n                }}>\n                  Send reminders:\n                </label>\n                <DaySelector \n                  selectedDays={settings.due_date_reminder_days}\n                  onChange={(days) => updateSetting('due_date_reminder_days', days)}\n                />\n                <p style={{\n                  margin: `${spacing[2]}px 0 0`,\n                  fontSize: typography.fontSize.xs,\n                  color: colors.textMuted,\n                }}>\n                  before the due date\n                </p>\n              </div>\n            </SettingRow>\n            \n            <SettingRow\n              title=\"Overdue notifications\"\n              description=\"Get notified when equipment becomes overdue\"\n              checked={settings.overdue_notifications}\n              onChange={(val) => updateSetting('overdue_notifications', val)}\n              disabled={emailDisabled}\n            />\n          </Section>\n          \n          {/* Reservations */}\n          <Section title=\"Reservations\" icon={Calendar} defaultOpen={true}>\n            <SettingRow\n              title=\"Reservation confirmations\"\n              description=\"Receive confirmation when reservations are created\"\n              checked={settings.reservation_confirmations}\n              onChange={(val) => updateSetting('reservation_confirmations', val)}\n              disabled={emailDisabled}\n            />\n            \n            <SettingRow\n              title=\"Reservation reminders\"\n              description=\"Get reminded before your reservations start\"\n              checked={settings.reservation_reminders}\n              onChange={(val) => updateSetting('reservation_reminders', val)}\n              disabled={emailDisabled}\n            >\n              <div style={{ display: 'flex', alignItems: 'center', gap: spacing[2] }}>\n                <label style={{ color: colors.textSecondary, fontSize: typography.fontSize.sm }}>\n                  Remind me\n                </label>\n                <Select\n                  value={settings.reservation_reminder_days}\n                  onChange={(e) => updateSetting('reservation_reminder_days', parseInt(e.target.value))}\n                  options={[\n                    { value: 1, label: '1 day' },\n                    { value: 2, label: '2 days' },\n                    { value: 3, label: '3 days' },\n                    { value: 7, label: '1 week' },\n                  ]}\n                  style={{ width: 100 }}\n                  aria-label=\"Reminder days\"\n                />\n                <label style={{ color: colors.textSecondary, fontSize: typography.fontSize.sm }}>\n                  before\n                </label>\n              </div>\n            </SettingRow>\n          </Section>\n          \n          {/* Checkout/Checkin */}\n          <Section title=\"Checkout & Returns\" icon={CheckCircle} defaultOpen={true}>\n            <SettingRow\n              title=\"Checkout confirmations\"\n              description=\"Receive confirmation when you check out equipment\"\n              checked={settings.checkout_confirmations}\n              onChange={(val) => updateSetting('checkout_confirmations', val)}\n              disabled={emailDisabled}\n            />\n            \n            <SettingRow\n              title=\"Return confirmations\"\n              description=\"Receive confirmation when equipment is returned\"\n              checked={settings.checkin_confirmations}\n              onChange={(val) => updateSetting('checkin_confirmations', val)}\n              disabled={emailDisabled}\n            />\n          </Section>\n          \n          {/* Maintenance */}\n          <Section title=\"Maintenance\" icon={Settings} defaultOpen={true}>\n            <SettingRow\n              title=\"Maintenance reminders\"\n              description=\"Get notified when maintenance tasks are due\"\n              checked={settings.maintenance_reminders}\n              onChange={(val) => updateSetting('maintenance_reminders', val)}\n              disabled={emailDisabled}\n            />\n          </Section>\n          \n          {/* Admin-only section */}\n          {isAdmin && (\n            <Section title=\"Admin Notifications\" icon={AlertTriangle} defaultOpen={false}>\n              <SettingRow\n                title=\"Damage reports\"\n                description=\"Get notified when damage is reported during check-in\"\n                checked={settings.admin_damage_reports}\n                onChange={(val) => updateSetting('admin_damage_reports', val)}\n                disabled={emailDisabled}\n              />\n              \n              <SettingRow\n                title=\"Overdue summary\"\n                description=\"Receive periodic summaries of all overdue items\"\n                checked={settings.admin_overdue_summary}\n                onChange={(val) => updateSetting('admin_overdue_summary', val)}\n                disabled={emailDisabled}\n              >\n                <div style={{ display: 'flex', alignItems: 'center', gap: spacing[2] }}>\n                  <label style={{ color: colors.textSecondary, fontSize: typography.fontSize.sm }}>\n                    Frequency:\n                  </label>\n                  <Select\n                    value={settings.admin_overdue_summary_frequency}\n                    onChange={(e) => updateSetting('admin_overdue_summary_frequency', e.target.value)}\n                    options={[\n                      { value: 'daily', label: 'Daily' },\n                      { value: 'weekly', label: 'Weekly' },\n                    ]}\n                    style={{ width: 100 }}\n                    aria-label=\"Summary frequency\"\n                  />\n                </div>\n              </SettingRow>\n              \n              <SettingRow\n                title=\"Low stock alerts\"\n                description=\"Get notified when consumable items are running low\"\n                checked={settings.admin_low_stock_alerts}\n                onChange={(val) => updateSetting('admin_low_stock_alerts', val)}\n                disabled={emailDisabled}\n              />\n            </Section>\n          )}\n        </div>\n        \n        {/* Save button */}\n        <div style={{\n          padding: spacing[4],\n          borderTop: `1px solid ${colors.borderLight}`,\n          display: 'flex',\n          justifyContent: 'flex-end',\n          gap: spacing[3],\n        }}>\n          {hasChanges && (\n            <span style={{\n              display: 'flex',\n              alignItems: 'center',\n              color: colors.textMuted,\n              fontSize: typography.fontSize.sm,\n            }}>\n              You have unsaved changes\n            </span>\n          )}\n          <Button \n            onClick={handleSave} \n            disabled={!hasChanges || saving}\n          >\n            {saving ? 'Saving...' : 'Save Preferences'}\n          </Button>\n        </div>\n      </Card>\n      \n      {/* Info box */}\n      <div style={{\n        marginTop: spacing[5],\n        padding: spacing[4],\n        background: `${withOpacity(colors.primary, 10)}`,\n        borderRadius: borderRadius.lg,\n        fontSize: typography.fontSize.sm,\n        color: colors.textSecondary,\n      }}>\n        <strong style={{ color: colors.textPrimary }}>ðŸ’¡ Note:</strong> Email notifications require \n        your Supabase project to be configured with an email service (like Resend). \n        Notifications are processed by Edge Functions running on a schedule.\n      </div>\n    </div>\n  );\n}\n\nexport default memo(NotificationSettings);\n"],"names":["Toggle","memo","checked","onChange","disabled","jsx","colors","SettingRow","Icon","title","description","children","jsxs","spacing","borderRadius","withOpacity","typography","Section","defaultOpen","isOpen","setIsOpen","useState","ChevronDown","ChevronRight","DaySelector","selectedDays","options","toggleDay","day","d","a","b","opt","NotificationSettings","preferences","onSave","onClose","isAdminProp","canView","usePermissions","isAdmin","settings","setSettings","hasChanges","setHasChanges","saving","setSaving","updateSetting","useCallback","key","value","prev","handleSave","err","logError","emailDisabled","Button","Card","Mail","val","Clock","styles","days","Calendar","Select","e","CheckCircle","Settings","AlertTriangle","NotificationSettings_default"],"mappings":"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"}