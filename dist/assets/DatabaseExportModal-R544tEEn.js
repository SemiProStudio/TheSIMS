import{j as e,a as r,s as x,c as a,w as j,i as U,t as D,B,J as i}from"./index-TtmnPN12.js";import{a as k,D as z}from"./vendor-icons-B6HpBdFH.js";import{M as A,a as F}from"./ModalBase-BgtxHV_N.js";import"./vendor-react-DwPMHwnM.js";const J=k.memo(function({inventory:y,packages:v,users:S,categories:L,specs:O,auditLog:C,packLists:E,onClose:b}){const[c,w]=k.useState("json"),[n,I]=k.useState({inventory:!0,packages:!0,users:!1,categories:!0,specs:!0,auditLog:!1,packLists:!0}),M=s=>{I(t=>({...t,[s]:!t[s]}))},$=()=>{const s=new Date().toISOString().split("T")[0];if(c==="json"){const t={};n.inventory&&(t.inventory=y),n.packages&&(t.packages=v),n.users&&(t.users=S.map(f=>({...f,password:void 0}))),n.categories&&(t.categories=L),n.specs&&(t.specs=O),n.auditLog&&(t.auditLog=C),n.packLists&&(t.packLists=E),t.exportedAt=new Date().toISOString(),t.version="2.0";const l=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),g=URL.createObjectURL(l),d=document.createElement("a");d.href=g,d.download=`sims-backup-${s}.json`,d.click(),URL.revokeObjectURL(g)}else{const t=["id","name","brand","category","status","condition","location","purchaseDate","purchasePrice","currentValue","serialNumber"],l=new Set;y.forEach(p=>{p.specs&&Object.keys(p.specs).forEach(m=>l.add(`spec:${m}`))});const g=[...t,...Array.from(l)],d=y.map(p=>{const m=t.map(o=>{const u=p[o];return u==null?"":String(u)});return Array.from(l).forEach(o=>{const u=o.replace("spec:","");m.push(p.specs?.[u]||"")}),m.map(o=>o.includes(",")||o.includes('"')||o.includes(`
`)?`"${o.replace(/"/g,'""')}"`:o).join(",")}),f=[g.join(","),...d].join(`
`),P=new Blob([f],{type:"text/csv;charset=utf-8"}),R=URL.createObjectURL(P),h=document.createElement("a");h.href=R,h.download=`sims-inventory-${s}.csv`,h.click(),URL.revokeObjectURL(R)}b()},N=[{key:"inventory",label:"Inventory",count:y.length},{key:"packages",label:"Kits & Packages",count:v.length},{key:"categories",label:"Categories",count:L.length},{key:"specs",label:"Specifications",count:Object.keys(O).length},{key:"packLists",label:"Pack Lists",count:E.length},{key:"users",label:"Users (no passwords)",count:S.length},{key:"auditLog",label:"Audit Log",count:C.length}];return e.jsxs(A,{onClose:b,maxWidth:500,children:[e.jsx(F,{title:"Export Database",onClose:b}),e.jsxs("div",{style:{padding:r[4]},children:[e.jsxs("div",{style:{marginBottom:r[4]},children:[e.jsx("label",{style:x.label,children:"Export Format"}),e.jsxs("div",{style:{display:"flex",gap:r[2]},children:[e.jsx("button",{onClick:()=>w("json"),style:{...x.btnSec,flex:1,justifyContent:"center",background:c==="json"?`${j(a.primary,30)}`:"transparent",borderColor:c==="json"?a.primary:a.border},children:"JSON (Full Backup)"}),e.jsx("button",{onClick:()=>w("csv"),style:{...x.btnSec,flex:1,justifyContent:"center",background:c==="csv"?`${j(a.primary,30)}`:"transparent",borderColor:c==="csv"?a.primary:a.border},children:"CSV (Inventory Only)"})]})]}),c==="json"&&e.jsxs("div",{style:{marginBottom:r[4]},children:[e.jsx("label",{style:x.label,children:"Include in Export"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:r[2]},children:N.map(s=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:r[2],cursor:"pointer",padding:r[2],borderRadius:U.md,background:n[s.key]?`${j(a.primary,10)}`:"transparent"},children:[e.jsx("input",{type:"checkbox",checked:n[s.key],onChange:()=>M(s.key),style:{accentColor:a.primary}}),e.jsx("span",{style:{flex:1,color:a.textPrimary},children:s.label}),e.jsx("span",{style:{color:a.textMuted,fontSize:D.fontSize.sm},children:s.count})]},s.key))})]}),e.jsx("p",{style:{color:a.textMuted,fontSize:D.fontSize.sm,marginBottom:r[4],padding:r[3],background:a.bgLight,borderRadius:U.md},children:c==="json"?"JSON backup includes all selected data and can be used to restore your inventory later.":"CSV export contains inventory items only, suitable for spreadsheet applications."}),e.jsxs("div",{style:{display:"flex",gap:r[3],justifyContent:"flex-end"},children:[e.jsx(B,{variant:"secondary",onClick:b,children:"Cancel"}),e.jsxs(B,{onClick:$,icon:z,children:["Export ",c.toUpperCase()]})]})]})]})});J.propTypes={inventory:i.array.isRequired,packages:i.array,users:i.array,categories:i.array,specs:i.object,auditLog:i.array,packLists:i.array,onClose:i.func.isRequired};export{J as DatabaseExportModal};
//# sourceMappingURL=DatabaseExportModal-R544tEEn.js.map
