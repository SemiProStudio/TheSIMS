import{v as E,I as F,x as G,j as r,a as n,y as U,i as v,c as i,w as x,t as C,C as V,B as j}from"./index-TtmnPN12.js";import{a as l,y as Y,G as W,E as X,z as q,H as J,t as Q}from"./vendor-icons-B6HpBdFH.js";import"./vendor-react-DwPMHwnM.js";const T={dashboard:{title:"Customize Dashboard Layout",subtitle:"Drag to reorder sections, toggle visibility. Changes are saved per user.",sections:G,prefsKey:"dashboard",backLabel:"Back to Dashboard"},itemDetail:{title:"Customize Item Detail Layout",subtitle:"Drag to reorder sections, toggle visibility. Changes are saved per user.",sections:F,prefsKey:"itemDetail",backLabel:"Back to Item"}};function Z({context:z="dashboard",layoutPrefs:w,onSave:D,onBack:y}){const s=T[z]||T.dashboard,[g,h]=l.useState(()=>{const e=w||E;return structuredClone(e)}),[O,m]=l.useState(!1),[c,S]=l.useState(null),[k,p]=l.useState(null),u=l.useRef(null),K=l.useCallback(()=>{const e=g[s.prefsKey]?.sections||{};return Object.values(s.sections).map(a=>({...a,visible:e[a.id]?.visible!==!1,collapsed:e[a.id]?.collapsed||!1,order:e[a.id]?.order??a.order})).sort((a,t)=>a.order-t.order)},[g,s])(),$=l.useCallback(e=>{h(a=>{const t=structuredClone(a);return t[s.prefsKey]||(t[s.prefsKey]={sections:{}}),t[s.prefsKey].sections||(t[s.prefsKey].sections={}),t[s.prefsKey].sections[e]||(t[s.prefsKey].sections[e]={visible:!0,collapsed:!1,order:0}),t[s.prefsKey].sections[e].visible=!t[s.prefsKey].sections[e].visible,t}),m(!0)},[s.prefsKey]),R=l.useCallback((e,a)=>{S(a),u.current=e.target,e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",a)),setTimeout(()=>{u.current&&(u.current.style.opacity="0.5")},0)},[]),P=l.useCallback(()=>{u.current&&(u.current.style.opacity="1"),S(null),p(null),u.current=null},[]),M=l.useCallback((e,a)=>{e.preventDefault(),c&&a!==c&&p(a)},[c]),A=l.useCallback(()=>{p(null)},[]),B=l.useCallback((e,a)=>{if(e.preventDefault(),!c||c===a){p(null);return}h(t=>{const d=structuredClone(t);d[s.prefsKey]||(d[s.prefsKey]={sections:{}}),d[s.prefsKey].sections||(d[s.prefsKey].sections={});const f=Object.values(s.sections).map(o=>({id:o.id,order:d[s.prefsKey].sections[o.id]?.order??o.order})).sort((o,b)=>o.order-b.order),I=f.findIndex(o=>o.id===c),L=f.findIndex(o=>o.id===a);if(I===-1||L===-1)return t;const[N]=f.splice(I,1);return f.splice(L,0,N),f.forEach((o,b)=>{d[s.prefsKey].sections[o.id]?d[s.prefsKey].sections[o.id].order=b:d[s.prefsKey].sections[o.id]={visible:!0,collapsed:!1,order:b}}),d}),p(null),m(!0)},[c,s]),_=l.useCallback(()=>{h(e=>({...e,[s.prefsKey]:structuredClone(E[s.prefsKey])})),m(!0)},[s.prefsKey]),H=l.useCallback(()=>{D(g),y()},[g,D,y]);return r.jsxs("div",{style:{maxWidth:700,margin:"0 auto",padding:n[4]},children:[r.jsx(U,{onClick:y,children:s.backLabel}),r.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:n[6]},children:r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:n[3]},children:[r.jsx("div",{style:{width:48,height:48,borderRadius:v.lg,background:`${x(i.primary,15)}`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:r.jsx(Y,{size:24,color:i.primary})}),r.jsxs("div",{children:[r.jsx("h2",{style:{margin:0,color:i.textPrimary},children:s.title}),r.jsx("p",{style:{margin:`${n[1]}px 0 0`,color:i.textMuted,fontSize:C.fontSize.sm},children:s.subtitle})]})]})}),r.jsxs(V,{children:[r.jsx("div",{style:{border:`1px solid ${i.borderLight}`,borderRadius:v.md,overflow:"hidden"},children:K.map((e,a)=>r.jsxs("div",{draggable:!0,onDragStart:t=>R(t,e.id),onDragEnd:P,onDragOver:t=>M(t,e.id),onDragLeave:A,onDrop:t=>B(t,e.id),style:{display:"flex",alignItems:"center",gap:n[2],padding:`${n[3]}px ${n[3]}px`,borderBottom:a<K.length-1?`1px solid ${i.borderLight}`:"none",background:k===e.id?`${x(i.primary,20)}`:e.visible?"transparent":`${x(i.textMuted,8)}`,transition:"background 150ms ease",cursor:"grab",userSelect:"none",borderTop:k===e.id?`2px solid ${i.primary}`:"2px solid transparent"},children:[r.jsx("div",{style:{display:"flex",alignItems:"center",color:i.textMuted,cursor:"grab"},children:r.jsx(W,{size:18})}),r.jsx("span",{style:{flex:1,color:e.visible?i.textPrimary:i.textMuted,fontSize:C.fontSize.sm,textDecoration:e.visible?"none":"line-through"},children:e.label}),r.jsx("button",{onClick:t=>{t.stopPropagation(),$(e.id)},onMouseDown:t=>t.stopPropagation(),draggable:!1,style:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,background:e.visible?`${x(i.primary,15)}`:i.bgLight,border:`1px solid ${e.visible?i.primary:i.borderLight}`,borderRadius:v.md,color:e.visible?i.primary:i.textMuted,cursor:"pointer",transition:"all 150ms ease"},title:e.visible?"Hide section":"Show section",children:e.visible?r.jsx(X,{size:16}):r.jsx(q,{size:16})})]},e.id))}),r.jsx("p",{style:{margin:`${n[4]}px 0 0`,color:i.textMuted,fontSize:C.fontSize.xs},children:"Tip: You can also click any section header to collapse/expand it inline."})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:n[6]},children:[r.jsx(j,{variant:"secondary",onClick:_,icon:J,children:"Reset to Defaults"}),r.jsxs("div",{style:{display:"flex",gap:n[2]},children:[r.jsx(j,{variant:"secondary",onClick:y,children:"Cancel"}),r.jsx(j,{onClick:H,icon:Q,children:O?"Save Changes":"Save"})]})]})]})}const ae=l.memo(Z);export{ae as default};
//# sourceMappingURL=LayoutCustomize-BItJdhTS.js.map
