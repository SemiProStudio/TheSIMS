import{j as e,P as _,C,a as s,t as l,c as t,b as A,y as D,i as j,w as g,d as E,H}from"./index-TtmnPN12.js";import{a as m,q as $,O as S,c as P,C as L,P as f,T as I,b as w,Q as M,p as O,U}from"./vendor-icons-B6HpBdFH.js";import"./vendor-react-DwPMHwnM.js";const R={created:{icon:w,color:t.success,label:"Created"},updated:{icon:f,color:t.primary,label:"Updated"},deleted:{icon:I,color:t.danger,label:"Deleted"},status_change:{icon:M,color:t.warning,label:"Status Changed"},checkout:{icon:O,color:t.checkedOut,label:"Checked Out"},checkin:{icon:M,color:t.available,label:"Checked In"},bulk_update:{icon:f,color:t.accent1,label:"Bulk Update"},bulk_delete:{icon:I,color:t.danger,label:"Bulk Delete"},reservation_added:{icon:w,color:t.reserved,label:"Reservation Added"},reservation_removed:{icon:I,color:t.textMuted,label:"Reservation Removed"},maintenance:{icon:f,color:t.warning,label:"Maintenance Updated"},value_updated:{icon:f,color:t.accent2,label:"Value Updated"}},B=n=>n==null?"-":typeof n=="boolean"?n?"Yes":"No":typeof n=="object"?JSON.stringify(n):String(n),T=m.memo(function({change:i,onViewItem:p,isExpanded:x}){const d=R[i.type]||R.updated,a=d.icon;return e.jsx("div",{style:{padding:s[3],borderBottom:`1px solid ${t.border}`,background:x?`${g(t.primary,5)}`:"transparent"},children:e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:s[3]},children:[e.jsx("div",{style:{width:36,height:36,borderRadius:j.md,background:g(d.color,15),display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(a,{size:18,style:{color:d.color}})}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:s[2],flexWrap:"wrap"},children:[e.jsx(E,{text:d.label,color:d.color,size:"sm"}),i.itemId&&e.jsxs("button",{onClick:()=>p(i.itemId,i.itemType),style:{background:"none",border:"none",padding:0,cursor:"pointer",color:t.primary,fontWeight:l.fontWeight.medium,fontSize:l.fontSize.sm,display:"flex",alignItems:"center",gap:s[1]},children:[i.itemType==="package"?e.jsx(P,{size:14}):null,i.itemId,i.itemName&&` - ${i.itemName}`]})]}),e.jsx("p",{style:{margin:`${s[1]}px 0 0`,color:t.textPrimary,fontSize:l.fontSize.sm},children:i.description}),i.changes&&i.changes.length>0&&e.jsx("div",{style:{marginTop:s[2],padding:s[2],background:t.bgDark,borderRadius:j.md,fontSize:l.fontSize.xs},children:i.changes.map((c,h)=>e.jsxs("div",{style:{display:"flex",gap:s[2],padding:`${s[1]}px 0`,borderBottom:h<i.changes.length-1?`1px solid ${t.border}`:"none"},children:[e.jsxs("span",{style:{color:t.textMuted,minWidth:100},children:[c.field,":"]}),e.jsx("span",{style:{color:t.danger,textDecoration:"line-through"},children:B(c.oldValue)}),e.jsx("span",{style:{color:t.textMuted},children:"→"}),e.jsx("span",{style:{color:t.success},children:B(c.newValue)})]},h))}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:s[3],marginTop:s[2],fontSize:l.fontSize.xs,color:t.textMuted},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:s[1]},children:[e.jsx($,{size:12}),H(i.timestamp)]}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:s[1]},children:[e.jsx(U,{size:12}),i.user||"System"]})]})]})]})})}),F=m.memo(function({item:i,changes:p,onBack:x,onViewItem:d}){if(!i)return null;const a=p.filter(c=>c.itemId===i.id);return e.jsxs("div",{children:[e.jsx(D,{onClick:x,label:"Back to Change Log"}),e.jsxs(C,{style:{marginTop:s[4]},children:[e.jsxs("div",{style:{padding:s[4],borderBottom:`1px solid ${t.border}`,display:"flex",alignItems:"center",gap:s[3]},children:[e.jsx("div",{style:{width:48,height:48,borderRadius:j.lg,background:`${g(t.primary,15)}`,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(S,{size:24,style:{color:t.primary}})}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,color:t.textPrimary},children:i.name}),e.jsxs("p",{style:{margin:`${s[1]}px 0 0`,color:t.textMuted,fontSize:l.fontSize.sm},children:[i.id," • ",a.length," change",a.length!==1?"s":""," recorded"]})]})]}),a.length>0?e.jsx("div",{children:a.map((c,h)=>e.jsx(T,{change:c,onViewItem:d},c.id||h))}):e.jsx("div",{style:{padding:s[6],textAlign:"center",color:t.textMuted},children:"No changes recorded for this item."})]})]})}),Q=m.memo(function({item:i,onClick:p,changeCount:x}){const d=i.type==="package";return e.jsxs("button",{onClick:p,className:"list-item-hover",style:{display:"flex",alignItems:"center",gap:s[3],width:"100%",padding:s[3],background:"transparent",border:"none",borderBottom:`1px solid ${t.border}`,cursor:"pointer",textAlign:"left"},children:[e.jsx("div",{style:{width:40,height:40,borderRadius:j.md,background:d?`${g(t.accent1,15)}`:`${g(t.primary,15)}`,display:"flex",alignItems:"center",justifyContent:"center"},children:d?e.jsx(P,{size:18,style:{color:t.accent1}}):e.jsx(S,{size:18,style:{color:t.primary}})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:l.fontWeight.medium,color:t.textPrimary},children:i.name}),e.jsxs("div",{style:{fontSize:l.fontSize.sm,color:t.textMuted},children:[i.id," • ",i.category||i.type]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:s[2]},children:[e.jsxs("span",{style:{fontSize:l.fontSize.sm,color:t.textMuted},children:[x," change",x!==1?"s":""]}),e.jsx(L,{size:16,style:{color:t.textMuted}})]})]})});function q({changeLog:n=[],inventory:i=[],packages:p=[],onViewItem:x,onBack:d}){const[a,c]=m.useState(""),[h,b]=m.useState(null),v=m.useMemo(()=>[...n].sort((r,o)=>new Date(o.timestamp)-new Date(r.timestamp)).slice(0,10),[n]),u=m.useMemo(()=>{const r=i.map(y=>({...y,type:"item"})),o=p.map(y=>({...y,type:"package"}));return[...r,...o]},[i,p]),N=m.useMemo(()=>{const r={};return n.forEach(o=>{o.itemId&&(r[o.itemId]=(r[o.itemId]||0)+1)}),r},[n]),k=m.useMemo(()=>{if(!a.trim())return[];const r=a.toLowerCase();return u.filter(o=>o.id?.toLowerCase().includes(r)||o.name?.toLowerCase().includes(r)||o.brand?.toLowerCase().includes(r)).slice(0,10)},[a,u]),z=m.useCallback((r,o)=>{const y=u.find(W=>W.id===r);y&&b(y)},[u]),V=m.useCallback(r=>{b(r),c("")},[]);return h?e.jsx(F,{item:h,changes:n,onBack:()=>b(null),onViewItem:z}):e.jsxs(e.Fragment,{children:[e.jsx(_,{title:"Change Log",subtitle:"Track all changes made to items, kits, and packages",onBack:d,backLabel:"Back to Admin"}),e.jsxs(C,{style:{marginBottom:s[4]},children:[e.jsxs("div",{style:{padding:s[4]},children:[e.jsx("label",{style:{display:"block",marginBottom:s[2],fontWeight:l.fontWeight.medium,color:t.textPrimary,fontSize:l.fontSize.sm},children:"Search Items, Kits & Packages"}),e.jsx("div",{style:{position:"relative"},children:e.jsx(A,{value:a,onChange:c,onClear:()=>c(""),placeholder:"Search by ID, name, or brand..."})})]}),k.length>0&&e.jsx("div",{style:{borderTop:`1px solid ${t.border}`},children:k.map(r=>e.jsx(Q,{item:r,onClick:()=>V(r),changeCount:N[r.id]||0},r.id))}),a&&k.length===0&&e.jsxs("div",{style:{padding:s[4],textAlign:"center",color:t.textMuted,borderTop:`1px solid ${t.border}`},children:['No items, kits or packages found matching "',a,'"']})]}),e.jsxs(C,{children:[e.jsxs("div",{style:{padding:s[4],borderBottom:`1px solid ${t.border}`,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:s[2]},children:[e.jsx($,{size:18,style:{color:t.primary}}),e.jsx("h3",{style:{margin:0,color:t.textPrimary,fontSize:l.fontSize.lg},children:"Recent Changes"})]}),e.jsx("span",{style:{color:t.textMuted,fontSize:l.fontSize.sm},children:"Last 10 changes"})]}),v.length>0?e.jsx("div",{children:v.map((r,o)=>e.jsx(T,{change:r,onViewItem:z},r.id||o))}):e.jsxs("div",{style:{padding:s[6],textAlign:"center",color:t.textMuted},children:[e.jsx(S,{size:48,style:{opacity:.3,marginBottom:s[3]}}),e.jsx("p",{style:{margin:0},children:"No changes recorded yet."}),e.jsx("p",{style:{margin:`${s[1]}px 0 0`,fontSize:l.fontSize.sm},children:"Changes to items, kits, and packages will appear here."})]})]})]})}const K=m.memo(q);export{K as default};
//# sourceMappingURL=ChangeLog-CQKx-PXE.js.map
