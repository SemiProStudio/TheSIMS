import{u as ee,e as T,j as e,k as V,a as l,t as p,c as i,B as M,C as z,b as te,S as H,i as E,w as _,d as $,f as se,z as le,N as ie,s as q}from"./index-TtmnPN12.js";import{a as m,I as D,b as W,x as Q,J as F,M as Y,l as G,n as ae,P as J,T as ne,m as re,k as oe,C as de,X as ce}from"./vendor-icons-B6HpBdFH.js";import"./vendor-react-DwPMHwnM.js";const X=["Individual","Company","Agency","Non-Profit","Government","Other"],xe=m.memo(function({client:s,stats:d,onSelect:g}){return e.jsx(z,{style:{cursor:"pointer",position:"relative"},onClick:()=>g(s),children:e.jsxs("div",{style:{display:"flex",gap:l[3]},children:[e.jsx("div",{style:{width:48,height:48,borderRadius:E.lg,background:`${_(i.primary,20)}`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:s.type==="Company"||s.type==="Agency"?e.jsx(Q,{size:24,color:i.primary}):e.jsx(D,{size:24,color:i.primary})}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:l[2],marginBottom:l[1]},children:[e.jsx("span",{style:{fontWeight:p.fontWeight.semibold,color:i.textPrimary,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:s.name}),s.favorite&&e.jsx(F,{size:14,color:"#f59e0b",fill:"#f59e0b"})]}),s.company&&s.type==="Individual"&&e.jsx("div",{style:{fontSize:p.fontSize.xs,color:i.textMuted,marginBottom:l[1]},children:s.company}),e.jsxs("div",{style:{display:"flex",gap:l[3],flexWrap:"wrap"},children:[s.email&&e.jsxs("span",{style:{fontSize:p.fontSize.xs,color:i.textSecondary,display:"flex",alignItems:"center",gap:4},children:[e.jsx(Y,{size:12})," ",s.email]}),s.phone&&e.jsxs("span",{style:{fontSize:p.fontSize.xs,color:i.textSecondary,display:"flex",alignItems:"center",gap:4},children:[e.jsx(G,{size:12})," ",s.phone]})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:l[1]},children:[e.jsxs($,{color:i.primary,children:[d.totalProjects," projects"]}),d.activeReservations>0&&e.jsxs($,{color:i.success,children:[d.activeReservations," active"]})]})]})})}),L=m.memo(function({client:s,onSave:d,onClose:g}){const[h,y]=m.useState({name:s?.name||"",type:s?.type||"Individual",company:s?.company||"",email:s?.email||"",phone:s?.phone||"",address:s?.address||"",notes:s?.notes||"",favorite:s?.favorite||!1}),[w,C]=m.useState(""),j=!h.name.trim(),f=!!s,S=o=>{if(o.preventDefault(),j){C("Client name is required");return}d({...s,...h,id:s?.id||`CL${Date.now()}`,createdAt:s?.createdAt||new Date().toISOString(),updatedAt:new Date().toISOString()})};return e.jsx("div",{className:"modal-backdrop",style:q.modal,onClick:g,children:e.jsxs("div",{style:q.modalBox,onClick:o=>o.stopPropagation(),children:[e.jsxs("div",{style:{padding:l[4],borderBottom:`1px solid ${i.borderLight}`,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("h3",{style:{margin:0,color:i.textPrimary},children:s?"Edit Client":"Add New Client"}),e.jsx("button",{onClick:g,style:{background:"none",border:"none",color:i.textMuted,cursor:"pointer",padding:l[1]},children:e.jsx(ce,{size:20})})]}),e.jsxs("form",{onSubmit:S,style:{padding:l[4],maxHeight:"calc(90vh - 80px)",overflowY:"auto"},children:[e.jsxs("div",{className:"form-section",children:[e.jsxs("label",{className:`form-label ${j?"label-required-empty":""}`,children:["Name ",e.jsx("span",{className:"required-indicator",children:"*"})]}),e.jsx("input",{type:"text",value:h.name,onChange:o=>{y(n=>({...n,name:o.target.value})),C("")},className:`input ${j?"input-required-empty":""}`,placeholder:"Client name",autoFocus:!0}),w&&e.jsx("span",{className:"required-error-text",children:w})]}),e.jsxs("div",{className:"form-section",children:[e.jsx("label",{className:"form-label",children:"Type"}),e.jsx(H,{value:h.type,onChange:o=>y(n=>({...n,type:o.target.value})),options:X.map(o=>({value:o,label:o})),"aria-label":"Client type"})]}),h.type==="Individual"&&e.jsxs("div",{className:"form-section",children:[e.jsx("label",{className:"form-label",children:"Company"}),e.jsx("input",{type:"text",value:h.company,onChange:o=>y(n=>({...n,company:o.target.value})),className:"input",placeholder:"Company name (optional)"})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-field",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",value:h.email,onChange:o=>y(n=>({...n,email:o.target.value})),className:"input",placeholder:"email@example.com"})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("label",{className:"form-label",children:"Phone"}),e.jsx("input",{type:"tel",value:h.phone,onChange:o=>y(n=>({...n,phone:o.target.value})),className:"input",placeholder:"555-123-4567"})]})]}),e.jsxs("div",{className:"form-section",children:[e.jsx("label",{className:"form-label",children:"Address"}),e.jsx("input",{type:"text",value:h.address,onChange:o=>y(n=>({...n,address:o.target.value})),className:"input",placeholder:"Street address, city, state"})]}),e.jsxs("div",{className:"form-section",children:[e.jsx("label",{className:"form-label",children:"Notes"}),e.jsx("textarea",{value:h.notes,onChange:o=>y(n=>({...n,notes:o.target.value})),className:"input",style:{minHeight:80,resize:"vertical"},placeholder:"Additional notes about this client"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:l[2],color:i.textSecondary,fontSize:p.fontSize.sm,cursor:"pointer",marginBottom:l[4]},children:[e.jsx("input",{type:"checkbox",checked:h.favorite,onChange:o=>y(n=>({...n,favorite:o.target.checked}))}),e.jsx(F,{size:14})," Mark as favorite"]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:l[2]},children:[e.jsx(M,{type:"button",variant:"secondary",onClick:g,children:"Cancel"}),e.jsx(M,{type:"submit",icon:f?J:W,children:f?"Save Changes":"Add Client"})]})]})]})})}),me=m.memo(function({client:s,projects:d,onBack:g,onEdit:h,onDelete:y,onViewReservation:w,onAddNote:C,onReplyNote:j,onDeleteNote:f,user:S}){const[o,n]=m.useState(!1),u=m.useMemo(()=>({totalProjects:d.length,activeProjects:d.filter(c=>new Date(c.end)>=new Date).length,totalValue:d.reduce((c,k)=>c+(k.value||0),0),lastProject:d.length>0?d.sort((c,k)=>new Date(k.start)-new Date(c.start))[0]:null}),[d]),N=s.clientNotes||[];return e.jsxs("div",{children:[e.jsx("button",{onClick:g,style:{display:"flex",alignItems:"center",gap:l[2],background:"transparent",border:"none",color:i.textMuted,cursor:"pointer",marginBottom:l[3],fontSize:p.fontSize.sm},children:"← Back to Clients"}),e.jsx(z,{style:{marginBottom:l[4]},children:e.jsxs("div",{style:{display:"flex",gap:l[4],alignItems:"flex-start"},children:[e.jsx("div",{style:{width:64,height:64,borderRadius:E.xl,background:`${_(i.primary,20)}`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:s.type==="Company"||s.type==="Agency"?e.jsx(Q,{size:32,color:i.primary}):e.jsx(D,{size:32,color:i.primary})}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:l[2],marginBottom:l[2]},children:[e.jsx("h2",{style:{margin:0,color:i.textPrimary},children:s.name}),s.favorite&&e.jsx(F,{size:18,color:"#f59e0b",fill:"#f59e0b"}),e.jsx($,{children:s.type})]}),e.jsxs("div",{style:{display:"flex",gap:l[4],flexWrap:"wrap",color:i.textSecondary,fontSize:p.fontSize.sm},children:[s.email&&e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(Y,{size:14})," ",s.email]}),s.phone&&e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(G,{size:14})," ",s.phone]}),s.address&&e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(ae,{size:14})," ",s.address]})]}),s.notes&&e.jsx("p",{style:{margin:`${l[3]}px 0 0`,color:i.textMuted,fontSize:p.fontSize.sm},children:s.notes})]}),e.jsxs("div",{style:{display:"flex",gap:l[2],alignItems:"center"},children:[e.jsx(M,{variant:"secondary",onClick:()=>h(s),icon:J,children:"Edit"}),e.jsx("button",{className:"btn-icon danger",onClick:()=>y(s),children:e.jsx(ne,{size:16})})]})]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:l[3],marginBottom:l[4]},children:[e.jsxs(z,{style:{textAlign:"center",padding:l[4]},children:[e.jsx("div",{style:{fontSize:p.fontSize["2xl"],fontWeight:"bold",color:i.primary},children:u.totalProjects}),e.jsx("div",{style:{fontSize:p.fontSize.xs,color:i.textMuted},children:"Total Projects"})]}),e.jsxs(z,{style:{textAlign:"center",padding:l[4]},children:[e.jsx("div",{style:{fontSize:p.fontSize["2xl"],fontWeight:"bold",color:i.success},children:u.activeProjects}),e.jsx("div",{style:{fontSize:p.fontSize.xs,color:i.textMuted},children:"Active"})]}),e.jsxs(z,{style:{textAlign:"center",padding:l[4]},children:[e.jsx("div",{style:{fontSize:p.fontSize["2xl"],fontWeight:"bold",color:i.accent1},children:se(u.totalValue)}),e.jsx("div",{style:{fontSize:p.fontSize.xs,color:i.textMuted},children:"Total Value"})]})]}),e.jsx(le,{title:"Notes",icon:re,badge:N.filter(c=>!c.deleted).length||null,badgeColor:i.primary,collapsed:o,onToggleCollapse:()=>n(!o),style:{marginBottom:l[4]},children:e.jsx(ie,{notes:N,onAddNote:C,onReply:j,onDelete:f,user:S,panelColor:i.primary})}),e.jsxs(z,{children:[e.jsx("h3",{style:{margin:`0 0 ${l[3]}px`,color:i.textPrimary},children:"Project History"}),d.length===0?e.jsx("div",{style:{textAlign:"center",padding:l[6],color:i.textMuted},children:"No projects yet"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:l[2]},children:d.map(c=>e.jsxs("div",{onClick:()=>w?.(c),style:{display:"flex",alignItems:"center",gap:l[3],padding:l[3],background:i.bgLight,borderRadius:E.md,cursor:"pointer"},children:[e.jsx(oe,{size:16,color:i.textMuted}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:p.fontWeight.medium,color:i.textPrimary},children:c.project}),e.jsxs("div",{style:{fontSize:p.fontSize.xs,color:i.textMuted},children:[c.start," - ",c.end," • ",c.itemCount||1," items"]})]}),c.value>0&&e.jsxs("span",{style:{color:i.textSecondary,fontSize:p.fontSize.sm},children:["$",c.value]}),e.jsx(de,{size:16,color:i.textMuted})]},c.id))})]})]})});function pe({clients:x=[],inventory:s=[],onUpdateClients:d,onViewReservation:g,onAddNote:h,onReplyNote:y,onDeleteNote:w,user:C,addAuditLog:j}){const f=ee(),[S,o]=m.useState(""),[n,u]=m.useState(null),[N,c]=m.useState(null),[k,P]=m.useState(!1),[b,A]=m.useState({isOpen:!1,client:null}),[I,K]=m.useState("all");m.useEffect(()=>{if(n){const t=x.find(a=>a.id===n.id);t&&t!==n&&u(t)}},[x,n]);const B=m.useCallback(t=>{const a=[];return s.forEach(r=>{(r.reservations||[]).forEach(v=>{v.clientId===t&&a.push({...v,itemId:r.id,itemName:r.name,itemCount:1})})}),a.sort((r,v)=>new Date(v.start)-new Date(r.start))},[s]),Z=m.useCallback(t=>{const a=B(t.id);return{totalProjects:a.length,activeReservations:a.filter(r=>new Date(r.end)>=new Date).length,totalValue:a.reduce((r,v)=>r+(v.value||0),0)}},[B]),O=m.useMemo(()=>{let t=[...x];if(S){const a=S.toLowerCase();t=t.filter(r=>r.name.toLowerCase().includes(a)||r.email?.toLowerCase().includes(a)||r.company?.toLowerCase().includes(a))}return I!=="all"&&(I==="favorites"?t=t.filter(a=>a.favorite):t=t.filter(a=>a.type===I)),t.sort((a,r)=>a.favorite&&!r.favorite?-1:!a.favorite&&r.favorite?1:a.name.localeCompare(r.name))},[x,S,I]),U=m.useCallback(async t=>{if(x.find(r=>r.id===t.id))if(f?.updateClient)try{await f.updateClient(t.id,t)}catch(r){T("Failed to update client:",r),d(x.map(v=>v.id===t.id?t:v))}else d(x.map(r=>r.id===t.id?t:r));else{if(f?.createClient)try{await f.createClient(t)}catch(r){T("Failed to create client:",r),d([...x,t])}else d([...x,t]);u(t)}P(!1),c(null)},[x,d,f]),R=m.useCallback(async()=>{if(b.client){const t=b.client;if(f?.deleteClient)try{await f.deleteClient(t.id)}catch(a){T("Failed to delete client:",a),d(x.filter(r=>r.id!==t.id))}else d(x.filter(a=>a.id!==t.id));j&&j({type:"client_deleted",description:`Client "${t.name}" deleted`,user:C?.name||"Unknown",clientId:t.id})}A({isOpen:!1,client:null})},[x,d,b.client,j,C,f]);return n?e.jsxs(e.Fragment,{children:[e.jsx(me,{client:n,projects:B(n.id),onBack:()=>u(null),onEdit:t=>{c(t)},onDelete:t=>{A({isOpen:!0,client:t})},onViewReservation:g,onAddNote:t=>h(n.id,t),onReplyNote:(t,a)=>y(n.id,t,a),onDeleteNote:t=>w(n.id,t),user:C}),N&&e.jsx(L,{client:N,onSave:t=>{d(x.map(a=>a.id===t.id?t:a)),c(null),u(t)},onClose:()=>c(null)}),e.jsx(V,{isOpen:b.isOpen,title:"Delete Client",message:`Are you sure you want to delete "${b.client?.name}"? This cannot be undone.`,confirmText:"Delete",onConfirm:()=>{R(),u(null)},onCancel:()=>A({isOpen:!1,client:null})})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"page-title",style:{display:"flex",alignItems:"center",gap:l[2]},children:[e.jsx(D,{size:24})," Clients"]}),e.jsxs("p",{style:{margin:`${l[1]}px 0 0`,color:i.textMuted,fontSize:p.fontSize.sm},children:[x.length," total clients"]})]}),e.jsx(M,{onClick:()=>P(!0),icon:W,children:"Add Client"})]}),e.jsx(z,{style:{marginBottom:l[4]},children:e.jsxs("div",{style:{display:"flex",gap:l[3],flexWrap:"wrap"},children:[e.jsx("div",{style:{flex:1,minWidth:200},children:e.jsx(te,{value:S,onChange:o,placeholder:"Search clients..."})}),e.jsx(H,{value:I,onChange:t=>K(t.target.value),options:[{value:"all",label:"All Types"},{value:"favorites",label:"★ Favorites"},...X.map(t=>({value:t,label:t}))],style:{minWidth:140},"aria-label":"Filter by type"})]})}),O.length===0?e.jsxs(z,{style:{textAlign:"center",padding:l[8]},children:[e.jsx(D,{size:48,color:i.textMuted,style:{marginBottom:l[3]}}),e.jsx("h3",{style:{margin:0,color:i.textPrimary},children:x.length===0?"No clients yet":"No clients match your search"}),e.jsx("p",{style:{margin:`${l[2]}px 0 0`,color:i.textMuted},children:x.length===0?"Add your first client to start tracking projects":"Try adjusting your search or filters"}),x.length===0&&e.jsx(M,{onClick:()=>P(!0),icon:W,style:{marginTop:l[4]},children:"Add Client"})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:l[3]},children:O.map(t=>e.jsx(xe,{client:t,stats:Z(t),onSelect:u},t.id))}),(k||N)&&e.jsx(L,{client:N,onSave:U,onClose:()=>{P(!1),c(null)}}),b&&e.jsx(V,{title:"Delete Client",message:`Are you sure you want to delete "${b.name}"? This cannot be undone.`,confirmLabel:"Delete",confirmVariant:"danger",onConfirm:()=>R(b),onCancel:()=>A(null)})]})}const ue=m.memo(pe);export{ue as default};
//# sourceMappingURL=ClientsView-DulEZl16.js.map
