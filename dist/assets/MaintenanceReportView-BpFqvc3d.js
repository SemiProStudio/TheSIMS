import{j as t,P as T,c as n,a,t as r,K as u,f as h,C as v,h as b,d as S,m as z,J as o}from"./index-TtmnPN12.js";import{a as f,Y as w,q as k,d as O,Z as P,x as A}from"./vendor-icons-B6HpBdFH.js";import"./vendor-react-DwPMHwnM.js";const I=f.memo(function({inventory:C,currentUser:W,onViewItem:D,onBack:N}){const d=f.useMemo(()=>{const e=[];return C.forEach(s=>{s.maintenanceHistory&&s.maintenanceHistory.length>0&&(s.maintenanceHistory||[]).forEach(c=>{e.push({...c,itemId:s.id,itemName:s.name,itemBrand:s.brand})})}),e},[C]),l=f.useMemo(()=>{const e=d.filter(i=>i.status==="completed"),s=d.filter(i=>i.status==="scheduled"||i.status==="in-progress"),c=d.filter(i=>i.status==="in-progress"),p=e.filter(i=>!i.warrantyWork).reduce((i,x)=>i+(Number(x.cost)||0),0),m=e.filter(i=>i.warrantyWork).reduce((i,x)=>i+(Number(x.cost)||0),0),g={};d.forEach(i=>{g[i.type]=(g[i.type]||0)+1});const j={};e.forEach(i=>{i.vendor&&(j[i.vendor]=(j[i.vendor]||0)+(Number(i.cost)||0))});const R=Object.entries(j).sort((i,x)=>x[1]-i[1]).slice(0,5);return{total:d.length,completed:e.length,pending:s.length,inProgress:c.length,totalCost:p,warrantySavings:m,byType:g,topVendors:R}},[d]),y=f.useMemo(()=>[...d].sort((e,s)=>{const c=e.status==="scheduled"||e.status==="in-progress",p=s.status==="scheduled"||s.status==="in-progress";if(c&&!p)return-1;if(!c&&p)return 1;const m=e.completedDate||e.scheduledDate||e.createdAt,g=s.completedDate||s.scheduledDate||s.createdAt;return new Date(g)-new Date(m)}),[d]),M=e=>{switch(e){case"completed":return n.available;case"in-progress":return n.checkedOut;case"scheduled":return n.primary;case"cancelled":return n.textMuted;default:return n.textMuted}},B=e=>{switch(e){case"completed":return"Completed";case"in-progress":return"In Progress";case"scheduled":return"Scheduled";case"cancelled":return"Cancelled";default:return e}};return t.jsxs(t.Fragment,{children:[t.jsx(T,{title:"Maintenance Report",subtitle:"All maintenance records across inventory",onBack:N,backLabel:"Back to Reports"}),W?.profile&&(()=>{const e=W.profile,s=e.showFields||{};return Object.entries(s).some(([p,m])=>m&&e[p])?t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:a[4],padding:a[3],marginBottom:a[4],borderBottom:`1px solid ${n.borderLight}`},children:[s.logo&&e.logo&&t.jsx("img",{src:e.logo,alt:"",style:{height:36,objectFit:"contain"}}),t.jsxs("div",{children:[s.businessName&&e.businessName&&t.jsx("div",{style:{fontWeight:r.fontWeight.semibold,color:n.textPrimary},children:e.businessName}),t.jsxs("div",{style:{fontSize:r.fontSize.xs,color:n.textMuted,display:"flex",gap:a[3],flexWrap:"wrap"},children:[s.displayName&&e.displayName&&t.jsx("span",{children:e.displayName}),s.phone&&e.phone&&t.jsx("span",{children:e.phone}),s.email&&e.email&&t.jsx("span",{children:e.email})]})]})]}):null})(),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:a[4],marginBottom:a[6]},children:[t.jsx(u,{icon:w,label:"Total Records",value:l.total,color:n.primary}),t.jsx(u,{icon:k,label:"Pending",value:l.pending,color:l.pending>0?n.checkedOut:n.textMuted}),t.jsx(u,{icon:O,label:"In Progress",value:l.inProgress,color:l.inProgress>0?n.accent1:n.textMuted}),t.jsx(u,{icon:P,label:"Total Cost",value:h(l.totalCost),color:n.danger}),t.jsx(u,{icon:P,label:"Warranty Savings",value:h(l.warrantySavings),color:n.available})]}),t.jsxs("div",{className:"responsive-two-col",style:{display:"grid",gap:a[5]},children:[t.jsxs(v,{padding:!1,style:{display:"flex",flexDirection:"column",maxHeight:"calc(100vh - 320px)"},children:[t.jsx(b,{title:"All Maintenance Records",icon:w}),t.jsx("div",{style:{flex:1,overflowY:"auto",minHeight:200},children:y.length===0?t.jsxs("div",{style:{padding:a[6],textAlign:"center",color:n.textMuted},children:[t.jsx(w,{size:32,style:{marginBottom:a[2],opacity:.3}}),t.jsx("p",{style:{margin:0},children:"No maintenance records found"})]}):y.map((e,s)=>t.jsxs("div",{style:{padding:a[4],borderBottom:s<y.length-1?`1px solid ${n.borderLight}`:"none",cursor:"pointer"},onClick:()=>D(e.itemId),children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:a[2]},children:[t.jsxs("div",{style:{display:"flex",gap:a[2],flexWrap:"wrap"},children:[t.jsx(S,{text:e.type,color:M(e.status),size:"xs"}),t.jsx(S,{text:B(e.status),color:M(e.status),size:"xs"}),e.warrantyWork&&t.jsx(S,{text:"Warranty",color:n.available,size:"xs"})]}),e.cost>0&&t.jsx("span",{style:{fontSize:r.fontSize.sm,fontWeight:r.fontWeight.medium,color:n.textPrimary},children:h(e.cost)})]}),t.jsx("div",{style:{fontSize:r.fontSize.sm,color:n.textPrimary,fontWeight:r.fontWeight.medium},children:e.description}),t.jsxs("div",{style:{fontSize:r.fontSize.xs,color:n.textMuted,marginTop:a[1]},children:[e.itemName," (",e.itemId,")",e.vendor&&` â€¢ ${e.vendor}`]}),t.jsx("div",{style:{fontSize:r.fontSize.xs,color:n.textMuted},children:e.status==="completed"&&e.completedDate?`Completed ${z(e.completedDate)}`:e.scheduledDate?`Scheduled ${z(e.scheduledDate)}`:z(e.createdAt)})]},e.id))})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:a[4]},children:[t.jsxs(v,{padding:!1,children:[t.jsx(b,{title:"By Type"}),t.jsx("div",{style:{padding:a[4]},children:Object.entries(l.byType).length===0?t.jsx("p",{style:{color:n.textMuted,textAlign:"center",margin:0,fontSize:r.fontSize.sm},children:"No data"}):Object.entries(l.byType).sort((e,s)=>s[1]-e[1]).map(([e,s])=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:a[2]},children:[t.jsx("span",{style:{color:n.textSecondary,fontSize:r.fontSize.sm},children:e}),t.jsx("span",{style:{color:n.textPrimary,fontWeight:r.fontWeight.medium,fontSize:r.fontSize.sm},children:s})]},e))})]}),t.jsxs(v,{padding:!1,children:[t.jsx(b,{title:"Top Vendors by Cost",icon:A}),t.jsx("div",{style:{padding:a[4]},children:l.topVendors.length===0?t.jsx("p",{style:{color:n.textMuted,textAlign:"center",margin:0,fontSize:r.fontSize.sm},children:"No vendor data"}):l.topVendors.map(([e,s])=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:a[2]},children:[t.jsx("span",{style:{color:n.textSecondary,fontSize:r.fontSize.sm,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:150},children:e}),t.jsx("span",{style:{color:n.textPrimary,fontWeight:r.fontWeight.medium,fontSize:r.fontSize.sm},children:h(s)})]},e))})]})]})]})]})});I.propTypes={inventory:o.arrayOf(o.shape({id:o.string.isRequired,name:o.string.isRequired,brand:o.string,maintenanceHistory:o.arrayOf(o.shape({id:o.string,type:o.string,description:o.string,status:o.oneOf(["scheduled","in-progress","completed","cancelled"]),cost:o.oneOfType([o.string,o.number]),vendor:o.string,warrantyWork:o.bool,scheduledDate:o.string,completedDate:o.string,createdAt:o.string}))})).isRequired,onViewItem:o.func.isRequired,onBack:o.func.isRequired};export{I as MaintenanceReportPanel};
//# sourceMappingURL=MaintenanceReportView-BpFqvc3d.js.map
