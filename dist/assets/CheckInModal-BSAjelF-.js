import{j as e,a as i,i as d,t as s,c as t,w as l,d as k,s as c,B as C,J as a}from"./index-TtmnPN12.js";import{a as y}from"./vendor-icons-B6HpBdFH.js";import{M,a as N}from"./ModalBase-BgtxHV_N.js";import"./vendor-react-DwPMHwnM.js";const I=y.memo(function({item:n,currentUser:D,onCheckIn:w,onClose:u}){const[o,j]=y.useState({condition:n?.condition||"excellent",conditionChanged:!1,conditionNotes:"",returnNotes:"",damageReported:!1,damageDescription:""}),[m,R]=y.useState({}),S=[{value:"excellent",label:"Excellent",description:"Like new, no visible wear"},{value:"good",label:"Good",description:"Minor wear, fully functional"},{value:"fair",label:"Fair",description:"Noticeable wear, works properly"},{value:"poor",label:"Poor",description:"Significant wear, may need attention"}],g=(r,h)=>{j(x=>({...x,[r]:h})),r==="condition"&&j(x=>({...x,[r]:h,conditionChanged:h!==n?.condition}))},z=()=>{const r={};return o.damageReported&&!o.damageDescription.trim()&&(r.damageDescription="Please describe the damage"),R(r),Object.keys(r).length===0},B=()=>{z()&&w({itemId:n.id,returnedBy:D?.name||n.checkedOutTo,condition:o.condition,conditionChanged:o.conditionChanged,conditionAtCheckout:n.condition,conditionNotes:o.conditionNotes.trim(),returnNotes:o.returnNotes.trim(),damageReported:o.damageReported,damageDescription:o.damageDescription.trim(),returnDate:new Date().toISOString().split("T")[0],returnTime:new Date().toLocaleTimeString()})};if(!n)return null;const f=n.checkedOutDate?new Date(n.checkedOutDate):null,v=new Date,b=f?Math.ceil((v-f)/(1e3*60*60*24)):0,p=n.dueBack&&new Date(n.dueBack)<v;return e.jsxs(M,{onClose:u,maxWidth:550,children:[e.jsx(N,{title:"Check In Item",onClose:u}),e.jsxs("div",{style:{padding:i[4],maxHeight:"75vh",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:i[3],padding:i[3],background:`${l(t.primary,10)}`,borderRadius:d.lg,marginBottom:i[4]},children:[n.image?e.jsx("img",{src:n.image,alt:"",style:{width:60,height:60,objectFit:"cover",borderRadius:d.md}}):e.jsx("div",{style:{width:60,height:60,background:`${l(t.primary,20)}`,borderRadius:d.md,display:"flex",alignItems:"center",justifyContent:"center",color:t.textMuted,fontSize:s.fontSize.xs},children:"No img"}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",gap:i[1],marginBottom:i[1]},children:[e.jsx(k,{text:n.id,color:t.primary}),p&&e.jsx(k,{text:"OVERDUE",color:t.danger})]}),e.jsx("div",{style:{fontWeight:s.fontWeight.medium,color:t.textPrimary},children:n.name}),e.jsx("div",{style:{fontSize:s.fontSize.sm,color:t.textMuted},children:n.brand})]})]}),e.jsx("div",{style:{padding:i[3],background:t.bgLight,borderRadius:d.md,marginBottom:i[4]},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:i[3],fontSize:s.fontSize.sm},children:[e.jsxs("div",{children:[e.jsx("span",{style:{color:t.textMuted},children:"Checked out to:"}),e.jsx("div",{style:{color:t.textPrimary,fontWeight:s.fontWeight.medium},children:n.checkedOutTo})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:t.textMuted},children:"Duration:"}),e.jsxs("div",{style:{color:p?t.danger:t.textPrimary,fontWeight:s.fontWeight.medium},children:[b," day",b!==1?"s":""," ",p&&"(overdue)"]})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:t.textMuted},children:"Checkout date:"}),e.jsx("div",{style:{color:t.textPrimary},children:n.checkedOutDate})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:t.textMuted},children:"Due date:"}),e.jsx("div",{style:{color:p?t.danger:t.textPrimary},children:n.dueBack||"Not set"})]})]})}),e.jsxs("div",{style:{marginBottom:i[4]},children:[e.jsx("h4",{style:{margin:`0 0 ${i[3]}px`,color:t.textPrimary,fontSize:s.fontSize.base},children:"Verify Condition"}),e.jsxs("p",{style:{color:t.textMuted,fontSize:s.fontSize.sm,marginBottom:i[3]},children:["Item was ",e.jsx("strong",{children:n.condition})," at checkout. Please verify current condition:"]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:i[2]},children:S.map(r=>e.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:i[2],padding:i[3],background:o.condition===r.value?`${l(t.primary,15)}`:t.bgLight,border:`1px solid ${o.condition===r.value?t.primary:t.border}`,borderRadius:d.md,cursor:"pointer"},children:[e.jsx("input",{type:"radio",name:"condition",value:r.value,checked:o.condition===r.value,onChange:h=>g("condition",h.target.value),style:{marginTop:2,accentColor:t.primary}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:s.fontWeight.medium,color:t.textPrimary},children:r.label}),e.jsx("div",{style:{fontSize:s.fontSize.xs,color:t.textMuted},children:r.description})]})]},r.value))}),o.conditionChanged&&e.jsxs("div",{style:{marginTop:i[3],padding:i[3],background:`${l(t.accent1,15)}`,borderRadius:d.md,fontSize:s.fontSize.sm},children:[e.jsxs("span",{style:{color:t.accent1},children:["⚠️ Condition changed from ",n.condition," to ",o.condition]}),e.jsxs("div",{style:{marginTop:i[2]},children:[e.jsx("label",{style:c.label,children:"Condition change notes"}),e.jsx("textarea",{value:o.conditionNotes,onChange:r=>g("conditionNotes",r.target.value),placeholder:"Explain the condition change...",rows:2,style:{...c.input,resize:"vertical"}})]})]})]}),e.jsxs("div",{style:{marginBottom:i[4]},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:i[2],cursor:"pointer",marginBottom:i[2]},children:[e.jsx("input",{type:"checkbox",checked:o.damageReported,onChange:r=>g("damageReported",r.target.checked),style:{accentColor:t.danger}}),e.jsx("span",{style:{color:t.textPrimary,fontWeight:s.fontWeight.medium},children:"Report damage or issue"})]}),o.damageReported&&e.jsxs("div",{style:{padding:i[3],background:`${l(t.danger,10)}`,border:`1px solid ${l(t.danger,30)}`,borderRadius:d.md},children:[e.jsxs("label",{style:{...c.label,color:o.damageDescription?void 0:t.danger},children:["Describe the damage ",e.jsx("span",{style:{color:t.danger},children:"*"})]}),e.jsx("textarea",{value:o.damageDescription,onChange:r=>g("damageDescription",r.target.value),placeholder:"Describe what's damaged and how it happened...",rows:3,style:{...c.input,resize:"vertical",borderColor:!o.damageDescription||m.damageDescription?t.danger:t.border}}),m.damageDescription&&e.jsx("span",{style:{color:t.danger,fontSize:s.fontSize.xs},children:m.damageDescription})]})]}),e.jsxs("div",{style:{marginBottom:i[4]},children:[e.jsx("label",{style:c.label,children:"Return Notes (optional)"}),e.jsx("textarea",{value:o.returnNotes,onChange:r=>g("returnNotes",r.target.value),placeholder:"Any notes about this return...",rows:2,style:{...c.input,resize:"vertical"}})]}),e.jsxs("div",{style:{display:"flex",gap:i[3],justifyContent:"flex-end"},children:[e.jsx(C,{variant:"secondary",onClick:u,children:"Cancel"}),e.jsx(C,{onClick:B,children:"Confirm Check In"})]})]})]})});I.propTypes={item:a.shape({id:a.string.isRequired,name:a.string.isRequired,brand:a.string,condition:a.string,image:a.string,status:a.string,checkout:a.shape({borrower:a.string,borrowerEmail:a.string,date:a.string,dueDate:a.string,project:a.string})}).isRequired,currentUser:a.shape({id:a.string,name:a.string,email:a.string}),onCheckIn:a.func.isRequired,onClose:a.func.isRequired};export{I as CheckInModal};
//# sourceMappingURL=CheckInModal-BSAjelF-.js.map
