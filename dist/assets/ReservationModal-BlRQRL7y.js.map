{"version":3,"file":"ReservationModal-BlRQRL7y.js","sources":["../../modals/ReservationModal.jsx"],"sourcesContent":["// ============================================================================\n// Reservation Modal\n// Add and edit reservations with multi-item search selection\n// ============================================================================\n\nimport React, { memo, useState, useMemo, useCallback, useRef, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { Plus, Save, AlertTriangle, Search, X, Package } from 'lucide-react';\nimport { PROJECT_TYPES } from '../constants.js';\nimport { colors, styles, spacing, borderRadius, typography, withOpacity } from '../theme.js';\nimport { getAllReservationConflicts } from '../utils.js';\nimport { Button, Badge } from '../components/ui.jsx';\nimport { Select } from '../components/Select.jsx';\nimport { DatePicker } from '../components/DatePicker.jsx';\nimport { Modal, ModalHeader } from './ModalBase.jsx';\n\n// ============================================================================\n// Item Search Component\n// ============================================================================\nconst ItemSearch = memo(function ItemSearch({ \n  inventory, \n  selectedItemIds, \n  onAddItem,\n  placeholder = \"Search items by name, ID, or brand...\"\n}) {\n  const [searchQuery, setSearchQuery] = useState('');\n  const [isOpen, setIsOpen] = useState(false);\n  const inputRef = useRef(null);\n  const dropdownRef = useRef(null);\n  \n  // Filter inventory based on search\n  const searchResults = useMemo(() => {\n    if (!searchQuery.trim()) return [];\n    const q = searchQuery.toLowerCase();\n    return inventory\n      .filter(item => \n        !selectedItemIds.includes(item.id) && // Exclude already selected\n        (item.status === 'available' || item.status === 'reserved') && // Only available/reserved items\n        (\n          item.name?.toLowerCase().includes(q) ||\n          item.id?.toLowerCase().includes(q) ||\n          item.brand?.toLowerCase().includes(q) ||\n          item.category?.toLowerCase().includes(q)\n        )\n      )\n      .slice(0, 10); // Limit results\n  }, [searchQuery, inventory, selectedItemIds]);\n  \n  // Close dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (e) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(e.target) &&\n          inputRef.current && !inputRef.current.contains(e.target)) {\n        setIsOpen(false);\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n  \n  const handleSelect = (item) => {\n    onAddItem(item);\n    setSearchQuery('');\n    setIsOpen(false);\n    inputRef.current?.focus();\n  };\n  \n  return (\n    <div style={{ position: 'relative' }}>\n      <div style={{ position: 'relative' }}>\n        <Search \n          size={16} \n          style={{ \n            position: 'absolute', \n            left: 12, \n            top: '50%', \n            transform: 'translateY(-50%)',\n            color: colors.textMuted \n          }} \n        />\n        <input\n          ref={inputRef}\n          type=\"text\"\n          value={searchQuery}\n          onChange={(e) => {\n            setSearchQuery(e.target.value);\n            setIsOpen(true);\n          }}\n          onFocus={() => setIsOpen(true)}\n          placeholder={placeholder}\n          style={{\n            ...styles.input,\n            paddingLeft: 40,\n          }}\n        />\n      </div>\n      \n      {/* Search Results Dropdown */}\n      {isOpen && searchQuery.trim() && (\n        <div\n          ref={dropdownRef}\n          style={{\n            position: 'absolute',\n            top: '100%',\n            left: 0,\n            right: 0,\n            marginTop: 4,\n            background: colors.bgMedium,\n            border: `1px solid ${colors.border}`,\n            borderRadius: borderRadius.lg,\n            boxShadow: '0 4px 20px rgba(0,0,0,0.3)',\n            zIndex: 100,\n            maxHeight: 300,\n            overflowY: 'auto',\n          }}\n        >\n          {searchResults.length === 0 ? (\n            <div style={{ \n              padding: spacing[4], \n              textAlign: 'center', \n              color: colors.textMuted,\n              fontSize: typography.fontSize.sm \n            }}>\n              No items found matching \"{searchQuery}\"\n            </div>\n          ) : (\n            searchResults.map(item => (\n              <div\n                key={item.id}\n                onClick={() => handleSelect(item)}\n                style={{\n                  padding: spacing[3],\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: spacing[3],\n                  cursor: 'pointer',\n                  borderBottom: `1px solid ${colors.borderLight}`,\n                  transition: 'background 0.15s ease',\n                }}\n                onMouseEnter={(e) => e.currentTarget.style.background = withOpacity(colors.primary, 15)}\n                onMouseLeave={(e) => e.currentTarget.style.background = 'transparent'}\n              >\n                {item.image ? (\n                  <img \n                    src={item.image} \n                    alt=\"\" \n                    style={{ \n                      width: 40, \n                      height: 40, \n                      borderRadius: borderRadius.md, \n                      objectFit: 'cover' \n                    }} \n                  />\n                ) : (\n                  <div style={{ \n                    width: 40, \n                    height: 40, \n                    borderRadius: borderRadius.md, \n                    background: withOpacity(colors.primary, 15),\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    color: colors.textMuted,\n                    fontSize: typography.fontSize.xs\n                  }}>\n                    <Package size={16} />\n                  </div>\n                )}\n                <div style={{ flex: 1, minWidth: 0 }}>\n                  <div style={{ \n                    fontWeight: typography.fontWeight.medium, \n                    color: colors.textPrimary,\n                    whiteSpace: 'nowrap',\n                    overflow: 'hidden',\n                    textOverflow: 'ellipsis'\n                  }}>\n                    {item.name}\n                  </div>\n                  <div style={{ \n                    fontSize: typography.fontSize.sm, \n                    color: colors.textMuted,\n                    display: 'flex',\n                    gap: spacing[2],\n                    alignItems: 'center'\n                  }}>\n                    <Badge text={item.id} color={colors.primary} />\n                    <span>{item.brand}</span>\n                    {item.status === 'reserved' && (\n                      <Badge text=\"Has Reservations\" color={colors.warning} />\n                    )}\n                  </div>\n                </div>\n                <Plus size={18} style={{ color: colors.primary }} />\n              </div>\n            ))\n          )}\n        </div>\n      )}\n    </div>\n  );\n});\n\n// ============================================================================\n// Selected Item Card\n// ============================================================================\nconst SelectedItemCard = memo(function SelectedItemCard({ item, onRemove, conflicts }) {\n  const hasConflict = conflicts?.hasConflicts;\n  \n  return (\n    <div style={{\n      display: 'flex',\n      alignItems: 'center',\n      gap: spacing[3],\n      padding: spacing[3],\n      background: hasConflict \n        ? withOpacity(colors.warning, 10) \n        : withOpacity(colors.primary, 10),\n      border: `1px solid ${hasConflict ? colors.warning : withOpacity(colors.primary, 30)}`,\n      borderRadius: borderRadius.md,\n    }}>\n      {item.image ? (\n        <img \n          src={item.image} \n          alt=\"\" \n          style={{ width: 48, height: 48, borderRadius: borderRadius.md, objectFit: 'cover' }} \n        />\n      ) : (\n        <div style={{ \n          width: 48, \n          height: 48, \n          borderRadius: borderRadius.md, \n          background: colors.bgDark,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          color: colors.textMuted\n        }}>\n          <Package size={20} />\n        </div>\n      )}\n      <div style={{ flex: 1, minWidth: 0 }}>\n        <div style={{ \n          fontWeight: typography.fontWeight.medium, \n          color: colors.textPrimary,\n          marginBottom: 2\n        }}>\n          {item.name}\n        </div>\n        <div style={{ \n          fontSize: typography.fontSize.sm, \n          color: colors.textMuted,\n          display: 'flex',\n          gap: spacing[2],\n          alignItems: 'center',\n          flexWrap: 'wrap'\n        }}>\n          <Badge text={item.id} color={colors.primary} />\n          <span>{item.brand} â€¢ {item.category}</span>\n        </div>\n        {hasConflict && (\n          <div style={{ \n            marginTop: spacing[1],\n            fontSize: typography.fontSize.xs,\n            color: colors.warning,\n            display: 'flex',\n            alignItems: 'center',\n            gap: spacing[1]\n          }}>\n            <AlertTriangle size={12} />\n            {conflicts.reservationConflicts?.length > 0 \n              ? `${conflicts.reservationConflicts.length} scheduling conflict(s)`\n              : 'Item currently checked out'}\n          </div>\n        )}\n      </div>\n      {onRemove && (\n        <button\n          onClick={() => onRemove(item.id)}\n          style={{\n            background: 'transparent',\n            border: 'none',\n            padding: spacing[1],\n            cursor: 'pointer',\n            color: colors.textMuted,\n            borderRadius: borderRadius.md,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n          }}\n          title=\"Remove item\"\n        >\n          <X size={18} />\n        </button>\n      )}\n    </div>\n  );\n});\n\n// ============================================================================\n// Main ReservationModal Component\n// ============================================================================\nexport const ReservationModal = memo(function ReservationModal({ \n  isEdit, \n  reservationForm, \n  setReservationForm, \n  onSave, \n  onClose, \n  clients = [],\n  inventory = [],\n  item = null,\n  editingReservationId = null\n}) {\n  const [touched, setTouched] = useState({});\n  const [acknowledgedConflicts, setAcknowledgedConflicts] = useState(false);\n  \n  // Selected items - from props (single item) or from form (multiple)\n  // Selected items - sync with props and form\n  const [selectedItems, setSelectedItems] = useState([]);\n  \n  // Reset selected items when modal opens/form resets\n  useEffect(() => {\n    if (item) {\n      setSelectedItems([item]);\n    } else if (reservationForm.itemIds?.length) {\n      setSelectedItems(inventory.filter(i => reservationForm.itemIds.includes(i.id)));\n    } else if (reservationForm.itemId) {\n      const found = inventory.find(i => i.id === reservationForm.itemId);\n      setSelectedItems(found ? [found] : []);\n    } else {\n      setSelectedItems([]);\n    }\n  }, [item, reservationForm.itemIds, reservationForm.itemId, inventory]);\n  \n  // Add item to selection\n  const handleAddItem = useCallback((newItem) => {\n    setSelectedItems(prev => [...prev, newItem]);\n    // Update form with item IDs\n    setReservationForm(prev => ({\n      ...prev,\n      itemIds: [...(prev.itemIds || []), newItem.id],\n      itemId: newItem.id // Keep single itemId for backwards compatibility\n    }));\n  }, [setReservationForm]);\n  \n  // Remove item from selection\n  const handleRemoveItem = useCallback((itemId) => {\n    setSelectedItems(prev => prev.filter(i => i.id !== itemId));\n    setReservationForm(prev => {\n      const newItemIds = (prev.itemIds || []).filter(id => id !== itemId);\n      return {\n        ...prev,\n        itemIds: newItemIds,\n        itemId: newItemIds[0] || ''\n      };\n    });\n  }, [setReservationForm]);\n  \n  const handleChange = (field, value) => {\n    setTouched(prev => ({ ...prev, [field]: true }));\n    if (field === 'start' || field === 'end') {\n      setAcknowledgedConflicts(false);\n    }\n    if (field === 'start' && reservationForm.end && value > reservationForm.end) {\n      setReservationForm(prev => ({ ...prev, start: value, end: value }));\n    } else if (field === 'clientId' && value) {\n      const client = clients.find(c => c.id === value);\n      if (client) {\n        setReservationForm(prev => ({ \n          ...prev, \n          clientId: value,\n          contactPhone: client.phone || prev.contactPhone,\n          contactEmail: client.email || prev.contactEmail,\n        }));\n      } else {\n        setReservationForm(prev => ({ ...prev, [field]: value }));\n      }\n    } else {\n      setReservationForm(prev => ({ ...prev, [field]: value }));\n    }\n  };\n\n  const handleBlur = (field) => {\n    setTouched(prev => ({ ...prev, [field]: true }));\n  };\n  \n  // Get conflicts for each selected item\n  const itemConflicts = useMemo(() => {\n    const conflicts = {};\n    if (reservationForm.start && reservationForm.end) {\n      selectedItems.forEach(selectedItem => {\n        conflicts[selectedItem.id] = getAllReservationConflicts(\n          selectedItem,\n          reservationForm.start,\n          reservationForm.end,\n          isEdit ? editingReservationId : null\n        );\n      });\n    }\n    return conflicts;\n  }, [selectedItems, reservationForm.start, reservationForm.end, isEdit, editingReservationId]);\n  \n  // Check if any item has conflicts\n  const hasAnyConflicts = useMemo(() => {\n    return Object.values(itemConflicts).some(c => c.hasConflicts);\n  }, [itemConflicts]);\n  \n  // Validation\n  const dateValid = reservationForm.start && reservationForm.end && reservationForm.end >= reservationForm.start;\n  const hasItems = selectedItems.length > 0;\n  const valid = hasItems && reservationForm.project?.trim() && dateValid && reservationForm.user?.trim();\n  const dateError = reservationForm.start && reservationForm.end && reservationForm.end < reservationForm.start;\n  \n  const canSave = valid && (!hasAnyConflicts || acknowledgedConflicts);\n  \n  const handleSave = useCallback(() => {\n    setTouched({\n      project: true,\n      start: true,\n      end: true,\n      user: true,\n      contactEmail: true,\n    });\n    \n    if (canSave) {\n      // Update form with selected item IDs before saving\n      const itemIds = selectedItems.map(i => i.id);\n      setReservationForm(prev => ({\n        ...prev,\n        itemIds,\n        itemId: itemIds[0] || ''\n      }));\n      onSave();\n    }\n  }, [canSave, onSave, selectedItems, setReservationForm]);\n  \n  const showProjectError = touched.project && !reservationForm.project;\n  const showStartError = touched.start && !reservationForm.start;\n  const showEndError = touched.end && (!reservationForm.end || dateError);\n  const showUserError = touched.user && !reservationForm.user;\n\n  const getInputStyle = (hasError, isEmpty) => ({\n    ...styles.input,\n    borderColor: hasError || isEmpty ? colors.danger : colors.border,\n    boxShadow: hasError ? `0 0 0 1px ${colors.danger}` : undefined\n  });\n\n  return (\n    <Modal onClose={onClose} maxWidth={600}>\n      <ModalHeader title={isEdit ? \"Edit Reservation\" : \"Add Reservation\"} onClose={onClose} />\n      <div style={{ padding: spacing[4], maxHeight: '75vh', overflowY: 'auto' }}>\n        \n        {/* ============ SECTION 1: ITEM SELECTION ============ */}\n        <div style={{ \n          marginBottom: spacing[4],\n          paddingBottom: spacing[4],\n          borderBottom: `1px solid ${colors.borderLight}`\n        }}>\n          <label style={{ \n            ...styles.label, \n            marginBottom: spacing[2],\n            display: 'flex',\n            alignItems: 'center',\n            gap: spacing[2]\n          }}>\n            <Package size={16} />\n            {item ? 'Item to Reserve' : 'Select Items to Reserve'}\n            {selectedItems.length === 0 && <span style={{ color: colors.danger }}>*</span>}\n          </label>\n          \n          {/* Search Input - only show when not in single-item mode and not editing */}\n          {!isEdit && !item && (\n            <ItemSearch\n              inventory={inventory}\n              selectedItemIds={selectedItems.map(i => i.id)}\n              onAddItem={handleAddItem}\n            />\n          )}\n          \n          {/* Selected Items */}\n          {selectedItems.length > 0 && (\n            <div style={{ \n              marginTop: spacing[3],\n              display: 'flex',\n              flexDirection: 'column',\n              gap: spacing[2]\n            }}>\n              {/* Only show count when multiple items */}\n              {!item && selectedItems.length > 1 && (\n                <div style={{ \n                  fontSize: typography.fontSize.sm, \n                  color: colors.textMuted,\n                  marginBottom: spacing[1]\n                }}>\n                  {selectedItems.length} items selected:\n                </div>\n              )}\n              {selectedItems.map(selectedItem => (\n                <SelectedItemCard\n                  key={selectedItem.id}\n                  item={selectedItem}\n                  onRemove={isEdit || item ? null : handleRemoveItem}\n                  conflicts={itemConflicts[selectedItem.id]}\n                />\n              ))}\n            </div>\n          )}\n          \n          {/* No items selected warning */}\n          {selectedItems.length === 0 && touched.project && (\n            <p style={{ \n              color: colors.danger, \n              fontSize: typography.fontSize.sm, \n              marginTop: spacing[2] \n            }}>\n              Please select at least one item to reserve\n            </p>\n          )}\n        </div>\n        \n        {/* ============ SECTION 2: RESERVATION DETAILS ============ */}\n        \n        {/* Conflict Warning Banner */}\n        {hasAnyConflicts && (\n          <div style={{\n            background: withOpacity(colors.warning, 15),\n            border: `1px solid ${colors.warning}`,\n            borderRadius: borderRadius.lg,\n            padding: spacing[3],\n            marginBottom: spacing[4],\n          }}>\n            <div style={{ \n              display: 'flex', \n              alignItems: 'center', \n              gap: spacing[2], \n              marginBottom: spacing[2],\n              color: colors.warning,\n              fontWeight: typography.fontWeight.semibold,\n            }}>\n              <AlertTriangle size={18} />\n              <span>Scheduling Conflicts Detected</span>\n            </div>\n            <p style={{ \n              fontSize: typography.fontSize.sm, \n              color: colors.textSecondary,\n              marginBottom: spacing[2]\n            }}>\n              One or more selected items have scheduling conflicts for the selected dates.\n              You can still proceed if needed.\n            </p>\n            <label style={{ \n              display: 'flex', \n              alignItems: 'center', \n              gap: spacing[2], \n              cursor: 'pointer',\n              fontSize: typography.fontSize.sm,\n              color: colors.textSecondary,\n            }}>\n              <input \n                type=\"checkbox\" \n                checked={acknowledgedConflicts}\n                onChange={(e) => setAcknowledgedConflicts(e.target.checked)}\n                style={{ width: 16, height: 16 }}\n              />\n              I understand and want to proceed anyway\n            </label>\n          </div>\n        )}\n        \n        {/* Client selector */}\n        {clients.length > 0 && (\n          <div style={{ marginBottom: spacing[3] }}>\n            <label style={styles.label}>Client (Optional)</label>\n            <Select \n              value={reservationForm.clientId || ''} \n              onChange={e => handleChange('clientId', e.target.value)} \n              options={[\n                { value: '', label: '-- Select a client --' },\n                ...clients.map(c => ({ \n                  value: c.id, \n                  label: c.name + (c.company ? ` (${c.company})` : '') \n                }))\n              ]}\n              aria-label=\"Client\"\n            />\n          </div>\n        )}\n        \n        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: spacing[3], marginBottom: spacing[3] }}>\n          <div>\n            <label style={{ ...styles.label, color: showProjectError ? colors.danger : undefined }}>\n              Project Name <span style={{ color: colors.danger }}>*</span>\n            </label>\n            <input \n              value={reservationForm.project || ''} \n              onChange={e => handleChange('project', e.target.value)} \n              onBlur={() => handleBlur('project')}\n              placeholder=\"e.g., Wedding - Smith/Jones\"\n              style={getInputStyle(showProjectError, !reservationForm.project)} \n            />\n            {showProjectError && <p style={{ color: colors.danger, fontSize: typography.fontSize.xs, margin: `${spacing[1]}px 0 0` }}>Required</p>}\n          </div>\n          <div>\n            <label style={styles.label}>Project Type</label>\n            <Select \n              value={reservationForm.projectType || 'Other'} \n              onChange={e => handleChange('projectType', e.target.value)} \n              options={PROJECT_TYPES.map(t => ({ value: t, label: t }))}\n              aria-label=\"Project type\"\n            />\n          </div>\n        </div>\n        \n        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: spacing[3], marginBottom: spacing[3] }}>\n          <div>\n            <label style={{ ...styles.label, color: showStartError ? colors.danger : undefined }}>\n              Start Date <span style={{ color: colors.danger }}>*</span>\n            </label>\n            <DatePicker\n              value={reservationForm.start || ''} \n              onChange={e => handleChange('start', e.target.value)} \n              error={showStartError}\n              placeholder=\"Select start date\"\n              aria-label=\"Start date\"\n            />\n            {showStartError && <p style={{ color: colors.danger, fontSize: typography.fontSize.xs, margin: `${spacing[1]}px 0 0` }}>Required</p>}\n          </div>\n          <div>\n            <label style={{ ...styles.label, color: showEndError ? colors.danger : undefined }}>\n              End Date / Due Back <span style={{ color: colors.danger }}>*</span>\n            </label>\n            <DatePicker\n              value={reservationForm.end || ''} \n              onChange={e => handleChange('end', e.target.value)} \n              min={reservationForm.start || undefined}\n              error={showEndError}\n              placeholder=\"Select end date\"\n              aria-label=\"End date\"\n            />\n            {dateError && (\n              <p style={{ color: colors.danger, fontSize: typography.fontSize.xs, margin: `${spacing[1]}px 0 0` }}>\n                End date must be on or after start date\n              </p>\n            )}\n          </div>\n        </div>\n        \n        <div style={{ marginBottom: spacing[3] }}>\n          <label style={{ ...styles.label, color: showUserError ? colors.danger : undefined }}>\n            Reserved By <span style={{ color: colors.danger }}>*</span>\n          </label>\n          <input \n            value={reservationForm.user || ''} \n            onChange={e => handleChange('user', e.target.value)} \n            onBlur={() => handleBlur('user')}\n            placeholder=\"e.g., John Smith\"\n            style={getInputStyle(showUserError, !reservationForm.user)} \n          />\n          {showUserError && <p style={{ color: colors.danger, fontSize: typography.fontSize.xs, margin: `${spacing[1]}px 0 0` }}>Required</p>}\n        </div>\n        \n        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: spacing[3], marginBottom: spacing[3] }}>\n          <div>\n            <label style={styles.label}>Contact Phone</label>\n            <input \n              type=\"tel\" \n              value={reservationForm.contactPhone || ''} \n              onChange={e => handleChange('contactPhone', e.target.value)} \n              placeholder=\"555-123-4567\" \n              style={styles.input} \n            />\n          </div>\n          <div>\n            <label style={styles.label}>Contact Email</label>\n            <input \n              type=\"email\" \n              value={reservationForm.contactEmail || ''} \n              onChange={e => handleChange('contactEmail', e.target.value)} \n              placeholder=\"email@example.com\" \n              style={styles.input} \n            />\n          </div>\n        </div>\n        \n        <div style={{ marginBottom: spacing[4] }}>\n          <label style={styles.label}>Location</label>\n          <input \n            value={reservationForm.location || ''} \n            onChange={e => handleChange('location', e.target.value)} \n            placeholder=\"Address or venue name\" \n            style={styles.input} \n          />\n        </div>\n        \n        {/* Action Buttons */}\n        <div style={{ display: 'flex', gap: spacing[3], justifyContent: 'flex-end' }}>\n          <Button variant=\"secondary\" onClick={onClose}>Cancel</Button>\n          <Button \n            onClick={handleSave} \n            disabled={!canSave} \n            icon={isEdit ? Save : Plus}\n            style={hasAnyConflicts && acknowledgedConflicts ? { background: colors.warning } : undefined}\n          >\n            {isEdit \n              ? 'Save Changes' \n              : hasAnyConflicts && acknowledgedConflicts \n                ? 'Save Anyway' \n                : `Add Reservation${selectedItems.length > 1 ? ` (${selectedItems.length} items)` : ''}`\n            }\n          </Button>\n        </div>\n      </div>\n    </Modal>\n  );\n});\n\n// ============================================================================\n// PropTypes\n// ============================================================================\n\nconst reservationFormShape = PropTypes.shape({\n  project: PropTypes.string,\n  projectType: PropTypes.string,\n  start: PropTypes.string,\n  end: PropTypes.string,\n  user: PropTypes.string,\n  clientId: PropTypes.string,\n  contactPhone: PropTypes.string,\n  contactEmail: PropTypes.string,\n  location: PropTypes.string,\n  itemId: PropTypes.string,\n  itemIds: PropTypes.arrayOf(PropTypes.string),\n});\n\nconst clientShape = PropTypes.shape({\n  id: PropTypes.string.isRequired,\n  name: PropTypes.string.isRequired,\n  company: PropTypes.string,\n  phone: PropTypes.string,\n  email: PropTypes.string,\n});\n\nconst itemShape = PropTypes.shape({\n  id: PropTypes.string.isRequired,\n  name: PropTypes.string,\n  brand: PropTypes.string,\n  category: PropTypes.string,\n  image: PropTypes.string,\n  status: PropTypes.string,\n  reservations: PropTypes.array,\n});\n\nReservationModal.propTypes = {\n  isEdit: PropTypes.bool,\n  reservationForm: reservationFormShape.isRequired,\n  setReservationForm: PropTypes.func.isRequired,\n  onSave: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired,\n  clients: PropTypes.arrayOf(clientShape),\n  inventory: PropTypes.arrayOf(itemShape),\n  item: itemShape,\n  editingReservationId: PropTypes.string,\n};\n"],"names":["ItemSearch","memo","inventory","selectedItemIds","onAddItem","placeholder","searchQuery","setSearchQuery","useState","isOpen","setIsOpen","inputRef","useRef","dropdownRef","searchResults","useMemo","q","item","useEffect","handleClickOutside","e","handleSelect","jsxs","jsx","Search","colors","styles","borderRadius","spacing","typography","withOpacity","Package","Badge","Plus","SelectedItemCard","onRemove","conflicts","hasConflict","AlertTriangle","X","ReservationModal","isEdit","reservationForm","setReservationForm","onSave","onClose","clients","editingReservationId","touched","setTouched","acknowledgedConflicts","setAcknowledgedConflicts","selectedItems","setSelectedItems","i","found","handleAddItem","useCallback","newItem","prev","handleRemoveItem","itemId","newItemIds","id","handleChange","field","value","client","c","handleBlur","itemConflicts","selectedItem","getAllReservationConflicts","hasAnyConflicts","dateValid","valid","dateError","canSave","handleSave","itemIds","showProjectError","showStartError","showEndError","showUserError","getInputStyle","hasError","isEmpty","Modal","ModalHeader","Select","PROJECT_TYPES","DatePicker","Button","Save","reservationFormShape","PropTypes","clientShape","itemShape"],"mappings":"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"}