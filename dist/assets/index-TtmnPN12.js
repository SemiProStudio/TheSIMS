const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LabelsView-Cz14xMMv.js","assets/vendor-icons-B6HpBdFH.js","assets/printUtil-TDGEm20O.js","assets/vendor-react-DwPMHwnM.js","assets/PackagesView-BRk7n8Z8.js","assets/PackListsView-B3Ih28WR.js","assets/ReservationDetail-DiiY3UzJ.js","assets/ScheduleView-Czwqz1UJ.js","assets/NotificationSettings-BJh_EgPE.js","assets/LocationsManager-BzGn_lVG.js","assets/LayoutCustomize-BItJdhTS.js","assets/ThemeSelector-8fyjr44D.js","assets/ClientsView-DulEZl16.js","assets/RolesManager-Bqof7tHo.js","assets/ChangeLog-CQKx-PXE.js","assets/AdminView-_onm691P.js","assets/UsersView-NzhLSkPx.js","assets/ReportsView-CKIaqg8P.js","assets/AuditLogView-CraJbfHF.js","assets/MaintenanceReportView-BpFqvc3d.js","assets/InsuranceReportView-DRNxvyjS.js","assets/AdminPages-C-YnZlb3.js","assets/ItemModal-Dum071tY.js","assets/ModalBase-BgtxHV_N.js","assets/ImageCropEditor-DFvxRXQs.js","assets/ReservationModal-BlRQRL7y.js","assets/QRModal-CUTgfIpN.js","assets/ExportModal-C5OyEm-d.js","assets/ProfileModal-BMznNtty.js","assets/ImageSelectorModal-BOvdi9FA.js","assets/QRScannerModal-C-DXLY0m.js","assets/CSVImportModal-gEvdy65k.js","assets/DatabaseExportModal-R544tEEn.js","assets/CheckOutModal-YRNUavqZ.js","assets/CheckInModal-BSAjelF-.js","assets/MaintenanceModal-MB5JX6M8.js","assets/BulkModals-B5mYDQU5.js","assets/AddUserModal-BBUbTwHT.js","assets/ImagePreviewModal-DEiRM48c.js"])))=>i.map(i=>d[i]);
import{r as yi,a8 as xr,a as s,A as xi,G as Si,a9 as ki,c as kn,e as vi,aa as wi,k as jt,ab as Sr,U as kr,$ as xa,S as ma,W as Ci,C as nn,ac as vr,ad as ji,a0 as wr,D as _i,g as pt,a5 as Ii,ae as $t,af as Ei,y as Cr,_ as Gn,d as an,s as vn,q as ln,ag as Di,ah as jr,ai as Ai,R as Sa,aj as Ti,ak as Ri,T as Cn,X as wn,b as bt,al as Pi,o as Li,am as Mi,Q as ka,f as jn,x as zi,Z as va,a4 as wa,Y as bn,m as _r,an as Ni,j as Oi,O as qi,ao as $i,E as Bi}from"./vendor-icons-B6HpBdFH.js";import{r as Ir}from"./vendor-react-DwPMHwnM.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const m of l.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&r(m)}).observe(document,{childList:!0,subtree:!0});function a(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(i){if(i.ep)return;i.ep=!0;const l=a(i);fetch(i.href,l)}})();var ra={exports:{}},fn={};var Qa;function Vi(){if(Qa)return fn;Qa=1;var e=yi(),n=Symbol.for("react.element"),a=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function m(d,f,h){var u,g={},p=null,k=null;h!==void 0&&(p=""+h),f.key!==void 0&&(p=""+f.key),f.ref!==void 0&&(k=f.ref);for(u in f)r.call(f,u)&&!l.hasOwnProperty(u)&&(g[u]=f[u]);if(d&&d.defaultProps)for(u in f=d.defaultProps,f)g[u]===void 0&&(g[u]=f[u]);return{$$typeof:n,type:d,key:p,ref:k,props:g,_owner:i.current}}return fn.Fragment=a,fn.jsx=m,fn.jsxs=m,fn}var Xa;function Wi(){return Xa||(Xa=1,ra.exports=Vi()),ra.exports}var t=Wi(),Vn={},Za;function Fi(){if(Za)return Vn;Za=1;var e=Ir();return Vn.createRoot=e.createRoot,Vn.hydrateRoot=e.hydrateRoot,Vn}var Hi=Fi();const Ui=xr(Hi);var Ja={},Gi="@vercel/speed-insights",Ki="1.3.1",Yi=()=>{window.si||(window.si=function(...n){(window.siq=window.siq||[]).push(n)})};function Qi(){return typeof window<"u"}function Xi(){try{const e="production"}catch{}return"production"}function Er(){return Xi()==="development"}function Zi(e){return e.scriptSrc?e.scriptSrc:Er()?"https://va.vercel-scripts.com/v1/speed-insights/script.debug.js":e.dsn?"https://va.vercel-scripts.com/v1/speed-insights/script.js":e.basePath?`${e.basePath}/speed-insights/script.js`:"/_vercel/speed-insights/script.js"}function Ji(e={}){var n;if(!Qi()||e.route===null)return null;Yi();const a=Zi(e);if(document.head.querySelector(`script[src*="${a}"]`))return null;e.beforeSend&&((n=window.si)==null||n.call(window,"beforeSend",e.beforeSend));const r=document.createElement("script");return r.src=a,r.defer=!0,r.dataset.sdkn=Gi+(e.framework?`/${e.framework}`:""),r.dataset.sdkv=Ki,e.sampleRate&&(r.dataset.sampleRate=e.sampleRate.toString()),e.route&&(r.dataset.route=e.route),e.endpoint?r.dataset.endpoint=e.endpoint:e.basePath&&(r.dataset.endpoint=`${e.basePath}/speed-insights/vitals`),e.dsn&&(r.dataset.dsn=e.dsn),Er()&&e.debug===!1&&(r.dataset.debug="false"),r.onerror=()=>{console.log(`[Vercel Speed Insights] Failed to load script from ${a}. Please check if any content blockers are enabled and try again.`)},document.head.appendChild(r),{setRoute:i=>{r.dataset.route=i??void 0}}}function es(){if(!(typeof process>"u"||typeof Ja>"u"))return Ja.REACT_APP_VERCEL_OBSERVABILITY_BASEPATH}function ts(e){s.useEffect(()=>{var a;e.beforeSend&&((a=window.si)==null||a.call(window,"beforeSend",e.beforeSend))},[e.beforeSend]);const n=s.useRef(null);return s.useEffect(()=>{if(n.current)e.route&&n.current(e.route);else{const a=Ji({framework:e.framework??"react",basePath:e.basePath??es(),...e});a&&(n.current=a.setRoute)}},[e.route]),null}const ns="modulepreload",as=function(e){return"/"+e},er={},fe=function(n,a,r){let i=Promise.resolve();if(a&&a.length>0){let f=function(h){return Promise.all(h.map(u=>Promise.resolve(u).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),d=m?.nonce||m?.getAttribute("nonce");i=f(a.map(h=>{if(h=as(h),h in er)return;er[h]=!0;const u=h.endsWith(".css"),g=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${g}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":ns,u||(p.as="script"),p.crossOrigin="",p.href=h,d&&p.setAttribute("nonce",d),document.head.appendChild(p),u)return new Promise((k,y)=>{p.addEventListener("load",k),p.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${h}`)))})}))}function l(m){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=m,window.dispatchEvent(d),!d.defaultPrevented)throw m}return i.then(m=>{for(const d of m||[])d.status==="rejected"&&l(d.reason);return n().catch(l)})},ee={HIDE:"hide",VIEW:"view",EDIT:"edit"},fa={DASHBOARD:{id:"dashboard",name:"Dashboard",description:"Main dashboard with stats and alerts"},GEAR_LIST:{id:"gear_list",name:"Gear List",description:"View and manage inventory items"},ITEM_DETAILS:{id:"item_details",name:"Item Details",description:"View/edit individual item details"},SCHEDULE:{id:"schedule",name:"Schedule",description:"Calendar and reservation management"},PACK_LISTS:{id:"pack_lists",name:"Pack Lists",description:"Create and manage pack lists"},CLIENTS:{id:"clients",name:"Clients",description:"Client management"},SEARCH:{id:"search",name:"Search",description:"Global search functionality"},LABELS:{id:"labels",name:"Labels",description:"Print labels for items"},REPORTS:{id:"reports",name:"Reports",description:"View reports and analytics"},ADMIN_USERS:{id:"admin_users",name:"Admin: Users",description:"Manage user accounts"},ADMIN_CATEGORIES:{id:"admin_categories",name:"Admin: Categories",description:"Manage item categories"},ADMIN_SPECS:{id:"admin_specs",name:"Admin: Specifications",description:"Manage item specifications"},ADMIN_LOCATIONS:{id:"admin_locations",name:"Admin: Locations",description:"Manage storage locations"},ADMIN_THEMES:{id:"admin_themes",name:"Admin: Themes",description:"Customize app appearance"},ADMIN_LAYOUT:{id:"admin_layout",name:"Admin: Layout",description:"Customize dashboard layout"},ADMIN_NOTIFICATIONS:{id:"admin_notifications",name:"Admin: Notifications",description:"Configure email notifications"},ADMIN_ROLES:{id:"admin_roles",name:"Admin: Roles & Permissions",description:"Manage user roles and permissions"},ADMIN_AUDIT:{id:"admin_audit",name:"Admin: Audit Log",description:"View system audit log"}},Dr=[{id:"role_admin",name:"Administrator",description:"Full access to all features",isSystem:!0,permissions:Object.keys(fa).reduce((e,n)=>(e[fa[n].id]=ee.EDIT,e),{})},{id:"role_manager",name:"Manager",description:"Can manage inventory and users, limited admin access",isSystem:!1,permissions:{dashboard:ee.EDIT,gear_list:ee.EDIT,item_details:ee.EDIT,schedule:ee.EDIT,pack_lists:ee.EDIT,clients:ee.EDIT,search:ee.EDIT,labels:ee.EDIT,reports:ee.VIEW,admin_users:ee.VIEW,admin_categories:ee.VIEW,admin_specs:ee.VIEW,admin_locations:ee.EDIT,admin_themes:ee.HIDE,admin_layout:ee.HIDE,admin_notifications:ee.HIDE,admin_roles:ee.HIDE,admin_audit:ee.VIEW}},{id:"role_user",name:"Standard User",description:"Basic access for day-to-day operations",isSystem:!0,permissions:{dashboard:ee.VIEW,gear_list:ee.VIEW,item_details:ee.VIEW,schedule:ee.EDIT,pack_lists:ee.EDIT,clients:ee.VIEW,search:ee.VIEW,labels:ee.VIEW,reports:ee.HIDE,admin_users:ee.HIDE,admin_categories:ee.HIDE,admin_specs:ee.HIDE,admin_locations:ee.HIDE,admin_themes:ee.HIDE,admin_layout:ee.HIDE,admin_notifications:ee.HIDE,admin_roles:ee.HIDE,admin_audit:ee.HIDE}},{id:"role_viewer",name:"Viewer",description:"Read-only access to inventory",isSystem:!1,permissions:{dashboard:ee.VIEW,gear_list:ee.VIEW,item_details:ee.VIEW,schedule:ee.VIEW,pack_lists:ee.VIEW,clients:ee.HIDE,search:ee.VIEW,labels:ee.HIDE,reports:ee.HIDE,admin_users:ee.HIDE,admin_categories:ee.HIDE,admin_specs:ee.HIDE,admin_locations:ee.HIDE,admin_themes:ee.HIDE,admin_layout:ee.HIDE,admin_notifications:ee.HIDE,admin_roles:ee.HIDE,admin_audit:ee.HIDE}}],M={DASHBOARD:"dashboard",GEAR_LIST:"inventory",GEAR_DETAIL:"detail",PACKAGES:"packages",PACKAGE_DETAIL:"pkg-detail",PACK_LISTS:"packlists",SCHEDULE:"schedule",SEARCH:"search",LABELS:"labels",RESERVATION_DETAIL:"reservation-detail",CLIENTS:"clients",CLIENT_DETAIL:"client-detail",CLIENT_REPORT:"client-report",ADMIN:"admin",USERS:"users",REPORTS:"reports",AUDIT_LOG:"auditlog",CHANGE_LOG:"changelog",OVERDUE:"overdue",NOTIFICATIONS:"notifications",MAINTENANCE_REPORT:"maintenance-report",INSURANCE_REPORT:"insurance-report",LOCATIONS_MANAGE:"locations-manage",ROLES_MANAGE:"roles-manage",KIT_DETAIL:"kit-detail",ADD_ITEM:"add-item",EDIT_SPECS:"edit-specs",EDIT_CATEGORIES:"edit-categories",CUSTOMIZE_DASHBOARD:"customize-dashboard",CUSTOMIZE_ITEM_DETAIL:"customize-item-detail",THEME_SELECTOR:"theme-selector"},ne={ADD_ITEM:"add-item",EDIT_ITEM:"edit-item",ADD_RESERVATION:"add-res",QR_CODE:"qr",QR_SCANNER:"qr-scanner",EXPORT:"export",PROFILE:"profile",IMAGE_SELECT:"image-select",IMAGE_PREVIEW:"image-preview",CSV_IMPORT:"csv-import",DATABASE_EXPORT:"database-export",CHECK_OUT:"check-out",CHECK_IN:"check-in",MAINTENANCE:"maintenance",BULK_STATUS:"bulk-status",BULK_LOCATION:"bulk-location",BULK_CATEGORY:"bulk-category",BULK_DELETE:"bulk-delete",ADD_USER:"add-user"},pa={STATS:{id:"stats",label:"Statistics",order:0},QUICK_SEARCH:{id:"quickSearch",label:"Quick Gear Search",order:1},ALERTS:{id:"alerts",label:"Alerts",order:2},REMINDERS:{id:"reminders",label:"Due Reminders",order:3},LOW_STOCK:{id:"lowStock",label:"Low Stock Items",order:4},RESERVATIONS:{id:"reservations",label:"Upcoming Reservations",order:5}},ga={SPECIFICATIONS:{id:"specifications",label:"Specifications",order:0},RESERVATIONS:{id:"reservations",label:"Reservations",order:1},NOTES:{id:"notes",label:"Notes",order:2},REMINDERS:{id:"reminders",label:"Reminders",order:3},REQUIRED_ACCESSORIES:{id:"requiredAccessories",label:"Required Accessories",order:4},PACKAGES:{id:"packages",label:"Packages",order:5},MAINTENANCE:{id:"maintenance",label:"Maintenance",order:6},TIMELINE:{id:"timeline",label:"Item Timeline",order:7},CHECKOUT_HISTORY:{id:"checkoutHistory",label:"Checkout History",order:8},VALUE:{id:"value",label:"Value & Purchase",order:9},DEPRECIATION:{id:"depreciation",label:"Depreciation",order:10}},tr=e=>{const n={};return Object.values(e).forEach(a=>{n[a.id]={visible:!0,collapsed:!1,order:a.order}}),n},nr={dashboard:{sections:tr(pa)},itemDetail:{sections:tr(ga)}},Me={AVAILABLE:"available",CHECKED_OUT:"checked-out",RESERVED:"reserved",NEEDS_ATTENTION:"needs-attention",MISSING:"missing",OVERDUE:"overdue",LOW_STOCK:"low-stock"},Zt={EXCELLENT:"excellent",GOOD:"good",FAIR:"fair",POOR:"poor"},Ar=["Cameras","Lenses","Lighting","Audio","Support","Accessories","Storage","Grip","Monitors","Power","Consumables"],rs={Cameras:"CA",Lenses:"LE",Lighting:"LI",Audio:"AU",Support:"SU",Accessories:"AC",Storage:"ST",Grip:"GR",Monitors:"MO",Power:"PW",Consumables:"CO"},is={Cameras:{trackQuantity:!1,trackSerialNumbers:!0,trackReorderPoint:!1,lowStockThreshold:0},Lenses:{trackQuantity:!1,trackSerialNumbers:!0,trackReorderPoint:!1,lowStockThreshold:0},Lighting:{trackQuantity:!0,trackSerialNumbers:!1,trackReorderPoint:!1,lowStockThreshold:2},Audio:{trackQuantity:!0,trackSerialNumbers:!1,trackReorderPoint:!1,lowStockThreshold:2},Support:{trackQuantity:!0,trackSerialNumbers:!1,trackReorderPoint:!1,lowStockThreshold:1},Accessories:{trackQuantity:!0,trackSerialNumbers:!1,trackReorderPoint:!1,lowStockThreshold:3},Storage:{trackQuantity:!0,trackSerialNumbers:!1,trackReorderPoint:!1,lowStockThreshold:5},Grip:{trackQuantity:!0,trackSerialNumbers:!1,trackReorderPoint:!1,lowStockThreshold:2},Monitors:{trackQuantity:!1,trackSerialNumbers:!0,trackReorderPoint:!1,lowStockThreshold:0},Power:{trackQuantity:!0,trackSerialNumbers:!1,trackReorderPoint:!1,lowStockThreshold:3},Consumables:{trackQuantity:!0,trackSerialNumbers:!1,trackReorderPoint:!0,lowStockThreshold:5}},gc={trackQuantity:!1,trackSerialNumbers:!0,trackReorderPoint:!1,lowStockThreshold:0},hc=["Wedding","Corporate","Documentary","Commercial","Music Video","Film","Event","Portrait","Other"],bc={LIST:"list",CALENDAR:"calendar"},yc={DAY:"day",WEEK:"week",MONTH:"month"},xc=[{id:"small",name:"Small - QR Only",width:1,height:1,description:"300x300px at 300dpi (square)"},{id:"medium",name:"Medium - QR + Info",width:2,height:1,description:"600x300px at 300dpi"},{id:"large",name:"Large - Full Details",width:3,height:2,description:"900x600px at 300dpi"},{id:"brandingText",name:"With Branding - Text",width:3,height:2.5,description:"900x750px at 300dpi"},{id:"brandingLogo",name:"With Branding - Logo",width:3,height:2.5,description:"900x750px at 300dpi"}],ss={Cameras:[{name:"Sensor Type",required:!0},{name:"Sensor Size",required:!0},{name:"Effective Pixels",required:!0},{name:"Image Processor",required:!1},{name:"Video Resolution",required:!1},{name:"Frame Rates",required:!1},{name:"Video Format",required:!1},{name:"Bit Depth",required:!1},{name:"Chroma Subsampling",required:!1},{name:"HDR Recording",required:!1},{name:"AF System",required:!1},{name:"AF Points",required:!1},{name:"AF Detection",required:!1},{name:"Mount Type",required:!0},{name:"Stabilization",required:!1},{name:"ISO Range",required:!1},{name:"Shutter Speed Range",required:!1},{name:"Continuous Shooting",required:!1},{name:"LCD Screen",required:!1},{name:"Viewfinder Type",required:!1},{name:"Viewfinder Coverage",required:!1},{name:"Memory Card Slots",required:!1},{name:"Card Types Supported",required:!1},{name:"Video Output",required:!1},{name:"Audio Input",required:!1},{name:"Wireless Connectivity",required:!1},{name:"Body Material",required:!1},{name:"Weather Sealing",required:!1},{name:"Dimensions",required:!1},{name:"Weight",required:!1},{name:"Battery Type",required:!1},{name:"Battery Life",required:!1}],Lenses:[{name:"Focal Length",required:!0},{name:"Maximum Aperture",required:!0},{name:"Minimum Aperture",required:!1},{name:"Lens Mount",required:!0},{name:"Lens Format Coverage",required:!1},{name:"Angle of View",required:!1},{name:"Optical Design",required:!1},{name:"Diaphragm Blades",required:!1},{name:"Minimum Focus Distance",required:!1},{name:"Maximum Magnification",required:!1},{name:"Autofocus",required:!1},{name:"AF Motor Type",required:!1},{name:"Full-Time Manual",required:!1},{name:"Focus Breathing",required:!1},{name:"Internal Focus",required:!1},{name:"Image Stabilization",required:!1},{name:"Stabilization Effect",required:!1},{name:"Filter Thread",required:!1},{name:"Dimensions",required:!1},{name:"Weight",required:!1},{name:"Hood Included",required:!1},{name:"Weather Sealing",required:!1},{name:"Front Diameter",required:!1},{name:"Focus Rotation",required:!1},{name:"Iris Rotation",required:!1},{name:"Focus Gear Position",required:!1}],Lighting:[{name:"Light Type",required:!0},{name:"Max Power Output",required:!0},{name:"Luminous Flux (lm)",required:!1},{name:"Illuminance (lux)",required:!1},{name:"CRI",required:!1},{name:"TLCI",required:!1},{name:"Color Temperature",required:!0},{name:"CCT Range",required:!1},{name:"Bi-Color",required:!1},{name:"RGB/HSI",required:!1},{name:"Gel/Filter Compatible",required:!1},{name:"Green/Magenta Adjustment",required:!1},{name:"Beam Angle",required:!1},{name:"Reflector Type",required:!1},{name:"Modifier Mount",required:!1},{name:"Barn Doors Included",required:!1},{name:"Dimming",required:!1},{name:"Dimming Range",required:!1},{name:"Strobe/Effects",required:!1},{name:"Control Method",required:!1},{name:"DMX",required:!1},{name:"Wireless Control",required:!1},{name:"App Control",required:!1},{name:"Power Input",required:!1},{name:"Power Draw",required:!1},{name:"Battery Compatible",required:!1},{name:"Battery Type",required:!1},{name:"Battery Runtime",required:!1},{name:"Cooling System",required:!1},{name:"Operating Temp",required:!1},{name:"Build Material",required:!1},{name:"Mount Type",required:!1},{name:"Dimensions",required:!1},{name:"Weight",required:!1}],Audio:[{name:"Microphone Type",required:!0},{name:"Transducer Type",required:!1},{name:"Polar Pattern",required:!0},{name:"Switchable Patterns",required:!1},{name:"Frequency Response",required:!1},{name:"Sensitivity",required:!1},{name:"Max SPL",required:!1},{name:"Self-Noise",required:!1},{name:"Signal-to-Noise Ratio",required:!1},{name:"Dynamic Range",required:!1},{name:"Bit Depth/Sample Rate",required:!1},{name:"Output Connector",required:!0},{name:"Impedance",required:!1},{name:"Phantom Power",required:!1},{name:"Wireless Frequency",required:!1},{name:"Wireless Range",required:!1},{name:"Channels",required:!1},{name:"Encryption",required:!1},{name:"Power Requirements",required:!1},{name:"Battery Type",required:!1},{name:"Battery Life",required:!1},{name:"Dimensions",required:!1},{name:"Weight",required:!1},{name:"Cable Length",required:!1}],Support:[{name:"Support Type",required:!0},{name:"Max Payload",required:!0},{name:"Max Height",required:!1},{name:"Min Height",required:!1},{name:"Folded Length",required:!1},{name:"Head Type",required:!1},{name:"Head Included",required:!1},{name:"Bowl Size",required:!1},{name:"Pan Range",required:!1},{name:"Tilt Range",required:!1},{name:"Counterbalance",required:!1},{name:"Leg Sections",required:!1},{name:"Leg Lock Type",required:!1},{name:"Spreader Type",required:!1},{name:"Spike/Rubber Feet",required:!1},{name:"Material",required:!1},{name:"Weight",required:!1},{name:"Load Capacity",required:!1},{name:"Center Column",required:!1}],Grip:[{name:"Grip Type",required:!0},{name:"Primary Use",required:!1},{name:"Max Load Capacity",required:!1},{name:"Working Load Limit",required:!1},{name:"Length",required:!1},{name:"Width",required:!1},{name:"Height",required:!1},{name:"Extended Length",required:!1},{name:"Collapsed Length",required:!1},{name:"Reach/Arm Length",required:!1},{name:"Mounting Hardware",required:!1},{name:"Receiver Size",required:!1},{name:"Pin/Spud Size",required:!1},{name:"Junior/Baby Pin",required:!1},{name:"Riser/Extension",required:!1},{name:"Leveling Leg",required:!1},{name:"Locking Mechanism",required:!1},{name:"Wheels/Casters",required:!1},{name:"Brakes",required:!1},{name:"Material",required:!1},{name:"Finish",required:!1},{name:"Weight",required:!1},{name:"Frame Size",required:!1},{name:"Fabric Type",required:!1},{name:"Diffusion Rating",required:!1}],Accessories:[{name:"Accessory Type",required:!0},{name:"Compatibility",required:!1},{name:"Material",required:!1},{name:"Dimensions",required:!1},{name:"Weight",required:!1},{name:"Color/Finish",required:!1},{name:"Mounting Type",required:!1},{name:"Thread Size",required:!1}],Storage:[{name:"Storage Type",required:!0},{name:"Capacity",required:!0},{name:"Interface",required:!1},{name:"Read Speed",required:!1},{name:"Write Speed",required:!1},{name:"Video Speed Class",required:!1},{name:"UHS Speed Class",required:!1},{name:"Min Sustained Write",required:!1},{name:"Form Factor",required:!1},{name:"Operating Temp",required:!1},{name:"Dimensions",required:!1},{name:"Weight",required:!1}],Monitors:[{name:"Screen Size",required:!0},{name:"Resolution",required:!0},{name:"Panel Type",required:!1},{name:"Pixel Density",required:!1},{name:"Aspect Ratio",required:!1},{name:"Brightness",required:!1},{name:"Contrast Ratio",required:!1},{name:"Color Depth",required:!1},{name:"Color Gamut",required:!1},{name:"HDR Support",required:!1},{name:"LUT Support",required:!1},{name:"Viewing Angle",required:!1},{name:"Touchscreen",required:!1},{name:"Focus Assist",required:!1},{name:"False Color",required:!1},{name:"Waveform/Scopes",required:!1},{name:"Zebras",required:!1},{name:"Anamorphic Desqueeze",required:!1},{name:"HDMI Input",required:!1},{name:"SDI Input",required:!1},{name:"HDMI Output",required:!1},{name:"SDI Output",required:!1},{name:"Power Input",required:!1},{name:"Battery Plate",required:!1},{name:"Power Draw",required:!1},{name:"Mounting Points",required:!1},{name:"Dimensions",required:!1},{name:"Weight",required:!1}],Power:[{name:"Battery Type",required:!0},{name:"Chemistry",required:!1},{name:"Capacity (Wh)",required:!0},{name:"Capacity (mAh)",required:!1},{name:"Voltage",required:!0},{name:"Max Discharge",required:!1},{name:"D-Tap Outputs",required:!1},{name:"USB Outputs",required:!1},{name:"DC Outputs",required:!1},{name:"Regulated Outputs",required:!1},{name:"Charge Time",required:!1},{name:"Charger Included",required:!1},{name:"LED Indicator",required:!1},{name:"Runtime Display",required:!1},{name:"Hot Swappable",required:!1},{name:"Mount Type",required:!1},{name:"Dimensions",required:!1},{name:"Weight",required:!1},{name:"Protection Circuits",required:!1},{name:"Airline Approved",required:!1}],Consumables:[{name:"Type",required:!0},{name:"Size/Dimensions",required:!1},{name:"Color",required:!1},{name:"Unit of Measure",required:!1},{name:"Units per Package",required:!1},{name:"Compatible With",required:!1},{name:"Expiration Date",required:!1},{name:"Storage Requirements",required:!1}]},Sc=["Repair","Cleaning","Calibration","Firmware Update","Parts Replacement","Inspection","Preventive Maintenance","Other"],ze={SCHEDULED:"scheduled",IN_PROGRESS:"in-progress",COMPLETED:"completed",CANCELLED:"cancelled"},pn={name:"",brand:"",category:"Cameras",location:"",purchaseDate:"",purchasePrice:"",currentValue:"",serialNumber:"",condition:Zt.EXCELLENT,image:null,specs:{},quantity:1,reorderPoint:0},gn={start:"",end:"",project:"",projectType:"Other",user:"",contactPhone:"",contactEmail:"",location:"",notes:[],itemId:"",itemIds:[],clientId:""},kc=[{value:"building",label:"Building",icon:"Building2"},{value:"room",label:"Room",icon:"Door"},{value:"cabinet",label:"Cabinet/Closet",icon:"Archive"},{value:"shelf",label:"Shelf/Rack",icon:"Layers"},{value:"case",label:"Case/Container",icon:"Box"},{value:"external",label:"External Location",icon:"MapPin"}],Kn=()=>{},yn=()=>{},X=console.error.bind(console),o={bgDark:"var(--bg-dark)",bgMedium:"var(--bg-medium)",bgLight:"var(--bg-light)",bgCard:"var(--bg-card)",primary:"var(--primary)",primaryDark:"var(--primary-dark)",accent1:"var(--accent1)",accent2:"var(--accent2)",accent3:"var(--accent3)",available:"var(--status-available)",checkedOut:"var(--status-checked-out)",reserved:"var(--status-reserved)",needsAttention:"var(--status-needs-attention)",missing:"var(--status-missing)",excellent:"var(--condition-excellent)",good:"var(--condition-good)",fair:"var(--condition-fair)",poor:"var(--condition-poor)",textPrimary:"var(--text-primary)",textSecondary:"var(--text-secondary)",textMuted:"var(--text-muted)",border:"var(--border)",borderLight:"var(--border-light)",danger:"var(--danger)",success:"var(--success)",warning:"var(--warning)"},te=(e,n)=>e?e.startsWith("#")?`color-mix(in srgb, ${e} ${n}%, transparent)`:`color-mix(in srgb, ${e} ${n}%, transparent)`:"transparent",b={fontFamily:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',fontSize:{xs:"10px",sm:"12px",base:"14px",md:"15px",lg:"16px","2xl":"20px","3xl":"24px"},fontWeight:{normal:400,medium:500,semibold:600,bold:700}},c={0:0,1:4,2:8,3:12,4:16,5:20,6:24,8:32,10:40,12:48,16:64},F={sm:"4px",md:"8px",lg:"10px",xl:"12px","2xl":"16px",full:"9999px"},ar={lg:"var(--shadow-lg)",card:"var(--shadow-card)"},Ca={base:0,dropdown:100,modal:500},rr={fast:"150ms ease"},me={card:{background:o.bgLight,backdropFilter:"blur(10px)",borderRadius:F.xl,border:`1px solid ${o.border}`,boxShadow:ar.card},btn:{display:"flex",alignItems:"center",gap:c[2],background:`linear-gradient(135deg, ${o.primary}, ${o.primaryDark})`,color:o.textPrimary,border:"none",padding:`${c[2]}px ${c[4]}px`,borderRadius:F.lg,cursor:"pointer",fontWeight:b.fontWeight.medium,fontSize:b.fontSize.sm,transition:rr.fast},btnSec:{display:"flex",alignItems:"center",gap:c[2],background:"transparent",color:o.textPrimary,border:`1px solid ${o.border}`,padding:`${c[2]}px ${c[3]}px`,borderRadius:F.lg,cursor:"pointer",fontSize:b.fontSize.sm,transition:rr.fast},input:{width:"100%",padding:`${c[3]}px ${c[4]}px`,background:"var(--input-bg, rgba(93, 138, 168, 0.1))",border:`1px solid ${o.border}`,borderRadius:F.lg,color:o.textPrimary,fontSize:b.fontSize.base,fontFamily:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',outline:"none",boxSizing:"border-box"},label:{display:"block",fontSize:b.fontSize.xs,color:o.textMuted,textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:c[2]},modal:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:Ca.modal,padding:c[4]},modalBox:{background:o.bgMedium,borderRadius:F.xl,border:`1px solid ${o.border}`,maxWidth:"500px",width:"100%",maxHeight:"90vh",overflow:"hidden",boxShadow:ar.lg}},Tr=(e,n=[])=>{const a=rs[e]||"OT";let r,i=0;const l=100,m=n||[];do r=a+Math.floor(1e3+Math.random()*9e3),i++;while(m.includes(r)&&i<l);return i>=l&&(r=a+Date.now().toString().slice(-4)),r},wt=()=>`id_${Date.now()}_${Math.random().toString(36).substring(2,11)}`,He=e=>{if(!e)return"-";try{const n=new Date(e);return isNaN(n.getTime())?"-":n.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch{return"-"}},os=e=>{if(!e)return"-";try{const n=new Date(e);return isNaN(n.getTime())?"-":n.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return"-"}},Ye=()=>new Date().toISOString().split("T")[0],Rr=(e,n,a,r)=>!e||!n||!a||!r?!1:e<=r&&a<=n,ls=(e,n,a,r=null)=>!e||!n||!a?[]:e.filter(i=>r&&i.id===r?!1:Rr(n,a,i.start,i.end)),cs=(e,n,a)=>!e||e.status!=="checked-out"||!e.checkedOutDate?null:e.dueBack?Rr(n,a,e.checkedOutDate,e.dueBack)?{type:"checked-out",borrower:e.checkedOutTo,checkedOutDate:e.checkedOutDate,dueBack:e.dueBack,message:`Checked out to ${e.checkedOutTo} until ${e.dueBack}`}:null:{type:"checked-out",borrower:e.checkedOutTo,checkedOutDate:e.checkedOutDate,dueBack:null,message:`Currently checked out to ${e.checkedOutTo} (no return date set)`},vc=(e,n,a,r=null)=>{if(!e)return{reservationConflicts:[],checkoutConflict:null};const i=ls(e.reservations||[],n,a,r),l=cs(e,n,a);return{reservationConflicts:i,checkoutConflict:l,hasConflicts:i.length>0||l!==null}},Ve=e=>"$"+(e||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}),Bt=e=>({[Me.AVAILABLE]:o.available,[Me.CHECKED_OUT]:o.checkedOut,[Me.RESERVED]:o.reserved,[Me.NEEDS_ATTENTION]:o.needsAttention,[Me.MISSING]:o.missing})[e]||o.textMuted,ds=e=>({[Zt.EXCELLENT]:o.excellent,[Zt.GOOD]:o.good,[Zt.FAIR]:o.fair,[Zt.POOR]:o.poor})[e]||o.textMuted,je=(e,n,a)=>e.map(r=>r.id!==n?r:typeof a=="function"?{...r,...a(r)}:{...r,...a}),us=(e,n)=>e.filter(a=>a.id!==n),ms=(e,n)=>e.find(a=>a.id===n),fs=(e,n,a=["name","brand","id"])=>{if(!n?.trim())return e;const r=n.toLowerCase().trim();return e.filter(i=>a.some(l=>i[l]?.toString().toLowerCase().includes(r)))},ps=(e,n)=>{if(!n||n==="all")return e;const a=Array.isArray(n)?n:[n];return a.length===0?e:e.filter(r=>a.includes(r.category))},gs=(e,n)=>{if(!n||n==="all")return e;const a=Array.isArray(n)?n:[n];if(a.length===0)return e;if(a.includes("overdue")){const r=Ye();return e.filter(i=>i.status==="checked-out"&&i.dueBack&&i.dueBack<r)}return e.filter(r=>a.includes(r.status))},ha=(e,n,a)=>e.map(r=>r.id===n?{...r,replies:[...r.replies||[],a]}:r.replies?.length>0?{...r,replies:ha(r.replies,n,a)}:r),ba=(e,n)=>e.map(a=>a.id===n?{...a,deleted:!0}:a.replies?.length>0?{...a,replies:ba(a.replies,n)}:a),Pr=(e,n)=>{for(const a of e){if(a.id===n)return a;if(a.replies?.length>0){const r=Pr(a.replies,n);if(r)return r}}return null},hs=(e,n="")=>{const a=[];return e.forEach(r=>{const i=n?`${n} > ${r.name}`:r.name;a.push({id:r.id,name:r.name,fullPath:i,type:r.type,depth:n.split(">").length-1+(n?1:0)}),r.children&&r.children.length>0&&a.push(...hs(r.children,i))}),a},Fn=e=>{if(!e||e.completed)return!1;const n=Ye();return e.dueDate<=n},Lt={STRAIGHT_LINE:"straight-line",DECLINING_BALANCE:"declining-balance",DOUBLE_DECLINING:"double-declining"},bs={Cameras:5,Lenses:7,Lighting:7,Audio:6,Support:10,Accessories:3,Storage:3,Grip:10,Monitors:5,Power:4},ys=(e,n,a,r,i)=>{if(!n)return{currentValue:e,totalDepreciation:0,annualDepreciation:0,monthlyDepreciation:0,ageInMonths:0,percentDepreciated:0,schedule:[]};const l=new Date(n),d=(new Date-l)/(365.25*24*60*60*1e3),f=Math.floor(d*12),h=e-r;let u,g,p,k,y=[];switch(i){case Lt.STRAIGHT_LINE:g=h/a,p=g/12,k=Math.min(d*g,h),u=Math.max(e-k,r);for(let x=1;x<=a;x++){const S=new Date(l);S.setFullYear(S.getFullYear()+x);const j=e-g*(x-1),z=Math.max(j-g,r);y.push({year:x,date:S.toISOString().split("T")[0],startValue:j,depreciation:j-z,endValue:z,accumulated:e-z})}break;case Lt.DECLINING_BALANCE:{const x=1/a*1.5;let S=e;k=0;for(let j=1;j<=a;j++){const z=new Date(l);z.setFullYear(z.getFullYear()+j);const A=S;let I=A*x;S-I<r&&(I=S-r),S=A-I,j<=Math.ceil(d)&&(j<Math.ceil(d)?k+=I:k+=I*(d-Math.floor(d))),y.push({year:j,date:z.toISOString().split("T")[0],startValue:A,depreciation:I,endValue:S,accumulated:e-S})}u=Math.max(e-k,r),g=y[0]?.depreciation||0,p=g/12;break}case Lt.DOUBLE_DECLINING:{const x=1/a*2;let S=e;k=0;for(let j=1;j<=a;j++){const z=new Date(l);z.setFullYear(z.getFullYear()+j);const A=S;let I=A*x;const L=(S-r)/(a-j+1);L>I&&(I=L),S-I<r&&(I=S-r),S=A-I,j<=Math.ceil(d)&&(j<Math.ceil(d)?k+=I:k+=I*(d-Math.floor(d))),y.push({year:j,date:z.toISOString().split("T")[0],startValue:A,depreciation:I,endValue:S,accumulated:e-S})}u=Math.max(e-k,r),g=y[0]?.depreciation||0,p=g/12;break}default:u=e,g=0,p=0,k=0}return{currentValue:u,totalDepreciation:k,annualDepreciation:g,monthlyDepreciation:p,ageInYears:d,ageInMonths:f,schedule:y,percentDepreciated:k/h*100}},wc={backgrounds:{label:"Backgrounds",colors:[{key:"--bg-dark",label:"Main Background"},{key:"--bg-medium",label:"Medium Background"},{key:"--bg-light",label:"Light Background"},{key:"--bg-card",label:"Card Background"}]},primary:{label:"Primary Colors",colors:[{key:"--primary",label:"Primary"},{key:"--primary-light",label:"Primary Light"},{key:"--primary-dark",label:"Primary Dark"}]},accents:{label:"Accent Colors",colors:[{key:"--accent1",label:"Accent 1"},{key:"--accent2",label:"Accent 2"},{key:"--accent3",label:"Accent 3"},{key:"--accent4",label:"Accent 4"},{key:"--accent5",label:"Accent 5"},{key:"--accent6",label:"Accent 6"}]},text:{label:"Text Colors",colors:[{key:"--text-primary",label:"Primary Text"},{key:"--text-secondary",label:"Secondary Text"},{key:"--text-muted",label:"Muted Text"}]},status:{label:"Status Colors",colors:[{key:"--status-available",label:"Available"},{key:"--status-checked-out",label:"Checked Out"},{key:"--status-reserved",label:"Reserved"},{key:"--status-needs-attention",label:"Needs Attention"},{key:"--status-missing",label:"Missing"}]},feedback:{label:"Feedback Colors",colors:[{key:"--danger",label:"Danger"},{key:"--success",label:"Success"},{key:"--warning",label:"Warning"}]},accessibility:{label:"Accessibility",colors:[{key:"--focus-ring-color",label:"Focus Ring Color"},{key:"--focus-ring-color-danger",label:"Focus Ring (Danger)"}]},panels:{label:"Dashboard Panels",colors:[{key:"--panel-stats",label:"Statistics"},{key:"--panel-search",label:"Quick Search"},{key:"--panel-alerts",label:"Alerts"},{key:"--panel-reminders",label:"Reminders"},{key:"--panel-lowstock",label:"Low Stock"},{key:"--panel-reservations",label:"Reservations"}]}},Rt={"--bg-dark":"#1a1d21","--bg-medium":"#22262b","--bg-light":"#2a2f36","--bg-card":"#22262b","--bg-card-solid":"#22262b","--primary":"#5d8aa8","--primary-light":"#7ba3be","--primary-dark":"#4a7089","--accent1":"#6b9e9e","--accent2":"#7a8f7a","--accent3":"#8fa5b5","--accent4":"#a58f8f","--accent5":"#9e9e6b","--accent6":"#8f7aa5","--status-available":"#6b9e78","--status-checked-out":"#8fa5b5","--status-reserved":"#5d8aa8","--status-needs-attention":"#b58f6b","--status-missing":"#9e6b6b","--condition-excellent":"#6b9e78","--condition-good":"#7a8f7a","--condition-fair":"#b5a56b","--condition-poor":"#b58f6b","--text-primary":"#e2e6ea","--text-secondary":"rgba(226, 230, 234, 0.65)","--text-muted":"rgba(226, 230, 234, 0.4)","--border":"rgba(93, 138, 168, 0.2)","--border-light":"rgba(93, 138, 168, 0.1)","--danger":"#b56b6b","--danger-bg":"rgba(181, 107, 107, 0.1)","--success":"#6b9e78","--warning":"#b5a56b","--focus-ring-color":"#8bb5cc","--focus-ring-color-danger":"#d08080","--sidebar-item1":"#5d8aa8","--sidebar-item2":"#6b9e9e","--sidebar-item3":"#7a8f7a","--sidebar-item4":"#8fa5b5","--sidebar-item5":"#a58f8f","--sidebar-item6":"#9e9e6b","--panel-stats":"#5d8aa8","--panel-search":"#6b9e9e","--panel-alerts":"#b58f6b","--panel-reminders":"#b5a56b","--panel-lowstock":"#9e6b6b","--panel-reservations":"#8fa5b5","--shadow-sm":"0 1px 2px rgba(0, 0, 0, 0.3)","--shadow-md":"0 4px 6px rgba(0, 0, 0, 0.3)","--shadow-lg":"0 10px 15px rgba(0, 0, 0, 0.3)","--shadow-card":"0 4px 20px rgba(0, 0, 0, 0.25)"},St=(e=.3)=>({"--shadow-sm":`0 1px 2px rgba(0, 0, 0, ${e})`,"--shadow-md":`0 4px 6px rgba(0, 0, 0, ${e})`,"--shadow-lg":`0 10px 15px rgba(0, 0, 0, ${e})`,"--shadow-card":`0 4px 20px rgba(0, 0, 0, ${e-.05})`}),Xt={light:{id:"light",name:"Light",description:"Clean, standard light theme",colors:{"--bg-dark":"#f0f2f5","--bg-medium":"#ffffff","--bg-light":"#f8f9fa","--bg-card":"#ffffff","--bg-card-solid":"#ffffff","--primary":"#2563eb","--primary-light":"#3b82f6","--primary-dark":"#1d4ed8","--accent1":"#0891b2","--accent2":"#059669","--accent3":"#7c3aed","--accent4":"#db2777","--accent5":"#ea580c","--accent6":"#65a30d","--status-available":"#16a34a","--status-checked-out":"#2563eb","--status-reserved":"#7c3aed","--status-needs-attention":"#ea580c","--status-missing":"#dc2626","--condition-excellent":"#16a34a","--condition-good":"#22c55e","--condition-fair":"#eab308","--condition-poor":"#ea580c","--text-primary":"#1f2937","--text-secondary":"#4b5563","--text-muted":"#9ca3af","--border":"#e5e7eb","--border-light":"#f3f4f6","--danger":"#dc2626","--danger-bg":"rgba(220, 38, 38, 0.1)","--success":"#16a34a","--warning":"#eab308","--sidebar-item1":"#2563eb","--sidebar-item2":"#0891b2","--sidebar-item3":"#059669","--sidebar-item4":"#7c3aed","--sidebar-item5":"#db2777","--sidebar-item6":"#ea580c","--panel-stats":"#2563eb","--panel-search":"#0891b2","--panel-alerts":"#ea580c","--panel-reminders":"#eab308","--panel-lowstock":"#dc2626","--panel-reservations":"#7c3aed",...St(.08)}},dark:{id:"dark",name:"Dark",description:"Default dark theme with muted blue accents",colors:{...Rt}},darker:{id:"darker",name:"Darker",description:"Pure black backgrounds with grey accents",colors:{"--bg-dark":"#000000","--bg-medium":"#0a0a0a","--bg-light":"#141414","--bg-card":"#0a0a0a","--bg-card-solid":"#0a0a0a","--primary":"#666666","--primary-light":"#888888","--primary-dark":"#444444","--accent1":"#555555","--accent2":"#666666","--accent3":"#777777","--accent4":"#888888","--accent5":"#999999","--accent6":"#aaaaaa","--status-available":"#4a4a4a","--status-checked-out":"#5a5a5a","--status-reserved":"#6a6a6a","--status-needs-attention":"#7a7a7a","--status-missing":"#8a8a8a","--condition-excellent":"#4a4a4a","--condition-good":"#5a5a5a","--condition-fair":"#6a6a6a","--condition-poor":"#7a7a7a","--text-primary":"#999999","--text-secondary":"#777777","--text-muted":"#555555","--border":"#333333","--border-light":"#222222","--danger":"#666666","--danger-bg":"rgba(102, 102, 102, 0.1)","--success":"#555555","--warning":"#777777","--sidebar-item1":"#666666","--sidebar-item2":"#666666","--sidebar-item3":"#666666","--sidebar-item4":"#666666","--sidebar-item5":"#666666","--sidebar-item6":"#666666","--panel-stats":"#444444","--panel-search":"#444444","--panel-alerts":"#444444","--panel-reminders":"#444444","--panel-lowstock":"#444444","--panel-reservations":"#444444",...St(.5)}},primaries:{id:"primaries",name:"Primaries",description:"Bright primary colors like children's toys",colors:{"--bg-dark":"#ffeb3b","--bg-medium":"#fff59d","--bg-light":"#fffde7","--bg-card":"#ffffff","--bg-card-solid":"#ffffff","--primary":"#f44336","--primary-light":"#e57373","--primary-dark":"#c62828","--accent1":"#2196f3","--accent2":"#4caf50","--accent3":"#ff9800","--accent4":"#9c27b0","--accent5":"#00bcd4","--accent6":"#e91e63","--status-available":"#4caf50","--status-checked-out":"#2196f3","--status-reserved":"#9c27b0","--status-needs-attention":"#ff9800","--status-missing":"#f44336","--condition-excellent":"#4caf50","--condition-good":"#8bc34a","--condition-fair":"#ffeb3b","--condition-poor":"#ff9800","--text-primary":"#1a1a1a","--text-secondary":"#333333","--text-muted":"#666666","--border":"#f44336","--border-light":"#ffcdd2","--danger":"#f44336","--danger-bg":"rgba(244, 67, 54, 0.15)","--success":"#4caf50","--warning":"#ff9800","--sidebar-item1":"#f44336","--sidebar-item2":"#2196f3","--sidebar-item3":"#4caf50","--sidebar-item4":"#ff9800","--sidebar-item5":"#9c27b0","--sidebar-item6":"#00bcd4","--panel-stats":"#2196f3","--panel-search":"#4caf50","--panel-alerts":"#ff9800","--panel-reminders":"#9c27b0","--panel-lowstock":"#f44336","--panel-reservations":"#00bcd4","--shadow-sm":"0 2px 4px rgba(244, 67, 54, 0.3)","--shadow-md":"0 4px 8px rgba(33, 150, 243, 0.3)","--shadow-lg":"0 10px 20px rgba(76, 175, 80, 0.3)","--shadow-card":"0 4px 20px rgba(156, 39, 176, 0.25)"}},pastel:{id:"pastel",name:"Pastel",description:"Soft, pleasing pastel tones",colors:{"--bg-dark":"#fdf2f8","--bg-medium":"#fefefe","--bg-light":"#f5f3ff","--bg-card":"#ffffff","--bg-card-solid":"#ffffff","--primary":"#a78bfa","--primary-light":"#c4b5fd","--primary-dark":"#8b5cf6","--accent1":"#67e8f9","--accent2":"#86efac","--accent3":"#fda4af","--accent4":"#fdba74","--accent5":"#fde047","--accent6":"#a5b4fc","--status-available":"#86efac","--status-checked-out":"#93c5fd","--status-reserved":"#c4b5fd","--status-needs-attention":"#fdba74","--status-missing":"#fca5a5","--condition-excellent":"#86efac","--condition-good":"#a7f3d0","--condition-fair":"#fde68a","--condition-poor":"#fed7aa","--text-primary":"#374151","--text-secondary":"#6b7280","--text-muted":"#9ca3af","--border":"#e9d5ff","--border-light":"#f3e8ff","--danger":"#f9a8d4","--danger-bg":"rgba(249, 168, 212, 0.2)","--success":"#86efac","--warning":"#fde68a","--sidebar-item1":"#a78bfa","--sidebar-item2":"#67e8f9","--sidebar-item3":"#86efac","--sidebar-item4":"#fda4af","--sidebar-item5":"#fdba74","--sidebar-item6":"#a5b4fc","--panel-stats":"#a78bfa","--panel-search":"#67e8f9","--panel-alerts":"#fdba74","--panel-reminders":"#fde047","--panel-lowstock":"#fda4af","--panel-reservations":"#a5b4fc",...St(.1)}},terminal:{id:"terminal",name:"Terminal",description:"80s hacker computer aesthetic",colors:{"--bg-dark":"#0a0a0a","--bg-medium":"#0d0d0d","--bg-light":"#111111","--bg-card":"#0d0d0d","--bg-card-solid":"#0d0d0d","--primary":"#00ff00","--primary-light":"#33ff33","--primary-dark":"#00cc00","--accent1":"#00ff00","--accent2":"#00dd00","--accent3":"#00bb00","--accent4":"#00ff66","--accent5":"#66ff00","--accent6":"#00ffaa","--status-available":"#00ff00","--status-checked-out":"#00cc00","--status-reserved":"#00aa00","--status-needs-attention":"#ffff00","--status-missing":"#ff0000","--condition-excellent":"#00ff00","--condition-good":"#00dd00","--condition-fair":"#ccff00","--condition-poor":"#ffcc00","--text-primary":"#00ff00","--text-secondary":"#00cc00","--text-muted":"#008800","--border":"#00ff00","--border-light":"#004400","--danger":"#ff0000","--danger-bg":"rgba(255, 0, 0, 0.1)","--success":"#00ff00","--warning":"#ffff00","--sidebar-item1":"#00ff00","--sidebar-item2":"#00ff66","--sidebar-item3":"#00ffaa","--sidebar-item4":"#66ff00","--sidebar-item5":"#00dd00","--sidebar-item6":"#00cc00","--panel-stats":"#00ff00","--panel-search":"#00ff66","--panel-alerts":"#ffff00","--panel-reminders":"#00ffaa","--panel-lowstock":"#ff0000","--panel-reservations":"#66ff00","--shadow-sm":"0 0 5px rgba(0, 255, 0, 0.3)","--shadow-md":"0 0 10px rgba(0, 255, 0, 0.3)","--shadow-lg":"0 0 20px rgba(0, 255, 0, 0.3)","--shadow-card":"0 0 15px rgba(0, 255, 0, 0.2)"},fontFamily:'"Courier New", Courier, monospace'},blackwhite:{id:"blackwhite",name:"Black & White",description:"Pure grayscale aesthetic",colors:{"--bg-dark":"#ffffff","--bg-medium":"#fafafa","--bg-light":"#f5f5f5","--bg-card":"#ffffff","--bg-card-solid":"#ffffff","--primary":"#333333","--primary-light":"#555555","--primary-dark":"#111111","--accent1":"#444444","--accent2":"#666666","--accent3":"#888888","--accent4":"#555555","--accent5":"#777777","--accent6":"#999999","--status-available":"#333333","--status-checked-out":"#555555","--status-reserved":"#777777","--status-needs-attention":"#999999","--status-missing":"#111111","--condition-excellent":"#222222","--condition-good":"#444444","--condition-fair":"#777777","--condition-poor":"#999999","--text-primary":"#000000","--text-secondary":"#333333","--text-muted":"#888888","--border":"#cccccc","--border-light":"#eeeeee","--danger":"#000000","--danger-bg":"rgba(0, 0, 0, 0.05)","--success":"#333333","--warning":"#666666","--sidebar-item1":"#333333","--sidebar-item2":"#444444","--sidebar-item3":"#555555","--sidebar-item4":"#666666","--sidebar-item5":"#777777","--sidebar-item6":"#888888","--panel-stats":"#333333","--panel-search":"#555555","--panel-alerts":"#777777","--panel-reminders":"#444444","--panel-lowstock":"#222222","--panel-reservations":"#666666",...St(.1)}},vibrant:{id:"vibrant",name:"Vibrant",description:"Bold, saturated complementary colors",colors:{"--bg-dark":"#1a0a2e","--bg-medium":"#16213e","--bg-light":"#1f3460","--bg-card":"#16213e","--bg-card-solid":"#16213e","--primary":"#ff006e","--primary-light":"#ff4d94","--primary-dark":"#cc0058","--accent1":"#00f5d4","--accent2":"#fee440","--accent3":"#9b5de5","--accent4":"#00bbf9","--accent5":"#f15bb5","--accent6":"#00ff87","--status-available":"#00f5d4","--status-checked-out":"#00bbf9","--status-reserved":"#9b5de5","--status-needs-attention":"#fee440","--status-missing":"#f15bb5","--condition-excellent":"#00f5d4","--condition-good":"#00bbf9","--condition-fair":"#fee440","--condition-poor":"#f15bb5","--text-primary":"#ffffff","--text-secondary":"rgba(255, 255, 255, 0.8)","--text-muted":"rgba(255, 255, 255, 0.5)","--border":"rgba(255, 0, 110, 0.3)","--border-light":"rgba(255, 0, 110, 0.15)","--danger":"#f15bb5","--danger-bg":"rgba(241, 91, 181, 0.15)","--success":"#00f5d4","--warning":"#fee440","--sidebar-item1":"#ff006e","--sidebar-item2":"#00f5d4","--sidebar-item3":"#fee440","--sidebar-item4":"#9b5de5","--sidebar-item5":"#00bbf9","--sidebar-item6":"#f15bb5","--panel-stats":"#00f5d4","--panel-search":"#00bbf9","--panel-alerts":"#fee440","--panel-reminders":"#9b5de5","--panel-lowstock":"#f15bb5","--panel-reservations":"#ff006e","--shadow-sm":"0 1px 3px rgba(255, 0, 110, 0.4)","--shadow-md":"0 4px 8px rgba(0, 245, 212, 0.3)","--shadow-lg":"0 10px 20px rgba(155, 93, 229, 0.3)","--shadow-card":"0 4px 25px rgba(155, 93, 229, 0.4)"}},muted:{id:"muted",name:"Muted",description:"Soft, desaturated tones",colors:{"--bg-dark":"#2d2d3a","--bg-medium":"#363646","--bg-light":"#404052","--bg-card":"#363646","--bg-card-solid":"#363646","--primary":"#9d8189","--primary-light":"#b8a1a8","--primary-dark":"#7d656b","--accent1":"#7ec8b8","--accent2":"#c9b896","--accent3":"#8b7eb8","--accent4":"#7eb8c8","--accent5":"#b87e8b","--accent6":"#96c9a8","--status-available":"#7ec8b8","--status-checked-out":"#7eb8c8","--status-reserved":"#8b7eb8","--status-needs-attention":"#c9b896","--status-missing":"#b87e8b","--condition-excellent":"#7ec8b8","--condition-good":"#96c9a8","--condition-fair":"#c9c196","--condition-poor":"#c9a896","--text-primary":"#e8e4e6","--text-secondary":"rgba(232, 228, 230, 0.7)","--text-muted":"rgba(232, 228, 230, 0.45)","--border":"rgba(157, 129, 137, 0.25)","--border-light":"rgba(157, 129, 137, 0.12)","--danger":"#b87e8b","--danger-bg":"rgba(184, 126, 139, 0.12)","--success":"#7ec8b8","--warning":"#c9b896","--sidebar-item1":"#9d8189","--sidebar-item2":"#7ec8b8","--sidebar-item3":"#c9b896","--sidebar-item4":"#8b7eb8","--sidebar-item5":"#7eb8c8","--sidebar-item6":"#b87e8b","--panel-stats":"#7ec8b8","--panel-search":"#7eb8c8","--panel-alerts":"#c9b896","--panel-reminders":"#8b7eb8","--panel-lowstock":"#b87e8b","--panel-reservations":"#9d8189",...St(.25)}},xp:{id:"xp",name:"XP",description:"Windows XP nostalgia",colors:{"--bg-dark":"#3a6ea5","--bg-medium":"#ece9d8","--bg-light":"#f5f4ea","--bg-card":"#ece9d8","--bg-card-solid":"#ece9d8","--primary":"#0054e3","--primary-light":"#3399ff","--primary-dark":"#003399","--accent1":"#21a121","--accent2":"#ff8c00","--accent3":"#cc0099","--accent4":"#0099cc","--accent5":"#ff6600","--accent6":"#9933ff","--status-available":"#21a121","--status-checked-out":"#0054e3","--status-reserved":"#ff8c00","--status-needs-attention":"#ff8c00","--status-missing":"#cc0000","--condition-excellent":"#21a121","--condition-good":"#66cc66","--condition-fair":"#ffcc00","--condition-poor":"#ff8c00","--text-primary":"#000000","--text-secondary":"#333333","--text-muted":"#808080","--border":"#7f9db9","--border-light":"#d4d0c8","--danger":"#cc0000","--danger-bg":"rgba(204, 0, 0, 0.1)","--success":"#21a121","--warning":"#ff8c00","--sidebar-item1":"#0054e3","--sidebar-item2":"#21a121","--sidebar-item3":"#ff8c00","--sidebar-item4":"#cc0099","--sidebar-item5":"#0099cc","--sidebar-item6":"#9933ff","--panel-stats":"#0054e3","--panel-search":"#21a121","--panel-alerts":"#ff8c00","--panel-reminders":"#cc0099","--panel-lowstock":"#cc0000","--panel-reservations":"#0099cc","--shadow-sm":"1px 1px 0 #808080, inset 1px 1px 0 #ffffff","--shadow-md":"2px 2px 0 #808080, inset 1px 1px 0 #ffffff","--shadow-lg":"3px 3px 0 #808080, inset 1px 1px 0 #ffffff","--shadow-card":"2px 2px 5px rgba(0, 0, 0, 0.3)"},buttonStyle:"xp"},cheese:{id:"cheese",name:"Cheese",description:"For the cheese enthusiasts üßÄ",colors:{"--bg-dark":"#ffd54f","--bg-medium":"#ffecb3","--bg-light":"#fff8e1","--bg-card":"#fffde7","--bg-card-solid":"#fffde7","--primary":"#ff8f00","--primary-light":"#ffa726","--primary-dark":"#e65100","--accent1":"#ffcc80","--accent2":"#ffe082","--accent3":"#ffab40","--accent4":"#ffd180","--accent5":"#ffb74d","--accent6":"#ffca28","--status-available":"#ffc107","--status-checked-out":"#ff9800","--status-reserved":"#ffab40","--status-needs-attention":"#e65100","--status-missing":"#bf360c","--condition-excellent":"#ffc107","--condition-good":"#ffca28","--condition-fair":"#ffa000","--condition-poor":"#ff6f00","--text-primary":"#4e342e","--text-secondary":"#5d4037","--text-muted":"#8d6e63","--border":"#ffb74d","--border-light":"#ffe0b2","--danger":"#bf360c","--danger-bg":"rgba(191, 54, 12, 0.1)","--success":"#ffc107","--warning":"#ff9800","--sidebar-item1":"#ff8f00","--sidebar-item2":"#ffa726","--sidebar-item3":"#ffb74d","--sidebar-item4":"#ffca28","--sidebar-item5":"#ffd54f","--sidebar-item6":"#ffe082","--panel-stats":"#ff8f00","--panel-search":"#ffa726","--panel-alerts":"#e65100","--panel-reminders":"#ffb74d","--panel-lowstock":"#bf360c","--panel-reservations":"#ffca28",...St(.25)},backgroundImage:"/cheese-bg.svg",cursor:"/cheese-cursor.svg"},cats:{id:"cats",name:"Cats",description:"Purrfect for cat lovers üê±",colors:{"--bg-dark":"#fce4ec","--bg-medium":"#fff0f5","--bg-light":"#fff5f8","--bg-card":"#ffffff","--bg-card-solid":"#ffffff","--primary":"#ec407a","--primary-light":"#f48fb1","--primary-dark":"#c2185b","--accent1":"#ab47bc","--accent2":"#7e57c2","--accent3":"#42a5f5","--accent4":"#ff7043","--accent5":"#66bb6a","--accent6":"#ffca28","--status-available":"#66bb6a","--status-checked-out":"#42a5f5","--status-reserved":"#ab47bc","--status-needs-attention":"#ffa726","--status-missing":"#ef5350","--condition-excellent":"#66bb6a","--condition-good":"#9ccc65","--condition-fair":"#ffee58","--condition-poor":"#ffa726","--text-primary":"#4a4a4a","--text-secondary":"#6d6d6d","--text-muted":"#9e9e9e","--border":"#f8bbd9","--border-light":"#fce4ec","--danger":"#ef5350","--danger-bg":"rgba(239, 83, 80, 0.1)","--success":"#66bb6a","--warning":"#ffa726","--sidebar-item1":"#ec407a","--sidebar-item2":"#ab47bc","--sidebar-item3":"#7e57c2","--sidebar-item4":"#42a5f5","--sidebar-item5":"#ff7043","--sidebar-item6":"#66bb6a","--panel-stats":"#ec407a","--panel-search":"#ab47bc","--panel-alerts":"#ff7043","--panel-reminders":"#7e57c2","--panel-lowstock":"#ef5350","--panel-reservations":"#42a5f5",...St(.15)},backgroundImage:"/cats-bg.svg",cursor:"/cats-cursor.svg"},dogs:{id:"dogs",name:"Dogs",description:"Pawsitively adorable üêï",colors:{"--bg-dark":"#efebe9","--bg-medium":"#faf7f5","--bg-light":"#fffbf8","--bg-card":"#ffffff","--bg-card-solid":"#ffffff","--primary":"#8d6e63","--primary-light":"#a1887f","--primary-dark":"#6d4c41","--accent1":"#ff8a65","--accent2":"#4fc3f7","--accent3":"#aed581","--accent4":"#ffb74d","--accent5":"#ba68c8","--accent6":"#4dd0e1","--status-available":"#81c784","--status-checked-out":"#4fc3f7","--status-reserved":"#ffb74d","--status-needs-attention":"#ff8a65","--status-missing":"#e57373","--condition-excellent":"#81c784","--condition-good":"#aed581","--condition-fair":"#fff176","--condition-poor":"#ffb74d","--text-primary":"#4e342e","--text-secondary":"#5d4037","--text-muted":"#8d6e63","--border":"#d7ccc8","--border-light":"#efebe9","--danger":"#e57373","--danger-bg":"rgba(229, 115, 115, 0.1)","--success":"#81c784","--warning":"#ffb74d","--sidebar-item1":"#8d6e63","--sidebar-item2":"#ff8a65","--sidebar-item3":"#4fc3f7","--sidebar-item4":"#aed581","--sidebar-item5":"#ffb74d","--sidebar-item6":"#ba68c8","--panel-stats":"#8d6e63","--panel-search":"#4fc3f7","--panel-alerts":"#ff8a65","--panel-reminders":"#ba68c8","--panel-lowstock":"#e57373","--panel-reservations":"#aed581",...St(.15)},backgroundImage:"/dogs-bg.svg",cursor:"/dogs-cursor.svg"},random:{id:"random",name:"Random",description:"Randomized colors on each switch",colors:{},isRandom:!0},custom:{id:"custom",name:"Custom Theme",description:"Create your own color scheme",colors:{},isCustom:!0}},ir=()=>{const e=()=>`hsl(${Math.random()*360}, ${60+Math.random()*40}%, ${30+Math.random()*40}%)`,n=()=>`hsl(${Math.random()*360}, ${70+Math.random()*30}%, ${80+Math.random()*15}%)`,a=()=>`hsl(${Math.random()*360}, ${40+Math.random()*30}%, ${10+Math.random()*15}%)`;return{"--bg-dark":a(),"--bg-medium":a(),"--bg-light":a(),"--bg-card":a(),"--bg-card-solid":a(),"--primary":e(),"--primary-light":e(),"--primary-dark":e(),"--accent1":e(),"--accent2":e(),"--accent3":e(),"--accent4":e(),"--accent5":e(),"--accent6":e(),"--status-available":e(),"--status-checked-out":e(),"--status-reserved":e(),"--status-needs-attention":e(),"--status-missing":e(),"--condition-excellent":e(),"--condition-good":e(),"--condition-fair":e(),"--condition-poor":e(),"--text-primary":n(),"--text-secondary":n(),"--text-muted":e(),"--border":e(),"--border-light":e(),"--danger":e(),"--danger-bg":e(),"--success":e(),"--warning":e(),"--sidebar-item1":e(),"--sidebar-item2":e(),"--sidebar-item3":e(),"--sidebar-item4":e(),"--sidebar-item5":e(),"--sidebar-item6":e(),"--panel-stats":e(),"--panel-search":e(),"--panel-alerts":e(),"--panel-reminders":e(),"--panel-lowstock":e(),"--panel-reservations":e(),"--shadow-sm":`0 1px 2px ${a()}`,"--shadow-md":`0 4px 6px ${a()}`,"--shadow-lg":`0 10px 15px ${a()}`,"--shadow-card":`0 4px 20px ${a()}`}};function sr(e){if(!e||typeof e!="string"||(e=e.replace(/^#/,""),e.length===3&&(e=e.split("").map(a=>a+a).join("")),e.length!==6))return null;const n=/^([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)}:null}function or({r:e,g:n,b:a}){const[r,i,l]=[e,n,a].map(m=>(m=m/255,m<=.03928?m/12.92:Math.pow((m+.055)/1.055,2.4)));return .2126*r+.7152*i+.0722*l}function xs(e,n){const a=sr(e),r=sr(n);if(!a||!r)return 1;const i=or(a),l=or(r),m=Math.max(i,l),d=Math.min(i,l);return(m+.05)/(d+.05)}function Ss(e,n,a=!1){const r=xs(e,n),i=a?3:4.5,l=a?4.5:7;let m="Fail";return r>=l?m="AAA":r>=i&&(m="AA"),{ratio:Math.round(r*100)/100,passes:r>=i,level:m}}function Cc(e){return e>=7?{status:"excellent",color:"#22c55e",description:"Excellent (AAA)"}:e>=4.5?{status:"good",color:"#84cc16",description:"Good (AA)"}:e>=3?{status:"warning",color:"#eab308",description:"Large text only"}:{status:"fail",color:"#ef4444",description:"Insufficient"}}const ks=[{fg:"--text-primary",bg:"--bg-dark",label:"Primary text on main background"},{fg:"--text-primary",bg:"--bg-medium",label:"Primary text on medium background"},{fg:"--text-primary",bg:"--bg-light",label:"Primary text on light background"},{fg:"--text-secondary",bg:"--bg-dark",label:"Secondary text on main background"},{fg:"--text-muted",bg:"--bg-dark",label:"Muted text on main background"},{fg:"--primary",bg:"--bg-dark",label:"Primary color on main background"},{fg:"--primary-light",bg:"--bg-dark",label:"Primary light on main background"},{fg:"--status-available",bg:"--bg-dark",label:"Available status on background"},{fg:"--status-needs-attention",bg:"--bg-dark",label:"Needs attention on background"},{fg:"--danger",bg:"--bg-dark",label:"Danger color on background"},{fg:"--success",bg:"--bg-dark",label:"Success color on background"},{fg:"--warning",bg:"--bg-dark",label:"Warning color on background"},{fg:"--focus-ring-color",bg:"--bg-dark",label:"Focus ring on background"}];function jc(e){return ks.map(n=>{const a=e[n.fg],r=e[n.bg];return!a?.startsWith("#")||!r?.startsWith("#")?{pair:n,result:{ratio:0,passes:!1,level:"Unknown",skipped:!0}}:{pair:n,result:Ss(a,r)}})}function _c(e){const n=e.filter(l=>l.result.passes).length,a=e.filter(l=>!l.result.passes&&!l.result.skipped).length,r=e.filter(l=>l.result.skipped).length,i=e.length-r;return{passing:n,failing:a,skipped:r,score:i>0?Math.round(n/i*100):0}}let mt=null;function vs(){return mt||(mt=document.createElement("div"),mt.setAttribute("role","status"),mt.setAttribute("aria-live","polite"),mt.setAttribute("aria-atomic","true"),mt.className="sr-only",Object.assign(mt.style,{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:"0"}),document.body.appendChild(mt),mt)}function Lr(e,n="polite"){const a=vs();a.setAttribute("aria-live",n),a.textContent="",requestAnimationFrame(()=>{a.textContent=e})}function ws(e){Lr(`Navigated to ${e}`)}const Hn=()=>{if(typeof window>"u")return null;try{const e=localStorage.getItem("sims-custom-theme"),n=localStorage.getItem("sims-custom-theme-name");if(e){const a=JSON.parse(e);return{id:"custom",name:n||"Custom Theme",description:"Your custom color scheme",colors:{...Rt,...a,"--bg-card-solid":a["--bg-card"]||a["--bg-light"]||Rt["--bg-card-solid"],"--danger-bg":(a["--danger"]||Rt["--danger"])+"20","--focus-ring-color":a["--focus-ring-color"]||a["--primary-light"]||Rt["--primary-light"],"--focus-ring-color-danger":a["--focus-ring-color-danger"]||a["--danger"]||Rt["--danger"]},isCustom:!0}}}catch{}return null},Cs=()=>{const e=Object.values(Xt),n=Hn();if(n){const a=e.findIndex(r=>r.id==="custom");a>=0&&(e[a]=n)}return e},Mr=s.createContext(null);function js({children:e}){const[n,a]=s.useState(()=>typeof window<"u"&&localStorage.getItem("sims-theme")||"dark"),[r,i]=s.useState(null),[l,m]=s.useState(null),d=s.useCallback((p,k=null,y=!1)=>{const x=document.documentElement,S=document.body;let j;return p.isRandom?j=k||ir():p.isCustom?j=Hn()?.colors||Rt:j=p.colors,j["--focus-ring-color"]||(j["--focus-ring-color"]=j["--primary-light"]||j["--primary"]),j["--focus-ring-color-danger"]||(j["--focus-ring-color-danger"]=j["--danger"]),Object.entries(j).forEach(([z,A])=>{x.style.setProperty(z,A)}),p.backgroundImage?x.style.setProperty("--theme-bg-image",`url("${p.backgroundImage}")`):x.style.setProperty("--theme-bg-image","none"),p.cursor?x.style.setProperty("--theme-cursor",`url("${p.cursor}") 2 2, auto`):x.style.setProperty("--theme-cursor","default"),p.fontFamily?(x.style.setProperty("--theme-font",p.fontFamily),S.style.fontFamily=p.fontFamily):(x.style.setProperty("--theme-font",""),S.style.fontFamily=""),localStorage.setItem("sims-theme",p.id),y&&Lr(`Theme changed to ${p.name}`),j},[]);s.useEffect(()=>{let p=Xt[n]||Xt.dark;if(p.isCustom){const k=Hn();k&&(p=k,m(k.colors))}if(p.isRandom){const k=ir();i(k),d(p,k,!0)}else i(null),d(p,null,!0)},[n,d]);const f=s.useCallback(p=>{(Xt[p]||p==="custom")&&a(p)},[]),h=s.useCallback(p=>{p?.colors&&(m(p.colors),n==="custom"&&d(p))},[n,d]),u=s.useMemo(()=>{const p=Xt[n]||Xt.dark;return p.isRandom&&r?{...p,colors:r}:p.isCustom&&l&&Hn()||p},[n,r,l]),g=s.useMemo(()=>({themeId:n,currentTheme:u,setTheme:f,updateCustomTheme:h,availableThemes:Cs()}),[n,u,f,h]);return t.jsx(Mr.Provider,{value:g,children:e})}function zr(){const e=s.useContext(Mr);if(!e)throw new Error("useTheme must be used within a ThemeProvider");return e}const Nr=s.createContext(null);function _s({children:e,currentUser:n,roles:a}){const r=s.useMemo(()=>{if(!n)return null;if(n.role&&typeof n.role=="object"&&n.role.permissions)return n.role;if(!a||a.length===0)return null;const g=n.roleId||n.role_id;return a.find(p=>p.id===g)||a.find(p=>p.id==="role_user")||null},[n,a]),i=s.useCallback((g,p=ee.VIEW)=>{if(!r)return!1;const k=r.permissions[g];if(!k)return!1;const y={[ee.HIDE]:0,[ee.VIEW]:1,[ee.EDIT]:2},x=y[p]||0;return(y[k]||0)>=x},[r,n]),l=s.useCallback(g=>i(g,ee.VIEW),[i]),m=s.useCallback(g=>i(g,ee.EDIT),[i]),d=s.useCallback(g=>!i(g,ee.VIEW),[i]),f=s.useCallback(g=>r&&r.permissions[g]||ee.HIDE,[r]),h=s.useMemo(()=>Object.values(fa).filter(g=>l(g.id)),[l]),u=s.useMemo(()=>({userRole:r,hasPermission:i,canView:l,canEdit:m,isHidden:d,getPermissionLevel:f,visibleFunctions:h,PERMISSION_LEVELS:ee}),[r,i,l,m,d,f,h]);return t.jsx(Nr.Provider,{value:u,children:e})}function cn(){const e=s.useContext(Nr);if(!e)throw new Error("usePermissions must be used within a PermissionsProvider");return e}function Is({functionId:e}){const{canEdit:n}=cn();return n(e)?null:t.jsxs("div",{style:{background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:F.md,padding:"8px 16px",marginBottom:16,display:"flex",alignItems:"center",gap:8,color:"#3b82f6",fontSize:b.fontSize.base},children:[t.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),t.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),t.jsx("span",{children:"You have view-only access. Some actions may be restricted."})]})}function Je({permission:e,requireEdit:n=!1,fallback:a=null,children:r}){const{canView:i,canEdit:l}=cn();return(n?l(e):i(e))?r:a}let Wn=null,ia=null;async function Es(){throw X("Supabase credentials not configured. Set VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY."),new Error("Supabase not configured")}async function We(){return Wn||(ia||(ia=Es()),Wn=await ia,Wn)}let Yn=null;We().then(e=>{Yn=e}).catch(e=>X(e));const Tt={signUp:async(e,n,a)=>{const r=await We(),{data:i,error:l}=await r.auth.signUp({email:e,password:n,options:{data:{name:a}}});if(l)throw l;return i},signIn:async(e,n)=>{const a=await We(),{data:r,error:i}=await a.auth.signInWithPassword({email:e,password:n});if(i)throw i;return r},signOut:async()=>{const e=await We(),{error:n}=await e.auth.signOut();if(n)throw n},getSession:async()=>{const e=await We(),{data:{session:n}}=await e.auth.getSession();return n},getUser:async()=>{const e=await We(),{data:{user:n}}=await e.auth.getUser();return n},onAuthStateChange:e=>Yn?Yn.auth.onAuthStateChange(e):{data:{subscription:{unsubscribe:()=>{}}}},resetPassword:async e=>{const n=await We(),{error:a}=await n.auth.resetPasswordForEmail(e);if(a)throw a},updatePassword:async e=>{const n=await We(),{error:a}=await n.auth.updateUser({password:e});if(a)throw a}},ja={category:"category_name",purchaseDate:"purchase_date",purchasePrice:"purchase_price",currentValue:"current_value",serialNumber:"serial_number",reorderPoint:"reorder_point",checkedOutTo:"checked_out_to_name",checkedOutToUserId:"checked_out_to_user_id",checkedOutDate:"checked_out_date",dueBack:"due_back",checkoutProject:"checkout_project",checkoutClientId:"checkout_client_id",isKit:"is_kit",kitType:"kit_type",kitItems:"kit_contents",viewCount:"view_count",checkoutCount:"checkout_count",location:"location_display",locationId:"location_id",createdAt:"created_at",updatedAt:"updated_at"},Ds={startDate:"start_date",endDate:"end_date",start:"start_date",end:"end_date",contactName:"contact_name",contactPhone:"contact_phone",contactEmail:"contact_email",itemId:"item_id",clientId:"client_id",createdById:"created_by_id",createdByName:"created_by_name",projectType:"project_type",createdAt:"created_at",updatedAt:"updated_at"},As={itemId:"item_id",dueDate:"due_date",completedAt:"completed_at",completedDate:"completed_at",createdById:"created_by_id",createdByName:"created_by_name",createdAt:"created_at",updatedAt:"updated_at"},Ts={itemId:"item_id",scheduledDate:"scheduled_date",completedDate:"completed_date",warrantyWork:"warranty_work",vendorContact:"vendor_contact",createdById:"created_by_id",createdByName:"created_by_name",createdAt:"created_at",updatedAt:"updated_at"},Rs={itemId:"item_id",userId:"user_id",userName:"user_name",clientId:"client_id",clientName:"client_name",conditionAtAction:"condition_at_action"};function Ps(e){if(e._reverse)return e._reverse;const n=Object.fromEntries(Object.entries(e).map(([a,r])=>[r,a]));return e._reverse=n,n}function _n(e,n,a={}){if(!e)return null;const r={...e},i=Ps(n);for(const[l,m]of Object.entries(i))e[l]!==void 0?r[m]=e[l]:e[m]!==void 0?r[m]=e[m]:m in a&&(r[m]=a[m]);for(const[l,m]of Object.entries(a))(r[l]===void 0||r[l]===null)&&(r[l]=m);return r}function Or(e,n,a={}){if(!e)return null;const{partial:r=!1,passThroughFields:i=[],numericFields:l={}}=a,m={};if(!r)for(const d of i)e[d]!==void 0&&(m[d]=e[d]);for(const[d,f]of Object.entries(n)){const h=e[d]!==void 0?e[d]:e[f];h!==void 0&&(d in l?m[f]=Number(h)||l[d]:m[f]=h)}if(r)for(const[d,f]of Object.entries(e))!(d in n)&&!(d in m)&&(Object.values(n).includes(d)||(m[d]=f));return m}async function U(){return await We()}const Ls={isKit:!1,kitItems:[],viewCount:0,checkoutCount:0,location:""},Ms=["id","name","brand","status","condition","image","specs","quantity"],qr={purchasePrice:0,currentValue:0,reorderPoint:0};function Mt(e){if(!e)return null;const n=_n(e,ja,Ls);return n.category_name=n.category||n.category_name,n}function zs(e){if(!e)return null;const n=Or(e,ja,{passThroughFields:Ms,numericFields:qr});return n.status||(n.status="available"),n.condition||(n.condition="excellent"),n.specs||(n.specs={}),n.quantity||(n.quantity=1),n}const ft={LIST_COLUMNS:["id","name","brand","status","condition","image","quantity","category_name","serial_number","specs","purchase_date","purchase_price","current_value","reorder_point","is_kit","kit_type","kit_contents","checked_out_to_name","checked_out_to_user_id","checked_out_date","due_back","checkout_project","checkout_client_id","location_display","location_id","view_count","checkout_count","created_at","updated_at"].join(","),async getAll(){const e=await U();if(!e)return[];const{data:n,error:a}=await e.from("inventory").select(this.LIST_COLUMNS).order("category_name").order("name");if(a)throw a;return(n||[]).map(Mt)},async getById(e){const n=await U();if(!n)return null;const{data:a,error:r}=await n.from("inventory").select("*").eq("id",e).single();if(r)throw r;return Mt(a)},async getByIdWithDetails(e){if(!await U())return null;const a=await this.getById(e);if(!a)return null;const[r,i,l,m,d]=await Promise.all([rn.getByItemId(e),sn.getByItemId(e),Ct.getByItemId(e),on.getByItemId(e),xn.getByItemId(e)]);return{...a,notes:r||[],reminders:i||[],reservations:l||[],maintenanceHistory:m||[],checkoutHistory:d||[]}},async create(e){const n=await U();if(!n)return e;const{validateItem:a}=await fe(async()=>{const{validateItem:d}=await Promise.resolve().then(()=>Bs);return{validateItem:d}},void 0),r=a(e);if(!r.isValid)throw new Error("Validation failed: "+Object.values(r.errors).join(", "));const i=zs(r.data||e),{data:l,error:m}=await n.from("inventory").insert(i).select().single();if(m)throw m;return Mt(l)},async update(e,n){const a=await U();if(!a)return{id:e,...n};const r=Or(n,ja,{partial:!0,numericFields:qr}),{data:i,error:l}=await a.from("inventory").update(r).eq("id",e).select().single();if(l)throw l;return Mt(i)},async delete(e){const n=await U();if(!n)return{id:e};const{error:a}=await n.from("inventory").delete().eq("id",e);if(a)throw a;return{id:e}},async checkOut(e,{userId:n,userName:a,clientId:r,clientName:i,project:l,dueBack:m}){const d=await U();if(!d)return null;const{data:f,error:h}=await d.from("inventory").update({status:"checked-out",checked_out_to_user_id:n,checked_out_to_name:a,checkout_client_id:r,checked_out_date:new Date().toISOString().split("T")[0],due_back:m,checkout_project:l}).eq("id",e).select().single();if(h)throw h;return d.rpc("increment_checkout_count",{item_id:e}).then(({error:u})=>{u&&yn("increment_checkout_count RPC not available:",u.message)}),xn.create({item_id:e,user_id:n,user_name:a,client_id:r,client_name:i,action:"checkout",project:l}).catch(u=>yn("Checkout history not saved:",u.message)),f},async checkIn(e,{userId:n,userName:a,notes:r,condition:i}){const l=await U();if(!l)return null;const m=await this.getById(e),d={status:"available",checked_out_to_user_id:null,checked_out_to_name:null,checkout_client_id:null,checked_out_date:null,due_back:null,checkout_project:null};i&&(d.condition=i);const{data:f,error:h}=await l.from("inventory").update(d).eq("id",e).select().single();if(h)throw h;return xn.create({item_id:e,user_id:n,user_name:a,client_id:m?.checkout_client_id,action:"checkin",notes:r,condition_at_action:i}).catch(u=>yn("Checkin history not saved:",u.message)),f},async generateId(e){const n=await U();if(!n)return`${e}1001`;const{data:a,error:r}=await n.rpc("generate_item_id",{category_prefix:e});if(r)throw r;return a},async incrementViewCount(e){const n=await U();n&&await n.rpc("increment_view_count",{item_id:e})},async search(e){const n=await U();if(!n)return[];const{data:a,error:r}=await n.from("inventory").select("*").or(`name.ilike.%${e}%,brand.ilike.%${e}%,id.ilike.%${e}%,serial_number.ilike.%${e}%`).limit(50);if(r)throw r;return a},async getByStatus(e){const n=await U();if(!n)return[];const{data:a,error:r}=await n.from("inventory").select("*").eq("status",e);if(r)throw r;return a},async getOverdue(){const e=await U();if(!e)return[];const n=new Date().toISOString().split("T")[0],{data:a,error:r}=await e.from("inventory").select("*").eq("status","checked-out").lt("due_back",n);if(r)throw r;return a}},rn={async getByItemId(e){const n=await U();if(!n)return[];const{data:a,error:r}=await n.from("item_notes").select("*").eq("item_id",e).eq("deleted",!1).order("created_at",{ascending:!1});if(r)throw r;return Ta(a)},async create(e){const n=await U();if(!n)return e;const{data:a,error:r}=await n.from("item_notes").insert(e).select().single();if(r)throw r;return a},async softDelete(e){const n=await U();if(!n)return{id:e};const{data:a,error:r}=await n.from("item_notes").update({deleted:!0}).eq("id",e).select().single();if(r)throw r;return a}};function lr(e){if(!e)return null;const n=_n(e,As);return n.item&&(n.item=Mt(n.item)),n}const sn={async getByItemId(e){const n=await U();if(!n)return[];const{data:a,error:r}=await n.from("item_reminders").select("*").eq("item_id",e).order("due_date");if(r)throw r;return(a||[]).map(lr)},async getDue(){const e=await U();if(!e)return[];const n=new Date().toISOString().split("T")[0],{data:a,error:r}=await e.from("item_reminders").select(`
        *,
        item:inventory(id, name, category_name)
      `).lte("due_date",n).eq("completed",!1).order("due_date");if(r)throw r;return(a||[]).map(lr)},async create(e){const n=await U();if(!n)return e;const{data:a,error:r}=await n.from("item_reminders").insert(e).select().single();if(r)throw r;return a},async update(e,n){const a=await U();if(!a)return{id:e,...n};const{data:r,error:i}=await a.from("item_reminders").update(n).eq("id",e).select().single();if(i)throw i;return r},async complete(e){const n=await U();if(!n)return{id:e,completed:!0};const{data:a,error:r}=await n.from("item_reminders").update({completed:!0,completed_at:new Date().toISOString()}).eq("id",e).select().single();if(r)throw r;return a},async delete(e){const n=await U();if(!n)return{id:e};const{error:a}=await n.from("item_reminders").delete().eq("id",e);if(a)throw a;return{id:e}}};function kt(e){if(!e)return null;let n=e.notes||[];if(typeof n=="string")try{n=JSON.parse(n)}catch{n=[]}Array.isArray(n)||(n=[]);const a=_n(e,Ds);return a.notes=n,a.startDate&&!a.start&&(a.start=a.startDate),a.endDate&&!a.end&&(a.end=a.endDate),a.start&&!a.startDate&&(a.startDate=a.start),a.end&&!a.endDate&&(a.endDate=a.end),a.contactName&&!a.user&&(a.user=a.contactName),a.user&&!a.contactName&&(a.contactName=a.user),a.dueBack||(a.dueBack=a.end||a.endDate),a.item&&(a.item=Mt(a.item)),a}const Ct={async getAll(){const e=await U();if(!e)return[];const{data:n,error:a}=await e.from("reservations").select(`
        *,
        item:inventory(id, name, category_name, brand, status),
        client:clients(id, name, type, email, phone)
      `).order("start_date");if(a)throw a;return(n||[]).map(kt)},async getByItemId(e){const n=await U();if(!n)return[];const{data:a,error:r}=await n.from("reservations").select(`
        *,
        client:clients(id, name, type)
      `).eq("item_id",e).order("start_date");if(r)throw r;return(a||[]).map(kt)},async getByClientId(e){const n=await U();if(!n)return[];const{data:a,error:r}=await n.from("reservations").select(`
        *,
        item:inventory(id, name, category_name, brand)
      `).eq("client_id",e).order("start_date",{ascending:!1});if(r)throw r;return(a||[]).map(kt)},async getUpcoming(e=7){const n=await U();if(!n)return[];const a=new Date,r=new Date(a);r.setDate(r.getDate()+e);const{data:i,error:l}=await n.from("reservations").select(`
        *,
        item:inventory(id, name, category_name, brand),
        client:clients(id, name, type)
      `).gte("end_date",a.toISOString().split("T")[0]).lte("start_date",r.toISOString().split("T")[0]).eq("status","confirmed").order("start_date");if(l)throw l;return(i||[]).map(kt)},async getByDateRange(e,n){const a=await U();if(!a)return[];const{data:r,error:i}=await a.from("reservations").select(`
        *,
        item:inventory(id, name, category_name, brand),
        client:clients(id, name, type)
      `).lte("start_date",n).gte("end_date",e).neq("status","cancelled").order("start_date");if(i)throw i;return(r||[]).map(kt)},async create(e){const n=await U();if(!n)return e;const{data:a,error:r}=await n.from("reservations").insert(e).select().single();if(r)throw r;const i=new Date().toISOString().split("T")[0];return e.start_date<=i&&await ft.update(e.item_id,{status:"reserved"}),kt(a)},async update(e,n){const a=await U();if(!a)return{id:e,...n};const{data:r,error:i}=await a.from("reservations").update(n).eq("id",e).select().single();if(i)throw i;return kt(r)},async delete(e){const n=await U();if(!n)return{id:e};const{error:a}=await n.from("reservations").delete().eq("id",e);if(a)throw a;return{id:e}},async cancel(e){const n=await U();if(!n)return{id:e,status:"cancelled"};const{data:a,error:r}=await n.from("reservations").update({status:"cancelled"}).eq("id",e).select().single();if(r)throw r;return kt(a)}};function Qt(e){if(!e)return null;const n=_n(e,Ts,{warrantyWork:!1});return n.item&&(n.item=Mt(n.item)),n}const on={async getAll(){const e=await U();if(!e)return[];const{data:n,error:a}=await e.from("maintenance_records").select(`
        *,
        item:inventory(id, name, category_name, brand)
      `).order("scheduled_date",{ascending:!1});if(a)throw a;return(n||[]).map(Qt)},async getByItemId(e){const n=await U();if(!n)return[];const{data:a,error:r}=await n.from("maintenance_records").select("*").eq("item_id",e).order("scheduled_date",{ascending:!1});if(r)throw r;return(a||[]).map(Qt)},async getPending(){const e=await U();if(!e)return[];const{data:n,error:a}=await e.from("maintenance_records").select(`
        *,
        item:inventory(id, name, category_name, brand)
      `).in("status",["scheduled","in-progress"]).order("scheduled_date");if(a)throw a;return(n||[]).map(Qt)},async create(e){const n=await U();if(!n)return e;const{data:a,error:r}=await n.from("maintenance_records").insert(e).select().single();if(r)throw r;return Qt(a)},async update(e,n){const a=await U();if(!a)return{id:e,...n};const{data:r,error:i}=await a.from("maintenance_records").update(n).eq("id",e).select().single();if(i)throw i;return Qt(r)},async complete(e,{completedDate:n,notes:a,cost:r}){const i=await U();if(!i)return{id:e,status:"completed"};const{data:l,error:m}=await i.from("maintenance_records").update({status:"completed",completed_date:n||new Date().toISOString().split("T")[0],notes:a,cost:r}).eq("id",e).select().single();if(m)throw m;return Qt(l)},async delete(e){const n=await U();if(!n)return{id:e};const{error:a}=await n.from("maintenance_records").delete().eq("id",e);if(a)throw a;return{id:e}},async getCostSummary(e){const n=await U();if(!n)return{total:0,count:0};const{data:a,error:r}=await n.from("maintenance_records").select("cost").eq("item_id",e).eq("status","completed");if(r)throw r;return{total:a.reduce((l,m)=>l+(parseFloat(m.cost)||0),0),count:a.length}}};function Ns(e){if(!e)return null;const n=_n(e,Rs);return n.user=n.userName||n.user,n.date=n.timestamp||n.date,n}const xn={async getByItemId(e,n=50){const a=await U();if(!a)return[];const{data:r,error:i}=await a.from("checkout_history").select("*").eq("item_id",e).order("timestamp",{ascending:!1}).limit(n);if(i)throw i;return(r||[]).map(Ns)},async getByUserId(e,n=50){const a=await U();if(!a)return[];const{data:r,error:i}=await a.from("checkout_history").select(`
        *,
        item:inventory(id, name, category_name)
      `).eq("user_id",e).order("timestamp",{ascending:!1}).limit(n);if(i)throw i;return r},async create(e){const n=await U();if(!n)return e;const{data:a,error:r}=await n.from("checkout_history").insert({...e,timestamp:new Date().toISOString()}).select().single();if(r)throw r;return a}},Jt={async getAll(){const e=await U();if(!e)return[];const{data:n,error:a}=await e.from("clients").select("*").order("favorite",{ascending:!1}).order("name");if(a)throw a;return n},async getById(e){const n=await U();if(!n)return null;const{data:a,error:r}=await n.from("clients").select("*").eq("id",e).single();if(r)throw r;return a},async getByIdWithDetails(e){if(!await U())return null;const a=await this.getById(e);if(!a)return null;const[r,i]=await Promise.all([_a.getByClientId(e),Ct.getByClientId(e)]);return{...a,clientNotes:r||[],reservations:i||[]}},async create(e){const n=await U();if(!n)return e;if(!e.id){const{data:i}=await n.rpc("generate_client_id");e.id=i}const{data:a,error:r}=await n.from("clients").insert(e).select().single();if(r)throw r;return a},async update(e,n){const a=await U();if(!a)return{id:e,...n};const{data:r,error:i}=await a.from("clients").update(n).eq("id",e).select().single();if(i)throw i;return r},async delete(e){const n=await U();if(!n)return{id:e};const{error:a}=await n.from("clients").delete().eq("id",e);if(a)throw a;return{id:e}},async toggleFavorite(e,n){const a=await U();if(!a)return{id:e,favorite:n};const{data:r,error:i}=await a.from("clients").update({favorite:n}).eq("id",e).select().single();if(i)throw i;return r},async generateId(){const e=await U();if(!e)return"CL001";const{data:n,error:a}=await e.rpc("generate_client_id");if(a)throw a;return n}},_a={async getByClientId(e){const n=await U();if(!n)return[];const{data:a,error:r}=await n.from("client_notes").select("*").eq("client_id",e).eq("deleted",!1).order("created_at",{ascending:!1});if(r)throw r;return Ta(a)},async create(e){const n=await U();if(!n)return e;const{data:a,error:r}=await n.from("client_notes").insert(e).select().single();if(r)throw r;return a},async softDelete(e){const n=await U();if(!n)return{id:e};const{data:a,error:r}=await n.from("client_notes").update({deleted:!0}).eq("id",e).select().single();if(r)throw r;return a}},en={async getAll(){const e=await U();if(!e)return[];const{data:n,error:a}=await e.from("packages").select(`
        *,
        package_items(item_id, sort_order)
      `).order("name");if(a)throw a;return n.map(r=>({...r,items:r.package_items.sort((i,l)=>i.sort_order-l.sort_order).map(i=>i.item_id)}))},async getById(e){const n=await U();if(!n)return null;const{data:a,error:r}=await n.from("packages").select(`
        *,
        package_items(item_id, sort_order),
        package_notes(*)
      `).eq("id",e).single();if(r)throw r;return{...a,items:a.package_items.sort((i,l)=>i.sort_order-l.sort_order).map(i=>i.item_id),notes:Ta(a.package_notes||[])}},async create(e){const n=await U();if(!n)return e;const{items:a,notes:r,category:i,...l}=e;l.id||(l.id=crypto.randomUUID());const{data:m,error:d}=await n.from("packages").insert(l).select().single();if(d)throw d;return a?.length>0&&await n.from("package_items").insert(a.map((f,h)=>({package_id:m.id,item_id:f,sort_order:h}))),{...m,items:a||[],notes:[],category:i||""}},async update(e,n){const a=await U();if(!a)return{id:e,...n};const{items:r,notes:i,category:l,...m}=n;let d={id:e};if(Object.keys(m).length>0){const{data:f,error:h}=await a.from("packages").update(m).eq("id",e).select().single();if(h)throw h;d=f}return r!==void 0&&(await a.from("package_items").delete().eq("package_id",e),r.length>0&&await a.from("package_items").insert(r.map((f,h)=>({package_id:e,item_id:f,sort_order:h})))),{...d,items:r||[],category:l||""}},async delete(e){const n=await U();if(!n)return{id:e};const{error:a}=await n.from("packages").delete().eq("id",e);if(a)throw a;return{id:e}}},tn={async getAll(){const e=await U();if(!e)return[];const{data:n,error:a}=await e.from("pack_lists").select(`
        *,
        pack_list_items(item_id, quantity, is_packed, sort_order),
        pack_list_packages(package_id, sort_order)
      `).order("created_at",{ascending:!1});if(a)throw a;return n.map(r=>({...r,createdAt:r.created_at,items:r.pack_list_items.sort((i,l)=>i.sort_order-l.sort_order).map(i=>({id:i.item_id,quantity:i.quantity})),packages:r.pack_list_packages.sort((i,l)=>i.sort_order-l.sort_order).map(i=>i.package_id),packedItems:r.pack_list_items.filter(i=>i.is_packed).map(i=>i.item_id)}))},async getById(e){const n=await U();if(!n)return null;const{data:a,error:r}=await n.from("pack_lists").select(`
        *,
        pack_list_items(item_id, quantity, is_packed, sort_order),
        pack_list_packages(package_id, sort_order)
      `).eq("id",e).single();if(r)throw r;return{...a,createdAt:a.created_at,items:a.pack_list_items.sort((i,l)=>i.sort_order-l.sort_order).map(i=>({id:i.item_id,quantity:i.quantity})),packages:a.pack_list_packages.sort((i,l)=>i.sort_order-l.sort_order).map(i=>i.package_id),packedItems:a.pack_list_items.filter(i=>i.is_packed).map(i=>i.item_id)}},async create(e){const n=await U();if(!n)return e;const{items:a,packages:r,packedItems:i,...l}=e;l.id||(l.id=crypto.randomUUID()),l.created_at||(l.created_at=new Date().toISOString());const{data:m,error:d}=await n.from("pack_lists").insert(l).select().single();if(d)throw d;return a?.length>0&&await n.from("pack_list_items").insert(a.map((f,h)=>({pack_list_id:m.id,item_id:f.id||f,quantity:f.quantity||1,is_packed:!1,sort_order:h}))),r?.length>0&&await n.from("pack_list_packages").insert(r.map((f,h)=>({pack_list_id:m.id,package_id:f,sort_order:h}))),{...m,createdAt:m.created_at,items:a||[],packages:r||[],packedItems:[]}},async update(e,n){const a=await U();if(!a)return{id:e,...n};const{items:r,packages:i,packedItems:l,...m}=n;if(Object.keys(m).length>0){const{error:d}=await a.from("pack_lists").update(m).eq("id",e);if(d)throw d}return r!==void 0&&(await a.from("pack_list_items").delete().eq("pack_list_id",e),r.length>0&&await a.from("pack_list_items").insert(r.map((d,f)=>({pack_list_id:e,item_id:d.id||d,quantity:d.quantity||1,is_packed:l?.includes(d.id||d)||!1,sort_order:f})))),i!==void 0&&(await a.from("pack_list_packages").delete().eq("pack_list_id",e),i.length>0&&await a.from("pack_list_packages").insert(i.map((d,f)=>({pack_list_id:e,package_id:d,sort_order:f})))),{id:e,...n}},async delete(e){const n=await U();if(!n)return{id:e};const{error:a}=await n.from("pack_lists").delete().eq("id",e);if(a)throw a;return{id:e}},async toggleItemPacked(e,n,a){const r=await U();if(!r)return{packListId:e,itemId:n,isPacked:a};const{data:i,error:l}=await r.from("pack_list_items").update({is_packed:a}).eq("pack_list_id",e).eq("item_id",n).select().single();if(l)throw l;return i}},Ia={async getAll(){const e=await U();if(!e)return[];const{data:n,error:a}=await e.from("categories").select("*").order("sort_order");if(a)throw a;return n},async create(e){const n=await U();if(!n)return e;const{data:a,error:r}=await n.from("categories").insert(e).select().single();if(r)throw r;return a},async update(e,n){const a=await U();if(!a)return{id:e,...n};const{data:r,error:i}=await a.from("categories").update(n).eq("id",e).select().single();if(i)throw i;return r},async delete(e){const n=await U();if(!n)return{name:e};const{error:a}=await n.from("categories").delete().eq("name",e);if(a)throw a;return{name:e}}},Ea={async getAll(){const e=await U();if(!e)return{};const{data:n,error:a}=await e.from("specs").select("*").order("category_name").order("sort_order");if(a)throw a;const r={};return n.forEach(i=>{r[i.category_name]||(r[i.category_name]=[]),r[i.category_name].push({name:i.name,required:i.required})}),r},async getByCategory(e){const n=await U();if(!n)return[];const{data:a,error:r}=await n.from("specs").select("*").eq("category_name",e).order("sort_order");if(r)throw r;return a},async upsert(e,n){const a=await U();if(!a)return n;if(await a.from("specs").delete().eq("category_name",e),n.length>0){const{data:r,error:i}=await a.from("specs").insert(n.map((l,m)=>({category_name:e,name:l.name,required:l.required||!1,sort_order:m}))).select();if(i)throw i;return r}return[]}},Da={async getAll(){const e=await U();if(!e)return[];const{data:n,error:a}=await e.from("locations").select("*").order("path");if(a)throw a;return Os(n)},async getFlat(){const e=await U();if(!e)return[];const{data:n,error:a}=await e.from("locations").select("*").order("path");if(a)throw a;return n},async create(e){const n=await U();if(!n)return e;const{data:a,error:r}=await n.from("locations").insert(e).select().single();if(r)throw r;return a},async update(e,n){const a=await U();if(!a)return{id:e,...n};const{data:r,error:i}=await a.from("locations").update(n).eq("id",e).select().single();if(i)throw i;return r},async delete(e){const n=await U();if(!n)return{id:e};const{error:a}=await n.from("locations").delete().eq("id",e);if(a)throw a;return{id:e}}},zt={async getAll(){const e=await U();if(!e)return[];const{data:n,error:a}=await e.from("users").select(`
        *,
        role:roles(id, name, permissions)
      `).order("name");if(a)throw a;return n},async getById(e){const n=await U();if(!n)return null;const{data:a,error:r}=await n.from("users").select(`
        *,
        role:roles(id, name, permissions)
      `).eq("id",e).single();if(r)throw r;return a},async update(e,n){const a=await U();if(!a)return{id:e,...n};const{data:r,error:i}=await a.from("users").update(n).eq("id",e).select().single();if(i)throw i;return r},async updateRole(e,n){const a=await U();if(!a)return{id:e,role_id:n};const{data:r,error:i}=await a.from("users").update({role_id:n}).eq("id",e).select().single();if(i)throw i;return r}},Aa={async getAll(){const e=await U();if(!e)return[];const{data:n,error:a}=await e.from("roles").select("*").order("name");if(a)throw a;return n},async create(e){const n=await U();if(!n)return e;const{data:a,error:r}=await n.from("roles").insert(e).select().single();if(r)throw r;return a},async update(e,n){const a=await U();if(!a)return{id:e,...n};const{data:r,error:i}=await a.from("roles").update(n).eq("id",e).select().single();if(i)throw i;return r},async delete(e){const n=await U();if(!n)return{id:e};const{error:a}=await n.from("roles").delete().eq("id",e);if(a)throw a;return{id:e}}},Qn={async getAll(e={}){const n=await U();if(!n)return[];let a=n.from("audit_log").select("*").order("timestamp",{ascending:!1});e.limit&&(a=a.limit(e.limit)),e.type&&(a=a.eq("type",e.type)),e.itemId&&(a=a.eq("item_id",e.itemId));const{data:r,error:i}=await a;if(i)throw i;return r},async create(e){const n=await U();if(!n)return e;const a={type:e.type,description:e.description,user:e.user,timestamp:new Date().toISOString()};e.itemId&&(a.item_id=e.itemId);const{data:r,error:i}=await n.from("audit_log").insert(a).select().single();if(i)throw i;return r}};function Ta(e){if(!e||e.length===0)return[];const n=i=>({...i,user:i.user_name||i.user,userName:i.user_name||i.userName,userId:i.user_id||i.userId,itemId:i.item_id||i.itemId,parentId:i.parent_id||i.parentId,date:i.created_at||i.date,createdAt:i.created_at||i.createdAt,replies:[]}),a=new Map,r=[];return e.forEach(i=>{const l=n(i);a.set(l.id,l)}),a.forEach(i=>{const l=i.parent_id||i.parentId;if(l){const m=a.get(l);m&&m.replies.push(i)}else r.push(i)}),r}function Os(e){if(!e||e.length===0)return[];const n=(a,r=null)=>a.filter(i=>i.parent_id===r).map(i=>({...i,children:n(a,i.id)}));return n(e)}const Xn={async getByUserId(e){const n=await U();if(!n)return null;const{data:a,error:r}=await n.from("notification_preferences").select("*").eq("user_id",e).single();if(r&&r.code!=="PGRST116")throw r;return a},async upsert(e,n){const a=await U();if(!a)return n;const{data:r,error:i}=await a.from("notification_preferences").upsert({user_id:e,...n,updated_at:new Date().toISOString()},{onConflict:"user_id"}).select().single();if(i)throw i;return r},async update(e,n){const a=await U();if(!a)return n;const{data:r,error:i}=await a.from("notification_preferences").update({...n,updated_at:new Date().toISOString()}).eq("user_id",e).select().single();if(i)throw i;return r}},Sn={async send({to:e,templateKey:n,templateData:a,userId:r}){const i=await U();if(!i)return{success:!0,demo:!0};try{const{data:l,error:m}=await i.functions.invoke("send-email",{body:{to:e,templateKey:n,templateData:a,userId:r}});return m?(yn("Email send failed (Edge Function may not be deployed):",m.message),{success:!1,error:m.message}):l}catch(l){return yn("Email service unavailable:",l.message),{success:!1,error:l.message}}},async sendCheckoutConfirmation({borrowerEmail:e,borrowerName:n,item:a,checkoutDate:r,dueDate:i,project:l}){return this.send({to:e,templateKey:"checkout_confirmation",templateData:{borrower_name:n,item_name:a.name,item_id:a.id,item_brand:a.brand||"",checkout_date:r,due_date:i,project:l||"",company_name:"SIMS"}})},async sendCheckinConfirmation({borrowerEmail:e,borrowerName:n,item:a,returnDate:r}){return this.send({to:e,templateKey:"checkin_confirmation",templateData:{borrower_name:n,item_name:a.name,item_id:a.id,return_date:r,company_name:"SIMS"}})},async sendReservationConfirmation({userEmail:e,userName:n,item:a,reservation:r}){return this.send({to:e,templateKey:"reservation_confirmation",templateData:{user_name:n,item_name:a.name,item_id:a.id,item_brand:a.brand||"",project_name:r.project,start_date:r.start,end_date:r.end,company_name:"SIMS"}})},async sendDueDateReminder({borrowerEmail:e,borrowerName:n,item:a,dueDate:r,daysUntilDue:i}){const l=i<0?"overdue_notice":"due_date_reminder";return this.send({to:e,templateKey:l,templateData:{borrower_name:n,item_name:a.name,item_id:a.id,due_date:r,days_until_due:Math.abs(i),company_name:"SIMS"}})}},qs=Object.freeze(Object.defineProperty({__proto__:null,auditLogService:Qn,categoriesService:Ia,checkoutHistoryService:xn,clientNotesService:_a,clientsService:Jt,emailService:Sn,inventoryService:ft,itemNotesService:rn,itemRemindersService:sn,locationsService:Da,maintenanceService:on,notificationPreferencesService:Xn,packListsService:tn,packagesService:en,reservationsService:Ct,rolesService:Aa,specsService:Ea,usersService:zt},Symbol.toStringTag,{value:"Module"})),$r=s.createContext(null);function Br({children:e}){const[n,a]=s.useState(null),[r,i]=s.useState(null),[l,m]=s.useState(null),[d,f]=s.useState(!0),[h,u]=s.useState(null);s.useEffect(()=>{let z=null;return(async()=>{f(!0);try{const I=await We(),L=await Tt.getSession();if(m(L),L?.user){a(L.user);try{const D=await zt.getById(L.user.id);i(D)}catch(D){X("Failed to fetch user profile:",D)}}const{data:R}=I.auth.onAuthStateChange(async(D,_)=>{if(Kn("Auth state changed:",D),m(_),a(_?.user??null),_?.user)try{const T=await zt.getById(_.user.id);i(T)}catch(T){X("Failed to fetch user profile:",T)}else i(null)});z=R.subscription}catch(I){X("Auth init error:",I),u(I)}finally{f(!1)}})(),()=>{z?.unsubscribe()}},[]);const g=s.useCallback(async(z,A)=>{u(null);try{const I=await Tt.signIn(z,A),L=I.user,R=I.session;a(L),m(R);let D=null;if(L)try{D=await zt.getById(L.id),i(D)}catch(_){X("Failed to fetch profile after login:",_)}return{user:D||L,error:null}}catch(I){return X("Sign in error:",I),u(I),{user:null,error:I}}},[]),p=s.useCallback(async(z,A,I)=>{u(null);try{return{user:(await Tt.signUp(z,A,I)).user,error:null}}catch(L){return u(L),{user:null,error:L}}},[]),k=s.useCallback(async()=>{try{await Tt.signOut(),a(null),i(null),m(null),u(null)}catch(z){throw u(z),z}},[]),y=s.useCallback(async z=>{u(null);try{return await Tt.resetPassword(z),{error:null}}catch(A){return u(A),{error:A}}},[]),x=s.useCallback(async z=>{u(null);try{return await Tt.updatePassword(z),{error:null}}catch(A){return u(A),{error:A}}},[]),S=s.useCallback(async z=>{if(!n)return{error:new Error("Not authenticated")};try{await zt.update(n.id,z);const A={...r,...z};return i(A),{error:null}}catch(A){return u(A),{error:A}}},[n,r]),j={user:n,userProfile:r,session:l,loading:d,error:h,isAuthenticated:!!n,userRole:r?.role||r?.roleId||"viewer",userName:r?.name||n?.email?.split("@")[0]||"User",userEmail:r?.email||n?.email||"",signIn:g,signUp:p,signOut:k,resetPassword:y,updatePassword:x,updateProfile:S};return t.jsx($r.Provider,{value:j,children:e})}function Ra(){const e=s.useContext($r);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function Vt(e){return typeof e=="string"&&e.trim().length>0}function ht(e,n,a){if(typeof e!="string")return!1;const r=e.trim().length;return r>=n&&r<=a}function Qe(e){return typeof e!="string"?"":e.trim()}function Nt(e){if(typeof e=="number")return e;if(typeof e!="string")return 0;const n=e.replace(/[$,\s]/g,""),a=parseFloat(n);return isNaN(a)?0:a}function yt(e){if(!e)return!1;const n=new Date(e);return!isNaN(n.getTime())}function Vr(e,n){return!yt(e)||!yt(n)?!1:new Date(e)<=new Date(n)}function Wr(e){return Object.values(Me).includes(e)}function Fr(e){return Object.values(Zt).includes(e)}function Hr(e,n=[]){return[...Object.values(Ar),...n].includes(e)}function $s(e,n={}){const{existingCodes:a=[],editingId:r=null,customCategories:i=[]}=n,l={};if(!e.name||!Vt(e.name)?l.name="Name is required":ht(e.name,2,100)||(l.name="Name must be between 2 and 100 characters"),e.category?Hr(e.category,i)||(l.category="Invalid category"):l.category="Category is required",e.code&&(ht(e.code,2,20)?a.includes(e.code)&&e.id!==r&&(l.code="This code is already in use"):l.code="Code must be between 2 and 20 characters"),e.status&&!Wr(e.status)&&(l.status="Invalid status"),e.condition&&!Fr(e.condition)&&(l.condition="Invalid condition"),e.value!==void 0&&e.value!==""&&e.value!==null){const f=Nt(e.value);f<0?l.value="Value cannot be negative":f>1e7&&(l.value="Value exceeds maximum allowed")}e.purchasePrice!==void 0&&e.purchasePrice!==""&&e.purchasePrice!==null&&Nt(e.purchasePrice)<0&&(l.purchasePrice="Purchase price cannot be negative"),e.serialNumber&&!ht(e.serialNumber,0,50)&&(l.serialNumber="Serial number must be 50 characters or less"),e.purchaseDate&&!yt(e.purchaseDate)&&(l.purchaseDate="Invalid purchase date"),e.warrantyExpires&&!yt(e.warrantyExpires)&&(l.warrantyExpires="Invalid warranty expiration date");const m=Object.keys(l).length===0,d=m?{...e,name:Qe(e.name),code:e.code?Qe(e.code):void 0,serialNumber:e.serialNumber?Qe(e.serialNumber):void 0,value:e.value!==void 0&&e.value!==""?Nt(e.value):void 0,purchasePrice:e.purchasePrice!==void 0&&e.purchasePrice!==""?Nt(e.purchasePrice):void 0}:null;return{isValid:m,errors:l,data:d}}function Ur(e,n={}){const{existingReservations:a=[],editingId:r=null}=n,i={};e.start?yt(e.start)||(i.start="Invalid start date"):i.start="Start date is required",e.end?yt(e.end)||(i.end="Invalid end date"):i.end="End date is required",e.start&&e.end&&!Vr(e.start,e.end)&&(i.end="End date must be after start date"),!e.project||!Vt(e.project)?i.project="Project name is required":ht(e.project,2,200)||(i.project="Project name must be between 2 and 200 characters"),(!e.user||!Vt(e.user))&&(i.user="Borrower name is required"),e.contactEmail&&!Pa(e.contactEmail)&&(i.contactEmail="Invalid email address"),e.contactPhone&&!ht(e.contactPhone,0,20)&&(i.contactPhone="Phone number too long"),e.start&&e.end&&a.length>0&&a.some(d=>d.id===r?!1:Yr(e.start,e.end,d.start,d.end))&&(i.dateRange="This item is already reserved during the selected dates");const l=Object.keys(i).length===0;return{isValid:l,errors:i,data:l?{...e,project:Qe(e.project),user:Qe(e.user),contactEmail:e.contactEmail?Qe(e.contactEmail):void 0,contactPhone:e.contactPhone?Qe(e.contactPhone):void 0}:null}}function Gr(e){const n={};!e.name||!Vt(e.name)?n.name="Client name is required":ht(e.name,2,100)||(n.name="Name must be between 2 and 100 characters"),e.email&&!Pa(e.email)&&(n.email="Invalid email address"),e.phone&&!ht(e.phone,0,20)&&(n.phone="Phone number too long");const a=Object.keys(n).length===0;return{isValid:a,errors:n,data:a?{...e,name:Qe(e.name),email:e.email?Qe(e.email):void 0,phone:e.phone?Qe(e.phone):void 0}:null}}function Kr(e){const n={};(!e.type||!Vt(e.type))&&(n.type="Maintenance type is required"),!e.description||!Vt(e.description)?n.description="Description is required":ht(e.description,5,1e3)||(n.description="Description must be between 5 and 1000 characters"),e.scheduledDate&&!yt(e.scheduledDate)&&(n.scheduledDate="Invalid scheduled date"),e.completedDate&&!yt(e.completedDate)&&(n.completedDate="Invalid completed date"),e.cost!==void 0&&e.cost!==""&&e.cost!==null&&Nt(e.cost)<0&&(n.cost="Cost cannot be negative");const a=Object.keys(n).length===0;return{isValid:a,errors:n,data:a?{...e,type:Qe(e.type),description:Qe(e.description),vendor:e.vendor?Qe(e.vendor):void 0,cost:e.cost!==void 0&&e.cost!==""?Nt(e.cost):void 0}:null}}function Pa(e){return e?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e):!1}function Yr(e,n,a,r){const i=new Date(e).getTime(),l=new Date(n).getTime(),m=new Date(a).getTime(),d=new Date(r).getTime();return i<=d&&l>=m}const Bs=Object.freeze(Object.defineProperty({__proto__:null,datesOverlap:Yr,isNonEmptyString:Vt,isValidCategory:Hr,isValidCondition:Fr,isValidDate:yt,isValidDateRange:Vr,isValidEmail:Pa,isValidLength:ht,isValidStatus:Wr,parseCurrency:Nt,sanitizeString:Qe,validateClient:Gr,validateItem:$s,validateMaintenanceRecord:Kr,validateReservation:Ur},Symbol.toStringTag,{value:"Module"})),Qr=s.createContext(null);function Xr({children:e}){const[n,a]=s.useState(!0),[r,i]=s.useState(null),[l,m]=s.useState(!1),[d,f]=s.useState([]),[h,u]=s.useState([]),[g,p]=s.useState([]),[k,y]=s.useState([]),[x,S]=s.useState([]),[j,z]=s.useState([]),[A,I]=s.useState([]),[L,R]=s.useState([]),[D,_]=s.useState({}),[T,w]=s.useState([]),v=s.useCallback(async()=>{a(!0),i(null);try{const[N,C,P,ue,Re,Ke]=await Promise.all([ft.getAll(),Ia.getAll(),zt.getAll(),Aa.getAll(),Da.getAll(),Ea.getAll()]);Kn("[DataContext] Tier 1 loaded:",{inventory:N?.length||0,categories:C?.length||0,users:P?.length||0}),f(N||[]),R(C?.map(qe=>qe.name)||[]),S(P||[]),z(ue||Dr),I(Re||[]),_(Ke||{}),m(!0)}catch(N){X("[DataContext] Tier 1 load failed:",N),i(N)}finally{a(!1)}try{const[N,C,P,ue,Re]=await Promise.all([Ct.getAll(),en.getAll(),tn.getAll(),Jt.getAll(),Qn.getAll({limit:100})]);Kn("[DataContext] Tier 2 loaded:",{reservations:N?.length||0,packages:C?.length||0,packLists:P?.length||0,clients:ue?.length||0});const Ke={};(N||[]).forEach(qe=>{Ke[qe.itemId]||(Ke[qe.itemId]=[]),Ke[qe.itemId].push(qe)}),f(qe=>qe.map(it=>({...it,reservations:Ke[it.id]||it.reservations||[]}))),u(C||[]),p(P||[]),y(ue||[]),w(Re||[])}catch(N){X("[DataContext] Tier 2 load failed (non-critical):",N)}},[]);s.useEffect(()=>{v()},[v]);const O=s.useCallback(async N=>{const C={...N,timestamp:new Date().toISOString()};try{await Qn.create(C)}catch(P){X("Failed to create audit log:",P)}w(P=>[C,...P])},[]),$=s.useCallback(async N=>{f(N)},[]),K=s.useCallback(async(N,C)=>{try{await ft.update(N,C)}catch(P){throw X("Failed to update item:",P),P}f(P=>P.map(ue=>ue.id===N?{...ue,...C}:ue))},[]),Y=s.useCallback(async N=>{let C=N;try{C=await ft.create(N)}catch(P){throw X("Failed to create item:",P),P}return f(P=>[...P,C]),C},[]),J=s.useCallback(async N=>{try{await ft.delete(N)}catch(C){throw X("Failed to delete item:",C),C}f(C=>C.filter(P=>P.id!==N))},[]),ie=s.useCallback(async N=>{try{return await ft.getByIdWithDetails(N)}catch(C){return X("Failed to fetch item details:",C),d.find(P=>P.id===N)||null}},[d]),_e=s.useCallback(async(N,C)=>{try{const P={item_id:N,user_name:C.user,text:C.text,parent_id:C.parentId||null,deleted:!1};return await rn.create(P)}catch(P){return X("Failed to save note:",P),null}},[]),ve=s.useCallback(async N=>{try{await rn.softDelete(N)}catch(C){X("Failed to delete note:",C)}},[]),B=s.useCallback(async(N,C)=>{try{const P={item_id:N,title:C.title,description:C.description||"",due_date:C.dueDate,recurrence:C.recurrence||"none",completed:!1,created_by_name:C.createdBy||"Unknown"};return await sn.create(P)}catch(P){return X("Failed to save reminder:",P),null}},[]),G=s.useCallback(async(N,C)=>{try{const P={};C.completed!==void 0&&(P.completed=C.completed),C.completedDate!==void 0&&(P.completed_at=C.completedDate),C.title!==void 0&&(P.title=C.title),C.dueDate!==void 0&&(P.due_date=C.dueDate),await sn.update(N,P)}catch(P){X("Failed to update reminder:",P)}},[]),q=s.useCallback(async N=>{try{await sn.delete(N)}catch(C){X("Failed to delete reminder:",C)}},[]),Q=s.useCallback(async(N,C)=>{try{const P=Kr(C);if(!P.isValid)throw new Error("Validation failed: "+Object.values(P.errors).join(", "));const ue={item_id:N,type:C.type,description:C.description||"",vendor:C.vendor||null,cost:C.cost||0,scheduled_date:C.date||C.scheduledDate||null,completed_date:C.completedDate||null,status:C.status||"completed",notes:C.notes||"",created_by_name:C.performedBy||"Unknown"};return await on.create(ue)}catch(P){return X("Failed to save maintenance record:",P),null}},[]),Z=s.useCallback(async(N,C)=>{try{await on.update(N,C)}catch(P){X("Failed to update maintenance record:",P)}},[]),W=s.useCallback(async N=>{try{await on.delete(N)}catch(C){X("Failed to delete maintenance record:",C)}},[]),le=s.useCallback(async(N,C)=>{try{const P=Ur(C);if(!P.isValid)throw new Error("Validation failed: "+Object.values(P.errors).join(", "));const ue={item_id:N,client_id:C.clientId||null,project:C.project,project_type:C.projectType||"Other",start_date:C.start,end_date:C.end,status:C.status||"confirmed",contact_name:C.user,contact_phone:C.contactPhone||"",contact_email:C.contactEmail||"",location:C.location||"",notes:C.notes||[]};return await Ct.create(ue)}catch(P){throw X("Failed to create reservation:",P),P}},[]),H=s.useCallback(async(N,C)=>{try{const P={};C.project!==void 0&&(P.project=C.project),C.projectType!==void 0&&(P.project_type=C.projectType),C.start!==void 0&&(P.start_date=C.start),C.end!==void 0&&(P.end_date=C.end),C.status!==void 0&&(P.status=C.status),C.user!==void 0&&(P.contact_name=C.user),C.contactPhone!==void 0&&(P.contact_phone=C.contactPhone),C.contactEmail!==void 0&&(P.contact_email=C.contactEmail),C.location!==void 0&&(P.location=C.location),C.clientId!==void 0&&(P.client_id=C.clientId),await Ct.update(N,P)}catch(P){throw X("Failed to update reservation:",P),P}},[]),se=s.useCallback(async N=>{try{await Ct.delete(N)}catch(C){throw X("Failed to delete reservation:",C),C}},[]),ae=s.useCallback(async(N,C)=>{try{const P=await ft.checkOut(N,C);return f(ue=>ue.map(Re=>Re.id===N?{...Re,status:"checked-out",checkedOutTo:C.userName,checkedOutToUserId:C.userId,checkedOutDate:new Date().toISOString().split("T")[0],dueBack:C.dueBack,checkoutProject:C.project,checkoutClientId:C.clientId}:Re)),P}catch(P){throw X("Failed to check out item:",P),P}},[]),V=s.useCallback(async(N,C)=>{try{const{returnedBy:P,userId:ue,condition:Re,conditionNotes:Ke,returnNotes:qe,damageReported:it,damageDescription:Et}=C,Wt=await ft.checkIn(N,{userId:ue,userName:P,notes:qe||Ke,condition:Re}),Ft=it?"needs-attention":"available";if(f(ct=>ct.map(dt=>dt.id===N?{...dt,status:Ft,condition:Re,checkedOutTo:null,checkedOutToUserId:null,checkedOutDate:null,dueBack:null,checkoutProject:null,checkoutClientId:null}:dt)),it&&Et)try{await rn.create({item_id:N,user_name:P||"System",text:`‚ö†Ô∏è Damage reported: ${Et}`})}catch(ct){X("Failed to add damage note:",ct)}return Wt}catch(P){throw X("Failed to check in item:",P),P}},[]),pe=s.useCallback(async N=>{u(N)},[]),ge=s.useCallback(async N=>{let C=N;try{C=await en.create(N)}catch(P){throw X("Failed to create package:",P),P}return u(P=>[...P,C]),C},[]),be=s.useCallback(async(N,C)=>{try{await en.update(N,C)}catch(P){throw X("Failed to update package:",P),P}u(P=>P.map(ue=>ue.id===N?{...ue,...C}:ue))},[]),ke=s.useCallback(async N=>{try{await en.delete(N)}catch(C){throw X("Failed to delete package:",C),C}u(C=>C.filter(P=>P.id!==N))},[]),re=s.useCallback(async N=>{p(N)},[]),Se=s.useCallback(async N=>{let C=N;try{C=await tn.create(N)}catch(P){throw X("Failed to create pack list:",P),P}return p(P=>[...P,C]),C},[]),Te=s.useCallback(async(N,C)=>{try{await tn.update(N,C)}catch(P){throw X("Failed to update pack list:",P),P}p(P=>P.map(ue=>ue.id===N?{...ue,...C}:ue))},[]),$e=s.useCallback(async N=>{try{await tn.delete(N)}catch(C){throw X("Failed to delete pack list:",C),C}p(C=>C.filter(P=>P.id!==N))},[]),xe=s.useCallback(async N=>{y(N)},[]),de=s.useCallback(async N=>{const C=Gr(N);if(!C.isValid)throw new Error("Validation failed: "+Object.values(C.errors).join(", "));let P=N;try{P=await Jt.create(N)}catch(ue){throw X("Failed to create client:",ue),ue}return y(ue=>[...ue,P]),P},[]),ce=s.useCallback(async(N,C)=>{try{await Jt.update(N,C)}catch(P){throw X("Failed to update client:",P),P}y(P=>P.map(ue=>ue.id===N?{...ue,...C}:ue))},[]),Ie=s.useCallback(async N=>{try{await Jt.delete(N)}catch(C){throw X("Failed to delete client:",C),C}y(C=>C.filter(P=>P.id!==N))},[]),Xe=s.useCallback(async N=>{S(N)},[]),et=s.useCallback(async N=>{z(N)},[]),tt=s.useCallback(async N=>{I(N)},[]),nt=s.useCallback(async N=>{R(N)},[]),at=s.useCallback(async N=>{_(N)},[]),Oe=s.useCallback(async(N,C)=>{try{await Xn.upsert(N,C)}catch(P){throw X("Failed to save notification preferences:",P),P}return C},[]),Ue=s.useCallback(async N=>{try{return await Xn.getByUserId(N)}catch(C){return X("Failed to get notification preferences:",C),null}},[]),Ce=s.useCallback(async({borrowerEmail:N,borrowerName:C,item:P,checkoutDate:ue,dueDate:Re,project:Ke})=>{try{return await Sn.sendCheckoutConfirmation({borrowerEmail:N,borrowerName:C,item:P,checkoutDate:ue,dueDate:Re,project:Ke})}catch(qe){return X("Failed to send checkout email:",qe),{success:!1,error:qe.message}}},[]),rt=s.useCallback(async({borrowerEmail:N,borrowerName:C,item:P,returnDate:ue})=>{try{return await Sn.sendCheckinConfirmation({borrowerEmail:N,borrowerName:C,item:P,returnDate:ue})}catch(Re){return X("Failed to send checkin email:",Re),{success:!1,error:Re.message}}},[]),_t=s.useCallback(async({userEmail:N,userName:C,item:P,reservation:ue})=>{try{return await Sn.sendReservationConfirmation({userEmail:N,userName:C,item:P,reservation:ue})}catch(Re){return X("Failed to send reservation email:",Re),{success:!1,error:Re.message}}},[]),It=s.useMemo(()=>({loading:n,error:r,dataLoaded:l,inventory:d,packages:h,packLists:g,clients:k,users:x,roles:j,locations:A,categories:L,specs:D,auditLog:T,refreshData:v,setInventory:f,setPackages:u,setPackLists:p,setClients:y,setUsers:S,setRoles:z,setLocations:I,setCategories:R,setSpecs:_,setAuditLog:w,updateInventory:$,updateItem:K,createItem:Y,deleteItem:J,getItemWithDetails:ie,addItemNote:_e,deleteItemNote:ve,addItemReminder:B,updateItemReminder:G,deleteItemReminder:q,addMaintenance:Q,updateMaintenance:Z,deleteMaintenance:W,createReservation:le,updateReservation:H,deleteReservation:se,checkOutItem:ae,checkInItem:V,updatePackages:pe,createPackage:ge,updatePackage:be,deletePackage:ke,updatePackLists:re,createPackList:Se,updatePackList:Te,deletePackList:$e,updateClients:xe,createClient:de,updateClient:ce,deleteClient:Ie,saveNotificationPreferences:Oe,getNotificationPreferences:Ue,sendCheckoutEmail:Ce,sendCheckinEmail:rt,sendReservationEmail:_t,updateUsers:Xe,updateRoles:et,updateLocations:tt,updateCategories:nt,updateSpecs:at,addAuditLog:O}),[n,r,l,d,h,g,k,x,j,A,L,D,T,v,$,K,Y,J,ie,_e,ve,B,G,q,Q,Z,W,le,H,se,ae,V,pe,ge,be,ke,re,Se,Te,$e,xe,de,ce,Ie,Oe,Ue,Ce,rt,_t,Xe,et,tt,nt,at,O]);return t.jsx(Qr.Provider,{value:It,children:e})}function In(){const e=s.useContext(Qr);if(!e)throw new Error("useData must be used within a DataProvider");return e}function Jn({size:e=40,color:n="#6366f1",className:a=""}){return t.jsxs("svg",{className:a,width:e,height:e,viewBox:"0 0 24 24",fill:"none",style:{animation:"spin 1s linear infinite"},children:[t.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:n,strokeWidth:"3",strokeOpacity:"0.25",fill:"none"}),t.jsx("path",{d:"M12 2a10 10 0 0 1 10 10",stroke:n,strokeWidth:"3",strokeLinecap:"round",fill:"none"}),t.jsx("style",{children:`
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]})}function Vs({message:e="Loading..."}){return t.jsxs("div",{style:Ot.fullPage,children:[t.jsx(Jn,{size:48}),t.jsx("p",{style:Ot.message,children:e})]})}function Ws(){return t.jsx("div",{style:Ot.modalBackdrop,children:t.jsxs("div",{style:Ot.modalLoadingBox,children:[t.jsx(Jn,{size:32}),t.jsx("p",{style:Ot.modalLoadingText,children:"Loading..."})]})})}function Ne({message:e="Loading view..."}){return t.jsxs("div",{style:Ot.viewLoading,children:[t.jsx(Jn,{size:36}),t.jsx("p",{style:Ot.viewLoadingText,children:e})]})}const Ot={fullPage:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",backgroundColor:"#1a1a2e",color:"#94a3b8",fontFamily:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},message:{marginTop:"16px",fontSize:"16px",color:"#94a3b8"},modalBackdrop:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},modalLoadingBox:{backgroundColor:"#16213e",borderRadius:"12px",padding:"32px 48px",display:"flex",flexDirection:"column",alignItems:"center",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)"},modalLoadingText:{marginTop:"16px",fontSize:"14px",color:"#94a3b8"},viewLoading:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px 20px",minHeight:"300px"},viewLoadingText:{marginTop:"16px",fontSize:"14px",color:"#64748b"}};var sa={exports:{}},oa,cr;function Fs(){if(cr)return oa;cr=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return oa=e,oa}var la,dr;function Hs(){if(dr)return la;dr=1;var e=Fs();function n(){}function a(){}return a.resetWarningCache=n,la=function(){function r(m,d,f,h,u,g){if(g!==e){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}r.isRequired=r;function i(){return r}var l={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:i,element:r,elementType:r,instanceOf:i,node:r,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:a,resetWarningCache:n};return l.PropTypes=l,l},la}var ur;function Us(){return ur||(ur=1,sa.exports=Hs()()),sa.exports}var Gs=Us();const E=xr(Gs),La=s.memo(function({onClick:n,children:a="Back"}){return t.jsxs("button",{onClick:n,type:"button","aria-label":`Go back: ${a}`,style:{...me.btnSec,marginBottom:c[4],border:"none",background:"none",padding:0,color:o.textSecondary,display:"flex",alignItems:"center",gap:c[2],cursor:"pointer"},children:[t.jsx(xi,{size:18,"aria-hidden":"true"})," ",a]})}),Ks=s.memo(function({title:n,subtitle:a,action:r,backButton:i,onBack:l,backLabel:m="Back"}){return t.jsxs(t.Fragment,{children:[(i||l)&&t.jsx(La,{onClick:l,children:m}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:c[5]},children:[t.jsxs("div",{children:[t.jsx("h2",{style:{margin:0,color:o.textPrimary},children:n}),a&&t.jsx("p",{style:{margin:`${c[1]}px 0 0`,color:o.textMuted,fontSize:b.fontSize.sm},children:a})]}),r]})]})}),Ys=s.memo(function({canDrag:n=!0,size:a=16}){return t.jsx("div",{style:{display:"flex",alignItems:"center",color:n?o.textMuted:o.borderLight,cursor:n?"grab":"default"},children:t.jsx(Si,{size:a})})}),Le=s.memo(function({text:n,children:a,color:r=o.primary,size:i="sm"}){const l={xs:{padding:"2px 5px",fontSize:"9px"},sm:{padding:"3px 8px",fontSize:"10px"},md:{padding:"4px 10px",fontSize:"11px"}},m=n||a;return m?t.jsx("span",{style:{display:"inline-flex",alignItems:"center",background:te(r,25),color:r,borderRadius:F.full,fontWeight:b.fontWeight.medium,textTransform:"uppercase",letterSpacing:"0.3px",whiteSpace:"nowrap",...l[i]},children:m}):null}),Ae=s.memo(s.forwardRef(function({children:n,variant:a="primary",size:r="md",disabled:i=!1,danger:l=!1,fullWidth:m=!1,icon:d,iconOnly:f=!1,"aria-label":h,onClick:u,style:g,className:p,type:k="button",...y},x){const S=[a==="primary"?"btn":"btn-secondary",l&&"btn-danger",r==="sm"&&"btn-sm",m&&"btn-full",p].filter(Boolean).join(" "),z=h||(f||d&&!n?"Button":void 0);return t.jsxs("button",{ref:x,className:S,style:g,disabled:i,onClick:u,type:k,"aria-label":z,"aria-disabled":i||void 0,...y,children:[d&&t.jsx(d,{size:r==="sm"?14:16,"aria-hidden":"true"}),n]})})),lt=s.memo(function({children:n,padding:a=!0,onClick:r,style:i,className:l,...m}){const d=!!r,f=["card",d&&"card-clickable",l].filter(Boolean).join(" ");return t.jsx("div",{className:f,style:{...a&&{padding:c[4]},...d&&{cursor:"pointer"},...i},onClick:r,tabIndex:d?0:void 0,role:d?"button":void 0,onKeyDown:d?h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),r?.(h))}:void 0,...m,children:n})}),Zn=s.memo(function({title:n,icon:a,action:r,children:i}){return t.jsxs("div",{style:{padding:`${c[4]}px`,borderBottom:`1px solid ${o.borderLight}`,display:"flex",alignItems:"center",gap:c[2]},children:[a&&t.jsx(a,{size:16,color:o.primary}),t.jsx("strong",{style:{color:o.textPrimary,flex:1},children:n}),r,i]})}),At=(e,n)=>{if(e.startsWith("rgba")||e.startsWith("rgb"))return e;if(e.startsWith("var(")){const l=Math.round(n*100);return`color-mix(in srgb, ${e} ${l}%, transparent)`}const a=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,r=e.replace(a,(l,m,d,f)=>m+m+d+d+f+f),i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return i?`rgba(${parseInt(i[1],16)}, ${parseInt(i[2],16)}, ${parseInt(i[3],16)}, ${n})`:e};function Fe({title:e,icon:n,badge:a,badgeColor:r,collapsed:i,onToggleCollapse:l,action:m,children:d,padding:f=!0,style:h,headerColor:u}){const g=u||o.primary;return t.jsxs("div",{style:{background:At(g,.18),borderRadius:F.lg,border:`1px solid ${At(g,.35)}`,overflow:"hidden",...h},children:[t.jsxs("div",{className:"collapsible-header",onClick:l,style:{"--section-accent-color":g,padding:`${c[3]}px ${c[4]}px`,display:"flex",alignItems:"center",gap:c[2],cursor:"pointer",userSelect:"none",background:i?At(g,.3):At(g,.38),borderBottom:i?"none":`1px solid ${At(g,.4)}`,borderLeft:`4px solid ${g}`},children:[n&&t.jsx(n,{size:16,color:g}),t.jsx("strong",{style:{color:o.textPrimary,flex:1},children:e}),a!=null&&t.jsx("span",{style:{background:At(g,.5),color:o.textPrimary,padding:"2px 8px",borderRadius:F.full,fontSize:b.fontSize.xs,fontWeight:b.fontWeight.medium},children:a}),m&&t.jsx("div",{onClick:p=>p.stopPropagation(),children:m})]}),!i&&t.jsx("div",{style:{padding:f?c[4]:0,background:At(g,.3)},children:d})]})}const Qs=s.memo(s.forwardRef(function({label:n,error:a,icon:r,style:i,containerStyle:l,className:m,...d},f){const h=["input",a&&"input-error",m].filter(Boolean).join(" ");return t.jsxs("div",{style:l,children:[n&&t.jsx("label",{className:a?"label label-error":"label",children:n}),t.jsxs("div",{style:{position:"relative"},children:[r&&t.jsx("div",{style:{position:"absolute",left:c[3],top:"50%",transform:"translateY(-50%)",color:o.textMuted},children:t.jsx(r,{size:16})}),t.jsx("input",{ref:f,className:h,style:{...r&&{paddingLeft:c[10]},...i},...d})]}),a&&t.jsx("span",{style:{color:o.danger,fontSize:b.fontSize.xs,marginTop:c[1]},children:a})]})})),Xs=s.memo(s.forwardRef(function({label:n,options:a,style:r,className:i,...l},m){const d=["select",i].filter(Boolean).join(" ");return t.jsxs("div",{children:[n&&t.jsx("label",{className:"label",children:n}),t.jsx("select",{ref:m,className:d,style:r,...l,children:a.map(f=>t.jsx("option",{value:f.value,children:f.label},f.value))})]})})),hn=s.memo(function({icon:n,value:a,label:r,color:i=o.primary,onClick:l}){return t.jsxs("div",{onClick:l,style:{padding:c[5],textAlign:"center",borderRadius:F.xl,border:`1px solid ${o.border}`,background:o.bgLight,boxShadow:"0 1px 3px rgba(0,0,0,0.1)",...l&&{cursor:"pointer"}},children:[t.jsx("div",{style:{width:48,height:48,margin:"0 auto 12px",background:o.bgMedium,border:`1px solid ${o.border}`,borderRadius:F.xl,display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx(n,{size:24,color:i})}),t.jsx("div",{style:{fontSize:b.fontSize["2xl"],fontWeight:b.fontWeight.bold,color:i,marginBottom:c[1]},children:a}),t.jsx("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted,textTransform:"uppercase",letterSpacing:"0.5px"},children:r})]})}),Zs=s.memo(function({src:n,alt:a="",size:r=56,borderRadius:i=F.md,showPlaceholder:l=!0}){return n?t.jsx("img",{src:n,alt:a,style:{width:r,height:r,borderRadius:i,objectFit:"cover"}}):l?t.jsxs("div",{style:{width:r,height:r,borderRadius:i,background:`${te(o.primary,15)}`,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:o.textMuted},children:[t.jsxs("svg",{width:r*.4,height:r*.4,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[t.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),t.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),t.jsx("polyline",{points:"21 15 16 10 5 21"})]}),r>=48&&t.jsx("span",{style:{fontSize:Math.max(8,r*.15),marginTop:2},children:"No Image"})]}):null}),Js=s.memo(function({isOpen:n,onClose:a,title:r,maxWidth:i=500,children:l}){return n?t.jsx("div",{className:"modal-backdrop",style:me.modal,onClick:a,children:t.jsxs("div",{onClick:m=>m.stopPropagation(),style:{...me.modalBox,maxWidth:i},role:"dialog","aria-modal":"true","aria-labelledby":r?"modal-title":void 0,children:[r&&t.jsxs("div",{style:{padding:c[4],borderBottom:`1px solid ${o.borderLight}`,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsx("h3",{id:"modal-title",style:{margin:0,fontSize:b.fontSize.lg,color:o.textPrimary},children:r}),t.jsx("button",{onClick:a,className:"modal-close","aria-label":"Close modal",type:"button",style:{background:"none",border:"none",color:o.textMuted,cursor:"pointer",padding:c[2],borderRadius:F.full,display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsxs("svg",{width:20,height:20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",children:[t.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),t.jsx("div",{style:{padding:c[4]},children:l})]})}):null}),eo=s.memo(function({icon:n,title:a,description:r,action:i}){return t.jsxs(lt,{style:{padding:c[12],textAlign:"center"},children:[n&&t.jsx("div",{style:{width:64,height:64,margin:"0 auto 16px",background:`${te(o.primary,20)}`,borderRadius:F["2xl"],display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx(n,{size:32,color:o.primary})}),t.jsx("h3",{style:{margin:"0 0 8px",fontSize:b.fontSize.lg,color:o.textPrimary},children:a}),r&&t.jsx("p",{style:{color:o.textMuted,marginBottom:c[5]},children:r}),i]})}),Zr=s.memo(function({isOpen:n,title:a="Confirm",message:r,confirmText:i="Delete",cancelText:l="Cancel",onConfirm:m,onCancel:d,danger:f=!0}){const h=s.useRef(null),u=s.useRef(null);s.useEffect(()=>{if(n)return u.current?.focus(),document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}},[n]);const g=s.useCallback(p=>{p.key==="Escape"&&(p.preventDefault(),d())},[d]);return n?t.jsx("div",{className:"modal-backdrop",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:d,role:"presentation",children:t.jsxs("div",{ref:h,onClick:p=>p.stopPropagation(),onKeyDown:g,role:"alertdialog","aria-modal":"true","aria-labelledby":"confirm-dialog-title","aria-describedby":"confirm-dialog-message",style:{background:o.bgMedium,borderRadius:F.xl,border:`1px solid ${o.border}`,width:"100%",maxWidth:400,overflow:"hidden",boxShadow:"0 20px 50px rgba(0,0,0,0.4)"},children:[t.jsxs("div",{style:{padding:c[5]},children:[t.jsx("h3",{id:"confirm-dialog-title",style:{margin:`0 0 ${c[3]}px`,fontSize:b.fontSize.lg,color:o.textPrimary},children:a}),t.jsx("p",{id:"confirm-dialog-message",style:{margin:0,color:o.textSecondary,fontSize:b.fontSize.sm,lineHeight:1.5},children:r})]}),t.jsxs("div",{style:{padding:c[4],borderTop:`1px solid ${o.borderLight}`,display:"flex",gap:c[3],justifyContent:"flex-end"},children:[t.jsx("button",{ref:u,onClick:d,type:"button",style:{...me.btnSec,padding:`${c[2]}px ${c[4]}px`},children:l}),t.jsx("button",{onClick:m,type:"button",style:{...me.btn,padding:`${c[2]}px ${c[4]}px`,background:f?o.danger:o.primary},children:i})]})]})}):null}),ea=s.memo(function({value:n,onChange:a,placeholder:r="Search...",onClear:i,"aria-label":l="Search",id:m,style:d={},...f}){const h=m||`search-input-${Math.random().toString(36).substr(2,9)}`,[u,g]=s.useState(!1);return t.jsxs("div",{role:"search",style:{display:"flex",alignItems:"center",gap:c[2],...me.input,padding:"12px 16px",...u&&{borderColor:o.primary,boxShadow:`0 0 0 2px color-mix(in srgb, ${o.primary} 20%, transparent)`},...d},children:[t.jsxs("svg",{width:18,height:18,viewBox:"0 0 24 24",fill:"none",stroke:o.textMuted,strokeWidth:"2","aria-hidden":"true",children:[t.jsx("circle",{cx:"11",cy:"11",r:"8"}),t.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),t.jsx("input",{id:h,type:"text",value:n,onChange:p=>a(p.target.value),placeholder:r,"aria-label":l,onFocus:()=>g(!0),onBlur:()=>g(!1),style:{background:"none",border:"none",color:o.textPrimary,flex:1,outline:"none",fontSize:b.fontSize.base,padding:0,margin:0,WebkitAppearance:"none",MozAppearance:"none",appearance:"none",boxShadow:"none"},...f}),n&&i&&t.jsx("button",{onClick:i,type:"button","aria-label":"Clear search",style:{background:"none",border:"none",color:o.textMuted,cursor:"pointer",padding:2},children:t.jsxs("svg",{width:14,height:14,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",children:[t.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})}),to=s.memo(function({name:n,src:a,size:r=40,style:i}){const l=n?.charAt(0)?.toUpperCase()||"?";return a?t.jsx("img",{src:a,alt:n,style:{width:r,height:r,borderRadius:F.md,objectFit:"cover",...i}}):t.jsx("div",{style:{width:r,height:r,borderRadius:F.md,background:`linear-gradient(135deg, ${o.primary}, ${o.accent1})`,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:b.fontWeight.semibold,color:o.textPrimary,fontSize:r*.4,...i},children:l})}),no=s.memo(function({spacing:n=4}){return t.jsx("hr",{style:{border:"none",borderTop:`1px solid ${o.borderLight}`,margin:`${c[n]}px 0`}})}),ao=s.memo(function({children:n,columns:a="auto-fill",minWidth:r=180,gap:i=4,style:l}){return t.jsx("div",{style:{display:"grid",gridTemplateColumns:`repeat(${a}, minmax(${r}px, 1fr))`,gap:c[i],...l},children:n})}),ro=s.memo(function({children:n,direction:a="row",align:r="center",justify:i="flex-start",gap:l=2,wrap:m=!1,style:d,...f}){return t.jsx("div",{style:{display:"flex",flexDirection:a,alignItems:r,justifyContent:i,gap:c[l],flexWrap:m?"wrap":"nowrap",...d},...f,children:n})}),Jr=s.memo(function({page:n,totalPages:a,totalItems:r,pageSize:i,onPageChange:l,showItemCount:m=!0}){if(a<=1)return null;const d=(n-1)*i+1,f=Math.min(n*i,r),h=()=>{const g=[];if(a<=5)for(let k=1;k<=a;k++)g.push(k);else{g.push(1);let k=Math.max(2,n-1),y=Math.min(a-1,n+1);n<=3&&(y=4),n>=a-2&&(k=a-3),k>2&&g.push("...");for(let x=k;x<=y;x++)g.push(x);y<a-1&&g.push("..."),g.push(a)}return g},u=g=>({...me.btnSec,minWidth:36,height:36,padding:0,justifyContent:"center",background:g?o.primary:"transparent",color:g?"#fff":o.textPrimary,border:g?"none":`1px solid ${o.border}`,fontWeight:g?b.fontWeight.medium:b.fontWeight.normal});return t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:c[5],paddingTop:c[4],borderTop:`1px solid ${o.borderLight}`},children:[m&&t.jsxs("div",{style:{fontSize:b.fontSize.sm,color:o.textMuted},children:["Showing ",d,"-",f," of ",r," items"]}),t.jsxs("div",{style:{display:"flex",gap:c[1],alignItems:"center"},children:[t.jsx("button",{onClick:()=>l(n-1),disabled:n===1,style:{...u(!1),opacity:n===1?.5:1,cursor:n===1?"not-allowed":"pointer"},children:"‚Äπ"}),h().map((g,p)=>g==="..."?t.jsx("span",{style:{padding:`0 ${c[2]}px`,color:o.textMuted},children:"‚Ä¶"},`ellipsis-${p}`):t.jsx("button",{onClick:()=>l(g),style:u(g===n),children:g},g)),t.jsx("button",{onClick:()=>l(n+1),disabled:n===a,style:{...u(!1),opacity:n===a?.5:1,cursor:n===a?"not-allowed":"pointer"},children:"‚Ä∫"})]})]})}),ei=s.memo(function({size:n=24,color:a=o.primary,style:r}){return t.jsx("div",{style:{width:n,height:n,border:`2px solid ${te(a,30)}`,borderTopColor:a,borderRadius:"50%",animation:"spin 0.8s linear infinite",...r},children:t.jsx("style",{children:`
        @keyframes spin {
          to { transform: rotate(360deg); }
        }
      `})})}),io=s.memo(function({message:n="Loading...",fullScreen:a=!1}){const r=a?{position:"fixed",inset:0,background:"rgba(0,0,0,0.7)",zIndex:1e3}:{position:"absolute",inset:0,background:`${o.bgDark}cc`};return t.jsxs("div",{style:{...r,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:c[3]},children:[t.jsx(ei,{size:32}),t.jsx("span",{style:{color:o.textMuted,fontSize:b.fontSize.sm},children:n})]})}),so=s.memo(function({children:n,as:a="span"}){return t.jsx(a,{style:{position:"absolute",width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:0},children:n})}),oo=s.memo(function({children:n,politeness:a="polite",atomic:r=!0}){return t.jsx("div",{role:"status","aria-live":a,"aria-atomic":r,style:{position:"absolute",width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:0},children:n})}),ti=s.memo(function({targetId:n="main-content",children:a="Skip to main content"}){return t.jsx("a",{href:`#${n}`,style:{position:"absolute",left:-9999,top:"auto",width:1,height:1,overflow:"hidden",zIndex:9999,padding:`${c[2]}px ${c[4]}px`,background:o.primary,color:"#fff",textDecoration:"none",borderRadius:F.md},onFocus:r=>{r.target.style.left=c[4]+"px",r.target.style.top=c[4]+"px",r.target.style.width="auto",r.target.style.height="auto"},onBlur:r=>{r.target.style.left="-9999px",r.target.style.width="1px",r.target.style.height="1px"},children:a})});La.propTypes={onClick:E.func.isRequired,children:E.node};Ks.propTypes={title:E.string.isRequired,subtitle:E.string,action:E.node,backButton:E.bool,onBack:E.func,backLabel:E.string};Ys.propTypes={canDrag:E.bool,size:E.number};Le.propTypes={text:E.string,children:E.node,color:E.string,size:E.oneOf(["xs","sm","md"])};Ae.propTypes={children:E.node,variant:E.oneOf(["primary","secondary"]),danger:E.bool,fullWidth:E.bool,small:E.bool,icon:E.elementType,disabled:E.bool,onClick:E.func,type:E.oneOf(["button","submit","reset"]),style:E.object};lt.propTypes={children:E.node.isRequired,padding:E.bool,onClick:E.func,className:E.string,style:E.object};Zn.propTypes={title:E.string.isRequired,icon:E.elementType,action:E.node};Qs.propTypes={label:E.string,error:E.string,helper:E.string,required:E.bool,type:E.string,placeholder:E.string,value:E.oneOfType([E.string,E.number]),onChange:E.func,disabled:E.bool};Xs.propTypes={label:E.string,error:E.string,required:E.bool,children:E.node.isRequired,value:E.string,onChange:E.func,disabled:E.bool};hn.propTypes={icon:E.elementType.isRequired,label:E.string.isRequired,value:E.oneOfType([E.string,E.number]).isRequired,color:E.string,onClick:E.func,trend:E.oneOf(["up","down"]),trendValue:E.string};Zs.propTypes={src:E.string,alt:E.string,size:E.number,onClick:E.func,clickable:E.bool};Js.propTypes={onClose:E.func.isRequired,maxWidth:E.number,children:E.node.isRequired};eo.propTypes={icon:E.elementType.isRequired,title:E.string.isRequired,description:E.string,action:E.node};Zr.propTypes={isOpen:E.bool.isRequired,title:E.string.isRequired,message:E.string.isRequired,confirmText:E.string,cancelText:E.string,danger:E.bool,onConfirm:E.func.isRequired,onCancel:E.func.isRequired};ea.propTypes={value:E.string.isRequired,onChange:E.func.isRequired,placeholder:E.string,debounceMs:E.number,onFocus:E.func,onBlur:E.func};to.propTypes={name:E.string,src:E.string,size:E.number,color:E.string};no.propTypes={spacing:E.number};ao.propTypes={children:E.node.isRequired,minWidth:E.number,gap:E.number};ro.propTypes={children:E.node.isRequired,direction:E.oneOf(["row","column"]),align:E.oneOf(["start","center","end","stretch"]),justify:E.oneOf(["start","center","end","between","around"]),gap:E.number,wrap:E.bool};Jr.propTypes={currentPage:E.number.isRequired,totalPages:E.number.isRequired,onPageChange:E.func.isRequired,itemsPerPageOptions:E.arrayOf(E.number),itemsPerPage:E.number,onItemsPerPageChange:E.func,totalItems:E.number};ei.propTypes={size:E.number,color:E.string};io.propTypes={text:E.string,inline:E.bool};so.propTypes={children:E.node.isRequired,as:E.elementType};oo.propTypes={message:E.string,politeness:E.oneOf(["polite","assertive"]),clearAfter:E.number};ti.propTypes={targetId:E.string,children:E.node};const gt={IDLE:"idle",AVAILABLE:"available",INSTALLED:"installed",DISMISSED:"dismissed"};function lo(){const[e,n]=s.useState(gt.IDLE),[a,r]=s.useState(null),[i,l]=s.useState(typeof navigator<"u"?navigator.onLine:!0),[m,d]=s.useState("idle"),[f,h]=s.useState(null),[u,g]=s.useState(!1),p=s.useRef(null);s.useEffect(()=>{const _=()=>{l(!0),console.log("[PWA] Online")},T=()=>{l(!1),console.log("[PWA] Offline")};return window.addEventListener("online",_),window.addEventListener("offline",T),()=>{window.removeEventListener("online",_),window.removeEventListener("offline",T)}},[]),s.useEffect(()=>{const _=w=>{w.preventDefault(),p.current=w,r(w),n(gt.AVAILABLE),console.log("[PWA] Install prompt available")},T=()=>{p.current=null,r(null),n(gt.INSTALLED),console.log("[PWA] App installed")};return window.addEventListener("beforeinstallprompt",_),window.addEventListener("appinstalled",T),window.matchMedia("(display-mode: standalone)").matches&&n(gt.INSTALLED),()=>{window.removeEventListener("beforeinstallprompt",_),window.removeEventListener("appinstalled",T)}},[]);const k=s.useCallback(async()=>{if(!p.current)return console.log("[PWA] No install prompt available"),{outcome:"unavailable"};p.current.prompt();const{outcome:_}=await p.current.userChoice;return console.log("[PWA] Install prompt outcome:",_),n(_==="accepted"?gt.INSTALLED:gt.DISMISSED),p.current=null,r(null),{outcome:_}},[]),y=s.useCallback(()=>{n(gt.DISMISSED),console.log("[PWA] Install dismissed")},[]);s.useEffect(()=>{if(!("serviceWorker"in navigator)){console.log("[PWA] Service workers not supported");return}(async()=>{try{d("installing");const T=await navigator.serviceWorker.register("/sw.js",{scope:"/"});h(T),console.log("[PWA] Service worker registered"),T.addEventListener("updatefound",()=>{const v=T.installing;v&&v.addEventListener("statechange",()=>{v.state==="installed"&&(navigator.serviceWorker.controller?(g(!0),d("updated"),console.log("[PWA] Update available")):(d("installed"),console.log("[PWA] Service worker installed")))})}),T.waiting&&(g(!0),d("updated"));let w=!1;navigator.serviceWorker.addEventListener("controllerchange",()=>{w||(w=!0,window.location.reload())}),d("installed")}catch(T){console.error("[PWA] Service worker registration failed:",T),d("idle")}})()},[]);const x=s.useCallback(()=>{f?.waiting&&(f.waiting.postMessage({type:"SKIP_WAITING"}),g(!1),console.log("[PWA] Updating service worker"))},[f]),S=s.useCallback(async()=>{if(f)try{await f.update(),console.log("[PWA] Checked for updates")}catch(_){console.error("[PWA] Update check failed:",_)}},[f]),j=s.useCallback(async()=>{if("caches"in window){const _=await caches.keys();await Promise.all(_.map(T=>caches.delete(T))),console.log("[PWA] Cache cleared")}},[]),z=s.useCallback(async()=>{if(!("Notification"in window))return console.log("[PWA] Notifications not supported"),"unsupported";const _=await Notification.requestPermission();return console.log("[PWA] Notification permission:",_),_},[]),A=typeof Notification<"u"&&Notification.permission==="granted",I=s.useCallback((_,T={})=>A?new Notification(_,{icon:"/favicon.svg",badge:"/favicon.svg",...T}):(console.log("[PWA] Notifications not enabled"),null),[A]),L=e===gt.AVAILABLE,R=e===gt.INSTALLED||window.matchMedia("(display-mode: standalone)").matches,D=window.matchMedia("(display-mode: standalone)").matches;return{isOnline:i,installStatus:e,canInstall:L,isInstalled:R,isStandalone:D,promptInstall:k,dismissInstall:y,swStatus:m,swRegistration:f,updateAvailable:u,updateServiceWorker:x,checkForUpdates:S,clearCache:j,notificationsEnabled:A,requestNotificationPermission:z,sendNotification:I}}function co({dataContext:e,setInventory:n,setSelectedItem:a,setCurrentView:r,setAuditLog:i,setChangeLog:l,setConfirmDialog:m,inventory:d,selectedItem:f,currentUser:h,currentView:u,specs:g,editingItemId:p,setEditingItemId:k,itemForm:y,setItemForm:x,resetItemForm:S,closeModal:j,openModal:z}){const[A,I]=s.useState(!1),[L,R]=s.useState(null),[D,_]=s.useState([]),T=s.useCallback(B=>{e?.addAuditLog&&e.addAuditLog({...B,user:h?.name||"Unknown"})},[e,h]),w=s.useCallback(B=>{l(G=>[...G,{...B,id:`CL${Date.now()}`,timestamp:new Date().toISOString(),user:h?.name||"Unknown"}])},[h,l]),v=s.useCallback(async()=>{I(!0),R(null);try{const B=Tr(y.category,d.map(Q=>Q.id)),G={};(g[y.category]||[]).forEach(Q=>{y.specs[Q.name]&&(G[Q.name]=y.specs[Q.name])});const q={...y,id:B,status:Me.AVAILABLE,purchasePrice:Number(y.purchasePrice)||0,currentValue:Number(y.currentValue)||Number(y.purchasePrice)||0,quantity:Number(y.quantity)||1,reorderPoint:Number(y.reorderPoint)||0,specs:G,notes:[],reservations:[],reminders:[],maintenanceHistory:[],viewCount:0,checkoutCount:0};if(e?.createItem?await e.createItem(q):n(Q=>[...Q,q]),w({type:"created",itemId:B,itemType:"item",itemName:q.name,description:`Created new item: ${q.name}`,changes:[{field:"item",newValue:q.name}]}),T({type:"item_created",description:`Created item: ${q.name} (${B})`,itemId:B}),q.image&&q.image.startsWith("data:"))try{const{storageService:Q}=await fe(async()=>{const{storageService:W}=await Promise.resolve().then(()=>qo);return{storageService:W}},void 0),Z=await Q.uploadFromDataUrl(q.image,B);Z?.url&&!Z.url.startsWith("data:")&&(e?.updateItem?await e.updateItem(B,{image:Z.url}):n(W=>W.map(le=>le.id===B?{...le,image:Z.url}:le)))}catch(Q){X("Failed to upload image to storage after item creation:",Q)}return j(),S?.(),u===M.ADD_ITEM&&r(M.GEAR_LIST),q}catch(B){throw X("Failed to create item:",B),R(B.message||"Failed to create item"),B}finally{I(!1)}},[y,d,g,j,S,u,r,n,w,e]),O=s.useCallback(async()=>{I(!0),R(null);try{const B={};(g[y.category]||[]).forEach(Z=>{y.specs[Z.name]&&(B[Z.name]=y.specs[Z.name])});const G={...y,specs:B,purchasePrice:Number(y.purchasePrice)||0,currentValue:Number(y.currentValue)||0,quantity:Number(y.quantity)||1,reorderPoint:Number(y.reorderPoint)||0},q=d.find(Z=>Z.id===p),Q=[];if(q){[{key:"name",label:"name"},{key:"brand",label:"brand"},{key:"category",label:"category"},{key:"condition",label:"condition"},{key:"location",label:"location"},{key:"serialNumber",label:"serialNumber"},{key:"purchasePrice",label:"purchasePrice"},{key:"currentValue",label:"currentValue"},{key:"purchaseDate",label:"purchaseDate"},{key:"quantity",label:"quantity"},{key:"reorderPoint",label:"reorderPoint"}].forEach(({key:H,label:se})=>{const ae=q[H],V=G[H];String(ae||"")!==String(V||"")&&Q.push({field:se,oldValue:ae,newValue:V})});const W=q.image||null,le=G.image||null;W!==le&&Q.push({field:"image",oldValue:W?"had image":"no image",newValue:le?"image updated":"image removed"})}e?.updateItem?await e.updateItem(p,G):n(Z=>je(Z,p,G)),f?.id===p&&a(Z=>({...Z,...G})),Q.length>0&&(w({type:"updated",itemId:p,itemType:"item",itemName:G.name,description:`Updated item: ${G.name}`,changes:Q}),T({type:"item_updated",description:`Updated item: ${G.name} (${Q.map(Z=>Z.field).join(", ")})`,itemId:p})),j(),k(null)}catch(B){throw X("Failed to update item:",B),R(B.message||"Failed to update item"),B}finally{I(!1)}},[y,p,f,g,j,d,n,a,k,w,e]),$=s.useCallback(B=>{const G=d.find(q=>q.id===B);m({isOpen:!0,title:"Delete Item",message:"Are you sure you want to delete this item? This action cannot be undone.",onConfirm:async()=>{I(!0),R(null);try{e?.deleteItem?await e.deleteItem(B):n(q=>q.filter(Q=>Q.id!==B)),w({type:"deleted",itemId:B,itemType:"item",itemName:G?.name||"Unknown",description:`Deleted item: ${G?.name||B}`,changes:[{field:"item",oldValue:G?.name}]}),T({type:"item_deleted",description:`Deleted item: ${G?.name||B}`,itemId:B}),f?.id===B&&(a(null),r(M.GEAR_LIST)),m(q=>({...q,isOpen:!1}))}catch(q){X("Failed to delete item:",q),R(q.message||"Failed to delete item"),m(Q=>({...Q,isOpen:!1}))}finally{I(!1)}}})},[f,d,n,a,r,m,w,e]),K=s.useCallback((B,G)=>{switch(_(G),B){case"status":z(ne.BULK_STATUS);break;case"location":z(ne.BULK_LOCATION);break;case"category":z(ne.BULK_CATEGORY);break;case"delete":z(ne.BULK_DELETE);break}},[z]),Y=s.useCallback(async B=>{I(!0),R(null);try{const G=[];for(const q of D){const Q=d.find(Z=>Z.id===q);Q&&(G.push({id:Q.id,name:Q.name,oldStatus:Q.status}),e?.updateItem&&await e.updateItem(q,{status:B}))}e?.updateItem||n(q=>q.map(Q=>D.includes(Q.id)?{...Q,status:B}:Q)),w({type:"bulk_update",itemType:"item",description:`Changed status to "${B}" for ${D.length} items`,changes:G.map(q=>({field:`${q.id} (${q.name})`,oldValue:q.oldStatus,newValue:B}))}),T({type:"bulk_status_change",description:`Bulk status change to "${B}" for ${D.length} items`}),j(),_([])}catch(G){X("Failed to apply bulk status:",G),R(G.message||"Failed to update items")}finally{I(!1)}},[D,d,n,w,j,e]),J=s.useCallback(async B=>{I(!0),R(null);try{const G=[];for(const q of D){const Q=d.find(Z=>Z.id===q);Q&&(G.push({id:Q.id,name:Q.name,oldLocation:Q.location}),e?.updateItem&&await e.updateItem(q,{location:B}))}e?.updateItem||n(q=>q.map(Q=>D.includes(Q.id)?{...Q,location:B}:Q)),w({type:"bulk_update",itemType:"item",description:`Changed location to "${B}" for ${D.length} items`,changes:G.map(q=>({field:`${q.id} (${q.name})`,oldValue:q.oldLocation||"-",newValue:B}))}),T({type:"bulk_location_change",description:`Bulk location change to "${B}" for ${D.length} items`}),j(),_([])}catch(G){X("Failed to apply bulk location:",G),R(G.message||"Failed to update items")}finally{I(!1)}},[D,d,n,w,T,j,e]),ie=s.useCallback(async B=>{I(!0),R(null);try{const G=[];for(const q of D){const Q=d.find(Z=>Z.id===q);Q&&(G.push({id:Q.id,name:Q.name,oldCategory:Q.category}),e?.updateItem&&await e.updateItem(q,{category:B,specs:{}}))}e?.updateItem||n(q=>q.map(Q=>D.includes(Q.id)?{...Q,category:B,specs:{}}:Q)),w({type:"bulk_update",itemType:"item",description:`Changed category to "${B}" for ${D.length} items`,changes:G.map(q=>({field:`${q.id} (${q.name})`,oldValue:q.oldCategory,newValue:B}))}),T({type:"bulk_category_change",description:`Bulk category change to "${B}" for ${D.length} items`}),j(),_([])}catch(G){X("Failed to apply bulk category:",G),R(G.message||"Failed to update items")}finally{I(!1)}},[D,d,n,w,T,j,e]),_e=s.useCallback(async()=>{I(!0),R(null);try{const B=d.filter(G=>D.includes(G.id));for(const G of D)e?.deleteItem&&await e.deleteItem(G);e?.deleteItem||n(G=>G.filter(q=>!D.includes(q.id))),f&&D.includes(f.id)&&(a(null),r(M.GEAR_LIST)),w({type:"bulk_delete",itemType:"item",description:`Deleted ${D.length} items`,changes:B.map(G=>({field:"deleted",oldValue:`${G.id} - ${G.name}`,newValue:null}))}),T({type:"bulk_delete",description:`Bulk deleted ${D.length} items`}),j(),_([])}catch(B){X("Failed to apply bulk delete:",B),R(B.message||"Failed to delete items")}finally{I(!1)}},[D,d,f,n,a,r,w,j,e]),ve=s.useCallback(B=>{k(B.id),x({name:B.name||"",brand:B.brand||"",category:B.category||"Cameras",location:B.location||"",purchaseDate:B.purchaseDate||"",purchasePrice:B.purchasePrice||"",currentValue:B.currentValue||"",serialNumber:B.serialNumber||"",condition:B.condition||"Excellent",image:B.image||null,specs:{...B.specs||{}},quantity:B.quantity??1,reorderPoint:B.reorderPoint??0}),z(ne.EDIT_ITEM)},[k,x,z]);return{isLoading:A,error:L,clearError:()=>R(null),createItem:v,updateItem:O,deleteItem:$,bulkActionIds:D,setBulkActionIds:_,handleBulkAction:K,applyBulkStatus:Y,applyBulkLocation:J,applyBulkCategory:ie,applyBulkDelete:_e,openEditItem:ve,addChangeLog:w}}function uo(e,n=20){const[a,r]=s.useState(1),i=Math.ceil(e.length/n),l=s.useMemo(()=>{const h=(a-1)*n;return e.slice(h,h+n)},[e,a,n]),m=s.useCallback(h=>{r(Math.max(1,Math.min(h,i)))},[i]),d=s.useCallback(()=>{m(a+1)},[a,m]),f=s.useCallback(()=>{m(a-1)},[a,m]);return s.useMemo(()=>{a>i&&i>0&&r(1)},[e.length,i,a]),{page:a,totalPages:i,paginatedItems:l,goToPage:m,nextPage:d,prevPage:f,hasNext:a<i,hasPrev:a>1}}function mo(e,n=300){const[a,r]=s.useState(e);return s.useEffect(()=>{const i=setTimeout(()=>{r(e)},n);return()=>{clearTimeout(i)}},[e,n]),a}const ni=s.createContext(null);function fo({children:e}){const{inventory:n,packages:a}=In(),{isAuthenticated:r}=Ra();return t.jsx(po,{isLoggedIn:r,inventory:n||[],packages:a||[],children:e})}function po({children:e,isLoggedIn:n=!1,inventory:a=[],packages:r=[]}){const[i,l]=s.useState(M.DASHBOARD),[m,d]=s.useState(null),[f,h]=s.useState(null),[u,g]=s.useState(null),[p,k]=s.useState(null),[y,x]=s.useState(null),[S,j]=s.useState(null),z=s.useRef(!1);s.useEffect(()=>{if(!n)return;if(z.current){z.current=!1;return}const O={view:i,selectedItemId:m?.id||null,selectedPackageId:f?.id||null};window.history.state?.view===void 0?window.history.replaceState(O,"",window.location.pathname):(window.history.state?.view!==i||window.history.state?.selectedItemId!==O.selectedItemId)&&window.history.pushState(O,"",window.location.pathname)},[i,m?.id,f?.id,n]),s.useEffect(()=>{const O=$=>{if(n)if(z.current=!0,$.state?.view){if(l($.state.view),$.state.view===M.GEAR_DETAIL&&$.state.selectedItemId){const K=a.find(Y=>Y.id===$.state.selectedItemId);K&&d(K)}else if($.state.view===M.PACKAGE_DETAIL&&$.state.selectedPackageId){const K=r.find(Y=>Y.id===$.state.selectedPackageId);K&&h(K)}}else l(M.DASHBOARD)};return window.addEventListener("popstate",O),()=>window.removeEventListener("popstate",O)},[n,a,r]);const A=s.useCallback(O=>{l(O),window.scrollTo(0,0);const $=document.getElementById("main-content");$&&($.scrollTop=0),O===M.GEAR_LIST?d(null):O===M.PACKAGES?h(null):O===M.PACK_LISTS&&g(null)},[]),I=s.useCallback((O,$=null)=>{d(O),j($),l(M.GEAR_DETAIL),window.scrollTo(0,0)},[]),L=s.useCallback(O=>{h(O),l(M.PACKAGE_DETAIL),window.scrollTo(0,0)},[]),R=s.useCallback(O=>{g(O),l(M.PACK_LIST_DETAIL),window.scrollTo(0,0)},[]),D=s.useCallback((O,$)=>{k(O),x($),l(M.RESERVATION_DETAIL),window.scrollTo(0,0)},[]),_=s.useCallback(()=>{i===M.GEAR_DETAIL?(d(null),l(S||M.GEAR_LIST),j(null)):i===M.PACKAGE_DETAIL?(h(null),l(M.PACKAGES)):i===M.PACK_LIST_DETAIL?(g(null),l(M.PACK_LISTS)):i===M.RESERVATION_DETAIL?(k(null),x(null),l(M.SCHEDULE)):l(M.DASHBOARD),window.scrollTo(0,0)},[i,S]),T=[M.GEAR_DETAIL,M.PACKAGE_DETAIL,M.PACK_LIST_DETAIL,M.RESERVATION_DETAIL].includes(i),w=s.useCallback(()=>{l(M.DASHBOARD),d(null),h(null),g(null),k(null),x(null),j(null)},[]),v=s.useMemo(()=>({currentView:i,selectedItem:m,selectedPackage:f,selectedPackList:u,selectedReservation:p,selectedReservationItem:y,itemBackContext:S,isDetailView:T,setCurrentView:l,setSelectedItem:d,setSelectedPackage:h,setSelectedPackList:g,setSelectedReservation:k,setSelectedReservationItem:x,setItemBackContext:j,navigate:A,navigateToItem:I,navigateToPackage:L,navigateToPackList:R,navigateToReservation:D,goBack:_,resetNavigation:w}),[i,m,f,u,p,y,S,T,A,I,L,R,D,_,w]);return t.jsx(ni.Provider,{value:v,children:e})}function Ma(){const e=s.useContext(ni);if(!e)throw new Error("useNavigationContext must be used within NavigationProvider");return e}const ai=s.createContext(null);function go({children:e,defaultCategoryFilter:n="all",defaultStatusFilter:a="all",defaultGridView:r=!0}){const[i,l]=s.useState(""),[m,d]=s.useState(n),[f,h]=s.useState([]),[u,g]=s.useState("all"),[p,k]=s.useState(a),[y,x]=s.useState([]),[S,j]=s.useState(r),[z,A]=s.useState("week"),[I,L]=s.useState("calendar"),[R,D]=s.useState(Ye()),[_,T]=s.useState([]),w=s.useCallback(re=>l(re),[]),v=s.useCallback(()=>l(""),[]),O=s.useCallback(re=>{d(re),h([])},[]),$=s.useCallback(re=>{h(Se=>Se.includes(re)?Se.filter(Te=>Te!==re):[...Se,re]),d("all")},[]),K=s.useCallback(()=>{d("all"),h([])},[]),Y=s.useCallback(re=>{k(re),x([])},[]),J=s.useCallback(re=>{x(Se=>Se.includes(re)?Se.filter(Te=>Te!==re):[...Se,re]),k("all")},[]),ie=s.useCallback(()=>{k("all"),x([])},[]),_e=s.useCallback(()=>j(re=>!re),[]),ve=s.useCallback(()=>j(!0),[]),B=s.useCallback(()=>j(!1),[]),G=s.useCallback(re=>A(re),[]),q=s.useCallback(re=>L(re),[]),Q=s.useCallback(re=>D(re),[]),Z=s.useCallback(()=>D(Ye()),[]),W=s.useCallback(re=>{T(Se=>Se.includes(re)?Se.filter(Te=>Te!==re):[...Se,re])},[]),le=s.useCallback(re=>T(re),[]),H=s.useCallback(()=>T([]),[]),se=s.useCallback(re=>_.includes(re),[_]),ae=s.useCallback(()=>{l(""),d(n),h([]),k(a),x([]),g("all"),T([])},[n,a]),V=s.useCallback((re={})=>{const{searchFields:Se=["name","code","description"],categoryField:Te="category",statusField:$e="status"}=re;return xe=>{if(i){const de=i.toLowerCase();if(!Se.some(Ie=>xe[Ie]?.toLowerCase?.().includes(de)))return!1}return!(m!=="all"&&xe[Te]!==m||f.length>0&&!f.includes(xe[Te])||p!=="all"&&xe[$e]!==p||y.length>0&&!y.includes(xe[$e]))}},[i,m,f,p,y]),pe=s.useMemo(()=>i!==""||m!=="all"||f.length>0||p!=="all"||y.length>0,[i,m,f,p,y]),ge=_.length,be=ge>0,ke=s.useMemo(()=>({searchQuery:i,setSearchQuery:l,handleSearch:w,clearSearch:v,categoryFilter:m,setCategoryFilter:d,selectedCategories:f,setSelectedCategories:h,packageCategoryFilter:u,setPackageCategoryFilter:g,handleCategoryFilter:O,toggleCategory:$,clearCategoryFilters:K,statusFilter:p,setStatusFilter:k,selectedStatuses:y,setSelectedStatuses:x,handleStatusFilter:Y,toggleStatus:J,clearStatusFilters:ie,isGridView:S,setIsGridView:j,toggleViewMode:_e,setGridView:ve,setListView:B,scheduleView:z,setScheduleView:A,scheduleMode:I,setScheduleMode:L,scheduleDate:R,setScheduleDate:D,handleScheduleView:G,handleScheduleMode:q,handleScheduleDate:Q,resetScheduleToToday:Z,selectedIds:_,setSelectedIds:T,toggleSelection:W,selectAll:le,clearSelection:H,isSelected:se,selectionCount:ge,hasSelection:be,resetAllFilters:ae,createItemFilter:V,hasActiveFilters:pe}),[i,m,f,u,p,y,S,z,I,R,_,ge,be,pe,w,v,O,$,K,Y,J,ie,_e,ve,B,G,q,Q,Z,W,le,H,se,ae,V]);return t.jsx(ai.Provider,{value:ke,children:e})}function ri(){const e=s.useContext(ai);if(!e)throw new Error("useFilterContext must be used within FilterProvider");return e}const ii=s.createContext(null);function ho({children:e}){const[n,a]=s.useState(null),[r,i]=s.useState(null),[l,m]=s.useState(null),[d,f]=s.useState(pn),[h,u]=s.useState(gn),[g,p]=s.useState({isOpen:!1,title:"",message:"",confirmText:"Confirm",cancelText:"Cancel",variant:"default",onConfirm:null,onCancel:null}),[k,y]=s.useState(null),x=s.useCallback((V,pe=null)=>{a(V),y(pe)},[]),S=s.useCallback(()=>{a(null),y(null)},[]),j=s.useCallback(V=>n===V,[n]),z=s.useCallback((V=null)=>{i(null),f(V||{...pn}),a(ne.ADD_ITEM)},[]),A=s.useCallback(V=>{i(V.id),f({name:V.name||"",code:V.code||"",category:V.category||"",subcategory:V.subcategory||"",status:V.status||"available",condition:V.condition||"excellent",location:V.location||"",sublocation:V.sublocation||"",value:V.value||"",serialNumber:V.serialNumber||"",manufacturer:V.manufacturer||"",model:V.model||"",purchaseDate:V.purchaseDate||"",purchasePrice:V.purchasePrice||"",vendor:V.vendor||"",warrantyExpires:V.warrantyExpires||"",description:V.description||"",image:V.image||"",tags:V.tags||[],specs:V.specs||{},customFields:V.customFields||{}}),a(ne.ADD_ITEM)},[]),I=s.useCallback(()=>{a(null),i(null),f({...pn})},[]),L=s.useCallback(V=>{m(null),u({...gn}),y(V),a(ne.ADD_RESERVATION)},[]),R=s.useCallback((V,pe)=>{m(V.id),u({name:V.name||"",start:V.start||"",end:V.end||"",clientId:V.clientId||"",clientName:V.clientName||"",project:V.project||"",notes:V.notes||"",status:V.status||"pending"}),y(pe),a(ne.ADD_RESERVATION)},[]),D=s.useCallback(()=>{a(null),m(null),u({...gn}),y(null)},[]),_=s.useCallback(V=>{y(V),a(ne.CHECK_OUT)},[]),T=s.useCallback(V=>{y(V),a(ne.CHECK_IN)},[]),w=s.useCallback(V=>{y(V),a(ne.QR_CODE)},[]),v=s.useCallback((V={})=>{y(V),a(ne.EXPORT)},[]),O=s.useCallback((V,pe=null)=>{y({item:V,record:pe}),a(ne.MAINTENANCE)},[]),$=s.useCallback(()=>a(ne.CSV_IMPORT),[]),K=s.useCallback(()=>a(ne.QR_SCANNER),[]),Y=s.useCallback(V=>{y({onSelect:V}),a(ne.IMAGE_SELECTOR)},[]),J=s.useCallback(V=>{y({ids:V}),a(ne.BULK_STATUS)},[]),ie=s.useCallback(V=>{y({ids:V}),a(ne.BULK_LOCATION)},[]),_e=s.useCallback(V=>{y({ids:V}),a(ne.BULK_CATEGORY)},[]),ve=s.useCallback(V=>{y({ids:V}),a(ne.BULK_DELETE)},[]),B=s.useCallback(({title:V,message:pe,confirmText:ge="Confirm",cancelText:be="Cancel",variant:ke="default",onConfirm:re,onCancel:Se})=>{p({isOpen:!0,title:V,message:pe,confirmText:ge,cancelText:be,variant:ke,onConfirm:re,onCancel:Se})},[]),G=s.useCallback((V,pe)=>{B({title:"Delete Item",message:`Are you sure you want to delete "${V}"? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel",variant:"danger",onConfirm:pe})},[B]),q=s.useCallback(()=>{p(V=>({...V,isOpen:!1}))},[]),Q=s.useCallback(()=>{g.onConfirm&&g.onConfirm(),q()},[g.onConfirm,q]),Z=s.useCallback(()=>{g.onCancel&&g.onCancel(),q()},[g.onCancel,q]),W=s.useCallback((V,pe)=>{f(ge=>({...ge,[V]:pe}))},[]),le=s.useCallback((V,pe)=>{u(ge=>({...ge,[V]:pe}))},[]),H=s.useCallback(()=>{f({...pn}),i(null)},[]),se=s.useCallback(()=>{u({...gn}),m(null)},[]),ae=s.useMemo(()=>({activeModal:n,setActiveModal:a,modalData:k,setModalData:y,openModal:x,closeModal:S,isModalOpen:j,editingItemId:r,setEditingItemId:i,editingReservationId:l,setEditingReservationId:m,isEditing:r!==null||l!==null,itemForm:d,setItemForm:f,updateItemForm:W,resetItemForm:H,reservationForm:h,setReservationForm:u,updateReservationForm:le,resetReservationForm:se,openAddItemModal:z,openEditItemModal:A,closeItemModal:I,openAddReservationModal:L,openEditReservationModal:R,closeReservationModal:D,openCheckOutModal:_,openCheckInModal:T,openQRModal:w,openExportModal:v,openMaintenanceModal:O,openCSVImportModal:$,openQRScannerModal:K,openImageSelectorModal:Y,openBulkStatusModal:J,openBulkLocationModal:ie,openBulkCategoryModal:_e,openBulkDeleteModal:ve,confirmDialog:g,setConfirmDialog:p,showConfirm:B,showDeleteConfirm:G,closeConfirm:q,handleConfirm:Q,handleCancel:Z}),[n,k,r,l,d,h,g,x,S,j,W,H,le,se,z,A,I,L,R,D,_,T,w,v,O,$,K,Y,J,ie,_e,ve,B,G,q,Q,Z]);return t.jsx(ii.Provider,{value:ae,children:e})}function za(){const e=s.useContext(ii);if(!e)throw new Error("useModalContext must be used within ModalProvider");return e}const si=s.createContext(null),mr={getItem(e){try{return localStorage.getItem(e)}catch{return null}},setItem(e,n){try{localStorage.setItem(e,n)}catch{}}};function bo({children:e,storageKey:n="sims-sidebar-collapsed",defaultCollapsed:a=!1,mobileBreakpoint:r=768}){const[i,l]=s.useState(!1),[m,d]=s.useState(()=>mr.getItem(n)==="true"?!0:a),[f,h]=s.useState(()=>typeof window>"u"?!1:window.innerWidth<r);s.useEffect(()=>{mr.setItem(n,String(m))},[m,n]),s.useEffect(()=>{const I=()=>{const L=window.innerWidth<r;h(L),!L&&i&&l(!1)};return window.addEventListener("resize",I),()=>window.removeEventListener("resize",I)},[r,i]),s.useEffect(()=>{const I=L=>{L.key==="Escape"&&i&&l(!1)};return document.addEventListener("keydown",I),()=>document.removeEventListener("keydown",I)},[i]),s.useEffect(()=>(document.body.style.overflow=i&&f?"hidden":"",()=>{document.body.style.overflow=""}),[i,f]);const u=s.useCallback(()=>l(I=>!I),[]),g=s.useCallback(()=>l(!0),[]),p=s.useCallback(()=>l(!1),[]),k=s.useCallback(()=>d(I=>!I),[]),y=s.useCallback(()=>d(!0),[]),x=s.useCallback(()=>d(!1),[]),S=s.useCallback(()=>{f&&l(!1)},[f]),j=m?64:256,z=f?0:j,A=s.useMemo(()=>({sidebarOpen:i,setSidebarOpen:l,sidebarCollapsed:m,setSidebarCollapsed:d,isMobile:f,toggleSidebarOpen:u,openSidebar:g,closeSidebar:p,toggleSidebarCollapsed:k,collapseSidebar:y,expandSidebar:x,handleNavClick:S,sidebarWidth:j,mainContentMargin:z,isExpanded:!m,showOverlay:i&&f}),[i,m,f,j,z,u,g,p,k,y,x,S]);return t.jsx(si.Provider,{value:A,children:e})}function yo(){const e=s.useContext(si);if(!e)throw new Error("useSidebarContext must be used within SidebarProvider");return e}function xo({inventory:e,setInventory:n,selectedItem:a,setSelectedItem:r,dataContext:i,currentUser:l,openModal:m,closeModal:d,addAuditLog:f,addChangeLog:h}){const[u,g]=s.useState(null),[p,k]=s.useState(null),[y,x]=s.useState(null),[S,j]=s.useState(null),z=s.useCallback(T=>{const w=e.find(v=>v.id===T);w&&(g(w),m(ne.CHECK_OUT))},[e,m]),A=s.useCallback(T=>{const w=e.find(v=>v.id===T);w&&(k(w),m(ne.CHECK_IN))},[e,m]),I=s.useCallback(async T=>{const{itemId:w,borrowerName:v,borrowerEmail:O,borrowerPhone:$,project:K,projectType:Y,dueDate:J,notes:ie,conditionAtCheckout:_e,checkedOutDate:ve,checkedOutTime:B}=T;try{await i.checkOutItem(w,{userId:l?.id,userName:v,clientId:null,clientName:null,project:K,dueBack:J}),a?.id===w&&r(G=>({...G,status:Me.CHECKED_OUT,checkedOutTo:v,checkedOutDate:ve,dueBack:J,checkoutProject:K,checkoutProjectType:Y,checkoutCount:(G.checkoutCount||0)+1})),f({type:"item_checkout",description:`${u?.name||w} checked out to ${v}`,user:l?.name||"Unknown",itemId:w}),h({type:"checkout",itemId:w,itemType:"item",itemName:u?.name||w,description:`Checked out to ${v} for ${K||"unspecified project"}`,changes:[{field:"status",oldValue:Me.AVAILABLE,newValue:Me.CHECKED_OUT},{field:"checkedOutTo",newValue:v},{field:"dueBack",newValue:J}]}),O&&i?.sendCheckoutEmail&&i.sendCheckoutEmail({borrowerEmail:O,borrowerName:v,item:u||{id:w,name:w},checkoutDate:ve,dueDate:J,project:K}).catch(G=>X("Email send failed:",G))}catch(G){X("Checkout process failed:",G),alert("Checkout failed: "+(G.message||"Please try again."))}finally{d(),g(null)}},[l,a,u,d,f,h,i,e]),L=s.useCallback(async T=>{const{itemId:w,returnedBy:v,condition:O,conditionChanged:$,conditionAtCheckout:K,conditionNotes:Y,returnNotes:J,damageReported:ie,damageDescription:_e,returnDate:ve,returnTime:B}=T;try{const G=e.find(W=>W.id===w),q=ie?Me.NEEDS_ATTENTION:Me.AVAILABLE;await i.checkInItem(w,{returnedBy:v,userId:l?.id,condition:O,conditionNotes:Y,returnNotes:J,damageReported:ie,damageDescription:_e}),a?.id===w&&r(W=>({...W,status:q,condition:O,checkedOutTo:null,checkedOutDate:null,dueBack:null,checkoutProject:null})),f({type:"item_checkin",description:`${p?.name||w} returned by ${v}${ie?" (damage reported)":""}`,user:l?.name||"Unknown",itemId:w}),h({type:"checkin",itemId:w,itemType:"item",itemName:p?.name||w,description:`Returned by ${v}${$?` (condition: ${K} ‚Üí ${O})`:""}`,changes:[{field:"status",oldValue:Me.CHECKED_OUT,newValue:ie?Me.NEEDS_ATTENTION:Me.AVAILABLE},{field:"returnedBy",newValue:v},...$?[{field:"condition",oldValue:K,newValue:O}]:[]]});const Z=G?.checkoutHistory?.filter(W=>W.type==="checkout").pop()?.borrowerEmail;Z&&i?.sendCheckinEmail&&i.sendCheckinEmail({borrowerEmail:Z,borrowerName:v,item:p||G||{id:w,name:w},returnDate:ve}).catch(W=>X("Email send failed:",W))}catch(G){X("Checkin process failed:",G),alert("Check-in failed: "+(G.message||"Please try again."))}finally{d(),k(null)}},[l,a,p,d,f,h,i,e]),R=s.useCallback(()=>{a&&(x(a),j(null),m(ne.MAINTENANCE))},[a,m]),D=s.useCallback(async T=>{if(!y)return;const w=y.id,v=!!S,O=T.id;if(n($=>je($,w,K=>{const Y=K.maintenanceHistory||[];let J;return v?J=Y.map(ie=>ie.id===T.id?T:ie):J=[...Y,T],{maintenanceHistory:J}})),a?.id===w&&r($=>{const K=$.maintenanceHistory||[];let Y;return v?Y=K.map(J=>J.id===T.id?T:J):Y=[...K,T],{...$,maintenanceHistory:Y}}),v)i.updateMaintenance(T.id,T);else{const $=await i.addMaintenance(w,T);if($?.id&&$.id!==O){const K=Y=>(Y||[]).map(J=>J.id===O?{...J,id:$.id}:J);n(Y=>je(Y,w,J=>({maintenanceHistory:K(J.maintenanceHistory)}))),a?.id===w&&r(Y=>({...Y,maintenanceHistory:K(Y.maintenanceHistory)}))}}f({type:v?"maintenance_updated":"maintenance_added",description:`${v?"Updated":"Added"} ${T.type} for ${y.name}`,user:l?.name||"Unknown",itemId:w}),h({type:"maintenance",itemId:w,itemType:"item",itemName:y.name,description:`${v?"Updated":"Added"} maintenance: ${T.type}`,changes:[{field:"maintenance",newValue:`${T.type} - ${T.description||T.status}`}]}),d(),x(null),j(null)},[y,S,a,l,d,f,h]),_=s.useCallback((T,w)=>{if(!a)return;const v=a.id,O=w==="completed"?new Date().toISOString().split("T")[0]:null;n($=>je($,v,K=>({maintenanceHistory:(K.maintenanceHistory||[]).map(Y=>Y.id===T?{...Y,status:w,completedDate:O||Y.completedDate,updatedAt:new Date().toISOString()}:Y)}))),r($=>({...$,maintenanceHistory:($.maintenanceHistory||[]).map(K=>K.id===T?{...K,status:w,completedDate:O||K.completedDate,updatedAt:new Date().toISOString()}:K)})),f({type:"maintenance_status_changed",description:`Maintenance status changed to ${w} for ${a.name}`,user:l?.name||"Unknown",itemId:v})},[a,l,f]);return{checkoutItem:u,checkinItemData:p,openCheckoutModal:z,openCheckinModal:A,processCheckout:I,processCheckin:L,maintenanceItem:y,setMaintenanceItem:x,editingMaintenanceRecord:S,setEditingMaintenanceRecord:j,openMaintenanceModal:R,saveMaintenance:D,updateMaintenanceStatus:_}}function So({inventory:e,setInventory:n,selectedItem:a,setSelectedItem:r,dataContext:i,currentUser:l,closeModal:m,addAuditLog:d,addChangeLog:f}){const h=s.useCallback(S=>{a&&(n(j=>je(j,a.id,{isKit:!0,kitType:S,childItemIds:[]})),r(j=>({...j,isKit:!0,kitType:S,childItemIds:[]})),d({type:"item_converted_to_kit",description:`${a.name} converted to ${S}`,user:l?.name||"Unknown",itemId:a.id}),f({type:"updated",itemId:a.id,itemType:"item",itemName:a.name,description:`Converted "${a.name}" to ${S}`,changes:[{field:"kitType",oldValue:null,newValue:S}]}))},[a,l,d,f]),u=s.useCallback(S=>{if(!a||!a.isKit)return;const j=[...a.childItemIds||[],...S],z=e.filter(A=>S.includes(A.id));n(A=>{let I=je(A,a.id,{childItemIds:j});return S.forEach(L=>{I=je(I,L,{parentKitId:a.id})}),I}),r(A=>({...A,childItemIds:j})),d({type:"items_added_to_kit",description:`${S.length} item(s) added to kit ${a.name}`,user:l?.name||"Unknown",itemId:a.id}),f({type:"updated",itemId:a.id,itemType:"item",itemName:a.name,description:`Added ${S.length} item(s) to kit "${a.name}"`,changes:z.map(A=>({field:"kitContents",oldValue:null,newValue:`+ ${A.name} (${A.id})`}))})},[a,l,e,d,f]),g=s.useCallback(S=>{if(!a||!a.isKit)return;const j=e.find(A=>A.id===S),z=(a.childItemIds||[]).filter(A=>A!==S);n(A=>{let I=je(A,a.id,{childItemIds:z});return I=je(I,S,{parentKitId:null}),I}),r(A=>({...A,childItemIds:z})),j&&f({type:"updated",itemId:a.id,itemType:"item",itemName:a.name,description:`Removed "${j.name}" from kit "${a.name}"`,changes:[{field:"kitContents",oldValue:`${j.name} (${j.id})`,newValue:null}]})},[a,e,f]),p=s.useCallback(()=>{if(!a||!a.isKit)return;const S=a.childItemIds||[],j=e.filter(z=>S.includes(z.id));n(z=>{let A=je(z,a.id,{childItemIds:[]});return S.forEach(I=>{A=je(A,I,{parentKitId:null})}),A}),r(z=>({...z,childItemIds:[]})),d({type:"kit_cleared",description:`All items removed from kit ${a.name}`,user:l?.name||"Unknown",itemId:a.id}),j.length>0&&f({type:"updated",itemId:a.id,itemType:"item",itemName:a.name,description:`Cleared all ${j.length} item(s) from kit "${a.name}"`,changes:j.map(z=>({field:"kitContents",oldValue:`${z.name} (${z.id})`,newValue:null}))})},[a,l,e,d,f]),k=s.useCallback((S,j)=>{if(!S||!j||j.length===0)return;const z=e.find(R=>R.id===S);if(!z)return;const A=z.requiredAccessories||[],I=[...new Set([...A,...j])];n(R=>je(R,S,{requiredAccessories:I})),a?.id===S&&r(R=>({...R,requiredAccessories:I}));const L=j.map(R=>e.find(D=>D.id===R)).filter(Boolean);f({type:"updated",itemId:S,itemType:"item",itemName:z.name,description:`Added ${L.length} required accessor${L.length===1?"y":"ies"}`,changes:L.map(R=>({field:"requiredAccessories",oldValue:null,newValue:`${R.name} (${R.id})`}))})},[e,a,f]),y=s.useCallback((S,j)=>{if(!S||!j)return;const z=e.find(R=>R.id===S);if(!z)return;const A=e.find(R=>R.id===j),L=(z.requiredAccessories||[]).filter(R=>R!==j);n(R=>je(R,S,{requiredAccessories:L})),a?.id===S&&r(R=>({...R,requiredAccessories:L})),A&&f({type:"updated",itemId:S,itemType:"item",itemName:z.name,description:`Removed required accessory: ${A.name}`,changes:[{field:"requiredAccessories",oldValue:`${A.name} (${A.id})`,newValue:null}]})},[e,a,f]),x=s.useCallback(async S=>{if(a){n(j=>je(j,a.id,{image:S})),r(j=>({...j,image:S}));try{await i.updateItem(a.id,{image:S})}catch(j){X("Failed to save image:",j)}}m()},[a,m,i]);return{setItemAsKit:h,addItemsToKit:u,removeItemFromKit:g,clearKitItems:p,addRequiredAccessories:k,removeRequiredAccessory:y,selectImage:x}}function ko({inventory:e,setInventory:n,selectedItem:a,setSelectedItem:r,dataContext:i,openModal:l,closeModal:m,addChangeLog:d,addAuditLog:f,currentUser:h,reservationForm:u,setReservationForm:g,editingReservationId:p,setEditingReservationId:k,selectedReservationItem:y,selectedReservation:x,setSelectedReservation:S,setCurrentView:j,resetReservationForm:z,navigateToReservation:A,showConfirm:I}){const L=s.useCallback(async()=>{if(p){const _={...u,id:p,dueBack:u.end};(e.find(w=>w.id===y.id).reservations||[]).map(w=>w.id===p?_:w);try{await i.updateReservation(p,u)}catch(w){X("Failed to update reservation:",w)}n(w=>je(w,y.id,v=>({reservations:(v.reservations||[]).map(O=>O.id===p?_:O)}))),S(_),a?.id===y.id&&r(w=>({...w,reservations:(w.reservations||[]).map(v=>v.id===p?_:v)})),d({type:"updated",itemId:y.id,itemType:"item",itemName:y.name,description:`Updated reservation for ${u.project}`,changes:[{field:"reservation",newValue:`${u.project} (${u.start} - ${u.end})`}]}),f?.({type:"reservation_updated",description:`Updated reservation: ${u.project} for ${y.name}`,itemId:y.id,user:h?.name||"Unknown"}),k(null)}else{const _=u.itemIds?.length?u.itemIds:u.itemId?[u.itemId]:[a?.id||y?.id].filter(Boolean);if(_.length===0){X("No items selected for reservation");return}let T=null;for(const $ of _){const K=e.find(J=>J.id===$);if(!K){X("Item not found:",$);continue}const Y={id:wt(),...u,notes:[],dueBack:u.end};try{const J=await i.createReservation($,u);J?.id&&(Y.id=J.id)}catch(J){X("Failed to create reservation for",$,J)}T||(T={reservation:Y,item:K}),n(J=>je(J,$,ie=>({reservations:[...ie.reservations||[],Y]}))),a?.id===$&&r(J=>({...J,reservations:[...J.reservations||[],Y]})),d({type:"reservation_added",itemId:$,itemType:"item",itemName:K.name,description:`New reservation: ${u.project} (${u.start} - ${u.end})`,changes:[{field:"reservation",newValue:u.project}]}),f?.({type:"reservation_created",description:`Created reservation: ${u.project} for ${K.name}`,itemId:$,user:h?.name||"Unknown"})}const w=u.contactEmail,v=_[0],O=e.find($=>$.id===v);w&&i?.sendReservationEmail&&O&&i.sendReservationEmail({userEmail:w,userName:u.user,item:O,reservation:{...u,itemCount:_.length}}).catch($=>X("Email send failed:",$)),T&&A(T.reservation,T.item)}m(),z()},[u,p,a,y,m,z,A,d,i,e]),R=s.useCallback(_=>{k(_.id),g({project:_.project,projectType:_.projectType||"Other",start:_.start,end:_.end,user:_.user,contactPhone:_.contactPhone||"",contactEmail:_.contactEmail||"",location:_.location||""}),l(ne.ADD_RESERVATION)},[l]),D=s.useCallback((_,T)=>{const w=e.find(Z=>Z.id===_),v=w?.reservations?.find(Z=>Z.id===T);if(!_||!T){X("[deleteReservation] Missing itemId or resId:",{itemId:_,resId:T});return}const O=v?.project||"Unknown",$=v?.start,K=v?.end,Y=w?.name||_,J=a?.id,ie=x?.id,_e=[],ve=[];v&&e.forEach(Z=>{(Z.reservations||[]).forEach(W=>{W.project===O&&W.start===$&&W.end===K&&(_e.push({itemId:Z.id,reservationId:W.id}),ve.includes(Z.id)||ve.push(Z.id))})});const B=_e.length,G=B>1?`Are you sure you want to cancel this reservation for ${B} items? This action cannot be undone.`:"Are you sure you want to cancel this reservation? This action cannot be undone.",q=_e.map(Z=>Z.reservationId),Q=[...ve];I({title:"Cancel Reservation",message:G,confirmText:"Cancel Reservation",cancelText:"Keep",variant:"danger",onConfirm:async()=>{try{for(const Z of q)await i.deleteReservation(Z)}catch(Z){X("Failed to delete reservations:",Z)}n(Z=>Z.map(W=>Q.includes(W.id)?{...W,reservations:(W.reservations||[]).filter(le=>!q.includes(le.id))}:W)),Q.includes(J)&&r(Z=>Z&&{...Z,reservations:(Z.reservations||[]).filter(W=>!q.includes(W.id))}),q.includes(ie)&&(S(null),j(M.SCHEDULE)),d({type:"reservation_removed",itemId:_,itemType:"item",itemName:B>1?`${B} items`:Y,description:`Cancelled reservation: ${O}`,changes:[{field:"reservation",oldValue:O}]}),f?.({type:"reservation_deleted",description:`Deleted reservation: ${O}`,itemId:_,user:h?.name||"Unknown"})}})},[e,d,f,h,i,a?.id,x?.id,I,j,n,r,S]);return{saveReservation:L,openEditReservation:R,deleteReservation:D}}function vo({selectedItem:e,setSelectedItem:n,setInventory:a,selectedPackage:r,setSelectedPackage:i,selectedReservation:l,setSelectedReservation:m,selectedReservationItem:d,setPackages:f,setClients:h,setAuditLog:u,dataContext:g,currentUser:p}){const[k,y]=s.useState(null),x=s.useCallback(I=>{const L=()=>I==="item"?e:I==="package"?r:I==="reservation"?l:null,R=T=>{I==="item"?n(T):I==="package"?i(T):I==="reservation"&&m(T)},D=(T,w)=>{I==="item"?a(v=>je(v,T,O=>({notes:w(O.notes)}))):I==="package"?f(v=>je(v,T,O=>({notes:w(O.notes||[])}))):I==="reservation"&&a(v=>je(v,d.id,O=>({reservations:(O.reservations||[]).map($=>$.id===T?{...$,notes:w($.notes||[])}:$)})))},_=(T,w,v)=>T.map(O=>({...O,id:O.id===w?v:O.id,replies:O.replies?_(O.replies,w,v):[]}));return{add:async T=>{const w=L();if(!T?.trim()||!w)return;const v=wt(),O={id:v,user:p.name,date:Ye(),text:T.trim(),replies:[],deleted:!1},K=[...w.notes||[],O];if(D(w.id,()=>K),R(Y=>({...Y,notes:K})),I==="item"&&g?.addItemNote){const Y=await g.addItemNote(w.id,O);if(Y?.id&&Y.id!==v){const J=ie=>_(ie,v,Y.id);D(w.id,J),R(ie=>({...ie,notes:J(ie.notes||[])}))}}},reply:async(T,w)=>{const v=L();if(!w?.trim()||!v)return;const O=wt(),$={id:O,user:p.name,date:Ye(),text:w.trim(),replies:[],deleted:!1,parentId:T},K=ha(v.notes||[],T,$);if(D(v.id,()=>K),R(Y=>({...Y,notes:K})),I==="item"&&g?.addItemNote){const Y=await g.addItemNote(v.id,$);if(Y?.id&&Y.id!==O){const J=ie=>_(ie,O,Y.id);D(v.id,J),R(ie=>({...ie,notes:J(ie.notes||[])}))}}},delete:T=>{const w=L();if(!w)return;const v=Pr(w.notes||[],T);v&&u($=>[...$,{type:"note_deleted",timestamp:new Date().toISOString(),description:`Note deleted from ${I} ${w.id}`,content:v.text,user:p.name,itemId:w.id}]);const O=ba(w.notes||[],T);D(w.id,()=>O),R($=>({...$,notes:O})),I==="item"&&g?.deleteItemNote&&g.deleteItemNote(T)}}},[e,r,l,d,p,g,m]),S=s.useMemo(()=>x("item"),[x]),j=s.useMemo(()=>x("package"),[x]),z=s.useMemo(()=>x("reservation"),[x]),A=s.useMemo(()=>({add:(I,L)=>{if(!L?.trim()||!I)return;const R={id:wt(),user:p?.name||"Unknown",date:Ye(),text:L.trim(),replies:[],deleted:!1};h(D=>D.map(_=>_.id===I?{..._,clientNotes:[..._.clientNotes||[],R]}:_))},reply:(I,L,R)=>{if(!R?.trim()||!I)return;const D={id:wt(),user:p?.name||"Unknown",date:Ye(),text:R.trim(),replies:[],deleted:!1};h(_=>_.map(T=>T.id===I?{...T,clientNotes:ha(T.clientNotes||[],L,D)}:T))},delete:(I,L)=>{I&&h(R=>R.map(D=>D.id===I?{...D,clientNotes:ba(D.clientNotes||[],L)}:D))}}),[p]);return{itemNoteHandlers:S,packageNoteHandlers:j,reservationNoteHandlers:z,clientNoteHandlers:A,selectedClientId:k,setSelectedClientId:y}}function wo({selectedItem:e,setSelectedItem:n,setInventory:a,setAuditLog:r,dataContext:i,currentUser:l,showConfirm:m}){const d=s.useCallback(async g=>{if(!e)return;const p=g.id,k=[...e.reminders||[],g];a(x=>je(x,e.id,S=>({reminders:[...S.reminders||[],g]}))),n(x=>({...x,reminders:k}));const y=await i.addItemReminder(e.id,{...g,createdBy:l.name});if(y?.id&&y.id!==p){const x=S=>(S||[]).map(j=>j.id===p?{...j,id:y.id}:j);a(S=>je(S,e.id,j=>({reminders:x(j.reminders)}))),n(S=>({...S,reminders:x(S.reminders)}))}r(x=>[...x,{type:"reminder_added",timestamp:new Date().toISOString(),description:`Reminder "${g.title}" added to ${e.name}`,user:l.name,itemId:e.id}])},[e,l,i]),f=s.useCallback(g=>{if(!e)return;const p=(e.reminders||[]).find(y=>y.id===g);if(!p)return;const k=(e.reminders||[]).map(y=>y.id===g?{...y,completed:!0,completedDate:Ye()}:y);a(y=>je(y,e.id,()=>({reminders:k}))),n(y=>({...y,reminders:k})),i.updateItemReminder(g,{completed:!0,completedDate:Ye()}),r(y=>[...y,{type:"reminder_completed",timestamp:new Date().toISOString(),description:`Reminder "${p.title}" completed for ${e.name}`,user:l.name,itemId:e.id}])},[e,l,i]),h=s.useCallback(g=>{if(!e||!(e.reminders||[]).find(y=>y.id===g))return;const k=(e.reminders||[]).map(y=>y.id===g?{...y,completed:!1,completedDate:null}:y);a(y=>je(y,e.id,()=>({reminders:k}))),n(y=>({...y,reminders:k})),i.updateItemReminder(g,{completed:!1,completedDate:null})},[e,i]),u=s.useCallback(g=>{if(!e)return;const p=(e.reminders||[]).find(k=>k.id===g);m({title:"Delete Reminder",message:`Are you sure you want to delete "${p?.title||"this reminder"}"?`,confirmText:"Delete",variant:"danger",onConfirm:()=>{const k=(e.reminders||[]).filter(y=>y.id!==g);a(y=>je(y,e.id,()=>({reminders:k}))),n(y=>({...y,reminders:k})),i.deleteItemReminder(g)}})},[e,i,m,a,n]);return{addReminder:d,completeReminder:f,uncompleteReminder:h,deleteReminder:u}}function Co({packages:e,setPackages:n,inventory:a,selectedPackage:r,setSelectedPackage:i,setCurrentView:l,categories:m,showConfirm:d,addChangeLog:f}){const h=s.useCallback(p=>{d({title:"Delete Package",message:"Are you sure you want to delete this package? This action cannot be undone.",confirmText:"Delete",variant:"danger",onConfirm:()=>{n(k=>us(k,p)),r?.id===p&&(i(null),l(M.PACKAGES))}})},[r,d,n,i,l]),u=s.useCallback((p,k)=>{const y=e.find(S=>S.id===p),x=a.find(S=>S.id===k);y&&x&&!y.items.includes(k)&&(n(S=>je(S,p,j=>({items:[...j.items,k]}))),f({type:"updated",itemId:p,itemType:"package",itemName:y.name,description:`Added "${x.name}" to package "${y.name}"`,changes:[{field:"packageContents",oldValue:null,newValue:`+ ${x.name} (${x.id})`}]}))},[e,a,f]),g=s.useCallback(()=>{const p=`pkg-${Date.now()}`,k={id:p,name:"New Package",description:"Package description",category:m[0]||"General",items:[],notes:[]};n(y=>[...y,k]),i(k),l(M.PACKAGE_DETAIL),f({type:"created",itemId:p,itemType:"package",itemName:"New Package",description:"Created new package",changes:[{field:"package",oldValue:null,newValue:"New Package"}]})},[m,f]);return{deletePackage:h,addItemToPackage:u,addPackage:g}}function jo({loginForm:e,setLoginForm:n,onLogin:a,isLoading:r,error:i}){const[l,m]=s.useState(!1);return t.jsx("div",{style:{minHeight:"100vh",background:o.bgDark,display:"flex",alignItems:"center",justifyContent:"center",fontFamily:b.fontFamily},children:t.jsxs("div",{style:{...me.card,width:"100%",maxWidth:400,padding:c[8]},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:c[3],marginBottom:c[8]},children:[t.jsx("img",{src:"/moe.png",alt:"SIMS Logo",style:{width:56,height:56,borderRadius:F.xl,objectFit:"cover"},onError:d=>{d.target.style.display="none",d.target.nextSibling.style.display="flex"}}),t.jsx("div",{style:{width:56,height:56,borderRadius:F.xl,background:"linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)",display:"none",alignItems:"center",justifyContent:"center",flexShrink:0},children:t.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),t.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}),t.jsxs("div",{children:[t.jsx("h1",{style:{margin:0,fontSize:b.fontSize["2xl"],fontWeight:b.fontWeight.bold,color:o.textPrimary},children:"SIMS"}),t.jsx("p",{style:{margin:0,fontSize:b.fontSize.xs,color:o.textMuted},children:"Studio Inventory Management System"})]})]}),i&&t.jsx("div",{style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:F.md,padding:c[3],marginBottom:c[4],fontSize:b.fontSize.sm,color:o.danger},children:i}),t.jsxs("form",{onSubmit:a,children:[t.jsxs("div",{style:{marginBottom:c[4]},children:[t.jsx("label",{style:me.label,children:"Email"}),t.jsx("input",{type:"email",value:e.email,onChange:d=>n(f=>({...f,email:d.target.value})),placeholder:"email@example.com",style:me.input,required:!0,disabled:r,autoComplete:"email"})]}),t.jsxs("div",{style:{marginBottom:c[6]},children:[t.jsx("label",{style:me.label,children:"Password"}),t.jsxs("div",{style:{position:"relative"},children:[t.jsx("input",{type:l?"text":"password",value:e.password,onChange:d=>n(f=>({...f,password:d.target.value})),placeholder:"Enter password",style:{...me.input,paddingRight:40},required:!0,disabled:r,autoComplete:"current-password"}),t.jsx("button",{type:"button",onClick:()=>m(!l),style:{position:"absolute",right:8,top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:o.textMuted,cursor:"pointer",padding:4},tabIndex:-1,children:l?t.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94"}),t.jsx("path",{d:"M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19"}),t.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):t.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),t.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})]})]}),t.jsx("button",{type:"submit",disabled:r,style:{...me.btn,width:"100%",justifyContent:"center",padding:`${c[3]}px ${c[4]}px`,opacity:r?.7:1,cursor:r?"not-allowed":"pointer"},children:r?t.jsxs(t.Fragment,{children:[t.jsx(Jn,{size:16,color:"white"}),t.jsx("span",{style:{marginLeft:8},children:"Signing in..."})]}):"Sign In"})]}),t.jsx("p",{style:{textAlign:"center",color:o.textMuted,fontSize:b.fontSize.xs,marginTop:c[6]},children:"Contact admin for access"})]})})}const _o=s.memo(jo),fr=s.memo(function({icon:n,label:a,viewId:r,currentView:i,onClick:l,colorVar:m,collapsed:d}){const f=i===r,h=m?`var(${m}, var(--primary))`:"var(--primary)";return t.jsxs("button",{onClick:()=>l(r),className:"sidebar-nav-btn",title:d?a:void 0,type:"button","aria-label":d?a:void 0,"aria-current":f?"page":void 0,style:{"--nav-active-color":h,display:"flex",alignItems:"center",gap:d?0:c[3],width:"100%",padding:`${c[3]}px ${d?c[3]:c[4]}px`,background:f?`color-mix(in srgb, ${h} 20%, transparent)`:"transparent",border:"none",borderRadius:F.lg,color:f?h:o.textSecondary,cursor:"pointer",textAlign:"left",fontSize:b.fontSize.sm,fontWeight:f?b.fontWeight.medium:b.fontWeight.normal,justifyContent:d?"center":"flex-start"},children:[t.jsx(n,{size:18,"aria-hidden":"true",style:{color:f?h:"inherit",flexShrink:0}}),t.jsx("span",{className:"sidebar-nav-label",style:{opacity:d?0:1,width:d?0:"auto",overflow:"hidden",whiteSpace:"nowrap"},children:a})]})}),Io=[{icon:ki,label:"Dashboard",viewId:M.DASHBOARD,colorVar:"--sidebar-item1",permissionId:"dashboard"},{icon:kn,label:"Gear List",viewId:M.GEAR_LIST,colorVar:"--sidebar-item2",permissionId:"gear_list"},{icon:vi,label:"Packages",viewId:M.PACKAGES,colorVar:"--sidebar-item3",permissionId:"pack_lists"},{icon:wi,label:"Pack Lists",viewId:M.PACK_LISTS,colorVar:"--sidebar-item4",permissionId:"pack_lists"},{icon:jt,label:"Schedule",viewId:M.SCHEDULE,colorVar:"--sidebar-item5",permissionId:"schedule"},{icon:Sr,label:"Labels",viewId:M.LABELS,colorVar:"--sidebar-item6",permissionId:"labels"},{icon:kr,label:"Clients",viewId:M.CLIENTS,colorVar:"--sidebar-item1",permissionId:"clients"},{icon:xa,label:"Search",viewId:M.SEARCH,colorVar:"--sidebar-item3",permissionId:"search"}],Eo=[{icon:ma,label:"Admin Panel",viewId:M.ADMIN,colorVar:"--sidebar-item1",permissionId:"admin_users"},{icon:Ci,label:"Reports",viewId:M.REPORTS,colorVar:"--sidebar-item2",permissionId:"reports"}],Do={[M.DASHBOARD]:"Dashboard",[M.GEAR_LIST]:"Gear List",[M.GEAR_DETAIL]:"Gear Details",[M.PACKAGES]:"Packages",[M.PACK_LISTS]:"Pack Lists",[M.SCHEDULE]:"Schedule",[M.LABELS]:"Labels",[M.CLIENTS]:"Clients",[M.CLIENT_DETAIL]:"Client Details",[M.SEARCH]:"Search",[M.ADMIN]:"Admin Panel",[M.REPORTS]:"Reports",[M.ADD_ITEM]:"Add Item",[M.EDIT_SPECS]:"Edit Specifications",[M.EDIT_CATEGORIES]:"Edit Categories",[M.THEME_SELECTOR]:"Theme Selector",[M.USERS]:"User Management",[M.AUDIT_LOG]:"Audit Log",[M.MAINTENANCE_REPORT]:"Maintenance Report",[M.INSURANCE_REPORT]:"Insurance Report",[M.LOCATIONS_MANAGE]:"Location Management",[M.CUSTOMIZE_DASHBOARD]:"Customize Dashboard",[M.CUSTOMIZE_ITEM_DETAIL]:"Customize Item Detail",[M.RESERVATION_DETAIL]:"Reservation Details",[M.NOTIFICATIONS]:"Notifications"};function Ao({currentView:e,setCurrentView:n,user:a,onLogout:r,onOpenProfile:i,onOpenScanner:l,onOpenImport:m,onOpenExport:d,isOpen:f,onClose:h,collapsed:u,onToggleCollapse:g}){const[p,k]=s.useState(!1),{themeId:y,availableThemes:x}=zr(),{canView:S,canEdit:j}=cn(),z=s.useRef(null),A=Io.filter(_=>S(_.permissionId)),I=Eo.filter(_=>S(_.permissionId)),L=I.length>0||S("admin_users")||S("admin_categories")||S("admin_specs")||S("admin_locations")||S("admin_roles")||S("admin_audit");s.useEffect(()=>{const _=T=>{z.current&&!z.current.contains(T.target)&&k(!1)};if(p)return document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)},[p]);const R=s.useRef(e);s.useEffect(()=>{if(e!==R.current){const _=Do[e]||e;ws(_),R.current=e}},[e]);const D=s.useCallback(_=>{n(_)},[n]);return t.jsxs("aside",{className:`app-sidebar ${f?"sidebar-open":""} ${u?"collapsed":""}`,role:"navigation","aria-label":"Main navigation",style:{height:"100vh",position:"fixed",left:0,top:0,background:o.bgMedium,borderRight:`1px solid ${o.border}`,display:"flex",flexDirection:"column"},children:[g&&t.jsx("button",{className:"sidebar-collapse-btn",onClick:g,title:u?"Expand sidebar":"Collapse sidebar","aria-label":u?"Expand sidebar":"Collapse sidebar","aria-expanded":!u,type:"button",children:u?t.jsx(nn,{size:14,"aria-hidden":"true"}):t.jsx(vr,{size:14,"aria-hidden":"true"})}),t.jsx("div",{style:{padding:u?c[3]:c[5],borderBottom:`1px solid ${o.borderLight}`,transition:"padding 0.3s ease"},children:t.jsxs("div",{className:"sidebar-logo",style:{display:"flex",alignItems:"center",justifyContent:u?"center":"space-between",transition:"justify-content 0.3s ease"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:u?0:c[3],transition:"gap 0.3s ease"},children:[t.jsx("div",{style:{width:40,height:40,borderRadius:F.lg,overflow:"hidden",flexShrink:0},children:t.jsx("img",{src:"/moe.png",alt:"SIMS",style:{width:"100%",height:"100%",objectFit:"cover"}})}),t.jsxs("div",{className:"sidebar-logo-text",style:{opacity:u?0:1,width:u?0:"auto",overflow:"hidden",whiteSpace:"nowrap",transition:"opacity 0.2s ease, width 0.2s ease"},children:[t.jsx("h1",{style:{margin:0,fontSize:b.fontSize.lg,fontWeight:b.fontWeight.bold,color:o.textPrimary},children:"S.I.M.S."}),t.jsxs("p",{style:{margin:0,fontSize:b.fontSize.xs,color:o.textMuted,lineHeight:1.3},children:["The SemiPro Inventory",t.jsx("br",{}),"Management System"]})]})]}),h&&!u&&t.jsx("button",{className:"sidebar-close-btn",onClick:h,style:{display:"none",background:te(o.textMuted,10),border:"none",borderRadius:F.md,color:o.textPrimary,cursor:"pointer",padding:c[2]},"aria-label":"Close menu",children:t.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})}),t.jsxs("nav",{style:{flex:1,padding:c[3],overflowY:"auto"},children:[t.jsxs("div",{style:{marginBottom:c[4]},children:[A.map(_=>t.jsx(fr,{icon:_.icon,label:_.label,viewId:_.viewId,currentView:e,onClick:D,colorVar:_.colorVar,collapsed:u},_.viewId)),t.jsxs("button",{onClick:l,className:"sidebar-nav-btn",title:u?"Scan QR Code":void 0,style:{display:"flex",alignItems:"center",gap:u?0:c[3],width:"100%",padding:`${c[3]}px ${u?c[3]:c[4]}px`,background:"transparent",border:"none",borderRadius:F.lg,color:o.textSecondary,cursor:"pointer",textAlign:"left",fontSize:b.fontSize.sm,transition:"all 150ms ease",justifyContent:u?"center":"flex-start"},children:[t.jsx(ji,{size:18,style:{flexShrink:0}}),t.jsx("span",{className:"sidebar-nav-label",style:{opacity:u?0:1,width:u?0:"auto",overflow:"hidden",whiteSpace:"nowrap",transition:"opacity 0.2s ease, width 0.2s ease"},children:"Scan QR Code"})]})]}),L&&t.jsxs("div",{style:{borderTop:`1px solid ${o.borderLight}`,paddingTop:c[4]},children:[t.jsx("p",{className:"sidebar-section-title",style:{fontSize:b.fontSize.xs,color:o.textMuted,textTransform:"uppercase",letterSpacing:"0.5px",padding:`0 ${u?c[3]:c[4]}px`,marginBottom:c[2],opacity:u?0:1,height:u?0:"auto",overflow:"hidden",transition:"opacity 0.2s ease, height 0.2s ease, padding 0.2s ease"},children:"Admin"}),I.map(_=>t.jsx(fr,{icon:_.icon,label:_.label,viewId:_.viewId,currentView:e,onClick:D,colorVar:_.colorVar,collapsed:u},_.viewId)),j("gear_list")&&t.jsxs("button",{onClick:m,className:"sidebar-nav-btn",title:u?"Import CSV":void 0,style:{display:"flex",alignItems:"center",gap:u?0:c[3],width:"100%",padding:`${c[3]}px ${u?c[3]:c[4]}px`,background:"transparent",border:"none",borderRadius:F.lg,color:o.textSecondary,cursor:"pointer",textAlign:"left",fontSize:b.fontSize.sm,transition:"all 150ms ease",justifyContent:u?"center":"flex-start"},children:[t.jsx(wr,{size:18,style:{flexShrink:0}}),t.jsx("span",{className:"sidebar-nav-label",style:{opacity:u?0:1,width:u?0:"auto",overflow:"hidden",whiteSpace:"nowrap",transition:"opacity 0.2s ease, width 0.2s ease"},children:"Import CSV"})]}),S("gear_list")&&t.jsxs("button",{onClick:d,className:"sidebar-nav-btn",title:u?"Export Data":void 0,style:{display:"flex",alignItems:"center",gap:u?0:c[3],width:"100%",padding:`${c[3]}px ${u?c[3]:c[4]}px`,background:"transparent",border:"none",borderRadius:F.lg,color:o.textSecondary,cursor:"pointer",textAlign:"left",fontSize:b.fontSize.sm,transition:"all 150ms ease",justifyContent:u?"center":"flex-start"},children:[t.jsx(_i,{size:18,style:{flexShrink:0}}),t.jsx("span",{className:"sidebar-nav-label",style:{opacity:u?0:1,width:u?0:"auto",overflow:"hidden",whiteSpace:"nowrap",transition:"opacity 0.2s ease, width 0.2s ease"},children:"Export Data"})]})]})]}),t.jsx("div",{className:"sidebar-user-section",style:{borderTop:`1px solid ${o.borderLight}`,padding:c[3],display:"flex",justifyContent:u?"center":"flex-start"},children:t.jsxs("div",{ref:z,style:{position:"relative",width:u?"auto":"100%"},children:[t.jsxs("button",{onClick:()=>k(!p),title:u?a?.name:void 0,style:{display:"flex",alignItems:"center",gap:u?0:c[3],width:u?"auto":"100%",padding:c[3],background:p?`${te(o.primary,10)}`:"transparent",border:"none",borderRadius:F.lg,cursor:"pointer",textAlign:"left",justifyContent:u?"center":"flex-start"},children:[a?.profile?.logo?t.jsx("img",{src:a.profile.logo,alt:a?.name,style:{width:36,height:36,borderRadius:F.md,objectFit:"cover",flexShrink:0}}):t.jsx("div",{style:{width:36,height:36,borderRadius:F.md,background:`linear-gradient(135deg, ${o.primary}, ${o.accent1})`,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:b.fontWeight.semibold,color:o.textPrimary,fontSize:b.fontSize.sm,flexShrink:0},children:a?.name?.charAt(0)||"?"}),t.jsxs("div",{className:"sidebar-user-info",style:{flex:1,minWidth:0,opacity:u?0:1,width:u?0:"auto",overflow:"hidden",transition:"opacity 0.2s ease, width 0.2s ease"},children:[t.jsx("div",{style:{fontWeight:b.fontWeight.medium,color:o.textPrimary,fontSize:b.fontSize.sm,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:a?.name}),t.jsx("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted,textTransform:"capitalize"},children:a?.role?.name||a?.roleId||"User"})]}),!u&&t.jsx(pt,{size:16,color:o.textMuted,style:{transform:p?"rotate(180deg)":"rotate(0)",transition:"transform 150ms ease"}})]}),p&&t.jsxs("div",{className:"sidebar-user-menu",style:{position:"absolute",bottom:"100%",left:u?"50%":0,right:u?"auto":0,transform:u?"translateX(-50%)":"none",marginBottom:c[2],background:o.bgLight,border:`1px solid ${o.border}`,borderRadius:F.lg,overflow:"hidden",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",minWidth:u?180:"auto"},children:[t.jsxs("button",{onClick:()=>{i(),k(!1)},className:"user-menu-item",style:{display:"flex",alignItems:"center",gap:c[2],width:"100%",padding:`${c[3]}px ${c[4]}px`,background:"none",border:"none",color:o.textPrimary,cursor:"pointer",fontSize:b.fontSize.sm,textAlign:"left"},children:[t.jsx(kr,{size:16}),"Profile Settings"]}),t.jsxs("button",{onClick:()=>{n(M.THEME_SELECTOR),k(!1)},className:"user-menu-item",style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:c[2],width:"100%",padding:`${c[3]}px ${c[4]}px`,background:"none",border:"none",borderTop:`1px solid ${o.borderLight}`,color:o.textPrimary,cursor:"pointer",fontSize:b.fontSize.sm,textAlign:"left"},children:[t.jsxs("span",{style:{display:"flex",alignItems:"center",gap:c[2]},children:[t.jsx(Ii,{size:16}),"Theme"]}),t.jsx("span",{style:{fontSize:b.fontSize.xs,color:o.textMuted,textTransform:"capitalize"},children:x.find(_=>_.id===y)?.name||"Dark"})]}),t.jsxs("button",{onClick:()=>{n(M.NOTIFICATIONS),k(!1)},className:"user-menu-item",style:{display:"flex",alignItems:"center",gap:c[2],width:"100%",padding:`${c[3]}px ${c[4]}px`,background:"none",border:"none",borderTop:`1px solid ${o.borderLight}`,color:o.textPrimary,cursor:"pointer",fontSize:b.fontSize.sm,textAlign:"left"},children:[t.jsx($t,{size:16}),"Notification Settings"]}),t.jsxs("button",{onClick:r,className:"user-menu-item",style:{display:"flex",alignItems:"center",gap:c[2],width:"100%",padding:`${c[3]}px ${c[4]}px`,background:"none",border:"none",borderTop:`1px solid ${o.borderLight}`,color:o.danger,cursor:"pointer",fontSize:b.fontSize.sm,textAlign:"left"},children:[t.jsx(Ei,{size:16}),"Sign Out"]})]})]})})]})}const To=s.memo(Ao);function Ro({currentUser:e,onOpenSidebar:n,onOpenModal:a,onSetView:r,onLogout:i}){const[l,m]=s.useState(!1);return t.jsxs("div",{className:"mobile-header",children:[t.jsx("button",{onClick:n,style:{background:"transparent",border:"none",borderRadius:F.md,padding:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:o.textPrimary},"aria-label":"Open menu",children:t.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),t.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),t.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1},children:[t.jsx("img",{src:"/moe.png",alt:"",style:{width:28,height:28,borderRadius:F.md},onError:d=>d.target.style.display="none"}),t.jsx("span",{style:{fontWeight:b.fontWeight.semibold,fontSize:b.fontSize.lg,color:o.textPrimary},children:"SIMS"})]}),e&&t.jsxs("div",{style:{position:"relative"},children:[t.jsx("button",{onClick:()=>m(!l),style:{width:36,height:36,borderRadius:"50%",background:o.primary,border:"none",display:"flex",alignItems:"center",justifyContent:"center",color:o.bgDark,fontWeight:b.fontWeight.semibold,fontSize:b.fontSize.base,cursor:"pointer"},"aria-label":"User menu",children:e.name?.charAt(0).toUpperCase()||"U"}),l&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:999},onClick:()=>m(!1)}),t.jsxs("div",{style:{position:"absolute",top:"100%",right:0,marginTop:8,background:o.bgMedium,border:`1px solid ${o.border}`,borderRadius:F.xl,padding:c[2],minWidth:180,zIndex:1e3,boxShadow:"0 4px 20px rgba(0,0,0,0.3)"},children:[t.jsxs("div",{style:{padding:`${c[2]}px ${c[3]}px`,borderBottom:`1px solid ${o.borderLight}`,marginBottom:c[2]},children:[t.jsx("div",{style:{fontWeight:b.fontWeight.semibold,color:o.textPrimary},children:e.name}),t.jsx("div",{style:{fontSize:b.fontSize.sm,color:o.textMuted},children:e.email})]}),t.jsxs("button",{onClick:()=>{m(!1),a(ne.PROFILE)},style:{width:"100%",padding:`${c[2]}px ${c[3]}px`,background:"transparent",border:"none",borderRadius:F.md,color:o.textPrimary,textAlign:"left",cursor:"pointer",display:"flex",alignItems:"center",gap:c[2]},children:[t.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),t.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),"Profile"]}),t.jsxs("button",{onClick:()=>{m(!1),r(M.THEME_SELECTOR)},style:{width:"100%",padding:`${c[2]}px ${c[3]}px`,background:"transparent",border:"none",borderRadius:F.md,color:o.textPrimary,textAlign:"left",cursor:"pointer",display:"flex",alignItems:"center",gap:c[2]},children:[t.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t.jsx("circle",{cx:"12",cy:"12",r:"3"}),t.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),"Theme"]}),t.jsx("div",{style:{borderTop:`1px solid ${o.borderLight}`,marginTop:c[2],paddingTop:c[2]},children:t.jsxs("button",{onClick:()=>{m(!1),i()},style:{width:"100%",padding:`${c[2]}px ${c[3]}px`,background:"transparent",border:"none",borderRadius:F.md,color:o.danger,textAlign:"left",cursor:"pointer",display:"flex",alignItems:"center",gap:c[2]},children:[t.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),t.jsx("polyline",{points:"16 17 21 12 16 7"}),t.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Sign Out"]})})]})]})]})]})}const we={stats:"var(--panel-stats)",search:"var(--panel-search)",alerts:"var(--panel-alerts)",reminders:"var(--panel-reminders)",lowStock:"var(--panel-lowstock)",reservations:"var(--panel-reservations)"};function Po({inventory:e=[],categorySettings:n={},layoutPrefs:a,onViewItem:r,onViewReservation:i,onFilteredView:l,onViewAlerts:m,onViewOverdue:d,onViewLowStock:f,onViewReservations:h,onCustomizeLayout:u,onToggleCollapse:g}){const[p,k]=s.useState(""),{canEdit:y}=cn();y("dashboard");const[x,S]=s.useState(()=>{const w={};return Object.values(pa).forEach(v=>{w[v.id]=a?.sections?.[v.id]?.collapsed||!1}),w});s.useEffect(()=>{a?.sections&&S(w=>{const v={...w};return Object.keys(a.sections).forEach(O=>{a.sections[O]?.collapsed!==void 0&&(v[O]=a.sections[O].collapsed)}),v})},[a]);const j=w=>{const v=Object.values(pa).find($=>$.id===w),O=a?.sections?.[w];return{visible:O?.visible!==!1,order:O?.order??v?.order??99}},z=w=>j(w).visible,A=w=>x[w]||!1,I=w=>{S(v=>({...v,[w]:!v[w]})),g&&g("dashboard",w)},L=s.useMemo(()=>["stats","quickSearch","alerts","reminders","lowStock","reservations"].filter(v=>z(v)).map(v=>({id:v,order:j(v).order})).sort((v,O)=>v.order-O.order).map(v=>v.id),[a]),R=s.useMemo(()=>{const w=Ye(),v=e.flatMap($=>($.reminders||[]).filter(K=>Fn(K)).map(K=>({...K,item:$}))),O=e.filter($=>{const K=n?.[$.category];if(!K?.trackQuantity||$.quantity===void 0||$.quantity===null)return!1;const Y=$.quantity,J=$.reorderPoint||K.lowStockThreshold||0;return J>0&&Y<=J});return{total:e.length,available:e.filter($=>$.status===Me.AVAILABLE).length,checkedOut:e.filter($=>$.status===Me.CHECKED_OUT).length,alerts:e.filter($=>$.status===Me.NEEDS_ATTENTION),overdue:e.filter($=>$.status===Me.CHECKED_OUT&&$.dueBack&&$.dueBack<w),dueReminders:v,lowStockItems:O}},[e,n]),D=s.useMemo(()=>e.flatMap(w=>(w.reservations||[]).map(v=>({...v,item:w}))).filter(w=>new Date(w.start)>=new Date).sort((w,v)=>new Date(w.start)-new Date(v.start)).slice(0,6),[e]),_=s.useMemo(()=>{if(!p.trim())return[];const w=p.toLowerCase();return e.filter(v=>v.name.toLowerCase().includes(w)||v.id.toLowerCase().includes(w)||v.brand.toLowerCase().includes(w)).slice(0,5)},[e,p]),T=w=>{switch(w){case"stats":return t.jsx(Fe,{title:"Statistics",icon:kn,badge:R.total,badgeColor:we.stats,headerColor:we.stats,collapsed:A("stats"),onToggleCollapse:()=>I("stats"),children:t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:c[3]},children:[t.jsx(hn,{icon:kn,value:R.total,label:"Total Items",color:we.stats,onClick:()=>l("all","all")}),t.jsx(hn,{icon:vn,value:R.available,label:"Available",color:o.available,onClick:()=>l("all",Me.AVAILABLE)}),t.jsx(hn,{icon:ln,value:R.checkedOut,label:"Checked Out",color:o.checkedOut,onClick:()=>l("all",Me.CHECKED_OUT)}),t.jsx(hn,{icon:an,value:R.overdue.length,label:"Overdue",color:o.danger,onClick:d})]})},"stats");case"quickSearch":return t.jsxs(Fe,{title:"Quick Gear Search",headerColor:we.search,icon:xa,collapsed:A("quickSearch"),onToggleCollapse:()=>I("quickSearch"),children:[t.jsx(ea,{value:p,onChange:k,onClear:()=>k(""),placeholder:"Search by name, ID, or brand..."}),_.length>0&&t.jsx("div",{style:{marginTop:c[3]},children:_.map(v=>t.jsxs("div",{onClick:()=>r(v.id),style:{display:"flex",alignItems:"center",gap:c[3],padding:c[3],borderRadius:F.md,cursor:"pointer",marginBottom:c[2],background:te(we.search,15),border:`1px solid ${te(we.search,40)}`},children:[t.jsx("div",{style:{width:36,height:36,borderRadius:F.sm,background:te(we.search,25),display:"flex",alignItems:"center",justifyContent:"center",color:o.textMuted,fontSize:b.fontSize.xs},children:v.image?t.jsx("img",{src:v.image,alt:"",style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:F.sm}}):"No img"}),t.jsxs("div",{style:{flex:1},children:[t.jsx("div",{style:{fontSize:b.fontSize.sm,fontWeight:b.fontWeight.medium,color:o.textPrimary},children:v.name}),t.jsxs("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted},children:[v.id," ‚Ä¢ ",v.category]})]}),t.jsx(Le,{text:v.status,color:Bt(v.status)})]},v.id))}),p&&_.length===0&&t.jsx("p",{style:{color:o.textMuted,textAlign:"center",fontSize:b.fontSize.sm,padding:c[4],margin:0},children:"No items found"}),!p&&t.jsx("p",{style:{color:o.textMuted,textAlign:"center",fontSize:b.fontSize.sm,padding:c[4],margin:0},children:"Start typing to search inventory"})]},"quickSearch");case"alerts":return t.jsx(Fe,{title:"Alerts",icon:an,badge:R.alerts.length||null,badgeColor:we.alerts,headerColor:we.alerts,collapsed:A("alerts"),onToggleCollapse:()=>I("alerts"),action:R.alerts.length>0?t.jsx("button",{onClick:v=>{v.stopPropagation(),m()},style:{...me.btnSec,padding:`${c[1]}px ${c[2]}px`,fontSize:b.fontSize.xs},children:"View All"}):null,padding:!1,children:R.alerts.length===0?t.jsx("div",{style:{padding:c[4],color:o.textMuted,fontSize:b.fontSize.sm,textAlign:"center"},children:"No alerts"}):t.jsx("div",{style:{padding:c[4],maxHeight:240,overflowY:"auto"},children:R.alerts.map(v=>t.jsxs("div",{onClick:()=>r(v.id),style:{display:"flex",alignItems:"center",gap:c[3],padding:c[3],borderRadius:F.md,cursor:"pointer",marginBottom:c[2],background:te(we.alerts,15),border:`1px solid ${te(we.alerts,40)}`},children:[t.jsx(an,{size:16,color:we.alerts}),t.jsxs("div",{style:{flex:1},children:[t.jsx("div",{style:{fontSize:b.fontSize.sm,color:o.textPrimary},children:v.name}),t.jsxs("div",{style:{fontSize:b.fontSize.xs,color:we.alerts},children:["Needs attention ‚Ä¢ ",v.category]})]}),t.jsx(nn,{size:16,color:o.textMuted})]},v.id))})},"alerts");case"reminders":return t.jsx(Fe,{title:"Due Reminders",icon:$t,badge:R.dueReminders.length||null,badgeColor:we.reminders,headerColor:we.reminders,collapsed:A("reminders"),onToggleCollapse:()=>I("reminders"),padding:!1,children:R.dueReminders.length===0?t.jsx("div",{style:{padding:c[4],color:o.textMuted,fontSize:b.fontSize.sm,textAlign:"center"},children:"No due reminders"}):t.jsx("div",{style:{padding:c[4],maxHeight:240,overflowY:"auto"},children:R.dueReminders.map(v=>t.jsxs("div",{onClick:()=>r(v.item.id),style:{display:"flex",alignItems:"center",gap:c[3],padding:c[3],borderRadius:F.md,cursor:"pointer",marginBottom:c[2],background:te(we.reminders,15),border:`1px solid ${te(we.reminders,40)}`},children:[t.jsx($t,{size:16,color:we.reminders}),t.jsxs("div",{style:{flex:1},children:[t.jsx("div",{style:{fontSize:b.fontSize.sm,color:o.textPrimary},children:v.title}),t.jsxs("div",{style:{fontSize:b.fontSize.xs,color:we.reminders},children:[v.item.name," ‚Ä¢ Due ",He(v.dueDate)]})]}),t.jsx(nn,{size:16,color:o.textMuted})]},v.id))})},"reminders");case"lowStock":return t.jsx(Fe,{title:"Low Stock Items",icon:Gn,badge:R.lowStockItems.length||null,badgeColor:we.lowStock,headerColor:we.lowStock,collapsed:A("lowStock"),onToggleCollapse:()=>I("lowStock"),action:R.lowStockItems.length>0?t.jsx("button",{onClick:v=>{v.stopPropagation(),f()},style:{...me.btnSec,padding:`${c[1]}px ${c[2]}px`,fontSize:b.fontSize.xs},children:"View All"}):null,padding:!1,children:R.lowStockItems.length===0?t.jsx("div",{style:{padding:c[4],color:o.textMuted,fontSize:b.fontSize.sm,textAlign:"center"},children:"No low stock items"}):t.jsx("div",{style:{padding:c[4],maxHeight:200,overflowY:"auto"},children:R.lowStockItems.map(v=>t.jsxs("div",{onClick:()=>r(v.id),style:{display:"flex",alignItems:"center",gap:c[3],padding:c[3],borderRadius:F.md,cursor:"pointer",marginBottom:c[2],background:te(we.lowStock,15),border:`1px solid ${te(we.lowStock,40)}`},children:[t.jsx(Gn,{size:16,color:we.lowStock}),t.jsxs("div",{style:{flex:1},children:[t.jsx("div",{style:{fontSize:b.fontSize.sm,color:o.textPrimary},children:v.name}),t.jsxs("div",{style:{fontSize:b.fontSize.xs,color:we.lowStock},children:[v.quantity||0," remaining (min: ",v.reorderPoint||n?.[v.category]?.lowStockThreshold||0,")"]})]}),t.jsx(Le,{text:v.category,color:we.lowStock,size:"xs"}),t.jsx(nn,{size:16,color:o.textMuted})]},v.id))})},"lowStock");case"reservations":return t.jsx(Fe,{title:"Upcoming Reservations",icon:jt,badge:D.length,badgeColor:we.reservations,headerColor:we.reservations,collapsed:A("reservations"),onToggleCollapse:()=>I("reservations"),action:t.jsx("button",{onClick:v=>{v.stopPropagation(),h()},style:{...me.btnSec,padding:`${c[1]}px ${c[2]}px`,fontSize:b.fontSize.xs},children:"View All"}),padding:!1,children:t.jsx("div",{style:{padding:c[4],maxHeight:240,overflowY:"auto"},children:D.length===0?t.jsx("p",{style:{color:o.textMuted,textAlign:"center",margin:0},children:"No upcoming reservations"}):t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gap:c[3]},children:D.map(v=>t.jsxs("div",{onClick:()=>i?i(v,v.item):r(v.item.id),style:{display:"flex",alignItems:"center",gap:c[3],padding:c[3],borderRadius:F.md,background:te(we.reservations,15),border:`1px solid ${te(we.reservations,40)}`,cursor:"pointer"},children:[t.jsx("div",{style:{width:40,height:40,borderRadius:F.sm,background:te(we.reservations,25),display:"flex",alignItems:"center",justifyContent:"center",color:o.textMuted,fontSize:b.fontSize.xs,flexShrink:0},children:v.item.image?t.jsx("img",{src:v.item.image,alt:"",style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:F.sm}}):"img"}),t.jsxs("div",{style:{flex:1,minWidth:0},children:[t.jsx("div",{style:{fontSize:b.fontSize.sm,color:o.textPrimary,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:v.item.name}),t.jsxs("div",{style:{fontSize:b.fontSize.xs,color:we.reservations},children:[v.project," ‚Ä¢ ",He(v.start)]})]})]},v.id))})})},"reservations");default:return null}};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"page-header",children:[t.jsx("h2",{className:"page-title",children:"Dashboard"}),u&&t.jsx(Ae,{variant:"secondary",onClick:u,icon:Cr,children:"Customize"})]}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:c[4]},children:L.map(w=>T(w))})]})}const Lo=s.memo(Po),Ze="equipment-images",ca=5*1024*1024,da=["image/jpeg","image/png","image/webp","image/gif"],Mo=1200,zo=200;async function pr(e,n,a=!1){return new Promise((r,i)=>{const l=new Image,m=URL.createObjectURL(e);l.onload=()=>{URL.revokeObjectURL(m);let d=l.width,f=l.height,h=0,u=0,g=d,p=f;if(a){const x=Math.min(d,f);h=(d-x)/2,u=(f-x)/2,g=p=x,d=f=n}else d>f?d>n&&(f=Math.round(f*n/d),d=n):f>n&&(d=Math.round(d*n/f),f=n);const k=document.createElement("canvas");k.width=d,k.height=f;const y=k.getContext("2d");y.imageSmoothingEnabled=!0,y.imageSmoothingQuality="high",y.drawImage(l,h,u,g,p,0,0,d,f),k.toBlob(x=>{x?r(x):i(new Error("Failed to create image blob"))},"image/jpeg",.85)},l.onerror=()=>{URL.revokeObjectURL(m),i(new Error("Failed to load image"))},l.src=m})}function No(e){return new Promise((n,a)=>{const r=new FileReader;r.onload=()=>n({url:r.result,path:null,thumbnailUrl:r.result}),r.onerror=()=>a(new Error("Failed to read file")),r.readAsDataURL(e)})}const Oo={async uploadImage(e,n){const a=await We();if(!a)return No(e);if(!e)throw new Error("No file provided");if(!da.includes(e.type))throw new Error(`Invalid file type. Allowed: ${da.join(", ")}`);if(e.size>ca)throw new Error(`File too large. Maximum size: ${ca/1024/1024}MB`);const r=Date.now(),i=`${n}/${r}`;try{const[l,m]=await Promise.all([pr(e,Mo,!1),pr(e,zo,!0)]),[d,f]=await Promise.all([a.storage.from(Ze).upload(`${i}.jpg`,l,{contentType:"image/jpeg",cacheControl:"31536000",upsert:!1}),a.storage.from(Ze).upload(`${i}_thumb.jpg`,m,{contentType:"image/jpeg",cacheControl:"31536000",upsert:!1})]);if(d.error)throw X("Full image upload error:",d.error),new Error(`Upload failed: ${d.error.message}`);f.error&&X("Thumbnail upload error:",f.error);const{data:h}=a.storage.from(Ze).getPublicUrl(d.data.path),{data:u}=a.storage.from(Ze).getPublicUrl(f.data?.path||d.data.path);return{url:h.publicUrl,path:d.data.path,thumbnailUrl:u.publicUrl}}catch(l){X("Image processing error:",l);const m=e.name.split(".").pop()||"jpg",d=`${i}.${m}`,{data:f,error:h}=await a.storage.from(Ze).upload(d,e,{cacheControl:"3600",upsert:!1});if(h)throw new Error(`Upload failed: ${h.message}`);const{data:u}=a.storage.from(Ze).getPublicUrl(f.path);return{url:u.publicUrl,path:f.path,thumbnailUrl:u.publicUrl}}},async uploadFromDataUrl(e,n){if(!await We())return{url:e,path:null,thumbnailUrl:e};const i=await(await fetch(e)).blob(),l=e.includes("image/png")?"png":e.includes("image/webp")?"webp":e.includes("image/gif")?"gif":"jpg",m=new File([i],`image.${l}`,{type:i.type});return this.uploadImage(m,n)},async deleteImage(e){if(!e)return!0;const n=await We();if(!n)return!0;const a=e.replace(/\.(jpg|jpeg|png|webp|gif)$/i,"_thumb.jpg"),r=[e];a!==e&&r.push(a);const{error:i}=await n.storage.from(Ze).remove(r);return i?(X("Delete error:",i),!1):!0},async deleteItemImages(e){const n=await We();if(!n)return!0;const{data:a,error:r}=await n.storage.from(Ze).list(e);if(r)return X("List error:",r),!1;if(!a||a.length===0)return!0;const i=a.map(m=>`${e}/${m.name}`),{error:l}=await n.storage.from(Ze).remove(i);return l?(X("Delete error:",l),!1):!0},async getSignedUrl(e,n=3600){if(!e)return null;const a=await We();if(!a)return null;const{data:r,error:i}=await a.storage.from(Ze).createSignedUrl(e,n);return i?(X("Signed URL error:",i),null):r.signedUrl},async checkBucket(){const e=await We();if(!e)return!1;try{const{data:n,error:a}=await e.storage.getBucket(Ze);return!a&&!!n}catch{return!1}},async initBucket(){const e=await We();if(!e)return!1;try{const{data:n}=await e.storage.getBucket(Ze);if(n)return!0;const{error:a}=await e.storage.createBucket(Ze,{public:!0,fileSizeLimit:ca,allowedMimeTypes:da});return a?(X("Bucket creation error:",a),!1):!0}catch(n){return X("Bucket init error:",n),!1}}};function oi(e){return e&&e.startsWith("data:")}function li(e){return e&&(e.includes("supabase.co/storage")||e.includes("supabase.in/storage"))}function ci(e){return!e||oi(e)||e.includes("_thumb.")?e:li(e)?e.replace(/\.(jpg|jpeg|png|webp|gif)(\?|$)/i,"_thumb.jpg$2"):e}const qo=Object.freeze(Object.defineProperty({__proto__:null,AuthProvider:Br,DataProvider:Xr,auditLogService:Qn,auth:Tt,categoriesService:Ia,checkoutHistoryService:xn,clientNotesService:_a,clientsService:Jt,emailService:Sn,getSupabase:We,getThumbnailUrl:ci,inventoryService:ft,isDataUrl:oi,isStorageUrl:li,itemNotesService:rn,itemRemindersService:sn,locationsService:Da,maintenanceService:on,notificationPreferencesService:Xn,packListsService:tn,packagesService:en,reservationsService:Ct,rolesService:Aa,specsService:Ea,storageService:Oo,get supabase(){return Yn},useAuth:Ra,useData:In,usersService:zt},Symbol.toStringTag,{value:"Module"}));function En({src:e,alt:n="",size:a="thumbnail",width:r,height:i,style:l={},className:m="",objectFit:d="cover",placeholder:f=null,onLoad:h,onError:u,lazy:g=!0}){const[p,k]=s.useState(!1),[y,x]=s.useState(!1),[S,j]=s.useState(!g),z=s.useRef(null),A=s.useRef(null),I=a==="thumbnail"?ci(e):e;s.useEffect(()=>{if(!g||S)return;const w=new IntersectionObserver(([v])=>{v.isIntersecting&&(j(!0),w.disconnect())},{rootMargin:"50px",threshold:.01});return A.current&&w.observe(A.current),()=>w.disconnect()},[g,S]),s.useEffect(()=>{k(!1),x(!1)},[e]);const L=w=>{k(!0),h?.(w)},R=w=>{if(x(!0),u?.(w),a==="thumbnail"&&I!==e){const v=w.target;v.src=e}},D=t.jsx("div",{style:{width:r||"100%",height:i||"100%",backgroundColor:o.surfaceHover,display:"flex",alignItems:"center",justifyContent:"center",color:o.textMuted,fontSize:"12px"},children:y?"‚ö†Ô∏è":""}),_={width:r||"100%",height:i||"100%",position:"relative",overflow:"hidden",backgroundColor:o.surfaceHover,borderRadius:F.md,...l},T={width:"100%",height:"100%",objectFit:d,opacity:p?1:0,transition:"opacity 0.2s ease-in-out"};return e?t.jsxs("div",{ref:A,style:_,className:m,children:[!p&&!y&&t.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0},children:f||D}),y&&!p&&t.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0},children:f||D}),S&&t.jsx("img",{ref:z,src:I,alt:n,style:T,onLoad:L,onError:R,loading:g?"lazy":"eager",decoding:"async"})]}):t.jsx("div",{ref:A,style:_,className:m,children:f||D})}En.propTypes={src:E.string,alt:E.string,size:E.oneOf(["thumbnail","full"]),width:E.oneOfType([E.number,E.string]),height:E.oneOfType([E.number,E.string]),style:E.object,className:E.string,objectFit:E.oneOf(["cover","contain","fill","none","scale-down"]),placeholder:E.node,onLoad:E.func,onError:E.func,lazy:E.bool};var di=Ir();function qt({value:e,onChange:n,options:a=[],placeholder:r="Select...",style:i={},disabled:l=!1,"aria-label":m}){const[d,f]=s.useState(!1),[h,u]=s.useState(-1),[g,p]=s.useState({top:0,left:0,width:0,direction:"down"}),k=s.useRef(null),y=s.useRef(null),x=a.find(D=>(typeof D=="object"?D.value:D)===e),S=x?typeof x=="object"?x.label:x:r,j=s.useCallback(()=>{if(!k.current)return;const D=k.current.getBoundingClientRect(),_=window.innerHeight-D.bottom,T=D.top,w=Math.min(a.length*36+8,200),v=_<w&&T>w?"up":"down";p({top:v==="down"?D.bottom+4:D.top-w-4,left:D.left,width:D.width,direction:v})},[a.length]);s.useEffect(()=>{if(!d)return;const D=_=>{if(k.current&&!k.current.contains(_.target)){if(y.current&&y.current.contains(_.target))return;f(!1)}};return document.addEventListener("mousedown",D),()=>document.removeEventListener("mousedown",D)},[d]),s.useEffect(()=>{if(d){j();const D=()=>j();return window.addEventListener("scroll",D,!0),window.addEventListener("resize",D),()=>{window.removeEventListener("scroll",D,!0),window.removeEventListener("resize",D)}}},[d,j]);const z=s.useCallback(D=>{if(!l)switch(D.key){case"Enter":case" ":if(D.preventDefault(),d&&h>=0){const _=a[h],T=typeof _=="object"?_.value:_;n({target:{value:T}}),f(!1)}else f(!0);break;case"Escape":f(!1);break;case"ArrowDown":D.preventDefault(),d?(I(!0),u(_=>_<a.length-1?_+1:0)):f(!0);break;case"ArrowUp":D.preventDefault(),d&&(I(!0),u(_=>_>0?_-1:a.length-1));break;case"Tab":f(!1);break}},[d,h,a,n,l]),[A,I]=s.useState(!1);s.useEffect(()=>{if(d&&h>=0&&y.current&&A){const D=y.current.children[h];D&&D.scrollIntoView({block:"nearest"}),I(!1)}},[h,d,A]),s.useEffect(()=>{if(d){const D=a.findIndex(_=>(typeof _=="object"?_.value:_)===e);u(D>=0?D:0)}},[d,a,e]);const L=D=>{const _=typeof D=="object"?D.value:D;n({target:{value:_}}),f(!1)},R=d&&di.createPortal(t.jsx("ul",{ref:y,role:"listbox","aria-activedescendant":h>=0?`option-${h}`:void 0,style:{position:"fixed",top:g.top,left:g.left,width:g.width,padding:4,background:o.bgMedium,border:`1px solid ${o.border}`,borderRadius:F.lg,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:99999,maxHeight:200,overflowY:"auto",listStyle:"none",margin:0,fontFamily:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:a.map((D,_)=>{const T=typeof D=="object"?D.value:D,w=typeof D=="object"?D.label:D,v=T===e,O=_===h;return t.jsx("li",{id:`option-${_}`,role:"option","aria-selected":v,onClick:()=>L(D),onMouseEnter:()=>u(_),style:{padding:"10px 16px",borderRadius:F.md,cursor:"pointer",color:o.textPrimary,fontSize:b.fontSize.base,fontFamily:"inherit",background:O?"rgba(106, 154, 184, 0.2)":v?"rgba(106, 154, 184, 0.1)":"transparent",fontWeight:v?600:400,transition:"background 0.15s ease"},children:w},T)})}),document.body);return t.jsxs("div",{ref:k,style:{position:"relative",...i},children:[t.jsxs("button",{type:"button",onClick:()=>!l&&f(!d),onKeyDown:z,disabled:l,"aria-haspopup":"listbox","aria-expanded":d,"aria-label":m,style:{width:"100%",padding:"12px 16px",paddingRight:40,background:"var(--input-bg, rgba(106, 154, 184, 0.1))",border:`1px solid ${o.border}`,borderRadius:F.lg,color:x?o.textPrimary:o.textMuted,fontSize:b.fontSize.base,textAlign:"left",cursor:l?"not-allowed":"pointer",opacity:l?.6:1,position:"relative",display:"flex",alignItems:"center",boxSizing:"border-box",transition:"border-color 150ms ease, box-shadow 150ms ease",outline:"none",...d&&{borderColor:o.primary,boxShadow:"0 0 0 2px rgba(106, 154, 184, 0.2)"}},children:[S,t.jsx(pt,{size:16,style:{position:"absolute",right:12,top:"50%",transform:"translateY(-50%)",color:o.textMuted,transition:"transform 0.2s ease",...d&&{transform:"translateY(-50%) rotate(180deg)"}}})]}),R]})}const $o=[25,50,100,250,500],Bo=25,gr="sims-saved-filter-views",Na=s.memo(function({checked:n,indeterminate:a,onChange:r,size:i=20}){const l=a?Di:n?jr:Ai;return t.jsx("button",{onClick:m=>{m.stopPropagation(),r(!n)},style:{background:"none",border:"none",padding:0,cursor:"pointer",color:n||a?o.primary:o.textMuted,display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx(l,{size:i})})}),Vo=s.memo(function({savedViews:n,currentFilters:a,onLoadView:r,onSaveView:i,onDeleteView:l,hasActiveFilters:m}){const[d,f]=s.useState(!1),[h,u]=s.useState(!1),[g,p]=s.useState(""),k=Sa.useRef(null);s.useEffect(()=>{const S=j=>{k.current&&!k.current.contains(j.target)&&f(!1)};return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[]);const y=()=>{g.trim()&&(i(g.trim()),p(""),u(!1))},x=S=>{S.key==="Enter"?y():S.key==="Escape"&&(u(!1),p(""))};return t.jsxs("div",{ref:k,style:{position:"relative"},children:[t.jsxs("button",{onClick:()=>f(!d),className:"btn-secondary",style:{display:"flex",alignItems:"center",gap:c[2],cursor:"pointer",minWidth:140,fontWeight:500},children:[t.jsx(Ti,{size:16}),t.jsx("span",{children:"Saved Views"}),t.jsx(pt,{size:16,style:{marginLeft:"auto"}})]}),d&&t.jsxs("div",{style:{position:"absolute",top:"100%",left:0,marginTop:c[1],background:o.bgLight,border:`1px solid ${o.border}`,borderRadius:F.lg,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",minWidth:250,maxHeight:350,overflowY:"auto",zIndex:Ca.dropdown},children:[m&&t.jsx("div",{style:{padding:c[2],borderBottom:`1px solid ${o.border}`},children:h?t.jsxs("div",{style:{display:"flex",gap:c[2]},children:[t.jsx("input",{type:"text",value:g,onChange:S=>p(S.target.value),onKeyDown:x,placeholder:"View name...",autoFocus:!0,style:{...me.input,flex:1,padding:`${c[1]}px ${c[2]}px`,fontSize:b.fontSize.sm}}),t.jsx("button",{onClick:y,disabled:!g.trim(),style:{background:o.primary,color:"white",border:"none",borderRadius:F.md,padding:`${c[1]}px ${c[2]}px`,cursor:g.trim()?"pointer":"not-allowed",opacity:g.trim()?1:.5},children:"Save"})]}):t.jsxs("button",{onClick:()=>u(!0),style:{display:"flex",alignItems:"center",gap:c[2],width:"100%",padding:`${c[2]}px`,background:`${te(o.primary,15)}`,border:"none",borderRadius:F.md,cursor:"pointer",color:o.primary,fontSize:b.fontSize.sm,fontWeight:b.fontWeight.medium},children:[t.jsx(Ri,{size:16}),"Save Current Filters"]})}),n.length>0?t.jsx("div",{style:{padding:c[1]},children:n.map(S=>t.jsxs("div",{className:"list-item-hover",style:{display:"flex",alignItems:"center",gap:c[2],padding:`${c[2]}px ${c[2]}px`,borderRadius:F.md,cursor:"pointer"},children:[t.jsxs("div",{style:{flex:1},onClick:()=>{r(S),f(!1)},children:[t.jsx("div",{style:{fontWeight:b.fontWeight.medium,color:o.textPrimary,fontSize:b.fontSize.sm},children:S.name}),t.jsx("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted,marginTop:2},children:[S.filters.search&&`"${S.filters.search}"`,S.filters.category!=="all"&&S.filters.category,S.filters.status!=="all"&&S.filters.status].filter(Boolean).join(" ‚Ä¢ ")||"No filters"})]}),t.jsx("button",{onClick:j=>{j.stopPropagation(),l(S.id)},className:"hover-danger",style:{background:"none",border:"none",padding:c[1],cursor:"pointer",color:o.textMuted,borderRadius:F.sm,display:"flex",alignItems:"center"},title:"Delete view",children:t.jsx(Cn,{size:14})})]},S.id))}):t.jsx("div",{style:{padding:c[4],textAlign:"center",color:o.textMuted,fontSize:b.fontSize.sm},children:m?"No saved views yet. Save your current filters above!":"No saved views. Apply filters and save them for quick access."})]})]})}),Wo=s.memo(function({item:n,onViewItem:a,selectionMode:r,isSelected:i,onToggleSelect:l}){return t.jsxs(lt,{onClick:()=>r?l(n.id):a(n.id),padding:!1,style:{cursor:"pointer",overflow:"hidden",aspectRatio:"1 / 1",display:"flex",flexDirection:"column",outline:i?`2px solid ${o.primary}`:"none",outlineOffset:"-2px"},children:[t.jsxs("div",{style:{flex:"0 0 60%",overflow:"hidden",position:"relative"},children:[r&&t.jsx("div",{style:{position:"absolute",top:c[2],left:c[2],zIndex:Ca.base+1,background:o.bgLight,borderRadius:F.sm,padding:2},onClick:m=>m.stopPropagation(),children:t.jsx(Na,{checked:i,onChange:()=>l(n.id),size:22})}),n.image?t.jsx(En,{src:n.image,alt:n.name,size:"thumbnail",style:{width:"100%",height:"100%"},objectFit:"cover"}):t.jsxs("div",{style:{width:"100%",height:"100%",background:`${te(o.primary,10)}`,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:o.textMuted},children:[t.jsxs("svg",{width:28,height:28,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[t.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),t.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),t.jsx("polyline",{points:"21 15 16 10 5 21"})]}),t.jsx("span",{style:{fontSize:b.fontSize.xs,marginTop:c[1]},children:"No Image"})]})]}),t.jsxs("div",{style:{flex:1,padding:c[3],display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",gap:c[1],marginBottom:c[1],flexWrap:"wrap"},children:[t.jsx(Le,{text:n.id,color:o.primary,size:"xs"}),t.jsx(Le,{text:n.status,color:Bt(n.status),size:"xs"})]}),t.jsx("h4",{style:{margin:0,fontSize:b.fontSize.sm,color:o.textPrimary,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n.name})]}),t.jsx("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted},children:n.brand})]})]})}),Fo=s.memo(function({item:n,onViewItem:a,selectionMode:r,isSelected:i,onToggleSelect:l}){return t.jsxs(lt,{onClick:()=>r?l(n.id):a(n.id),style:{cursor:"pointer",padding:c[3],display:"flex",alignItems:"center",gap:c[3],outline:i?`2px solid ${o.primary}`:"none",outlineOffset:"-2px"},children:[r&&t.jsx("div",{onClick:m=>m.stopPropagation(),children:t.jsx(Na,{checked:i,onChange:()=>l(n.id),size:22})}),n.image?t.jsx(En,{src:n.image,alt:n.name,size:"thumbnail",width:56,height:56,style:{borderRadius:F.md},objectFit:"cover"}):t.jsx("div",{style:{width:56,height:56,borderRadius:F.md,background:`${te(o.primary,10)}`,display:"flex",alignItems:"center",justifyContent:"center",color:o.textMuted,fontSize:b.fontSize.xs},children:"No img"}),t.jsxs("div",{style:{flex:1},children:[t.jsxs("div",{style:{display:"flex",gap:c[1],marginBottom:c[1]},children:[t.jsx(Le,{text:n.id,color:o.primary}),t.jsx(Le,{text:n.status,color:Bt(n.status)}),t.jsx(Le,{text:n.category,color:o.accent2})]}),t.jsx("div",{style:{fontWeight:b.fontWeight.medium,color:o.textPrimary},children:n.name}),t.jsx("div",{style:{fontSize:b.fontSize.sm,color:o.textMuted},children:n.brand})]})]})}),Ho=s.memo(function({selectedCount:n,totalCount:a,onSelectAll:r,onDeselectAll:i,onCancel:l,onBulkAction:m,allSelected:d,someSelected:f}){return t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:c[3],padding:c[3],background:`${te(o.primary,15)}`,borderRadius:F.lg,marginBottom:c[4],flexWrap:"wrap"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:c[2]},children:[t.jsx(Na,{checked:d,indeterminate:f&&!d,onChange:()=>d?i():r()}),t.jsxs("span",{style:{fontSize:b.fontSize.sm,color:o.textPrimary},children:[n," of ",a," selected"]})]}),n>0&&t.jsxs("div",{style:{display:"flex",gap:c[2],flex:1,justifyContent:"center",flexWrap:"wrap"},children:[t.jsx(Ae,{size:"sm",variant:"secondary",onClick:()=>m("status"),children:"Change Status"}),t.jsx(Ae,{size:"sm",variant:"secondary",onClick:()=>m("location"),children:"Update Location"}),t.jsx(Ae,{size:"sm",variant:"secondary",onClick:()=>m("category"),children:"Change Category"}),t.jsx(Ae,{size:"sm",variant:"secondary",danger:!0,onClick:()=>m("delete"),children:"Delete"})]}),t.jsx(Ae,{size:"sm",variant:"secondary",onClick:l,icon:wn,children:"Exit Selection"})]})});function Uo({inventory:e,categories:n,categorySettings:a,searchQuery:r,setSearchQuery:i,categoryFilter:l,setCategoryFilter:m,statusFilter:d,setStatusFilter:f,isGridView:h,setIsGridView:u,onViewItem:g,onAddItem:p,onBulkAction:k}){const{canEdit:y}=cn(),x=y("gear_list"),[S,j]=s.useState(()=>{const H=localStorage.getItem("sims-gear-list-page-size");return H?parseInt(H,10):Bo}),[z,A]=s.useState(!1),[I,L]=s.useState(new Set),[R,D]=s.useState(()=>{try{const H=localStorage.getItem(gr);return H?JSON.parse(H):[]}catch{return[]}});s.useEffect(()=>{localStorage.setItem(gr,JSON.stringify(R))},[R]);const _=r||l!=="all"||d!=="all",T=s.useMemo(()=>({search:r,category:l,status:d}),[r,l,d]),w=s.useCallback(H=>{const se={id:wt(),name:H,filters:{...T},createdAt:new Date().toISOString()};D(ae=>[...ae,se])},[T]),v=s.useCallback(H=>{i(H.filters.search||""),m(H.filters.category||"all"),f(H.filters.status||"all")},[i,m,f]),O=s.useCallback(H=>{D(se=>se.filter(ae=>ae.id!==H))},[]);s.useEffect(()=>{localStorage.setItem("sims-gear-list-page-size",S.toString())},[S]);const $=mo(r,200),K=s.useMemo(()=>{let H=e.filter(se=>!se.isKit);return H=fs(H,$,["name","brand","id"]),H=ps(H,l),d==="low-stock"?H=H.filter(se=>{const ae=a?.[se.category];if(!ae?.trackQuantity||se.quantity===void 0||se.quantity===null)return!1;const V=se.quantity,pe=se.reorderPoint||ae.lowStockThreshold||0;return pe>0&&V<=pe}):H=gs(H,d),H},[e,$,l,d,a]),Y=s.useMemo(()=>new Set(K.map(H=>H.id)),[K]);s.useEffect(()=>{z||L(new Set)},[z]),s.useEffect(()=>{L(H=>{const se=new Set([...H].filter(ae=>Y.has(ae)));return se.size!==H.size?se:H})},[Y]);const J=s.useCallback(H=>{L(se=>{const ae=new Set(se);return ae.has(H)?ae.delete(H):ae.add(H),ae})},[]),ie=s.useCallback(()=>{L(new Set(K.map(H=>H.id)))},[K]),_e=s.useCallback(()=>{L(new Set)},[]),ve=s.useCallback(H=>{k&&I.size>0&&k(H,[...I])},[k,I]),B=I.size,G=B===K.length&&K.length>0,q=B>0,{page:Q,totalPages:Z,paginatedItems:W,goToPage:le}=uo(K,S);return s.useMemo(()=>{le(1)},[$,l,d,S]),t.jsxs(t.Fragment,{children:[!x&&t.jsx(Is,{functionId:"gear_list"}),t.jsxs("div",{className:"page-header",children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:c[3]},children:[t.jsxs("div",{children:[t.jsx("h2",{className:"page-title",children:"Gear List"}),t.jsxs("p",{style:{margin:`${c[1]}px 0 0`,color:o.textMuted,fontSize:b.fontSize.sm},children:[K.length," ",K.length===1?"item":"items",_&&" (filtered)"]})]}),x&&t.jsx(Ae,{onClick:p,icon:bt,children:"Add Item"})]}),t.jsxs("div",{style:{display:"flex",gap:c[2],alignItems:"center"},children:[t.jsx(Vo,{savedViews:R,currentFilters:T,onLoadView:v,onSaveView:w,onDeleteView:O,hasActiveFilters:_}),x&&!z?t.jsx(Ae,{variant:"secondary",onClick:()=>A(!0),icon:jr,children:"Multiple Selection"}):z?t.jsx(Ae,{variant:"secondary",onClick:()=>A(!1),icon:wn,children:"Cancel Selection"}):null]})]}),z&&t.jsx(Ho,{selectedCount:B,totalCount:K.length,onSelectAll:ie,onDeselectAll:_e,onCancel:()=>A(!1),onBulkAction:ve,allSelected:G,someSelected:q}),t.jsxs("div",{style:{display:"flex",gap:c[3],marginBottom:c[5],flexWrap:"wrap",alignItems:"center",justifyContent:"space-between"},children:[t.jsx("div",{style:{minWidth:200,maxWidth:400,flex:"1 1 200px"},children:t.jsx(ea,{value:r,onChange:i,onClear:()=>i(""),placeholder:"Search items..."})}),t.jsxs("div",{style:{display:"flex",gap:c[3],alignItems:"center",flexWrap:"wrap",marginLeft:"auto"},children:[_&&t.jsxs("button",{onClick:()=>{i(""),m("all"),f("all")},style:{...me.btnSec,display:"flex",alignItems:"center",gap:c[1],padding:"12px 14px",fontSize:b.fontSize.sm,color:o.textMuted},title:"Clear all filters",children:[t.jsx(wn,{size:14}),"Clear"]}),t.jsx(qt,{value:l,onChange:H=>m(H.target.value),options:[{value:"all",label:"All Categories"},...n.map(H=>({value:H,label:H}))],style:{minWidth:150},"aria-label":"Filter by category"}),t.jsx(qt,{value:d,onChange:H=>f(H.target.value),options:[{value:"all",label:"All Status"},{value:"available",label:"Available"},{value:"checked-out",label:"Checked Out"},{value:"reserved",label:"Reserved"},{value:"needs-attention",label:"Needs Attention"},{value:"missing",label:"Missing"},{value:"overdue",label:"Overdue"},{value:"low-stock",label:"Low Stock"}],style:{minWidth:140},"aria-label":"Filter by status"}),t.jsxs("div",{style:{display:"flex",background:`${te(o.primary,15)}`,borderRadius:F.lg},children:[t.jsx("button",{onClick:()=>u(!0),style:{...me.btnSec,border:"none",padding:"12px 14px",background:h?`${te(o.primary,30)}`:"transparent",color:h?o.primary:o.textSecondary},children:t.jsx(Pi,{size:18})}),t.jsx("button",{onClick:()=>u(!1),style:{...me.btnSec,border:"none",padding:"12px 14px",background:h?"transparent":`${te(o.primary,30)}`,color:h?o.textSecondary:o.primary},children:t.jsx(Li,{size:18})})]})]})]}),h?t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:c[4]},children:W.map(H=>t.jsx(Wo,{item:H,onViewItem:g,selectionMode:z,isSelected:I.has(H.id),onToggleSelect:J},H.id))}):t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:c[2]},children:W.map(H=>t.jsx(Fo,{item:H,onViewItem:g,selectionMode:z,isSelected:I.has(H.id),onToggleSelect:J},H.id))}),K.length===0&&t.jsx("div",{style:{textAlign:"center",padding:c[10],color:o.textMuted},children:"No items found matching your criteria"}),K.length>0&&t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:c[3],marginTop:c[5]},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:c[2]},children:[t.jsx("span",{style:{fontSize:b.fontSize.sm,color:o.textMuted},children:"Show:"}),t.jsx(qt,{value:S,onChange:H=>j(parseInt(H.target.value,10)),options:$o.map(H=>({value:H,label:String(H)})),style:{width:80},"aria-label":"Items per page"}),t.jsx("span",{style:{fontSize:b.fontSize.sm,color:o.textMuted},children:"items"})]}),t.jsx(Jr,{page:Q,totalPages:Z,totalItems:K.length,pageSize:S,onPageChange:le})]})]})}const Go=s.memo(Uo),Ko=s.memo(function e({note:n,depth:a=0,onReply:r,onDelete:i,user:l,panelColor:m}){const[d,f]=s.useState(!0),[h,u]=s.useState(!1),[g,p]=s.useState(""),k=s.useCallback(()=>{g.trim()&&(r(n.id,g),p(""),u(!1))},[n.id,g,r]),y=s.useCallback(j=>{j.key==="Enter"&&!j.shiftKey&&(j.preventDefault(),k())},[k]);if(n.deleted)return t.jsx("div",{style:{padding:c[3],marginLeft:a*c[5],color:o.textMuted,fontStyle:"italic",fontSize:b.fontSize.sm},children:"[Note deleted]"});const x=n.replies&&n.replies.length>0,S=m&&m.length>0?m:o.primary;return t.jsxs("div",{style:{marginLeft:a*c[5]},children:[t.jsxs("div",{style:{padding:c[3],background:`${te(S,20)}`,border:`1px solid ${te(S,50)}`,borderRadius:F.md,borderLeft:a>0?`3px solid ${S}`:`1px solid ${te(S,50)}`,marginBottom:c[2]},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:c[2],marginBottom:c[2]},children:[x&&t.jsx("button",{onClick:()=>f(!d),style:{background:"none",border:"none",color:o.textMuted,cursor:"pointer",padding:0,display:"flex"},children:d?t.jsx(pt,{size:14}):t.jsx(nn,{size:14})}),t.jsx("span",{style:{fontWeight:b.fontWeight.medium,color:o.textPrimary,fontSize:b.fontSize.sm},children:n.user}),t.jsx("span",{style:{fontSize:b.fontSize.xs,color:o.textMuted},children:He(n.date)})]}),t.jsx("p",{style:{margin:0,color:o.textSecondary,fontSize:b.fontSize.sm,lineHeight:1.5},children:n.text}),t.jsxs("div",{style:{display:"flex",gap:c[2],marginTop:c[2]},children:[t.jsxs("button",{onClick:()=>u(!h),style:{display:"flex",alignItems:"center",gap:c[1],background:"none",border:"none",color:o.textMuted,cursor:"pointer",fontSize:b.fontSize.xs,padding:c[1]},children:[t.jsx(Mi,{size:12}),"Reply"]}),t.jsxs("button",{onClick:()=>i(n.id),style:{display:"flex",alignItems:"center",gap:c[1],background:"none",border:"none",color:o.textMuted,cursor:"pointer",fontSize:b.fontSize.xs,padding:c[1]},children:[t.jsx(Cn,{size:12}),"Delete"]})]}),h&&t.jsxs("div",{style:{display:"flex",gap:c[2],marginTop:c[3]},children:[t.jsx("input",{value:g,onChange:j=>p(j.target.value),onKeyDown:y,placeholder:"Write a reply...",style:{...me.input,flex:1,padding:c[2],fontSize:b.fontSize.sm},autoFocus:!0}),t.jsx("button",{onClick:k,disabled:!g.trim(),style:{...me.btn,padding:c[2],opacity:g.trim()?1:.5},children:"Reply"})]})]}),x&&d&&t.jsx("div",{children:n.replies.map(j=>t.jsx(e,{note:j,depth:a+1,onReply:r,onDelete:i,user:l,panelColor:m},j.id))})]})});function Yo({notes:e=[],onAddNote:n,onReply:a,onDelete:r,user:i,panelColor:l}){const[m,d]=s.useState(""),f=s.useCallback(()=>{m.trim()&&(n(m),d(""))},[m,n]),h=s.useCallback(u=>{u.key==="Enter"&&!u.shiftKey&&(u.preventDefault(),f())},[f]);return e.filter(u=>!u.deleted),t.jsx(t.Fragment,{children:t.jsxs("div",{style:{padding:c[4]},children:[t.jsxs("div",{style:{display:"flex",gap:c[2],marginBottom:c[4]},children:[t.jsx("input",{value:m,onChange:u=>d(u.target.value),onKeyDown:h,placeholder:"Add a note...",style:{...me.input,flex:1,padding:c[2],fontSize:b.fontSize.sm}}),t.jsx("button",{onClick:f,disabled:!m.trim(),style:{...me.btn,padding:c[2],opacity:m.trim()?1:.5},children:t.jsx(bt,{size:16})})]}),t.jsx("div",{style:{maxHeight:300,overflowY:"auto"},children:e.length===0?t.jsx("p",{style:{color:o.textMuted,textAlign:"center",fontSize:b.fontSize.sm,padding:c[4]},children:"No notes yet"}):e.map(u=>t.jsx(Ko,{note:u,onReply:a,onDelete:r,user:i,panelColor:l},u.id))})]})})}const Qo=s.memo(Yo),Xo=["January","February","March","April","May","June","July","August","September","October","November","December"],Zo=["Su","Mo","Tu","We","Th","Fr","Sa"];function hr(e,n){return new Date(e,n+1,0).getDate()}function Jo(e,n){return new Date(e,n,1).getDay()}function ua(e){if(!e)return"";const n=new Date(e),a=n.getFullYear(),r=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0");return`${a}-${r}-${i}`}function Un(e){if(!e)return null;const[n,a,r]=e.split("-").map(Number);return new Date(n,a-1,r)}function el(e){if(!e)return"";const n=Un(e);return!n||isNaN(n.getTime())?"":n.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}function ui(e,n){return!e||!n?!1:e.getFullYear()===n.getFullYear()&&e.getMonth()===n.getMonth()&&e.getDate()===n.getDate()}function tl(e){return ui(e,new Date)}const Ee={container:{position:"relative",width:"100%"},inputWrapper:{position:"relative",display:"flex",alignItems:"center"},input:{width:"100%",padding:`${c[3]}px ${c[4]}px`,paddingRight:"44px",background:`color-mix(in srgb, ${o.primary} 10%, transparent)`,border:`1px solid ${o.border}`,borderRadius:F.lg,color:o.textPrimary,fontSize:b.fontSize.sm,fontFamily:"inherit",outline:"none",boxSizing:"border-box",minHeight:"46px",cursor:"pointer",transition:"border-color 150ms ease, box-shadow 150ms ease"},inputFocused:{borderColor:o.primary,boxShadow:`0 0 0 2px color-mix(in srgb, ${o.primary} 20%, transparent)`},inputError:{borderColor:o.danger},inputDisabled:{opacity:.6,cursor:"not-allowed"},icon:{position:"absolute",right:"12px",pointerEvents:"none",color:o.textMuted,display:"flex",alignItems:"center",justifyContent:"center",transition:"color 150ms ease"},iconActive:{color:o.primary},popup:{position:"absolute",top:"calc(100% + 4px)",left:0,zIndex:1e3,background:o.bgCard,border:`1px solid ${o.border}`,borderRadius:F.lg,boxShadow:"0 10px 40px rgba(0, 0, 0, 0.4)",padding:c[3],minWidth:"280px",animation:"fadeIn 150ms ease"},popupAbove:{top:"auto",bottom:"calc(100% + 4px)"},popupLeft:{left:"auto",right:0},header:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:c[3],paddingBottom:c[2],borderBottom:`1px solid ${o.border}`},headerTitle:{fontSize:b.fontSize.base,fontWeight:b.fontWeight.semibold,color:o.textPrimary},navButton:{display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px",background:"transparent",border:"none",borderRadius:F.md,color:o.textSecondary,cursor:"pointer",transition:"background 150ms ease, color 150ms ease"},navButtonHover:{background:`color-mix(in srgb, ${o.primary} 15%, transparent)`,color:o.primary},weekDays:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"2px",marginBottom:c[2]},weekDay:{textAlign:"center",fontSize:b.fontSize.xs,fontWeight:b.fontWeight.medium,color:o.textMuted,padding:`${c[1]}px 0`},days:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"2px"},day:{display:"flex",alignItems:"center",justifyContent:"center",width:"36px",height:"36px",fontSize:b.fontSize.sm,color:o.textPrimary,background:"transparent",border:"none",borderRadius:F.md,cursor:"pointer",transition:"background 150ms ease, color 150ms ease, transform 100ms ease"},dayHover:{background:`color-mix(in srgb, ${o.primary} 15%, transparent)`},daySelected:{background:o.primary,color:"#ffffff",fontWeight:b.fontWeight.semibold},dayToday:{border:`2px solid ${o.primary}`,fontWeight:b.fontWeight.semibold},dayOtherMonth:{color:o.textMuted,opacity:.5},dayDisabled:{color:o.textMuted,opacity:.3,cursor:"not-allowed"},footer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:c[3],paddingTop:c[2],borderTop:`1px solid ${o.border}`},todayButton:{padding:`${c[1]}px ${c[3]}px`,fontSize:b.fontSize.sm,color:o.primary,background:"transparent",border:"none",borderRadius:F.md,cursor:"pointer",transition:"background 150ms ease"},clearButton:{padding:`${c[1]}px ${c[3]}px`,fontSize:b.fontSize.sm,color:o.textMuted,background:"transparent",border:"none",borderRadius:F.md,cursor:"pointer",transition:"color 150ms ease"}},mi=s.memo(function({value:n,onChange:a,min:r,max:i,disabled:l=!1,error:m=!1,placeholder:d="Select date",clearable:f=!0,showTodayButton:h=!0,className:u="",style:g={},"aria-label":p,id:k}){const[y,x]=s.useState(!1),[S,j]=s.useState(()=>{const W=n?Un(n):new Date;return{year:W.getFullYear(),month:W.getMonth()}}),[z,A]=s.useState(null),[I,L]=s.useState(null),[R,D]=s.useState(!1),[_,T]=s.useState(!1),[w,v]=s.useState(!1),O=s.useRef(null),$=s.useRef(null),K=s.useRef(null),Y=n?Un(n):null;s.useEffect(()=>{if(y&&O.current){const W=O.current.getBoundingClientRect(),le=window.innerHeight-W.bottom,H=W.top,se=window.innerWidth-W.left;T(le<350&&H>le),v(se<320)}},[y]),s.useEffect(()=>{if(!y)return;const W=H=>{O.current&&!O.current.contains(H.target)&&x(!1)},le=H=>{H.key==="Escape"&&(x(!1),$.current?.focus())};return document.addEventListener("mousedown",W),document.addEventListener("keydown",le),()=>{document.removeEventListener("mousedown",W),document.removeEventListener("keydown",le)}},[y]),s.useEffect(()=>{if(n){const W=Un(n);W&&!isNaN(W.getTime())&&j({year:W.getFullYear(),month:W.getMonth()})}},[n]);const J=s.useCallback(()=>{l||x(W=>!W)},[l]),ie=s.useCallback(()=>{j(W=>W.month===0?{year:W.year-1,month:11}:{...W,month:W.month-1})},[]),_e=s.useCallback(()=>{j(W=>W.month===11?{year:W.year+1,month:0}:{...W,month:W.month+1})},[]),ve=s.useCallback((W,le)=>{let H=S.year,se=S.month;le||(W>15?(se--,se<0&&(se=11,H--)):(se++,se>11&&(se=0,H++)));const ae=new Date(H,se,W),V=ua(ae);r&&V<r||i&&V>i||(a({target:{value:V}}),x(!1))},[S,a,r,i]),B=s.useCallback(()=>{const le=ua(new Date);r&&le<r||i&&le>i||(a({target:{value:le}}),x(!1))},[a,r,i]),G=s.useCallback(()=>{a({target:{value:""}}),x(!1)},[a]),q=()=>{const{year:W,month:le}=S,H=hr(W,le),se=Jo(W,le),ae=hr(W,le-1),V=[];for(let ge=se-1;ge>=0;ge--){const be=ae-ge;V.push({day:be,isCurrentMonth:!1,isPrev:!0})}for(let ge=1;ge<=H;ge++)V.push({day:ge,isCurrentMonth:!0});const pe=42-V.length;for(let ge=1;ge<=pe;ge++)V.push({day:ge,isCurrentMonth:!1,isNext:!0});return V.map((ge,be)=>{let ke=W,re=le;ge.isPrev?(re--,re<0&&(re=11,ke--)):ge.isNext&&(re++,re>11&&(re=0,ke++));const Se=new Date(ke,re,ge.day),Te=ua(Se),$e=Y&&ui(Se,Y),xe=tl(Se),de=r&&Te<r||i&&Te>i,ce=z===be,Ie={...Ee.day,...ge.isCurrentMonth?{}:Ee.dayOtherMonth,...de?Ee.dayDisabled:{},...ce&&!de&&!$e?Ee.dayHover:{},...xe&&!$e?Ee.dayToday:{},...$e?Ee.daySelected:{}};return t.jsx("button",{type:"button",style:Ie,onClick:()=>!de&&ve(ge.day,ge.isCurrentMonth),onMouseEnter:()=>A(be),onMouseLeave:()=>A(null),disabled:de,tabIndex:y?0:-1,"aria-label":Se.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"}),"aria-selected":$e,"aria-current":xe?"date":void 0,children:ge.day},be)})},Q={...Ee.input,...R||y?Ee.inputFocused:{},...m?Ee.inputError:{},...l?Ee.inputDisabled:{},...g},Z=el(n);return t.jsxs("div",{ref:O,style:{...Ee.container,...g},className:u,children:[t.jsxs("div",{style:Ee.inputWrapper,children:[t.jsx("input",{ref:$,type:"text",id:k,value:Z,placeholder:d,onClick:J,onFocus:()=>D(!0),onBlur:()=>D(!1),onKeyDown:W=>{(W.key==="Enter"||W.key===" ")&&(W.preventDefault(),x(!0))},readOnly:!0,disabled:l,style:Q,"aria-label":p,"aria-haspopup":"dialog","aria-expanded":y}),t.jsx("div",{style:{...Ee.icon,...y?Ee.iconActive:{}},children:t.jsx(jt,{size:18})})]}),y&&t.jsxs("div",{ref:K,style:{...Ee.popup,..._?Ee.popupAbove:{},...w?Ee.popupLeft:{}},role:"dialog","aria-label":"Choose date",children:[t.jsxs("div",{style:Ee.header,children:[t.jsx("button",{type:"button",style:{...Ee.navButton,...I==="prev"?Ee.navButtonHover:{}},onClick:ie,onMouseEnter:()=>L("prev"),onMouseLeave:()=>L(null),"aria-label":"Previous month",children:t.jsx(vr,{size:20})}),t.jsxs("span",{style:Ee.headerTitle,children:[Xo[S.month]," ",S.year]}),t.jsx("button",{type:"button",style:{...Ee.navButton,...I==="next"?Ee.navButtonHover:{}},onClick:_e,onMouseEnter:()=>L("next"),onMouseLeave:()=>L(null),"aria-label":"Next month",children:t.jsx(nn,{size:20})})]}),t.jsx("div",{style:Ee.weekDays,children:Zo.map(W=>t.jsx("div",{style:Ee.weekDay,children:W},W))}),t.jsx("div",{style:Ee.days,children:q()}),(h||f)&&t.jsxs("div",{style:Ee.footer,children:[f&&n?t.jsx("button",{type:"button",style:Ee.clearButton,onClick:G,onMouseEnter:W=>W.target.style.color=o.danger,onMouseLeave:W=>W.target.style.color=o.textMuted,children:"Clear"}):t.jsx("span",{}),h&&t.jsx("button",{type:"button",style:Ee.todayButton,onClick:B,onMouseEnter:W=>W.target.style.background=`color-mix(in srgb, ${o.primary} 15%, transparent)`,onMouseLeave:W=>W.target.style.background="transparent",children:"Today"})]})]})]})});mi.propTypes={value:E.string,onChange:E.func.isRequired,min:E.string,max:E.string,disabled:E.bool,error:E.bool,placeholder:E.string,clearable:E.bool,showTodayButton:E.bool,className:E.string,style:E.object,"aria-label":E.string,id:E.string};const fi=[{value:"none",label:"One-time"},{value:"weekly",label:"Weekly"},{value:"biweekly",label:"Every 2 weeks"},{value:"monthly",label:"Monthly"},{value:"quarterly",label:"Quarterly"},{value:"biannual",label:"Every 6 months"},{value:"yearly",label:"Yearly"}],nl=s.memo(function({reminder:n,onComplete:a,onUncomplete:r,onDelete:i,panelColor:l}){const m=Ye(),d=n.completed,f=!d&&n.dueDate<=m,h=!d&&n.dueDate<m,u=l&&l.length>0?l:o.primary;let g,p,k;return d?(g=te(o.available,20),p=te(o.available,50),k=te(o.available,25)):f?(g=te(o.needsAttention,20),p=te(o.needsAttention,50),k=te(o.needsAttention,25)):(g=te(u,20),p=te(u,50),k=te(u,25)),t.jsx("div",{style:{background:g,border:`1px solid ${p}`,borderRadius:F.md,padding:c[3],marginBottom:c[2],opacity:d?.7:1},children:t.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:c[3]},children:[t.jsx("div",{style:{width:32,height:32,borderRadius:F.md,background:k,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:d?t.jsx(vn,{size:16,color:o.available}):f?t.jsx(an,{size:16,color:o.needsAttention}):t.jsx($t,{size:16,color:u})}),t.jsxs("div",{style:{flex:1,minWidth:0},children:[t.jsx("div",{style:{fontSize:b.fontSize.sm,fontWeight:b.fontWeight.medium,color:d?o.textMuted:o.textPrimary,marginBottom:c[1],textDecoration:d?"line-through":"none"},children:n.title}),n.description&&t.jsx("div",{style:{fontSize:b.fontSize.xs,color:o.textSecondary,marginBottom:c[1]},children:n.description}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:c[2],flexWrap:"wrap"},children:[d?t.jsxs("span",{style:{fontSize:b.fontSize.xs,color:o.available,fontWeight:b.fontWeight.medium},children:[t.jsx(vn,{size:10,style:{marginRight:4,verticalAlign:"middle"}}),"Completed ",n.completedDate?He(n.completedDate):""]}):t.jsxs("span",{style:{fontSize:b.fontSize.xs,color:f?o.needsAttention:o.textMuted,fontWeight:f?b.fontWeight.medium:b.fontWeight.normal},children:[t.jsx(jt,{size:10,style:{marginRight:4,verticalAlign:"middle"}}),h?"Overdue: ":f?"Due: ":"",He(n.dueDate)]}),n.recurrence!=="none"&&t.jsxs("span",{style:{fontSize:b.fontSize.xs,color:o.primary,display:"flex",alignItems:"center",gap:2},children:[t.jsx(ka,{size:10}),fi.find(y=>y.value===n.recurrence)?.label]})]})]}),t.jsxs("div",{style:{display:"flex",gap:c[1],flexShrink:0},children:[d?t.jsx("button",{onClick:()=>r(n.id),title:"Mark incomplete",style:{...me.btnSec,padding:c[1],fontSize:b.fontSize.xs},children:"‚Ü©"}):t.jsx("button",{onClick:()=>a(n.id),title:"Mark complete",style:{...me.btn,padding:c[1],fontSize:b.fontSize.xs,background:o.success},children:"‚úì"}),t.jsx("button",{onClick:()=>i(n.id),title:"Delete reminder",style:{...me.btnSec,padding:c[1],color:o.danger},children:t.jsx(Cn,{size:14})})]})]})})}),al=s.memo(function({onAdd:n,onCancel:a}){const[r,i]=s.useState({title:"",description:"",dueDate:"",recurrence:"none"}),[l,m]=s.useState({}),d=(p,k)=>{i(y=>({...y,[p]:k}))},f=()=>{!r.title.trim()||!r.dueDate||n({id:wt(),title:r.title.trim(),description:r.description.trim(),dueDate:r.dueDate,recurrence:r.recurrence,completed:!1,createdAt:Ye()})},h=r.title.trim()&&r.dueDate,u=l.title&&!r.title.trim(),g=l.dueDate&&!r.dueDate;return t.jsxs("div",{style:{padding:c[3],background:te(o.primary,10),borderRadius:F.md,border:`1px solid ${te(o.primary,30)}`,marginBottom:c[3]},children:[t.jsxs("div",{style:{marginBottom:c[3]},children:[t.jsx("label",{style:{...me.label,color:u?o.danger:void 0},children:"Reminder Title *"}),t.jsx("input",{type:"text",value:r.title,onChange:p=>d("title",p.target.value),onBlur:()=>m(p=>({...p,title:!0})),placeholder:"e.g., Sensor cleaning due",style:{...me.input,borderColor:u?o.danger:void 0}})]}),t.jsxs("div",{style:{marginBottom:c[3]},children:[t.jsx("label",{style:me.label,children:"Description (optional)"}),t.jsx("input",{type:"text",value:r.description,onChange:p=>d("description",p.target.value),placeholder:"Additional details...",style:me.input})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:c[3],marginBottom:c[3]},children:[t.jsxs("div",{children:[t.jsx("label",{style:{...me.label,color:g?o.danger:void 0},children:"Due Date *"}),t.jsx(mi,{value:r.dueDate,onChange:p=>d("dueDate",p.target.value),min:Ye(),error:g,placeholder:"Select due date","aria-label":"Due date"})]}),t.jsxs("div",{children:[t.jsx("label",{style:me.label,children:"Recurrence"}),t.jsx(qt,{value:r.recurrence,onChange:p=>d("recurrence",p.target.value),options:fi,"aria-label":"Recurrence"})]})]}),t.jsxs("div",{style:{display:"flex",gap:c[2],justifyContent:"flex-end"},children:[t.jsx(Ae,{variant:"secondary",size:"sm",onClick:a,children:"Cancel"}),t.jsx(Ae,{size:"sm",onClick:f,disabled:!h,icon:bt,children:"Add Reminder"})]})]})});function rl({reminders:e=[],onAddReminder:n,onCompleteReminder:a,onUncompleteReminder:r,onDeleteReminder:i,panelColor:l}){const[m,d]=s.useState(!1),f=s.useCallback(g=>{n(g),d(!1)},[n]),h=[...e].sort((g,p)=>{if(g.completed&&!p.completed)return 1;if(!g.completed&&p.completed)return-1;if(!g.completed&&!p.completed){const k=Fn(g),y=Fn(p);if(k&&!y)return-1;if(!k&&y)return 1}return new Date(g.dueDate)-new Date(p.dueDate)});return h.filter(g=>!g.completed).filter(g=>Fn(g)).length,t.jsx(t.Fragment,{children:t.jsxs("div",{style:{padding:c[4]},children:[m?t.jsx(al,{onAdd:f,onCancel:()=>d(!1)}):t.jsx(Ae,{variant:"secondary",onClick:()=>d(!0),icon:bt,style:{width:"100%",justifyContent:"center",marginBottom:h.length>0?c[3]:0},children:"Add Reminder"}),h.length>0?t.jsx("div",{style:{maxHeight:300,overflowY:"auto"},children:h.map(g=>t.jsx(nl,{reminder:g,onComplete:a,onUncomplete:r,onDelete:i,panelColor:l},g.id))}):!m&&t.jsx("p",{style:{color:o.textMuted,textAlign:"center",fontSize:b.fontSize.sm,margin:`${c[4]}px 0 0`},children:"No reminders set"})]})})}const il=s.memo(rl),sl=e=>{switch(e){case ze.COMPLETED:return o.available;case ze.IN_PROGRESS:return o.checkedOut;case ze.SCHEDULED:return o.primary;case ze.CANCELLED:return o.textMuted;default:return o.textMuted}},ol=e=>{switch(e){case ze.COMPLETED:return wa;case ze.IN_PROGRESS:return ln;case ze.SCHEDULED:return jt;case ze.CANCELLED:return an;default:return bn}},ll=e=>{switch(e){case ze.COMPLETED:return"Completed";case ze.IN_PROGRESS:return"In Progress";case ze.SCHEDULED:return"Scheduled";case ze.CANCELLED:return"Cancelled";default:return e}},cl=s.memo(function({entry:n,onComplete:a,onEdit:r,panelColor:i}){const[l,m]=s.useState(!1),d=ol(n.status),f=sl(n.status),h=n.status===ze.COMPLETED,u=n.status===ze.SCHEDULED,g=n.status===ze.IN_PROGRESS,p=i&&i.length>0?i:o.primary;return t.jsxs("div",{style:{background:`${te(p,20)}`,border:`1px solid ${te(p,50)}`,borderLeft:`3px solid ${f}`,borderRadius:F.lg,marginBottom:c[3],overflow:"hidden"},children:[t.jsxs("div",{onClick:()=>m(!l),style:{padding:c[3],cursor:"pointer",display:"flex",alignItems:"center",gap:c[3]},children:[t.jsx("div",{style:{width:36,height:36,borderRadius:F.md,background:te(f,20),display:"flex",alignItems:"center",justifyContent:"center",color:f},children:t.jsx(d,{size:18})}),t.jsxs("div",{style:{flex:1,minWidth:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:c[2],marginBottom:c[1]},children:[t.jsx(Le,{text:n.type,color:f,size:"xs"}),t.jsx(Le,{text:ll(n.status),color:f,size:"xs"}),n.warrantyWork&&t.jsx(Le,{text:"Warranty",color:o.available,size:"xs"})]}),t.jsx("div",{style:{fontSize:b.fontSize.sm,color:o.textPrimary,fontWeight:b.fontWeight.medium,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:n.description||n.type}),t.jsxs("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted},children:[h&&n.completedDate?`Completed ${He(n.completedDate)}`:n.scheduledDate?`Scheduled ${He(n.scheduledDate)}`:He(n.createdAt),n.cost>0&&t.jsxs("span",{style:{color:o.textSecondary},children:[" ‚Ä¢ ",Ve(n.cost)]})]})]}),t.jsx("div",{style:{color:o.textMuted},children:l?t.jsx(jn,{size:18}):t.jsx(pt,{size:18})})]}),l&&t.jsx("div",{style:{padding:c[3],paddingTop:0,borderTop:`1px solid ${o.borderLight}`},children:t.jsxs("div",{style:{paddingTop:c[3]},children:[n.vendor&&t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:c[2],marginBottom:c[2]},children:[t.jsx(zi,{size:14,color:o.textMuted}),t.jsxs("span",{style:{fontSize:b.fontSize.sm,color:o.textSecondary},children:[n.vendor,n.vendorContact&&` ‚Ä¢ ${n.vendorContact}`]})]}),n.cost>0&&t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:c[2],marginBottom:c[2]},children:[t.jsx(va,{size:14,color:o.textMuted}),t.jsxs("span",{style:{fontSize:b.fontSize.sm,color:o.textSecondary},children:[Ve(n.cost),n.warrantyWork&&" (Warranty covered)"]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:c[2],marginBottom:c[2]},children:[t.jsx(jt,{size:14,color:o.textMuted}),t.jsxs("span",{style:{fontSize:b.fontSize.sm,color:o.textSecondary},children:[n.scheduledDate&&`Scheduled: ${He(n.scheduledDate)}`,n.scheduledDate&&n.completedDate&&" ‚Üí ",n.completedDate&&`Completed: ${He(n.completedDate)}`]})]}),n.notes&&t.jsxs("div",{style:{marginTop:c[2],padding:c[2],background:o.bgCard,borderRadius:F.md,fontSize:b.fontSize.sm,color:o.textSecondary,fontStyle:"italic"},children:['"',n.notes,'"']}),(u||g)&&t.jsxs("div",{style:{display:"flex",gap:c[2],marginTop:c[3]},children:[u&&t.jsx(Ae,{size:"sm",variant:"secondary",onClick:k=>{k.stopPropagation(),a(n.id,ze.IN_PROGRESS)},children:"Start Work"}),g&&t.jsx(Ae,{size:"sm",onClick:k=>{k.stopPropagation(),a(n.id,ze.COMPLETED)},icon:wa,children:"Mark Complete"})]})]})})]})});function dl({maintenanceHistory:e=[],onAddMaintenance:n,onUpdateMaintenance:a,onCompleteMaintenance:r,panelColor:i}){const l=i&&i.length>0?i:o.primary,m=e.filter(u=>u.status===ze.COMPLETED&&!u.warrantyWork).reduce((u,g)=>u+(Number(g.cost)||0),0),d=e.filter(u=>u.status===ze.SCHEDULED||u.status===ze.IN_PROGRESS).length,f=[...e].sort((u,g)=>{const p=u.status===ze.SCHEDULED||u.status===ze.IN_PROGRESS,k=g.status===ze.SCHEDULED||g.status===ze.IN_PROGRESS;if(p&&!k)return-1;if(!p&&k)return 1;const y=u.completedDate||u.scheduledDate||u.createdAt,x=g.completedDate||g.scheduledDate||g.createdAt;return new Date(x)-new Date(y)});return t.jsx(t.Fragment,{children:t.jsxs("div",{style:{padding:c[4]},children:[e.length>0&&t.jsxs("div",{style:{display:"flex",gap:c[4],marginBottom:c[4],padding:c[3],background:`${te(l,15)}`,borderRadius:F.md},children:[t.jsxs("div",{style:{textAlign:"center",flex:1},children:[t.jsx("div",{style:{fontSize:b.fontSize.lg,fontWeight:b.fontWeight.bold,color:o.primary},children:e.length}),t.jsx("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted},children:"Total Records"})]}),t.jsxs("div",{style:{textAlign:"center",flex:1},children:[t.jsx("div",{style:{fontSize:b.fontSize.lg,fontWeight:b.fontWeight.bold,color:d>0?o.checkedOut:o.textMuted},children:d}),t.jsx("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted},children:"Pending"})]}),t.jsxs("div",{style:{textAlign:"center",flex:1},children:[t.jsx("div",{style:{fontSize:b.fontSize.lg,fontWeight:b.fontWeight.bold,color:o.available},children:Ve(m)}),t.jsx("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted},children:"Total Cost"})]})]}),t.jsx(Ae,{variant:"secondary",onClick:n,icon:bt,style:{width:"100%",justifyContent:"center",marginBottom:f.length>0?c[3]:0},children:"Add Record"}),t.jsx("div",{style:{maxHeight:400,overflowY:"auto"},children:f.length===0?t.jsx("div",{style:{textAlign:"center",padding:c[4],color:o.textMuted},children:t.jsx("p",{style:{margin:0,fontSize:b.fontSize.sm},children:"No maintenance records yet"})}):f.map(u=>t.jsx(cl,{entry:u,onComplete:r,onEdit:a,panelColor:i},u.id))})]})})}const ul=s.memo(dl),pi={checkout:{icon:vn,color:o.checkedOut,label:"Checked Out",category:"checkout"},checkin:{icon:ka,color:o.available,label:"Returned",category:"checkout"},maintenance_scheduled:{icon:bn,color:o.primary,label:"Maintenance Scheduled",category:"maintenance"},maintenance_started:{icon:bn,color:o.checkedOut,label:"Maintenance Started",category:"maintenance"},maintenance_completed:{icon:bn,color:o.available,label:"Maintenance Completed",category:"maintenance"},note_added:{icon:_r,color:o.accent1,label:"Note Added",category:"notes"},reservation_created:{icon:jt,color:o.primary,label:"Reservation Created",category:"reservations"},reminder_created:{icon:$t,color:o.accent2,label:"Reminder Set",category:"reminders"},reminder_completed:{icon:$t,color:o.available,label:"Reminder Completed",category:"reminders"},condition_changed:{icon:an,color:o.danger,label:"Condition Changed",category:"status"},value_updated:{icon:va,color:o.accent1,label:"Value Updated",category:"value"}},ml=s.memo(function({event:n,isLast:a}){const[r,i]=s.useState(!1),l=pi[n.type]||{icon:ln,color:o.textMuted,label:n.type},m=l.icon;return t.jsxs("div",{style:{display:"flex",gap:c[3]},children:[t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:24},children:[t.jsx("div",{style:{width:32,height:32,borderRadius:"50%",background:te(l.color,20),display:"flex",alignItems:"center",justifyContent:"center",color:l.color,flexShrink:0},children:t.jsx(m,{size:16})}),!a&&t.jsx("div",{style:{width:2,flex:1,background:o.borderLight,marginTop:c[1],marginBottom:c[1]}})]}),t.jsx("div",{style:{flex:1,paddingBottom:a?0:c[4]},children:t.jsxs("div",{onClick:()=>n.details&&i(!r),style:{background:o.bgCard,border:`1px solid ${o.borderLight}`,borderRadius:F.lg,padding:c[3],cursor:n.details?"pointer":"default"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:c[1]},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:c[2]},children:[t.jsx(Le,{text:l.label,color:l.color,size:"xs"}),n.important&&t.jsx("span",{style:{color:o.danger,fontSize:b.fontSize.xs},children:"‚óè"})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:c[2]},children:[t.jsx("span",{style:{fontSize:b.fontSize.xs,color:o.textMuted},children:os(n.date)}),n.details&&t.jsx("span",{style:{color:o.textMuted},children:r?t.jsx(jn,{size:14}):t.jsx(pt,{size:14})})]})]}),t.jsx("div",{style:{fontSize:b.fontSize.sm,color:o.textPrimary},children:n.summary}),n.user&&t.jsxs("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted,marginTop:c[1]},children:["By: ",n.user]}),r&&n.details&&t.jsx("div",{style:{marginTop:c[3],paddingTop:c[3],borderTop:`1px solid ${o.borderLight}`},children:Object.entries(n.details).map(([d,f])=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:c[1]},children:[t.jsx("span",{style:{fontSize:b.fontSize.xs,color:o.textMuted,textTransform:"capitalize"},children:d.replace(/([A-Z])/g," $1").trim()}),t.jsx("span",{style:{fontSize:b.fontSize.xs,color:o.textSecondary},children:typeof f=="number"&&d.toLowerCase().includes("cost")?Ve(f):String(f)})]},d))})]})})]})});function fl({item:e}){const[n,a]=s.useState("all"),[r,i]=s.useState(!1),l=s.useMemo(()=>{const h=[];return e.checkoutHistory&&e.checkoutHistory.forEach(u=>{u.type==="checkout"?h.push({id:`checkout-${u.id}`,type:"checkout",date:u.checkedOutDate,summary:`Checked out to ${u.borrowerName}${u.project?` for ${u.project}`:""}`,user:u.borrowerName,details:{project:u.project,dueDate:u.dueDate,notes:u.notes}}):u.type==="return"&&h.push({id:`return-${u.id}`,type:"checkin",date:u.returnDate,summary:`Returned by ${u.returnedBy}${u.conditionChanged?" - condition changed":""}`,user:u.returnedBy,important:u.damageReported,details:u.damageReported?{conditionAtReturn:u.conditionAtReturn,damageReported:"Yes",damageDescription:u.damageDescription}:null})}),e.maintenanceHistory&&(e.maintenanceHistory||[]).forEach(u=>{u.scheduledDate&&h.push({id:`maint-sched-${u.id}`,type:"maintenance_scheduled",date:u.createdAt||u.scheduledDate,summary:`${u.type}: ${u.description}`,details:{vendor:u.vendor,estimatedCost:u.cost,scheduledFor:u.scheduledDate}}),u.status==="completed"&&u.completedDate&&h.push({id:`maint-done-${u.id}`,type:"maintenance_completed",date:u.completedDate,summary:`${u.type} completed${u.vendor?` by ${u.vendor}`:""}`,details:{description:u.description,cost:u.cost,warrantyWork:u.warrantyWork?"Yes":"No",notes:u.notes}})}),e.notes&&(e.notes||[]).filter(u=>!u.deleted).forEach(u=>{h.push({id:`note-${u.id}`,type:"note_added",date:u.date,summary:u.text.length>100?u.text.substring(0,100)+"...":u.text,user:u.user})}),e.reservations&&(e.reservations||[]).forEach(u=>{h.push({id:`res-${u.id}`,type:"reservation_created",date:u.start,summary:`Reserved for ${u.project} (${He(u.start)} - ${He(u.end)})`,user:u.user,details:{project:u.project,projectType:u.projectType,startDate:u.start,endDate:u.end,location:u.location}})}),e.reminders&&(e.reminders||[]).forEach(u=>{h.push({id:`rem-${u.id}`,type:u.completed?"reminder_completed":"reminder_created",date:u.completed?u.completedAt||u.dueDate:u.createdAt||u.dueDate,summary:u.title+(u.description?`: ${u.description}`:""),details:{dueDate:u.dueDate,recurrence:u.recurrence,completed:u.completed?"Yes":"No"}})}),h.sort((u,g)=>new Date(g.date)-new Date(u.date)),h},[e]),m=s.useMemo(()=>n==="all"?l:l.filter(h=>{const u=pi[h.type];return u&&u.category===n}),[l,n]),d=r?m:m.slice(0,5),f=[{value:"all",label:"All Events"},{value:"checkout",label:"Checkouts"},{value:"maintenance",label:"Maintenance"},{value:"notes",label:"Notes"},{value:"reservations",label:"Reservations"},{value:"reminders",label:"Reminders"}];return t.jsxs(lt,{padding:!1,children:[t.jsx(Zn,{title:"Item Timeline",icon:ln,action:t.jsx(qt,{value:n,onChange:h=>a(h.target.value),options:f,style:{width:120},"aria-label":"Filter timeline"})}),t.jsx("div",{style:{padding:c[4]},children:d.length===0?t.jsxs("div",{style:{textAlign:"center",padding:c[6],color:o.textMuted},children:[t.jsx(ln,{size:32,style:{marginBottom:c[2],opacity:.3}}),t.jsx("p",{style:{margin:0,fontSize:b.fontSize.sm},children:"No events recorded yet"})]}):t.jsxs(t.Fragment,{children:[d.map((h,u)=>t.jsx(ml,{event:h,isLast:u===d.length-1},h.id)),m.length>5&&!r&&t.jsxs("button",{onClick:()=>i(!0),style:{...me.btnSec,width:"100%",marginTop:c[3],display:"flex",alignItems:"center",justifyContent:"center",gap:c[2]},children:[t.jsx(pt,{size:16}),"Show Full Timeline (",m.length," events)"]}),r&&m.length>5&&t.jsxs("button",{onClick:()=>i(!1),style:{...me.btnSec,width:"100%",marginTop:c[3],display:"flex",alignItems:"center",justifyContent:"center",gap:c[2]},children:[t.jsx(jn,{size:16}),"Hide Full Timeline"]})]})})]})}const pl=s.memo(fl);function gl({item:e,onUpdateValue:n}){const[a,r]=s.useState(Lt.STRAIGHT_LINE),[i,l]=s.useState(bs[e.category]||5),[m,d]=s.useState(10),[f,h]=s.useState(!1),[u,g]=s.useState(!1),p=e.purchasePrice*m/100,k=s.useMemo(()=>!e.purchasePrice||!e.purchaseDate?null:ys(e.purchasePrice,e.purchaseDate,i,p,a),[e.purchasePrice,e.purchaseDate,i,p,a]);if(!e.purchasePrice||!e.purchaseDate)return t.jsxs(lt,{padding:!1,children:[t.jsx(Zn,{title:"Depreciation",icon:Gn}),t.jsx("div",{style:{padding:c[4],textAlign:"center",color:o.textMuted},children:t.jsx("p",{style:{margin:0,fontSize:b.fontSize.sm},children:"Purchase price and date required to calculate depreciation."})})]});const y={[Lt.STRAIGHT_LINE]:"Straight Line",[Lt.DECLINING_BALANCE]:"Declining Balance (150%)",[Lt.DOUBLE_DECLINING]:"Double Declining (200%)"};return t.jsxs(lt,{padding:!1,children:[t.jsx(Zn,{title:"Depreciation Calculator",icon:Gn,action:t.jsx("button",{onClick:()=>g(!u),style:{background:"none",border:"none",color:o.textMuted,cursor:"pointer",padding:c[1]},children:t.jsx(Ni,{size:16})})}),t.jsxs("div",{style:{padding:c[4]},children:[u&&t.jsxs("div",{style:{background:`${te(o.primary,10)}`,borderRadius:F.md,padding:c[3],marginBottom:c[4],fontSize:b.fontSize.xs,color:o.textSecondary},children:[t.jsx("strong",{style:{color:o.textPrimary},children:"Depreciation Methods:"}),t.jsxs("ul",{style:{margin:`${c[2]}px 0 0 0`,paddingLeft:c[4]},children:[t.jsxs("li",{children:[t.jsx("strong",{children:"Straight Line:"})," Equal depreciation each year"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Declining Balance:"})," 150% of straight-line rate applied to remaining value"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Double Declining:"})," 200% of straight-line rate (accelerated)"]})]})]}),t.jsxs("div",{className:"responsive-three-col",style:{display:"grid",gap:c[3],marginBottom:c[4]},children:[t.jsxs("div",{children:[t.jsx("label",{style:{...me.label,fontSize:b.fontSize.xs},children:"Method"}),t.jsx(qt,{value:a,onChange:x=>r(x.target.value),options:Object.entries(y).map(([x,S])=>({value:x,label:S})),"aria-label":"Depreciation method"})]}),t.jsxs("div",{children:[t.jsx("label",{style:{...me.label,fontSize:b.fontSize.xs},children:"Useful Life (years)"}),t.jsx("input",{type:"number",value:i,onChange:x=>l(Math.max(1,parseInt(x.target.value)||1)),min:"1",max:"30",style:{...me.input,fontSize:b.fontSize.sm,padding:c[2]}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{...me.label,fontSize:b.fontSize.xs},children:"Salvage Value (%)"}),t.jsx("input",{type:"number",value:m,onChange:x=>d(Math.max(0,Math.min(100,parseInt(x.target.value)||0))),min:"0",max:"100",style:{...me.input,fontSize:b.fontSize.sm,padding:c[2]}})]})]}),k&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"responsive-three-col",style:{display:"grid",gap:c[3],marginBottom:c[4],padding:c[3],background:o.bgDark,borderRadius:F.lg},children:[t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted,marginBottom:c[1]},children:"Purchase Price"}),t.jsx("div",{style:{fontSize:b.fontSize.lg,fontWeight:b.fontWeight.bold,color:o.textPrimary},children:Ve(e.purchasePrice)})]}),t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted,marginBottom:c[1]},children:"Calculated Value"}),t.jsx("div",{style:{fontSize:b.fontSize.lg,fontWeight:b.fontWeight.bold,color:o.primary},children:Ve(k.currentValue)})]}),t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted,marginBottom:c[1]},children:"Current Value"}),t.jsx("div",{style:{fontSize:b.fontSize.lg,fontWeight:b.fontWeight.bold,color:o.available},children:Ve(e.currentValue)})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:c[2],marginBottom:c[4]},children:[t.jsxs("div",{style:{padding:c[2],background:`${te(o.danger,10)}`,borderRadius:F.md,textAlign:"center"},children:[t.jsx("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted},children:"Total Depreciation"}),t.jsx("div",{style:{fontSize:b.fontSize.sm,fontWeight:b.fontWeight.semibold,color:o.danger},children:Ve(k.totalDepreciation)})]}),t.jsxs("div",{style:{padding:c[2],background:`${te(o.primary,10)}`,borderRadius:F.md,textAlign:"center"},children:[t.jsx("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted},children:"Annual"}),t.jsx("div",{style:{fontSize:b.fontSize.sm,fontWeight:b.fontWeight.semibold,color:o.primary},children:Ve(k.annualDepreciation)})]}),t.jsxs("div",{style:{padding:c[2],background:`${te(o.accent1,10)}`,borderRadius:F.md,textAlign:"center"},children:[t.jsx("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted},children:"Age"}),t.jsxs("div",{style:{fontSize:b.fontSize.sm,fontWeight:b.fontWeight.semibold,color:o.accent1},children:[k.ageInYears.toFixed(1)," yrs"]})]}),t.jsxs("div",{style:{padding:c[2],background:`${te(o.accent2,10)}`,borderRadius:F.md,textAlign:"center"},children:[t.jsx("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted},children:"% Depreciated"}),t.jsxs("div",{style:{fontSize:b.fontSize.sm,fontWeight:b.fontWeight.semibold,color:o.accent2},children:[k.percentDepreciated.toFixed(1),"%"]})]})]}),t.jsxs("div",{style:{marginBottom:c[4]},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:c[1]},children:[t.jsx("span",{style:{fontSize:b.fontSize.xs,color:o.textMuted},children:"Depreciation Progress"}),t.jsxs("span",{style:{fontSize:b.fontSize.xs,color:o.textMuted},children:["Salvage: ",Ve(p)]})]}),t.jsx("div",{style:{height:8,background:o.borderLight,borderRadius:F.full,overflow:"hidden"},children:t.jsx("div",{style:{height:"100%",width:`${Math.min(k.percentDepreciated,100)}%`,background:`linear-gradient(90deg, ${o.danger}, ${o.accent1})`,borderRadius:F.full,transition:"width 0.3s ease"}})})]}),Math.abs(e.currentValue-k.currentValue)>1&&n&&t.jsxs(Ae,{variant:"secondary",size:"sm",fullWidth:!0,onClick:()=>n(Math.round(k.currentValue)),style:{marginBottom:c[4]},children:["Update Current Value to ",Ve(k.currentValue)]}),t.jsxs("button",{onClick:()=>h(!f),style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:c[2],background:"none",border:`1px solid ${o.borderLight}`,borderRadius:F.md,cursor:"pointer",color:o.textSecondary,fontSize:b.fontSize.sm},children:[t.jsx("span",{children:"Depreciation Schedule"}),f?t.jsx(jn,{size:16}):t.jsx(pt,{size:16})]}),f&&t.jsx("div",{style:{marginTop:c[3],overflowX:"auto"},children:t.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:b.fontSize.xs},children:[t.jsx("thead",{children:t.jsxs("tr",{style:{borderBottom:`1px solid ${o.borderLight}`},children:[t.jsx("th",{style:{padding:c[2],textAlign:"left",color:o.textMuted},children:"Year"}),t.jsx("th",{style:{padding:c[2],textAlign:"right",color:o.textMuted},children:"Start Value"}),t.jsx("th",{style:{padding:c[2],textAlign:"right",color:o.textMuted},children:"Depreciation"}),t.jsx("th",{style:{padding:c[2],textAlign:"right",color:o.textMuted},children:"End Value"}),t.jsx("th",{style:{padding:c[2],textAlign:"right",color:o.textMuted},children:"Accumulated"})]})}),t.jsx("tbody",{children:k.schedule.map((x,S)=>{const j=x.year===Math.ceil(k.ageInYears);return t.jsxs("tr",{style:{borderBottom:`1px solid ${o.borderLight}`,background:j?`${te(o.primary,10)}`:"transparent"},children:[t.jsxs("td",{style:{padding:c[2],color:o.textPrimary},children:[x.year,j&&t.jsx(Le,{text:"Current",color:o.primary,size:"xs",style:{marginLeft:c[1]}})]}),t.jsx("td",{style:{padding:c[2],textAlign:"right",color:o.textSecondary},children:Ve(x.startValue)}),t.jsxs("td",{style:{padding:c[2],textAlign:"right",color:o.danger},children:["-",Ve(x.depreciation)]}),t.jsx("td",{style:{padding:c[2],textAlign:"right",color:o.textPrimary,fontWeight:b.fontWeight.medium},children:Ve(x.endValue)}),t.jsx("td",{style:{padding:c[2],textAlign:"right",color:o.textMuted},children:Ve(x.accumulated)})]},x.year)})})]})})]})]})]})}const hl=s.memo(gl),ot={specs:"var(--sidebar-item1)",reservations:"var(--panel-reservations)",notes:"var(--sidebar-item3)",reminders:"var(--panel-reminders)",maintenance:"var(--sidebar-item5)",depreciation:"var(--sidebar-item6)",timeline:"var(--sidebar-item2)",addToKit:"var(--sidebar-item4)"},Pt=e=>({background:te(e,20),border:`1px solid ${te(e,50)}`,borderRadius:F.md,padding:c[3],marginBottom:c[2]}),bl=s.memo(function({item:n,packages:a,onAddToPackage:r,panelColor:i}){const[l,m]=s.useState(""),d=i&&i.length>0?i:o.primary,f=Pt(d),h=s.useMemo(()=>(a||[]).filter(p=>p.items&&p.items.includes(n.id)),[a,n.id]),u=s.useMemo(()=>(a||[]).filter(p=>!p.items||!p.items.includes(n.id)),[a,n.id]),g=()=>{l&&r&&(r(l,n.id),m(""))};return t.jsxs("div",{style:{padding:c[3]},children:[h.length>0&&t.jsxs("div",{style:{marginBottom:c[3]},children:[t.jsx("div",{style:{fontSize:b.fontSize.sm,color:o.textSecondary,marginBottom:c[2]},children:"This item is included in:"}),h.map(p=>t.jsx("div",{style:f,children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:c[2]},children:[t.jsx(kn,{size:18,color:d}),t.jsxs("div",{style:{flex:1},children:[t.jsx("div",{style:{fontSize:b.fontSize.sm,fontWeight:b.fontWeight.medium,color:o.textPrimary},children:p.name}),t.jsxs("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted},children:[p.id," ‚Ä¢ ",p.items?.length||0," items"]})]})]})},p.id))]}),u.length===0?h.length===0&&t.jsx("div",{style:{textAlign:"center",padding:c[4],color:o.textMuted,fontSize:b.fontSize.sm},children:"No kits or packages available."}):t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:b.fontSize.sm,color:o.textSecondary,marginBottom:c[2]},children:"Add to a kit or package:"}),t.jsxs("div",{style:{display:"flex",gap:c[2],alignItems:"flex-start"},children:[t.jsx(qt,{value:l,onChange:p=>m(p.target.value),options:[{value:"",label:"Select a kit/package..."},...u.map(p=>({value:p.id,label:`${p.name} (${p.items?.length||0} items)`}))],style:{flex:1},"aria-label":"Select kit or package"}),t.jsx(Ae,{onClick:g,disabled:!l,icon:bt,children:"Add"})]})]})]})}),yl=s.memo(function({item:n,inventory:a,onAddAccessory:r,onRemoveAccessory:i,onViewItem:l,panelColor:m}){const[d,f]=s.useState(!1),[h,u]=s.useState(""),[g,p]=s.useState([]),k=m&&m.length>0?m:o.primary,y=Pt(k),x=s.useMemo(()=>n.requiredAccessories?n.requiredAccessories.map(A=>a.find(I=>I.id===A)).filter(Boolean):[],[n.requiredAccessories,a]),S=s.useMemo(()=>{const A=new Set(n.requiredAccessories||[]);return A.add(n.id),a.filter(I=>{if(A.has(I.id)||I.isKit)return!1;if(h){const L=h.toLowerCase();return I.name.toLowerCase().includes(L)||I.id.toLowerCase().includes(L)}return!0})},[a,n.id,n.requiredAccessories,h]),j=A=>{p(I=>I.includes(A)?I.filter(L=>L!==A):[...I,A])},z=()=>{g.length>0&&r&&(r(n.id,g),p([]),f(!1),u(""))};return t.jsxs("div",{style:{padding:c[3]},children:[x.length>0?t.jsx("div",{style:{marginBottom:c[3]},children:x.map(A=>t.jsx("div",{style:y,children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:c[2]},children:[t.jsxs("div",{style:{flex:1,cursor:"pointer"},onClick:()=>l?.(A.id),children:[t.jsx("div",{style:{fontSize:b.fontSize.sm,fontWeight:b.fontWeight.medium,color:o.textPrimary},children:A.name}),t.jsxs("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted},children:[A.id," ‚Ä¢ ",A.category]})]}),t.jsx(Le,{text:A.status,color:Bt(A.status),size:"sm"}),i&&t.jsx("button",{onClick:()=>i(n.id,A.id),style:{background:"none",border:"none",color:o.textMuted,cursor:"pointer",padding:c[1]},children:t.jsx(Cn,{size:14})})]})},A.id))}):t.jsx("p",{style:{color:o.textMuted,textAlign:"center",fontSize:b.fontSize.sm,margin:`0 0 ${c[3]}px`,padding:c[3]},children:"No required accessories defined"}),d?t.jsxs("div",{style:{background:te(k,10),borderRadius:F.md,padding:c[3],border:`1px solid ${te(k,30)}`},children:[t.jsx("div",{style:{marginBottom:c[2]},children:t.jsx("input",{type:"text",value:h,onChange:A=>u(A.target.value),placeholder:"Search items...",style:{...me.input,width:"100%"}})}),t.jsxs("div",{style:{maxHeight:200,overflowY:"auto",marginBottom:c[2]},children:[S.slice(0,50).map(A=>t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:c[2],padding:c[2],cursor:"pointer",borderRadius:F.sm,background:g.includes(A.id)?te(k,20):"transparent"},children:[t.jsx("input",{type:"checkbox",checked:g.includes(A.id),onChange:()=>j(A.id)}),t.jsxs("div",{style:{flex:1},children:[t.jsx("div",{style:{fontSize:b.fontSize.sm,color:o.textPrimary},children:A.name}),t.jsx("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted},children:A.id})]})]},A.id)),S.length===0&&t.jsx("p",{style:{color:o.textMuted,textAlign:"center",padding:c[2]},children:"No items found"})]}),t.jsxs("div",{style:{display:"flex",gap:c[2],justifyContent:"flex-end"},children:[t.jsx(Ae,{variant:"secondary",onClick:()=>{f(!1),p([]),u("")},children:"Cancel"}),t.jsxs(Ae,{onClick:z,disabled:g.length===0,icon:bt,children:["Add (",g.length,")"]})]})]}):t.jsx(Ae,{variant:"secondary",onClick:()=>f(!0),icon:bt,fullWidth:!0,children:"Add Required Accessory"})]})});function xl({item:e,inventory:n,packages:a,specs:r,categorySettings:i,layoutPrefs:l,onBack:m,backLabel:d="Back to Gear List",onCheckout:f,onCheckin:h,onEdit:u,onDelete:g,onShowQR:p,onAddReservation:k,onDeleteReservation:y,onAddNote:x,onReplyNote:S,onDeleteNote:j,onSelectImage:z,onViewReservation:A,onAddReminder:I,onCompleteReminder:L,onUncompleteReminder:R,onDeleteReminder:D,onAddMaintenance:_,onUpdateMaintenance:T,onCompleteMaintenance:w,onUpdateValue:v,onAddAccessory:O,onRemoveAccessory:$,onSetAsKit:K,onAddToKit:Y,onAddToPackage:J,onRemoveFromKit:ie,onClearKit:_e,onViewItem:ve,onCustomizeLayout:B,onToggleCollapse:G,user:q}){const{canEdit:Q}=cn(),Z=Q("item_details"),[W,le]=s.useState(!1),H=e?.status==="checked-out",se=e?r[e.category]||[]:[],ae=e&&i?.[e.category]||{trackQuantity:!1,trackSerialNumbers:!0},[V,pe]=s.useState(()=>{const de={};return Object.values(ga).forEach(ce=>{de[ce.id]=l?.sections?.[ce.id]?.collapsed||!1}),de});s.useEffect(()=>{l?.sections&&pe(de=>{const ce={...de};return Object.keys(l.sections).forEach(Ie=>{l.sections[Ie]?.collapsed!==void 0&&(ce[Ie]=l.sections[Ie].collapsed)}),ce})},[l]);const ge=de=>{const ce=Object.values(ga).find(Xe=>Xe.id===de),Ie=l?.sections?.[de];return{visible:Ie?.visible!==!1,order:Ie?.order??ce?.order??99}},be=de=>V[de]||!1,ke=de=>{pe(ce=>({...ce,[de]:!ce[de]})),G&&G("itemDetail",de)},re=s.useMemo(()=>{if(!e)return[];const de=[{name:"Location",value:e.location||"-"},{name:"Serial Number",value:e.serialNumber||"-"}];ae.trackQuantity&&de.push({name:"Quantity",value:e.quantity??1},{name:"Reorder Point",value:e.reorderPoint??0});const ce=se.map(Ie=>({name:Ie.name,value:e.specs?.[Ie.name]||"-"}));return[...de,...ce]},[e,se,ae]),Se=s.useMemo(()=>["specifications","reservations","notes","reminders","addToKit","maintenance","timeline","checkoutHistory","value","depreciation"].filter(ce=>ge(ce).visible).map(ce=>({id:ce,order:ge(ce).order})).sort((ce,Ie)=>ce.order-Ie.order).map(ce=>ce.id),[l]);if(!e)return null;const Te=de=>{switch(de){case"specifications":return t.jsxs(Fe,{title:"Specifications",icon:ma,headerColor:ot.specs,collapsed:be("specifications"),onToggleCollapse:()=>ke("specifications"),children:[t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:c[3]},children:(W?re:re.slice(0,10)).map(Ce=>t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:b.fontSize.xs,color:o.textMuted,textTransform:"uppercase",marginBottom:c[1]},children:Ce.name}),t.jsx("div",{style:{color:o.textPrimary,fontSize:b.fontSize.sm},children:Ce.value})]},Ce.name))}),re.length>10&&t.jsxs("button",{onClick:()=>le(!W),style:{...me.btnSec,width:"100%",marginTop:c[3],display:"flex",alignItems:"center",justifyContent:"center",gap:c[2]},children:[W?t.jsx(jn,{size:16}):t.jsx(pt,{size:16}),W?"Hide Full Specs":"Show Full Specs"]})]},"specifications");case"reservations":const ce=ot.reservations;return t.jsx(Fe,{title:"Reservations",icon:jt,badge:e.reservations?.length||0,badgeColor:ce,headerColor:ce,collapsed:be("reservations"),onToggleCollapse:()=>ke("reservations"),action:Z&&t.jsx("button",{onClick:k,style:{...me.btn,padding:`${c[1]}px ${c[2]}px`,fontSize:b.fontSize.xs},children:t.jsx(bt,{size:12})}),children:t.jsx("div",{style:{maxHeight:220,overflowY:"auto"},children:!e.reservations||e.reservations.length===0?t.jsx("p",{style:{color:o.textMuted,textAlign:"center",fontSize:b.fontSize.sm,margin:0,padding:c[3]},children:"No reservations"}):e.reservations.map(Ce=>t.jsx("div",{onClick:()=>A?.(Ce),style:{...Pt(ce),cursor:"pointer"},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:b.fontSize.sm,fontWeight:b.fontWeight.medium,color:o.textPrimary},children:Ce.project}),t.jsxs("div",{style:{fontSize:b.fontSize.xs,color:o.primary},children:[He(Ce.start)," ‚Üí ",He(Ce.end)]})]}),Z&&t.jsx("button",{onClick:rt=>{rt.stopPropagation(),y(e.id,Ce.id)},style:{background:"none",border:"none",color:o.textMuted,cursor:"pointer",padding:c[1]},children:t.jsx(Cn,{size:14})})]})},Ce.id))})},"reservations");case"notes":const Ie=ot.notes;return t.jsx(Fe,{title:"Notes",icon:_r,badge:(e.notes||[]).length,badgeColor:Ie,headerColor:Ie,collapsed:be("notes"),onToggleCollapse:()=>ke("notes"),padding:!1,children:t.jsx(Qo,{notes:e.notes||[],onAddNote:x,onReply:S,onDelete:j,user:q,panelColor:Ie})},"notes");case"reminders":const Xe=ot.reminders;return t.jsx(Fe,{title:"Reminders",icon:$t,badge:(e.reminders||[]).length,badgeColor:Xe,headerColor:Xe,collapsed:be("reminders"),onToggleCollapse:()=>ke("reminders"),padding:!1,children:t.jsx(il,{reminders:e.reminders||[],onAddReminder:I,onCompleteReminder:L,onUncompleteReminder:R,onDeleteReminder:D,panelColor:Xe})},"reminders");case"requiredAccessories":const et=ot.addToKit;return t.jsx(Fe,{title:"Required Accessories",icon:ma,badge:(e.requiredAccessories||[]).length,badgeColor:et,headerColor:et,collapsed:be("requiredAccessories"),onToggleCollapse:()=>ke("requiredAccessories"),padding:!1,children:t.jsx(yl,{item:e,inventory:n,onAddAccessory:O,onRemoveAccessory:$,onViewItem:ve,panelColor:et})},"requiredAccessories");case"packages":const tt=ot.addToKit,nt=(a||[]).filter(Ce=>Ce.items&&Ce.items.includes(e.id)).length;return t.jsx(Fe,{title:"Packages",icon:kn,badge:nt,badgeColor:tt,headerColor:tt,collapsed:be("packages"),onToggleCollapse:()=>ke("packages"),padding:!1,children:t.jsx(bl,{item:e,packages:a,onAddToPackage:J,panelColor:tt})},"packages");case"maintenance":const at=ot.maintenance;return t.jsx(Fe,{title:"Maintenance",icon:bn,badge:(e.maintenanceHistory||[]).length,badgeColor:at,headerColor:at,collapsed:be("maintenance"),onToggleCollapse:()=>ke("maintenance"),padding:!1,children:t.jsx(ul,{maintenanceHistory:e.maintenanceHistory||[],onAddMaintenance:_,onUpdateMaintenance:T,onCompleteMaintenance:w,panelColor:at})},"maintenance");case"timeline":return t.jsx(Fe,{title:"Item Timeline",icon:qi,headerColor:ot.timeline,collapsed:be("timeline"),onToggleCollapse:()=>ke("timeline"),padding:!1,children:t.jsx(pl,{item:e})},"timeline");case"checkoutHistory":if(!e.checkoutHistory||e.checkoutHistory.length===0)return null;const Oe=ot.timeline;return t.jsx(Fe,{title:"Checkout History",icon:ln,badge:e.checkoutHistory.length,badgeColor:Oe,headerColor:Oe,collapsed:be("checkoutHistory"),onToggleCollapse:()=>ke("checkoutHistory"),children:t.jsx("div",{style:{maxHeight:220,overflowY:"auto"},children:[...e.checkoutHistory].reverse().slice(0,8).map((Ce,rt)=>t.jsxs("div",{style:Pt(Oe),children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:c[1]},children:[t.jsx(Le,{text:Ce.type==="checkout"?"Out":"In",color:Ce.type==="checkout"?o.checkedOut:o.available,size:"xs"}),t.jsx("span",{style:{fontSize:b.fontSize.xs,color:o.textMuted},children:Ce.type==="checkout"?Ce.checkedOutDate:Ce.returnDate})]}),t.jsx("div",{style:{fontSize:b.fontSize.sm,color:o.textPrimary},children:Ce.type==="checkout"?Ce.borrowerName:`Returned by ${Ce.returnedBy}`})]},Ce.id||rt))})},"checkoutHistory");case"value":const Ue=ot.depreciation;return t.jsx(Fe,{title:"Value & Purchase",icon:va,badge:Ve(e.currentValue),badgeColor:Ue,headerColor:Ue,collapsed:be("value"),onToggleCollapse:()=>ke("value"),children:t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:c[2]},children:[t.jsx("div",{style:Pt(Ue),children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:o.textSecondary,fontSize:b.fontSize.sm},children:"Purchase Price"}),t.jsx("span",{style:{color:o.textPrimary,fontSize:b.fontSize.sm},children:Ve(e.purchasePrice)})]})}),t.jsx("div",{style:Pt(Ue),children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:o.textSecondary,fontSize:b.fontSize.sm},children:"Current Value"}),t.jsx("span",{style:{color:o.available,fontWeight:b.fontWeight.semibold,fontSize:b.fontSize.sm},children:Ve(e.currentValue)})]})}),t.jsx("div",{style:Pt(Ue),children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:o.textSecondary,fontSize:b.fontSize.sm},children:"Purchase Date"}),t.jsx("span",{style:{color:o.textPrimary,fontSize:b.fontSize.sm},children:He(e.purchaseDate)})]})})]})},"value");case"depreciation":return t.jsx(Fe,{title:"Depreciation",headerColor:ot.depreciation,collapsed:be("depreciation"),onToggleCollapse:()=>ke("depreciation"),padding:!1,children:t.jsx(hl,{item:e,onUpdateValue:v})},"depreciation");default:return null}},$e=Se.filter((de,ce)=>ce%2===0),xe=Se.filter((de,ce)=>ce%2===1);return t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:c[5]},children:[t.jsx(La,{onClick:m,children:d}),B&&t.jsx(Ae,{variant:"secondary",size:"sm",onClick:B,icon:Cr,children:"Customize"})]}),t.jsx(lt,{padding:!1,style:{marginBottom:c[5],overflow:"hidden"},children:t.jsxs("div",{className:"item-detail-header",style:{display:"flex",minHeight:280},children:[t.jsx("div",{className:"item-detail-image",onClick:z,style:{width:320,minWidth:320,background:`${te(o.primary,10)}`,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:e.image?t.jsx(En,{src:e.image,alt:e.name,size:"full",style:{width:"100%",height:"100%"},objectFit:"cover",lazy:!1}):t.jsxs(t.Fragment,{children:[t.jsx(wr,{size:48,color:o.textMuted}),t.jsx("span",{style:{color:o.textMuted,fontSize:b.fontSize.sm,marginTop:c[2]},children:"Click to add image"})]})}),t.jsxs("div",{className:"item-detail-info",style:{flex:1,padding:c[6],display:"flex",flexDirection:"column",justifyContent:"center"},children:[t.jsxs("div",{style:{display:"flex",gap:c[2],marginBottom:c[4],flexWrap:"wrap"},children:[t.jsx(Le,{text:e.id,color:o.primary}),t.jsx(Le,{text:e.status,color:Bt(e.status)}),t.jsx(Le,{text:e.condition,color:ds(e.condition)}),t.jsx(Le,{text:e.category,color:o.accent2})]}),t.jsx("h1",{style:{margin:`0 0 ${c[2]}px`,fontSize:b.fontSize["3xl"],color:o.textPrimary},children:e.name}),t.jsx("p",{style:{color:o.textSecondary,margin:`0 0 ${c[5]}px`,fontSize:b.fontSize.lg},children:e.brand}),t.jsxs("div",{style:{display:"flex",gap:c[3],flexWrap:"wrap"},children:[Z&&(H?t.jsx(Ae,{onClick:()=>h(e.id),icon:ka,children:"Check In"}):t.jsx(Ae,{onClick:()=>f(e.id),icon:vn,children:"Check Out"})),Z&&t.jsx(Ae,{variant:"secondary",onClick:()=>u(e),icon:Oi,children:"Edit"}),t.jsx(Ae,{variant:"secondary",onClick:p,icon:Sr,children:"QR Code"})]}),!Z&&t.jsx("div",{style:{marginTop:c[4],padding:c[3],background:`${te(o.primary,10)}`,borderRadius:F.md,fontSize:b.fontSize.sm,color:o.primary},children:"You have view-only access to this item."}),H&&e.checkedOutTo&&t.jsxs("div",{style:{marginTop:c[4],padding:c[3],background:`${te(o.checkedOut,15)}`,borderRadius:F.md,fontSize:b.fontSize.sm},children:[t.jsx("span",{style:{color:o.textMuted},children:"Checked out to "}),t.jsx("span",{style:{color:o.textPrimary,fontWeight:b.fontWeight.medium},children:e.checkedOutTo}),t.jsxs("span",{style:{color:o.textMuted},children:[" on ",He(e.checkedOutDate)]}),e.dueBack&&t.jsxs(t.Fragment,{children:[t.jsx("span",{style:{color:o.textMuted},children:" ‚Ä¢ Due "}),t.jsx("span",{style:{color:o.danger},children:He(e.dueBack)})]})]})]})]})}),t.jsxs("div",{className:"responsive-two-col",style:{display:"grid",gap:c[5]},children:[t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:c[4]},children:$e.map(de=>Te(de))}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:c[4]},children:xe.map(de=>Te(de))})]})]})}const Sl=s.memo(xl),ya=s.memo(function({label:n,options:a=[],selectedValues:r=[],onChange:i,placeholder:l="Select...",renderOption:m,className:d="",style:f={}}){const[h,u]=s.useState(!1),[g,p]=s.useState({top:0,left:0,width:0}),k=s.useRef(null),y=s.useRef(null),x=s.useCallback(()=>{if(!k.current)return;const L=k.current.getBoundingClientRect(),R=window.innerHeight-L.bottom,D=Math.min(a.length*40+8,280),_=R<D?"up":"down";p({top:_==="down"?L.bottom+4:L.top-D-4,left:L.left,width:L.width})},[a.length]);s.useEffect(()=>{if(!h)return;const L=D=>{if(k.current&&!k.current.contains(D.target)){if(y.current&&y.current.contains(D.target))return;u(!1)}},R=D=>{D.key==="Escape"&&u(!1)};return document.addEventListener("mousedown",L),document.addEventListener("keydown",R),()=>{document.removeEventListener("mousedown",L),document.removeEventListener("keydown",R)}},[h]),s.useEffect(()=>{if(h){x();const L=()=>x();return window.addEventListener("scroll",L,!0),window.addEventListener("resize",L),()=>{window.removeEventListener("scroll",L,!0),window.removeEventListener("resize",L)}}},[h,x]);const S=s.useCallback(L=>{r.includes(L)?i(r.filter(R=>R!==L)):i([...r,L])},[r,i]),j=s.useCallback(L=>{L.stopPropagation(),i([])},[i]),z=r.length===0?l:r.length===1?a.find(L=>L.value===r[0])?.label||r[0]:`${r.length} selected`,A={container:{position:"relative",...f},trigger:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:c[2],width:"100%",padding:"12px 16px",paddingRight:40,background:"var(--input-bg, rgba(106, 154, 184, 0.1))",border:`1px solid ${o.border}`,borderRadius:F.lg,color:r.length>0?o.textPrimary:o.textMuted,fontSize:b.fontSize.base,fontFamily:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',cursor:"pointer",textAlign:"left",position:"relative",boxSizing:"border-box",transition:"border-color 150ms ease, box-shadow 150ms ease",outline:"none"},triggerOpen:{borderColor:o.primary,boxShadow:`0 0 0 2px color-mix(in srgb, ${o.primary} 20%, transparent)`},triggerContent:{display:"flex",alignItems:"center",gap:c[2],flex:1,overflow:"hidden"},clearButton:{display:"flex",alignItems:"center",justifyContent:"center",padding:c[1],background:"transparent",border:"none",borderRadius:F.sm,color:o.textMuted,cursor:"pointer",transition:"color 150ms ease",position:"absolute",right:36,top:"50%",transform:"translateY(-50%)",zIndex:1},chevronWrapper:{position:"absolute",right:12,top:"50%",transform:`translateY(-50%) ${h?"rotate(180deg)":"rotate(0deg)"}`,transition:"transform 150ms ease",pointerEvents:"none",color:o.textMuted},dropdown:{position:"fixed",top:g.top,left:g.left,width:g.width,padding:4,background:o.bgMedium,border:`1px solid ${o.border}`,borderRadius:F.lg,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",maxHeight:"280px",overflowY:"auto",zIndex:99999,fontFamily:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},option:{display:"flex",alignItems:"center",gap:c[2],padding:`${c[2]}px ${c[3]}px`,borderRadius:F.md,cursor:"pointer",transition:"background 150ms ease",color:o.textPrimary,fontSize:b.fontSize.sm},checkbox:{width:"18px",height:"18px",borderRadius:F.sm,border:`2px solid ${o.border}`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,transition:"all 150ms ease",background:"transparent"},checkboxChecked:{background:o.primary,borderColor:o.primary},label:{display:"block",marginBottom:c[1],fontSize:b.fontSize.sm,fontWeight:b.fontWeight.medium,color:o.textSecondary}},I=h&&di.createPortal(t.jsx("div",{ref:y,style:A.dropdown,children:a.map(L=>{const R=r.includes(L.value);return t.jsxs("div",{onClick:()=>S(L.value),style:A.option,onMouseEnter:D=>D.currentTarget.style.background=`color-mix(in srgb, ${o.primary} 15%, transparent)`,onMouseLeave:D=>D.currentTarget.style.background="transparent",children:[t.jsx("div",{style:{...A.checkbox,...R?A.checkboxChecked:{}},children:R&&t.jsx(wa,{size:12,color:"#fff"})}),m?m(L):t.jsx("span",{children:L.label})]},L.value)})}),document.body);return t.jsxs("div",{ref:k,style:A.container,className:d,children:[n&&t.jsx("label",{style:A.label,children:n}),t.jsxs("button",{type:"button",onClick:()=>u(L=>!L),style:{...A.trigger,...h?A.triggerOpen:{}},children:[t.jsx("span",{style:A.triggerContent,children:z}),r.length>0&&t.jsx("button",{type:"button",style:A.clearButton,onClick:j,onMouseEnter:L=>L.currentTarget.style.color=o.danger,onMouseLeave:L=>L.currentTarget.style.color=o.textMuted,"aria-label":"Clear selection",children:t.jsx(wn,{size:14})}),t.jsx("span",{style:A.chevronWrapper,children:t.jsx(pt,{size:16})})]}),I]})});ya.propTypes={label:E.string,options:E.arrayOf(E.shape({value:E.string.isRequired,label:E.string.isRequired})).isRequired,selectedValues:E.arrayOf(E.string),onChange:E.func.isRequired,placeholder:E.string,renderOption:E.func,className:E.string,style:E.object};const kl=Object.values(Me);function vl({inventory:e,categories:n,searchQuery:a,setSearchQuery:r,selectedCategories:i,setSelectedCategories:l,selectedStatuses:m,setSelectedStatuses:d,onViewItem:f}){const h=s.useMemo(()=>{let x=e;if(a.trim()){const S=a.toLowerCase();x=x.filter(j=>j.name.toLowerCase().includes(S)||j.brand.toLowerCase().includes(S)||j.id.toLowerCase().includes(S))}return i.length>0&&(x=x.filter(S=>i.includes(S.category))),m.length>0&&(x=x.filter(S=>m.includes(S.status))),x},[e,a,i,m]),u=s.useCallback(()=>{r(""),l([]),d([])},[r,l,d]),g=a.trim()||i.length>0||m.length>0,p=s.useMemo(()=>n.map(x=>({value:x,label:x})),[n]),k=s.useMemo(()=>kl.map(x=>({value:x,label:x})),[]),y=s.useCallback(x=>t.jsx(Le,{text:x.label,color:Bt(x.value),size:"sm"}),[]);return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"page-header",children:t.jsx("h2",{className:"page-title",children:"Search"})}),t.jsxs(lt,{style:{marginBottom:c[4],padding:c[3]},children:[t.jsxs("div",{style:{display:"flex",gap:c[3],alignItems:"flex-end",flexWrap:"wrap"},children:[t.jsxs("div",{style:{flex:"1 1 250px",minWidth:"200px"},children:[t.jsx("label",{style:{display:"block",marginBottom:c[1],fontSize:b.fontSize.sm,fontWeight:b.fontWeight.medium,color:o.textSecondary},children:"Search"}),t.jsx(ea,{value:a,onChange:r,onClear:()=>r(""),placeholder:"Search by name, brand, or ID..."})]}),t.jsx("div",{style:{flex:"0 1 200px",minWidth:"160px"},children:t.jsx(ya,{label:"Categories",options:p,selectedValues:i,onChange:l,placeholder:"All categories"})}),t.jsx("div",{style:{flex:"0 1 200px",minWidth:"160px"},children:t.jsx(ya,{label:"Status",options:k,selectedValues:m,onChange:d,placeholder:"All statuses",renderOption:y})}),g&&t.jsx(Ae,{variant:"secondary",onClick:u,icon:wn,style:{flexShrink:0},children:"Clear"})]}),g&&t.jsxs("div",{style:{marginTop:c[3],paddingTop:c[3],borderTop:`1px solid ${o.borderLight}`,display:"flex",alignItems:"center",gap:c[2],flexWrap:"wrap"},children:[t.jsx($i,{size:14,color:o.textMuted}),t.jsxs("span",{style:{fontSize:b.fontSize.sm,color:o.textMuted},children:["Showing ",h.length," of ",e.length," items"]}),i.length>0&&t.jsx(Le,{text:`${i.length} categor${i.length>1?"ies":"y"}`,color:o.accent2,size:"sm"}),m.length>0&&t.jsx(Le,{text:`${m.length} status${m.length>1?"es":""}`,color:o.primary,size:"sm"})]})]}),t.jsxs("div",{style:{marginBottom:c[3],color:o.textMuted,fontSize:b.fontSize.sm},children:[h.length," results"]}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:c[2]},children:h.map(x=>t.jsxs(lt,{style:{padding:c[3],display:"flex",alignItems:"center",gap:c[3]},children:[t.jsxs("div",{onClick:()=>f(x.id),style:{flex:1,display:"flex",alignItems:"center",gap:c[3],cursor:"pointer"},children:[x.image?t.jsx(En,{src:x.image,alt:x.name,size:"thumbnail",width:48,height:48,style:{borderRadius:F.md},objectFit:"cover"}):t.jsx("div",{style:{width:48,height:48,borderRadius:F.md,background:`${te(o.primary,10)}`,display:"flex",alignItems:"center",justifyContent:"center",color:o.textMuted,fontSize:b.fontSize.xs},children:"No img"}),t.jsxs("div",{style:{flex:1},children:[t.jsxs("div",{style:{display:"flex",gap:c[1],marginBottom:c[1],flexWrap:"wrap"},children:[t.jsx(Le,{text:x.id,color:o.primary}),t.jsx(Le,{text:x.status,color:Bt(x.status)}),t.jsx(Le,{text:x.category,color:o.accent2})]}),t.jsx("div",{style:{fontWeight:b.fontWeight.medium,color:o.textPrimary},children:x.name}),t.jsx("div",{style:{fontSize:b.fontSize.sm,color:o.textMuted},children:x.brand})]})]}),t.jsx("button",{onClick:()=>f(x.id),className:"btn-secondary",style:{padding:c[2]},children:t.jsx(Bi,{size:16})})]},x.id))}),h.length===0&&t.jsxs(lt,{style:{textAlign:"center",padding:c[10]},children:[t.jsx(xa,{size:48,color:o.textMuted,style:{marginBottom:c[3],opacity:.5}}),t.jsx("div",{style:{color:o.textMuted},children:"No items found matching your filters"}),g&&t.jsx(Ae,{variant:"secondary",onClick:u,style:{marginTop:c[3]},children:"Clear Filters"})]})]})}const wl=s.memo(vl),Cl=s.lazy(()=>fe(()=>import("./LabelsView-Cz14xMMv.js"),__vite__mapDeps([0,1,2,3]))),jl=s.lazy(()=>fe(()=>import("./PackagesView-BRk7n8Z8.js"),__vite__mapDeps([4,1,3]))),_l=s.lazy(()=>fe(()=>import("./PackListsView-B3Ih28WR.js"),__vite__mapDeps([5,1,2,3]))),Il=s.lazy(()=>fe(()=>import("./ReservationDetail-DiiY3UzJ.js"),__vite__mapDeps([6,1,3]))),El=s.lazy(()=>fe(()=>import("./ScheduleView-Czwqz1UJ.js"),__vite__mapDeps([7,1,3]))),Dl=s.lazy(()=>fe(()=>import("./NotificationSettings-BJh_EgPE.js"),__vite__mapDeps([8,1,3]))),Al=s.lazy(()=>fe(()=>import("./LocationsManager-BzGn_lVG.js"),__vite__mapDeps([9,1,3]))),br=s.lazy(()=>fe(()=>import("./LayoutCustomize-BItJdhTS.js"),__vite__mapDeps([10,1,3]))),Tl=s.lazy(()=>fe(()=>import("./ThemeSelector-8fyjr44D.js"),__vite__mapDeps([11,1,3]))),Rl=s.lazy(()=>fe(()=>import("./ClientsView-DulEZl16.js"),__vite__mapDeps([12,1,3]))),Pl=s.lazy(()=>fe(()=>import("./RolesManager-Bqof7tHo.js"),__vite__mapDeps([13,1,3]))),Ll=s.lazy(()=>fe(()=>import("./ChangeLog-CQKx-PXE.js"),__vite__mapDeps([14,1,3]))),Ml=s.lazy(()=>fe(()=>import("./AdminView-_onm691P.js"),__vite__mapDeps([15,1,3])).then(e=>({default:e.AdminPanel}))),zl=s.lazy(()=>fe(()=>import("./UsersView-NzhLSkPx.js"),__vite__mapDeps([16,1,3])).then(e=>({default:e.UsersPanel}))),Nl=s.lazy(()=>fe(()=>import("./ReportsView-CKIaqg8P.js"),__vite__mapDeps([17,1,3])).then(e=>({default:e.ReportsPanel}))),Ol=s.lazy(()=>fe(()=>import("./AuditLogView-CraJbfHF.js"),__vite__mapDeps([18,1,3])).then(e=>({default:e.AuditLogPanel}))),ql=s.lazy(()=>fe(()=>import("./MaintenanceReportView-BpFqvc3d.js"),__vite__mapDeps([19,1,3])).then(e=>({default:e.MaintenanceReportPanel}))),$l=s.lazy(()=>fe(()=>import("./InsuranceReportView-DRNxvyjS.js"),__vite__mapDeps([20,1,3])).then(e=>({default:e.InsuranceReportPanel}))),Bl=s.lazy(()=>fe(()=>import("./AdminPages-C-YnZlb3.js"),__vite__mapDeps([21,1,22,23,24,3])).then(e=>({default:e.ItemFormPage}))),Vl=s.lazy(()=>fe(()=>import("./AdminPages-C-YnZlb3.js"),__vite__mapDeps([21,1,22,23,24,3])).then(e=>({default:e.SpecsPage}))),Wl=s.lazy(()=>fe(()=>import("./AdminPages-C-YnZlb3.js"),__vite__mapDeps([21,1,22,23,24,3])).then(e=>({default:e.CategoriesPage})));function Fl({handlers:e,currentUser:n,categorySettings:a,changeLog:r}){const{currentView:i,setCurrentView:l,selectedItem:m,setSelectedItem:d,selectedPackage:f,setSelectedPackage:h,selectedPackList:u,setSelectedPackList:g,selectedReservation:p,setSelectedReservation:k,selectedReservationItem:y,itemBackContext:x,setItemBackContext:S}=Ma(),{searchQuery:j,setSearchQuery:z,categoryFilter:A,setCategoryFilter:I,statusFilter:L,setStatusFilter:R,selectedCategories:D,setSelectedCategories:_,selectedStatuses:T,setSelectedStatuses:w,isGridView:v,setIsGridView:O,scheduleView:$,setScheduleView:K,scheduleMode:Y,setScheduleMode:J,scheduleDate:ie,setScheduleDate:_e,selectedIds:ve,setSelectedIds:B}=ri(),{editingItemId:G,editingReservationId:q,setEditingReservationId:Q,itemForm:Z,setItemForm:W,reservationForm:le,setReservationForm:H,showConfirm:se}=za(),{inventory:ae,setInventory:V,packages:pe,setPackages:ge,users:be,setUsers:ke,roles:re,setRoles:Se,specs:Te,setSpecs:$e,locations:xe,setLocations:de,categories:ce,setCategories:Ie,auditLog:Xe,clients:et,setClients:tt,packLists:nt,setPackLists:at}=In(),{navigateToItem:Oe,navigateToReservation:Ue,navigateToFilteredSearch:Ce,navigateToAlerts:rt,navigateToOverdue:_t,navigateToLowStock:It,navigateToReservations:N,handleToggleCollapse:C,handleSaveLayoutPrefs:P,createItem:ue,deleteItem:Re,openEditItem:Ke,handleBulkAction:qe,openCheckoutModal:it,openCheckinModal:Et,openMaintenanceModal:Wt,openMaintenanceEditModal:Ft,itemNoteHandlers:ct,clientNoteHandlers:dt,reservationNoteHandlers:Ht,addReminder:Dn,completeReminder:Ut,uncompleteReminder:st,deleteReminder:An,openEditReservation:Tn,deleteReservation:Dt,saveReservation:dn,setItemAsKit:Rn,addItemsToKit:Pn,removeItemFromKit:Ln,clearKitItems:Mn,addRequiredAccessories:zn,removeRequiredAccessory:Gt,selectImage:ta,addItemToPackage:Nn,updateMaintenanceStatus:On,updateUserProfile:na,addAuditLog:Kt,setCategorySettings:qn,resetItemForm:$n,resetReservationForm:un,openModal:ut,closeModal:mn}=e;return t.jsxs("div",{style:{flex:1,minHeight:0},children:[i===M.DASHBOARD&&t.jsx(Lo,{inventory:ae,categorySettings:a,layoutPrefs:n?.layoutPrefs?.dashboard,onViewItem:Oe,onViewReservation:Ue,onFilteredView:Ce,onViewAlerts:rt,onViewOverdue:_t,onViewLowStock:It,onViewReservations:N,onCustomizeLayout:()=>l(M.CUSTOMIZE_DASHBOARD),onToggleCollapse:C}),i===M.GEAR_LIST&&t.jsx(Go,{inventory:ae,categories:ce,categorySettings:a,searchQuery:j,setSearchQuery:z,categoryFilter:A,setCategoryFilter:I,statusFilter:L,setStatusFilter:R,isGridView:v,setIsGridView:O,onViewItem:Oe,onAddItem:()=>{$n(),l(M.ADD_ITEM)},onBulkAction:qe}),i===M.GEAR_DETAIL&&m&&t.jsx(Sl,{item:m,inventory:ae,packages:pe,specs:Te,categorySettings:a,layoutPrefs:n?.layoutPrefs?.itemDetail,onBack:()=>{if(x?.returnTo==="package"&&x.packageId){const he=pe.find(De=>De.id===x.packageId);he&&(h(he),l(M.PACKAGES))}else if(x?.returnTo==="packList"&&x.packListId){const he=nt.find(De=>De.id===x.packListId);he&&(g(he),l(M.PACK_LISTS))}else l(M.GEAR_LIST);S(null)},backLabel:x?.backLabel||"Back to Gear List",onCheckout:it,onCheckin:Et,onEdit:Ke,onDelete:Re,onShowQR:()=>ut(ne.QR_CODE),onAddReservation:()=>{un(),Q(null),ut(ne.ADD_RESERVATION)},onDeleteReservation:Dt,onAddNote:ct.add,onReplyNote:ct.reply,onDeleteNote:ct.delete,onAddReminder:Dn,onCompleteReminder:Ut,onUncompleteReminder:st,onDeleteReminder:An,onAddMaintenance:Wt,onUpdateMaintenance:Ft,onCompleteMaintenance:On,onUpdateValue:he=>{V(De=>De.map(Pe=>Pe.id===m.id?{...Pe,currentValue:he}:Pe)),d(De=>({...De,currentValue:he}))},onSetAsKit:Rn,onAddToKit:Pn,onAddToPackage:Nn,onRemoveFromKit:Ln,onClearKit:Mn,onAddAccessory:zn,onRemoveAccessory:Gt,onViewItem:Oe,onSelectImage:()=>m?.image?ut(ne.IMAGE_PREVIEW):ut(ne.IMAGE_SELECT),onViewReservation:he=>Ue(he,m),onCustomizeLayout:()=>l(M.CUSTOMIZE_ITEM_DETAIL),onToggleCollapse:C,user:n}),i===M.PACKAGES&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Packages..."}),children:t.jsx(jl,{packages:pe,setPackages:ge,inventory:ae,onViewItem:Oe,initialSelectedPackage:f,onPackageSelect:h})}),i===M.PACK_LISTS&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Pack Lists..."}),children:t.jsx(_l,{packLists:nt,setPackLists:at,inventory:ae,packages:pe,categorySettings:a,onViewItem:Oe,addAuditLog:Kt,currentUser:n,initialSelectedList:u,onListSelect:g})}),i===M.SCHEDULE&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Schedule..."}),children:t.jsx(El,{inventory:ae,scheduleView:$,setScheduleView:K,scheduleDate:ie,setScheduleDate:_e,scheduleMode:Y,setScheduleMode:J,onViewItem:Oe,onViewReservation:Ue,onAddReservation:()=>{un(),Q(null),ut(ne.ADD_RESERVATION)}})}),i===M.SEARCH&&t.jsx(wl,{inventory:ae,categories:ce,searchQuery:j,setSearchQuery:z,selectedCategories:D,setSelectedCategories:_,selectedStatuses:T,setSelectedStatuses:w,onViewItem:Oe}),i===M.LABELS&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Labels..."}),children:t.jsx(Cl,{inventory:ae,packages:pe,user:n})}),i===M.CLIENTS&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Clients..."}),children:t.jsx(Rl,{clients:et,inventory:ae,onUpdateClients:tt,onViewReservation:Ue,onAddNote:dt.add,onReplyNote:dt.reply,onDeleteNote:dt.delete,user:n,addAuditLog:Kt})}),i===M.RESERVATION_DETAIL&&p&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Reservation..."}),children:t.jsx(Il,{reservation:p,item:y,onBack:()=>l(m?M.GEAR_DETAIL:M.SCHEDULE),onEdit:()=>Tn(p),onDelete:()=>{const he=y?.id||m?.id||p?.itemId,De=p?.id;he&&De?Dt(he,De):(X("Cannot delete: missing item or reservation ID",{itemId:he,resId:De}),alert("Unable to cancel reservation ‚Äî missing reference. Please go back and try again."))},onAddNote:Ht.add,onReplyNote:Ht.reply,onDeleteNote:Ht.delete,user:n,onViewItem:Oe})}),t.jsx(Je,{permission:"admin_users",children:i===M.ADMIN&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Admin Panel..."}),children:t.jsx(Ml,{setCurrentView:l})})}),t.jsx(Je,{permission:"gear_list",requireEdit:!0,children:i===M.ADD_ITEM&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Item Form..."}),children:t.jsx(Bl,{isEdit:!1,itemForm:Z,setItemForm:W,specs:Te,categories:ce,categorySettings:a,locations:xe,inventory:ae,onSave:ue,onBack:()=>l(M.GEAR_LIST)})})}),t.jsx(Je,{permission:"admin_specs",children:i===M.EDIT_SPECS&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Specs Editor..."}),children:t.jsx(Vl,{specs:Te,onSave:he=>$e(he),onBack:()=>l(M.ADMIN)})})}),t.jsx(Je,{permission:"admin_categories",children:i===M.EDIT_CATEGORIES&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Categories..."}),children:t.jsx(Wl,{categories:ce,inventory:ae,specs:Te,categorySettings:a,onSave:(he,De,Pe)=>{Ie(he),$e(De),qn(Pe)},onBack:()=>l(M.ADMIN)})})}),i===M.CUSTOMIZE_DASHBOARD&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Layout Editor..."}),children:t.jsx(br,{context:"dashboard",layoutPrefs:n?.layoutPrefs,onSave:P,onBack:()=>l(M.DASHBOARD)})}),i===M.CUSTOMIZE_ITEM_DETAIL&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Layout Editor..."}),children:t.jsx(br,{context:"itemDetail",layoutPrefs:n?.layoutPrefs,onSave:P,onBack:()=>l(M.GEAR_DETAIL)})}),i===M.THEME_SELECTOR&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Themes..."}),children:t.jsx(Tl,{onBack:()=>l(M.DASHBOARD)})}),t.jsx(Je,{permission:"admin_users",children:i===M.USERS&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Users..."}),children:t.jsx(zl,{users:be,currentUserId:n?.id,onAddUser:()=>ut(ne.ADD_USER),onDeleteUser:he=>{const De=be.find(Pe=>Pe.id===he);se({title:"Delete User",message:"Are you sure you want to delete this user? This action cannot be undone.",confirmText:"Delete",variant:"danger",onConfirm:()=>{ke(Pe=>Pe.filter(xt=>xt.id!==he)),Kt({type:"user_deleted",description:`User deleted: ${De?.name||he}`,user:n?.name||"Unknown",itemId:he})}})},onBack:()=>l(M.ADMIN)})})}),t.jsx(Je,{permission:"reports",children:i===M.REPORTS&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Reports..."}),children:t.jsx(Nl,{inventory:ae,currentUser:n,onExport:()=>ut(ne.EXPORT),onBack:()=>l(M.ADMIN)})})}),t.jsx(Je,{permission:"admin_audit",children:i===M.AUDIT_LOG&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Audit Log..."}),children:t.jsx(Ol,{auditLog:Xe,onBack:()=>l(M.ADMIN)})})}),t.jsx(Je,{permission:"reports",children:i===M.MAINTENANCE_REPORT&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Maintenance Report..."}),children:t.jsx(ql,{inventory:ae,currentUser:n,onViewItem:Oe,onBack:()=>l(M.ADMIN)})})}),t.jsx(Je,{permission:"reports",children:i===M.INSURANCE_REPORT&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Insurance Report..."}),children:t.jsx($l,{inventory:ae,categories:ce,currentUser:n,onViewItem:Oe,onBack:()=>l(M.ADMIN)})})}),t.jsx(Je,{permission:"admin_locations",children:i===M.LOCATIONS_MANAGE&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Locations..."}),children:t.jsx(Al,{locations:xe,inventory:ae,onSave:he=>de(he),onClose:()=>l(M.ADMIN)})})}),t.jsx(Je,{permission:"admin_audit",children:i===M.CHANGE_LOG&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Change Log..."}),children:t.jsx(Ll,{changeLog:r,inventory:ae,packages:pe,onViewItem:Oe,onBack:()=>l(M.ADMIN)})})}),t.jsx(Je,{permission:"admin_roles",children:i===M.ROLES_MANAGE&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Roles..."}),children:t.jsx(Pl,{roles:re,users:be,onSaveRole:he=>{if(he.id)Se(De=>De.map(Pe=>Pe.id===he.id?he:Pe));else{const De={...he,id:`role_${wt()}`};Se(Pe=>[...Pe,De])}},onDeleteRole:he=>{Se(De=>De.filter(Pe=>Pe.id!==he)),ke(De=>De.map(Pe=>Pe.roleId===he?{...Pe,roleId:"role_user"}:Pe))},onAssignUsers:(he,De)=>{ke(Pe=>Pe.map(xt=>De.includes(xt.id)?{...xt,roleId:he}:xt))},onBack:()=>l(M.ADMIN)})})}),i===M.NOTIFICATIONS&&t.jsx(s.Suspense,{fallback:t.jsx(Ne,{message:"Loading Notifications..."}),children:t.jsx(Dl,{preferences:n?.notificationPreferences,isAdmin:n?.roleId==="role_admin",onSave:e.saveNotificationPreferences,onClose:()=>l(M.DASHBOARD)})})]})}const yr=s.lazy(()=>fe(()=>import("./ItemModal-Dum071tY.js").then(e=>e.I),__vite__mapDeps([22,1,23,24])).then(e=>({default:e.ItemModal}))),Hl=s.lazy(()=>fe(()=>import("./ReservationModal-BlRQRL7y.js"),__vite__mapDeps([25,1,23,3])).then(e=>({default:e.ReservationModal}))),Ul=s.lazy(()=>fe(()=>import("./QRModal-CUTgfIpN.js"),__vite__mapDeps([26,1,23,3])).then(e=>({default:e.QRModal}))),Gl=s.lazy(()=>fe(()=>import("./ExportModal-C5OyEm-d.js"),__vite__mapDeps([27,1,23,3])).then(e=>({default:e.ExportModal}))),Kl=s.lazy(()=>fe(()=>import("./ProfileModal-BMznNtty.js"),__vite__mapDeps([28,1,24,3]))),Yl=s.lazy(()=>fe(()=>import("./ImageSelectorModal-BOvdi9FA.js"),__vite__mapDeps([29,1,23,24,3])).then(e=>({default:e.ImageSelectorModal}))),Ql=s.lazy(()=>fe(()=>import("./QRScannerModal-C-DXLY0m.js"),__vite__mapDeps([30,1,23,3])).then(e=>({default:e.QRScannerModal}))),Xl=s.lazy(()=>fe(()=>import("./CSVImportModal-gEvdy65k.js"),__vite__mapDeps([31,1,23,3])).then(e=>({default:e.CSVImportModal}))),Zl=s.lazy(()=>fe(()=>import("./DatabaseExportModal-R544tEEn.js"),__vite__mapDeps([32,1,23,3])).then(e=>({default:e.DatabaseExportModal}))),Jl=s.lazy(()=>fe(()=>import("./CheckOutModal-YRNUavqZ.js"),__vite__mapDeps([33,1,23,3])).then(e=>({default:e.CheckOutModal}))),ec=s.lazy(()=>fe(()=>import("./CheckInModal-BSAjelF-.js"),__vite__mapDeps([34,1,23,3])).then(e=>({default:e.CheckInModal}))),tc=s.lazy(()=>fe(()=>import("./MaintenanceModal-MB5JX6M8.js"),__vite__mapDeps([35,1,23,3])).then(e=>({default:e.MaintenanceModal}))),nc=s.lazy(()=>fe(()=>import("./BulkModals-B5mYDQU5.js"),__vite__mapDeps([36,1,23,3])).then(e=>({default:e.BulkStatusModal}))),ac=s.lazy(()=>fe(()=>import("./BulkModals-B5mYDQU5.js"),__vite__mapDeps([36,1,23,3])).then(e=>({default:e.BulkLocationModal}))),rc=s.lazy(()=>fe(()=>import("./BulkModals-B5mYDQU5.js"),__vite__mapDeps([36,1,23,3])).then(e=>({default:e.BulkCategoryModal}))),ic=s.lazy(()=>fe(()=>import("./BulkModals-B5mYDQU5.js"),__vite__mapDeps([36,1,23,3])).then(e=>({default:e.BulkDeleteModal}))),sc=s.lazy(()=>fe(()=>import("./AddUserModal-BBUbTwHT.js"),__vite__mapDeps([37,1,23,3])).then(e=>({default:e.AddUserModal}))),oc=s.lazy(()=>fe(()=>import("./ImagePreviewModal-DEiRM48c.js"),__vite__mapDeps([38,1,3])));function lc({handlers:e,currentUser:n,categorySettings:a}){const{selectedItem:r,setSelectedItem:i,selectedReservationItem:l,setCurrentView:m}=Ma(),{activeModal:d,editingItemId:f,editingReservationId:h,setEditingReservationId:u,itemForm:g,setItemForm:p,reservationForm:k,setReservationForm:y,confirmDialog:x,handleConfirm:S,closeConfirm:j}=za(),{inventory:z,setInventory:A,packages:I,users:L,setUsers:R,specs:D,locations:_,categories:T,auditLog:w,packLists:v,clients:O}=In(),{createItem:$,updateItem:K,deleteItem:Y,saveReservation:J,selectImage:ie,exportData:_e,updateUserProfile:ve,addAuditLog:B,openModal:G,closeModal:q,checkoutItem:Q,checkinItemData:Z,openCheckoutModal:W,openCheckinModal:le,processCheckout:H,processCheckin:se,maintenanceItem:ae,editingMaintenanceRecord:V,setEditingMaintenanceRecord:pe,saveMaintenance:ge,bulkActionIds:be,setBulkActionIds:ke,applyBulkStatus:re,applyBulkLocation:Se,applyBulkCategory:Te,applyBulkDelete:$e}=e;return t.jsxs(t.Fragment,{children:[t.jsxs(s.Suspense,{fallback:t.jsx(Ws,{}),children:[d===ne.ADD_ITEM&&t.jsx(yr,{isEdit:!1,itemForm:g,setItemForm:p,specs:D,categories:T,categorySettings:a,locations:_,inventory:z,onSave:$,onClose:q}),d===ne.EDIT_ITEM&&t.jsx(yr,{isEdit:!0,itemId:f,itemForm:g,setItemForm:p,specs:D,categories:T,categorySettings:a,locations:_,inventory:z,onSave:K,onClose:q,onDelete:Y}),d===ne.ADD_RESERVATION&&t.jsx(Hl,{isEdit:!!h,reservationForm:k,setReservationForm:y,onSave:J,onClose:()=>{q(),u(null)},clients:O,inventory:z,item:h?r||l:null,editingReservationId:h},h||"new-reservation"),d===ne.QR_CODE&&r&&t.jsx(Ul,{item:r,onClose:q}),d===ne.EXPORT&&t.jsx(Gl,{onExport:_e,onClose:q,user:n}),d===ne.PROFILE&&t.jsx(Kl,{user:n,onSave:ve,onClose:q}),d===ne.IMAGE_SELECT&&t.jsx(Yl,{images:[],currentImage:r?.image,itemId:r?.id,onSelect:ie,onClose:q}),d===ne.IMAGE_PREVIEW&&r?.image&&t.jsx(oc,{imageSrc:r.image,itemName:r.name,onReplace:()=>{q(),setTimeout(()=>G(ne.IMAGE_SELECT),50)},onRemove:()=>{ie(null),q()},onClose:q}),d===ne.QR_SCANNER&&t.jsx(Ql,{inventory:z,onItemFound:xe=>{q(),i(xe),m(M.GEAR_DETAIL)},onQuickCheckout:xe=>{q(),W(xe.id)},onQuickCheckin:xe=>{q(),le(xe.id)},onClose:q}),d===ne.CSV_IMPORT&&t.jsx(Xl,{categories:T,specs:D,onImport:xe=>{const de=xe.map(ce=>({...ce,id:Tr(ce.category,z.map(Ie=>Ie.id)),image:null}));A(ce=>[...ce,...de]),B({type:"csv_import",description:`Imported ${de.length} items from CSV`,user:n?.name||"Unknown"})},onClose:q}),d===ne.DATABASE_EXPORT&&t.jsx(Zl,{inventory:z,packages:I,users:L,categories:T,specs:D,auditLog:w,packLists:v,onClose:q}),d===ne.CHECK_OUT&&Q&&t.jsx(Jl,{item:Q,users:L,currentUser:n,onCheckOut:H,onClose:q}),d===ne.CHECK_IN&&Z&&t.jsx(ec,{item:Z,currentUser:n,onCheckIn:se,onClose:q}),d===ne.MAINTENANCE&&ae&&t.jsx(tc,{item:ae,editingRecord:V,onSave:ge,onClose:()=>{q(),pe(null)}}),d===ne.ADD_USER&&t.jsx(sc,{existingEmails:L.map(xe=>xe.email.toLowerCase()),onSave:xe=>{R(de=>[...de,xe]),B({type:"user_created",description:`New user created: ${xe.name} (${xe.role?.name||xe.roleId||"User"})`,user:n?.name||"Unknown",itemId:xe.id}),q()},onClose:q}),d===ne.BULK_STATUS&&t.jsx(nc,{selectedIds:be,inventory:z,onApply:re,onClose:()=>{q(),ke([])}}),d===ne.BULK_LOCATION&&t.jsx(ac,{selectedIds:be,locations:_,onApply:Se,onClose:()=>{q(),ke([])}}),d===ne.BULK_CATEGORY&&t.jsx(rc,{selectedIds:be,categories:T,onApply:Te,onClose:()=>{q(),ke([])}}),d===ne.BULK_DELETE&&t.jsx(ic,{selectedIds:be,inventory:z,onConfirm:$e,onClose:()=>{q(),ke([])}})]}),t.jsx(Zr,{isOpen:x.isOpen,title:x.title,message:x.message,confirmText:x.confirmText,cancelText:x.cancelText,danger:x.variant==="danger",onConfirm:S,onCancel:j})]})}function cc(){const{currentTheme:e}=zr(),n=Ra(),a=In(),{inventory:r,setInventory:i,packages:l,setPackages:m,setUsers:d,roles:f,specs:h,categories:u,setAuditLog:g,setClients:p}=a,k=f?.length?f:Dr,y=h&&Object.keys(h).length?h:ss,x=u?.length?u:Ar,[S,j]=s.useState(is),[z,A]=s.useState([]),[I,L]=s.useState(!1),[R,D]=s.useState(null),[_,T]=s.useState({email:"",password:""});s.useEffect(()=>{n.isAuthenticated&&n.userProfile?(Kn("[App] User authenticated:",n.userProfile.email),L(!0),D({...n.userProfile,layoutPrefs:n.userProfile.layoutPrefs||nr})):!n.loading&&!n.isAuthenticated&&(L(!1),D(null))},[n.isAuthenticated,n.userProfile,n.loading]);const{sidebarOpen:w,setSidebarOpen:v,sidebarCollapsed:O,setSidebarCollapsed:$}=yo(),{currentView:K,setCurrentView:Y,selectedItem:J,setSelectedItem:ie,selectedPackage:_e,setSelectedPackage:ve,setSelectedPackList:B,selectedReservation:G,setSelectedReservation:q,selectedReservationItem:Q,setSelectedReservationItem:Z,setItemBackContext:W}=Ma(),{setSearchQuery:le,setCategoryFilter:H,setStatusFilter:se,setScheduleDate:ae,selectedIds:V}=ri(),{setActiveModal:pe,editingItemId:ge,setEditingItemId:be,editingReservationId:ke,setEditingReservationId:re,itemForm:Se,setItemForm:Te,reservationForm:$e,setReservationForm:xe,showConfirm:de}=za(),ce=s.useCallback(async oe=>{oe.preventDefault();const{user:ye,error:Ge}=await n.signIn(_.email,_.password);if(Ge){X("Login failed:",Ge);return}ye&&(L(!0),D({...ye,layoutPrefs:ye.layoutPrefs||nr}),a.refreshData&&a.refreshData())},[n,_,a]),Ie=s.useCallback(async()=>{await n.signOut(),L(!1),D(null)},[n]),Xe=s.useCallback(oe=>{D(ye=>({...ye,layoutPrefs:oe})),d(ye=>je(ye,R?.id,{layoutPrefs:oe}))},[R?.id]),et=s.useCallback((oe,ye)=>{D(Ge=>{if(!Ge)return Ge;const Be=structuredClone(Ge.layoutPrefs||{});return Be[oe]||(Be[oe]={sections:{}}),Be[oe].sections||(Be[oe].sections={}),Be[oe].sections[ye]||(Be[oe].sections[ye]={visible:!0,collapsed:!1,order:0}),Be[oe].sections[ye].collapsed=!Be[oe].sections[ye].collapsed,{...Ge,layoutPrefs:Be}})},[]),tt=s.useCallback((oe,ye=null)=>{const Ge=ms(r,oe);Ge&&(ie(Ge),i(Be=>je(Be,oe,Yt=>({...Yt,viewCount:(Yt.viewCount||0)+1}))),Y(M.GEAR_DETAIL),pe(null),W(ye),window.scrollTo(0,0),a.getItemWithDetails(oe).then(Be=>{Be&&(ie(Be),i(Yt=>je(Yt,oe,Be)))}).catch(Be=>X("Failed to load item details:",Be)))},[r,a]),nt=s.useCallback((oe,ye)=>{q(oe),Z(ye),Y(M.RESERVATION_DETAIL),window.scrollTo(0,0)},[]),at=s.useCallback((oe,ye)=>{H(oe),se(ye),le(""),Y(M.GEAR_LIST)},[]),Oe=s.useCallback(()=>{H("all"),se(Me.NEEDS_ATTENTION),le(""),Y(M.GEAR_LIST)},[]),Ue=s.useCallback(()=>{H("all"),se(Me.OVERDUE),le(""),Y(M.GEAR_LIST)},[]),Ce=s.useCallback(()=>{H("all"),se("low-stock"),le(""),Y(M.GEAR_LIST)},[]),rt=s.useCallback(()=>{Y(M.SCHEDULE)},[]),_t=s.useCallback(oe=>{if(pe(null),oe===M.GEAR_LIST&&(H("all"),se("all"),le("")),oe===M.PACKAGES&&ve(null),oe===M.PACK_LISTS&&B(null),oe===M.SCHEDULE){const ye=new Date;ae(`${ye.getFullYear()}-${String(ye.getMonth()+1).padStart(2,"0")}-${String(ye.getDate()).padStart(2,"0")}`)}Y(oe)},[ae]),It=s.useCallback(()=>Te(pn),[]),N=s.useCallback(()=>xe(gn),[]),C=s.useCallback(oe=>pe(oe),[]),P=s.useCallback(()=>pe(null),[]),ue=co({dataContext:a,setInventory:i,setSelectedItem:ie,setCurrentView:Y,setAuditLog:g,setChangeLog:A,showConfirm:de,inventory:r,selectedItem:J,currentUser:R,currentView:K,specs:y,editingItemId:ge,setEditingItemId:be,itemForm:Se,setItemForm:Te,resetItemForm:It,closeModal:P,openModal:C}),{createItem:Re,updateItem:Ke,deleteItem:qe,bulkActionIds:it,setBulkActionIds:Et,handleBulkAction:Wt,applyBulkStatus:Ft,applyBulkLocation:ct,applyBulkCategory:dt,applyBulkDelete:Ht,openEditItem:Dn,addChangeLog:Ut}=ue,st=s.useCallback(oe=>{a.addAuditLog(oe)},[a]),{checkoutItem:An,checkinItemData:Tn,openCheckoutModal:Dt,openCheckinModal:dn,processCheckout:Rn,processCheckin:Pn,maintenanceItem:Ln,setMaintenanceItem:Mn,editingMaintenanceRecord:zn,setEditingMaintenanceRecord:Gt,openMaintenanceModal:ta,saveMaintenance:Nn,updateMaintenanceStatus:On}=xo({inventory:r,setInventory:i,selectedItem:J,setSelectedItem:ie,dataContext:a,currentUser:R,openModal:C,closeModal:P,addAuditLog:st,addChangeLog:Ut}),{setItemAsKit:na,addItemsToKit:Kt,removeItemFromKit:qn,clearKitItems:$n,addRequiredAccessories:un,removeRequiredAccessory:ut,selectImage:mn}=So({inventory:r,setInventory:i,selectedItem:J,setSelectedItem:ie,dataContext:a,currentUser:R,closeModal:P,addAuditLog:st,addChangeLog:Ut}),{saveReservation:he,openEditReservation:De,deleteReservation:Pe}=ko({inventory:r,setInventory:i,selectedItem:J,setSelectedItem:ie,dataContext:a,openModal:C,closeModal:P,addChangeLog:Ut,addAuditLog:st,currentUser:R,reservationForm:$e,setReservationForm:xe,editingReservationId:ke,setEditingReservationId:re,selectedReservationItem:Q,selectedReservation:G,setSelectedReservation:q,setCurrentView:Y,resetReservationForm:N,navigateToReservation:nt,showConfirm:de}),{itemNoteHandlers:xt,reservationNoteHandlers:Oa,clientNoteHandlers:qa}=vo({selectedItem:J,setSelectedItem:ie,setInventory:i,selectedPackage:_e,setSelectedPackage:ve,selectedReservation:G,setSelectedReservation:q,selectedReservationItem:Q,setPackages:m,setClients:p,setAuditLog:g,dataContext:a,currentUser:R}),{addReminder:$a,completeReminder:Ba,uncompleteReminder:Va,deleteReminder:Wa}=wo({selectedItem:J,setSelectedItem:ie,setInventory:i,setAuditLog:g,dataContext:a,currentUser:R,showConfirm:de}),{addItemToPackage:Fa}=Co({packages:l,setPackages:m,inventory:r,selectedPackage:_e,setSelectedPackage:ve,setCurrentView:Y,categories:x,showConfirm:de,addChangeLog:Ut}),Bn=s.useCallback(async oe=>{d(ye=>je(ye,oe.id,oe)),R.id===oe.id&&D(oe);try{const{usersService:ye}=await fe(async()=>{const{usersService:Ge}=await Promise.resolve().then(()=>qs);return{usersService:Ge}},void 0);await ye.update(oe.id,{profile:oe.profile})}catch(ye){console.error("Failed to save profile:",ye)}st({type:"profile_updated",description:`${oe.name||"User"} updated their profile`})},[R,st]),Ha=s.useCallback(oe=>{const ye=V.length?r.filter(Ge=>V.includes(Ge.id)):r;if(oe.format==="csv"){const Ge=oe.columns.join(","),Be=ye.map(Ka=>oe.columns.map(Ya=>Ya==="value"?Ka.currentValue:Ka[Ya]||"").join(",")),Yt=Ge+`
`+Be.join(`
`),aa=document.createElement("a");aa.href="data:text/csv;charset=utf-8,"+encodeURIComponent(Yt),aa.download="inventory.csv",aa.click()}},[r,V]),Ua=s.useCallback(async oe=>{try{await a.saveNotificationPreferences(R.id,oe)}catch(ye){X("Failed to save notification preferences:",ye)}d(ye=>je(ye,R.id,{notificationPreferences:oe})),D(ye=>({...ye,notificationPreferences:oe}))},[a,R]),Ga=s.useCallback(oe=>{Gt(oe),Mn(J),C(ne.MAINTENANCE)},[J,Gt,Mn,C]),gi=s.useCallback(oe=>{v(!1),_t(oe)},[_t]),hi=s.useMemo(()=>({navigateToItem:tt,navigateToReservation:nt,navigateToFilteredSearch:at,navigateToAlerts:Oe,navigateToOverdue:Ue,navigateToLowStock:Ce,navigateToReservations:rt,handleToggleCollapse:et,handleSaveLayoutPrefs:Xe,createItem:Re,deleteItem:qe,openEditItem:Dn,handleBulkAction:Wt,openCheckoutModal:Dt,openCheckinModal:dn,openMaintenanceModal:ta,openMaintenanceEditModal:Ga,itemNoteHandlers:xt,clientNoteHandlers:qa,reservationNoteHandlers:Oa,addReminder:$a,completeReminder:Ba,uncompleteReminder:Va,deleteReminder:Wa,openEditReservation:De,deleteReservation:Pe,saveReservation:he,setItemAsKit:na,addItemsToKit:Kt,removeItemFromKit:qn,clearKitItems:$n,addRequiredAccessories:un,removeRequiredAccessory:ut,selectImage:mn,addItemToPackage:Fa,updateMaintenanceStatus:On,updateUserProfile:Bn,addAuditLog:st,setCategorySettings:j,resetItemForm:It,resetReservationForm:N,openModal:C,closeModal:P,saveNotificationPreferences:Ua}),[tt,nt,at,Oe,Ue,Ce,rt,et,Xe,Re,qe,Dn,Wt,Dt,dn,ta,Ga,xt,qa,Oa,$a,Ba,Va,Wa,De,Pe,he,na,Kt,qn,$n,un,ut,mn,Fa,On,Bn,st,j,It,N,C,P,Ua]),bi=s.useMemo(()=>({createItem:Re,updateItem:Ke,deleteItem:qe,saveReservation:he,selectImage:mn,exportData:Ha,updateUserProfile:Bn,addAuditLog:st,openModal:C,closeModal:P,checkoutItem:An,checkinItemData:Tn,openCheckoutModal:Dt,openCheckinModal:dn,processCheckout:Rn,processCheckin:Pn,maintenanceItem:Ln,editingMaintenanceRecord:zn,setEditingMaintenanceRecord:Gt,saveMaintenance:Nn,bulkActionIds:it,setBulkActionIds:Et,applyBulkStatus:Ft,applyBulkLocation:ct,applyBulkCategory:dt,applyBulkDelete:Ht}),[Re,Ke,qe,he,mn,Ha,Bn,st,C,P,An,Tn,Dt,dn,Rn,Pn,Ln,zn,Gt,Nn,it,Et,Ft,ct,dt,Ht]);return n.loading||a.loading?t.jsx(Vs,{message:"Loading SIMS..."}):I?t.jsx(_s,{currentUser:R,roles:k,children:t.jsxs("div",{className:`app-wrapper ${O?"sidebar-is-collapsed":""}`,style:{display:"flex",minHeight:"100vh",fontFamily:"system-ui, -apple-system, sans-serif",color:o.textPrimary,backgroundColor:o.bgDark,backgroundImage:e.backgroundImage||"none",backgroundRepeat:"repeat",backgroundAttachment:"fixed",cursor:e.cursor||"default"},children:[t.jsx(ti,{targetId:"main-content"}),t.jsx("div",{className:`sidebar-overlay ${w?"visible":""}`,onClick:()=>v(!1),"aria-hidden":"true"}),t.jsx(To,{currentView:K,setCurrentView:gi,user:R,onLogout:Ie,onOpenProfile:()=>{v(!1),C(ne.PROFILE)},onOpenScanner:()=>{v(!1),C(ne.QR_SCANNER)},onOpenImport:()=>{v(!1),C(ne.CSV_IMPORT)},onOpenExport:()=>{v(!1),C(ne.DATABASE_EXPORT)},isOpen:w,onClose:()=>v(!1),collapsed:O,onToggleCollapse:()=>$(!O)}),t.jsxs("main",{id:"main-content",className:`app-main ${O?"sidebar-collapsed":""}`,role:"main",tabIndex:-1,style:{flex:1,minHeight:"100vh",boxSizing:"border-box",display:"flex",flexDirection:"column",overflow:"auto"},children:[t.jsx(Ro,{currentUser:R,onOpenSidebar:()=>v(!0),onOpenModal:C,onSetView:Y,onLogout:Ie}),t.jsx(Fl,{handlers:hi,currentUser:R,categorySettings:S,changeLog:z})]}),t.jsx(lc,{handlers:bi,currentUser:R,categorySettings:S})]})}):t.jsx("div",{style:{minHeight:"100vh",backgroundColor:o.bgDark,backgroundImage:e.backgroundImage||"none",backgroundRepeat:"repeat",backgroundAttachment:"fixed",cursor:e.cursor||"default"},children:t.jsx(_o,{loginForm:_,setLoginForm:T,onLogin:ce,isLoading:n.loading,error:n.error?.message})})}const dc=s.createContext(null);function uc({children:e}){const n=lo(),a=s.useMemo(()=>n,[n.isOnline,n.installStatus,n.swStatus,n.updateAvailable,n.notificationsEnabled]);return t.jsx(dc.Provider,{value:a,children:e})}class mc extends Sa.Component{constructor(n){super(n),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,a){console.error("ErrorBoundary caught an error:",n,a),this.setState({errorInfo:a})}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:t.jsx("div",{style:vt.container,children:t.jsxs("div",{style:vt.card,children:[t.jsx("div",{style:vt.iconContainer,children:t.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"#ef4444",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("circle",{cx:"12",cy:"12",r:"10"}),t.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),t.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]})}),t.jsx("h1",{style:vt.title,children:"Something went wrong"}),t.jsx("p",{style:vt.message,children:"We're sorry, but something unexpected happened. Please try refreshing the page or contact support if the problem persists."}),!1,t.jsxs("div",{style:vt.actions,children:[t.jsx("button",{onClick:this.handleReset,style:vt.buttonSecondary,children:"Try Again"}),t.jsx("button",{onClick:()=>window.location.reload(),style:vt.buttonPrimary,children:"Reload Page"})]})]})}):this.props.children}}const vt={container:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",padding:"20px",backgroundColor:"#1a1a2e",fontFamily:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},card:{backgroundColor:"#16213e",borderRadius:"16px",padding:"40px",maxWidth:"500px",width:"100%",textAlign:"center",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)"},iconContainer:{marginBottom:"24px"},title:{color:"#ffffff",fontSize:"24px",fontWeight:"600",margin:"0 0 16px 0"},message:{color:"#94a3b8",fontSize:"16px",lineHeight:"1.6",margin:"0 0 24px 0"},actions:{display:"flex",gap:"12px",justifyContent:"center"},buttonPrimary:{backgroundColor:"#6366f1",color:"#ffffff",border:"none",borderRadius:"8px",padding:"12px 24px",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"background-color 0.2s"},buttonSecondary:{backgroundColor:"transparent",color:"#94a3b8",border:"1px solid #334155",borderRadius:"8px",padding:"12px 24px",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"}};window.addEventListener("error",e=>{(e.message?.includes("Failed to fetch dynamically imported module")||e.message?.includes("Importing a module script failed")||e.error?.name==="ChunkLoadError")&&(sessionStorage.getItem("chunk-reload")||(sessionStorage.setItem("chunk-reload","1"),window.location.reload()))});sessionStorage.removeItem("chunk-reload");Ui.createRoot(document.getElementById("root")).render(t.jsx(Sa.StrictMode,{children:t.jsx(mc,{children:t.jsx(js,{children:t.jsx(uc,{children:t.jsx(Br,{children:t.jsx(Xr,{children:t.jsx(bo,{children:t.jsx(ho,{children:t.jsx(go,{children:t.jsxs(fo,{children:[t.jsx(cc,{}),t.jsx(ts,{})]})})})})})})})})})}));export{jc as $,fa as A,Ae as B,lt as C,mi as D,eo as E,ee as F,Ca as G,os as H,ga as I,E as J,hn as K,kc as L,Zt as M,Qo as N,En as O,Ks as P,gc as Q,vc as R,qt as S,hc as T,Sc as U,M as V,Me as W,Rt as X,Lr as Y,wc as Z,fe as _,c as a,_c as a0,Cc as a1,zr as a2,Tr as a3,$s as a4,yn as a5,We as a6,xc as a7,qo as a8,ea as b,o as c,Le as d,X as e,Ve as f,Bt as g,Zn as h,F as i,t as j,Zr as k,wt as l,He as m,Ye as n,yc as o,bc as p,cn as q,hs as r,me as s,b as t,In as u,nr as v,te as w,pa as x,La as y,Fe as z};
//# sourceMappingURL=index-TtmnPN12.js.map
