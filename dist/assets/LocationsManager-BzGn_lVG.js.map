{"version":3,"file":"LocationsManager-BzGn_lVG.js","sources":["../../views/LocationsManager.jsx"],"sourcesContent":["// ============================================================================\n// Locations Manager Component\n// Manages hierarchical locations (Building > Room > Shelf)\n// ============================================================================\n\nimport React, { memo, useState, useMemo, useCallback } from 'react';\nimport { \n  Building2, DoorOpen, Archive, Layers, Box, MapPin, \n  Plus, Trash2, Edit, ChevronRight, ChevronDown, Save,\n  FolderTree, Search\n} from 'lucide-react';\nimport { LOCATION_TYPES } from '../constants.js';\nimport { colors, styles, spacing, borderRadius, typography, withOpacity} from '../theme.js';\nimport { flattenLocations } from '../utils.js';\nimport { Badge, Card, CardHeader, Button, SearchInput, PageHeader } from '../components/ui.jsx';\nimport { Select } from '../components/Select.jsx';\n\n// Get icon for location type\nconst getLocationIcon = (type) => {\n  switch (type) {\n    case 'building': return Building2;\n    case 'room': return DoorOpen;\n    case 'cabinet': return Archive;\n    case 'shelf': return Layers;\n    case 'case': return Box;\n    case 'external': return MapPin;\n    default: return FolderTree;\n  }\n};\n\n// Recursive location tree item component\nconst LocationTreeItem = memo(function LocationTreeItem({ \n  location, \n  level = 0, \n  onEdit, \n  onDelete, \n  onAddChild,\n  expandedIds,\n  toggleExpand,\n  itemCounts,\n}) {\n  const Icon = getLocationIcon(location.type);\n  const hasChildren = location.children && location.children.length > 0;\n  const isExpanded = expandedIds.has(location.id);\n  const itemCount = itemCounts[location.id] || 0;\n  \n  // Get full path for display\n  const getLocationPath = (loc) => {\n    return loc.name;\n  };\n\n  return (\n    <div>\n      <div\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          gap: spacing[2],\n          padding: `${spacing[2]}px ${spacing[3]}px`,\n          paddingLeft: spacing[3] + (level * 24),\n          background: level % 2 === 0 ? 'transparent' : `${withOpacity(colors.primary, 3)}`,\n          borderBottom: `1px solid ${colors.borderLight}`,\n        }}\n      >\n        {/* Expand/collapse button */}\n        <button\n          onClick={() => hasChildren && toggleExpand(location.id)}\n          style={{\n            background: 'none',\n            border: 'none',\n            color: hasChildren ? colors.textMuted : 'transparent',\n            cursor: hasChildren ? 'pointer' : 'default',\n            padding: 2,\n            width: 20,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n          }}\n        >\n          {hasChildren && (isExpanded ? <ChevronDown size={14} /> : <ChevronRight size={14} />)}\n        </button>\n\n        {/* Icon */}\n        <div\n          style={{\n            width: 28,\n            height: 28,\n            borderRadius: borderRadius.md,\n            background: `${withOpacity(colors.primary, 15)}`,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            color: colors.primary,\n          }}\n        >\n          <Icon size={14} />\n        </div>\n\n        {/* Name and type */}\n        <div style={{ flex: 1 }}>\n          <div style={{ \n            fontSize: typography.fontSize.sm, \n            color: colors.textPrimary,\n            fontWeight: typography.fontWeight.medium,\n          }}>\n            {location.name}\n          </div>\n          <div style={{ \n            fontSize: typography.fontSize.xs, \n            color: colors.textMuted,\n            display: 'flex',\n            alignItems: 'center',\n            gap: spacing[2],\n          }}>\n            <span style={{ textTransform: 'capitalize' }}>{location.type}</span>\n            {itemCount > 0 && (\n              <Badge text={`${itemCount} items`} color={colors.primary} size=\"xs\" />\n            )}\n          </div>\n        </div>\n\n        {/* Actions */}\n        <div style={{ display: 'flex', gap: spacing[1] }}>\n          <button\n            onClick={() => onAddChild(location)}\n            title=\"Add sub-location\"\n            style={{\n              ...styles.btnSec,\n              padding: spacing[1],\n              fontSize: typography.fontSize.xs,\n            }}\n          >\n            <Plus size={14} />\n          </button>\n          <button\n            onClick={() => onEdit(location)}\n            title=\"Edit location\"\n            style={{\n              ...styles.btnSec,\n              padding: spacing[1],\n              fontSize: typography.fontSize.xs,\n            }}\n          >\n            <Edit size={14} />\n          </button>\n          <button\n            onClick={() => onDelete(location)}\n            title={itemCount > 0 ? `Cannot delete - ${itemCount} items` : 'Delete location'}\n            disabled={itemCount > 0}\n            style={{\n              ...styles.btnSec,\n              padding: spacing[1],\n              color: itemCount > 0 ? colors.textMuted : colors.danger,\n              opacity: itemCount > 0 ? 0.5 : 1,\n              cursor: itemCount > 0 ? 'not-allowed' : 'pointer',\n            }}\n          >\n            <Trash2 size={14} />\n          </button>\n        </div>\n      </div>\n\n      {/* Children */}\n      {hasChildren && isExpanded && (\n        <div>\n          {location.children.map(child => (\n            <LocationTreeItem\n              key={child.id}\n              location={child}\n              level={level + 1}\n              onEdit={onEdit}\n              onDelete={onDelete}\n              onAddChild={onAddChild}\n              expandedIds={expandedIds}\n              toggleExpand={toggleExpand}\n              itemCounts={itemCounts}\n            />\n          ))}\n        </div>\n      )}\n    </div>\n  );\n});\n\n// Location edit form component\nconst LocationEditForm = memo(function LocationEditForm({ \n  location, \n  parentLocation,\n  isNew,\n  onSave, \n  onCancel \n}) {\n  const [name, setName] = useState(location?.name || '');\n  const [type, setType] = useState(location?.type || 'room');\n  const [error, setError] = useState('');\n\n  const handleSave = () => {\n    if (!name.trim()) {\n      setError('Name is required');\n      return;\n    }\n    onSave({\n      id: location?.id || `loc-${Date.now()}`,\n      name: name.trim(),\n      type,\n      children: location?.children || [],\n    });\n  };\n\n  return (\n    <div style={{\n      padding: spacing[4],\n      background: `${withOpacity(colors.primary, 5)}`,\n      borderRadius: borderRadius.lg,\n      border: `1px solid ${withOpacity(colors.primary, 20)}`,\n      marginBottom: spacing[4],\n    }}>\n      <h4 style={{ margin: `0 0 ${spacing[3]}px`, color: colors.textPrimary }}>\n        {isNew ? (parentLocation ? `Add Sub-location to \"${parentLocation.name}\"` : 'Add New Location') : 'Edit Location'}\n      </h4>\n      \n      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr', gap: spacing[3], marginBottom: spacing[3] }}>\n        <div>\n          <label style={{ ...styles.label, color: !name || error ? colors.danger : undefined }}>\n            Name <span style={{ color: colors.danger }}>*</span>\n          </label>\n          <input\n            type=\"text\"\n            value={name}\n            onChange={e => { setName(e.target.value); setError(''); }}\n            placeholder=\"e.g., Studio A, Main Floor, Shelf 1\"\n            style={{ ...styles.input, borderColor: !name || error ? colors.danger : colors.border }}\n            autoFocus\n          />\n          {error && <span style={{ color: colors.danger, fontSize: typography.fontSize.xs }}>{error}</span>}\n        </div>\n        <div>\n          <label style={styles.label}>Type</label>\n          <Select\n            value={type}\n            onChange={e => setType(e.target.value)}\n            options={LOCATION_TYPES}\n            aria-label=\"Location type\"\n          />\n        </div>\n      </div>\n\n      <div style={{ display: 'flex', gap: spacing[2], justifyContent: 'flex-end' }}>\n        <Button variant=\"secondary\" onClick={onCancel} size=\"sm\">Cancel</Button>\n        <Button onClick={handleSave} icon={Save} size=\"sm\">\n          {isNew ? 'Add Location' : 'Save Changes'}\n        </Button>\n      </div>\n    </div>\n  );\n});\n\n// Main Locations Manager component\nfunction LocationsManager({ locations, inventory, onSave, onClose }) {\n  const [editLocations, setEditLocations] = useState(structuredClone(locations));\n  const [expandedIds, setExpandedIds] = useState(new Set(['loc-studio-a', 'loc-studio-b']));\n  const [editingLocation, setEditingLocation] = useState(null);\n  const [parentForNew, setParentForNew] = useState(null);\n  const [isAddingNew, setIsAddingNew] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n\n  // Count items per location\n  const itemCounts = useMemo(() => {\n    const counts = {};\n    \n    // Helper to get all location IDs including nested\n    const getAllLocationIds = (loc) => {\n      const ids = [loc.id];\n      if (loc.children) {\n        loc.children.forEach(child => {\n          ids.push(...getAllLocationIds(child));\n        });\n      }\n      return ids;\n    };\n\n    // Build a map of location name to ID for fuzzy matching\n    const locationNameToId = {};\n    const processLocation = (loc, parentPath = '') => {\n      const fullPath = parentPath ? `${parentPath} - ${loc.name}` : loc.name;\n      locationNameToId[loc.name.toLowerCase()] = loc.id;\n      locationNameToId[fullPath.toLowerCase()] = loc.id;\n      counts[loc.id] = 0;\n      if (loc.children) {\n        loc.children.forEach(child => processLocation(child, fullPath));\n      }\n    };\n    editLocations.forEach(loc => processLocation(loc));\n\n    // Count items by matching location strings\n    inventory.forEach(item => {\n      if (item.location) {\n        const locLower = item.location.toLowerCase();\n        // Try exact match first\n        if (locationNameToId[locLower]) {\n          counts[locationNameToId[locLower]]++;\n        } else {\n          // Try partial match\n          Object.keys(locationNameToId).forEach(key => {\n            if (locLower.includes(key) || key.includes(locLower)) {\n              counts[locationNameToId[key]]++;\n            }\n          });\n        }\n      }\n    });\n\n    return counts;\n  }, [editLocations, inventory]);\n\n  // Toggle expand/collapse\n  const toggleExpand = useCallback((id) => {\n    setExpandedIds(prev => {\n      const next = new Set(prev);\n      if (next.has(id)) {\n        next.delete(id);\n      } else {\n        next.add(id);\n      }\n      return next;\n    });\n  }, []);\n\n  // Find location by ID in tree\n  const findLocationById = (locations, id) => {\n    for (const loc of locations) {\n      if (loc.id === id) return loc;\n      if (loc.children) {\n        const found = findLocationById(loc.children, id);\n        if (found) return found;\n      }\n    }\n    return null;\n  };\n\n  // Find parent of location\n  const findParentOfLocation = (locations, id, parent = null) => {\n    for (const loc of locations) {\n      if (loc.id === id) return parent;\n      if (loc.children) {\n        const found = findParentOfLocation(loc.children, id, loc);\n        if (found !== undefined) return found;\n      }\n    }\n    return undefined;\n  };\n\n  // Add child location\n  const handleAddChild = (parent) => {\n    setParentForNew(parent);\n    setEditingLocation(null);\n    setIsAddingNew(true);\n  };\n\n  // Add root location\n  const handleAddRoot = () => {\n    setParentForNew(null);\n    setEditingLocation(null);\n    setIsAddingNew(true);\n  };\n\n  // Edit location\n  const handleEdit = (location) => {\n    setEditingLocation(location);\n    setIsAddingNew(false);\n    setParentForNew(null);\n  };\n\n  // Delete location\n  const handleDelete = (location) => {\n    if ((itemCounts[location.id] || 0) > 0) return;\n\n    const deleteFromTree = (locations) => {\n      return locations.filter(loc => {\n        if (loc.id === location.id) return false;\n        if (loc.children) {\n          loc.children = deleteFromTree(loc.children);\n        }\n        return true;\n      });\n    };\n\n    setEditLocations(prev => deleteFromTree([...prev]));\n  };\n\n  // Save location (add or edit)\n  const handleSaveLocation = (updatedLocation) => {\n    if (isAddingNew) {\n      // Adding new location\n      if (parentForNew) {\n        // Add as child\n        const addToParent = (locations) => {\n          return locations.map(loc => {\n            if (loc.id === parentForNew.id) {\n              return {\n                ...loc,\n                children: [...(loc.children || []), updatedLocation],\n              };\n            }\n            if (loc.children) {\n              return { ...loc, children: addToParent(loc.children) };\n            }\n            return loc;\n          });\n        };\n        setEditLocations(prev => addToParent([...prev]));\n        // Expand parent to show new child\n        setExpandedIds(prev => new Set([...prev, parentForNew.id]));\n      } else {\n        // Add as root\n        setEditLocations(prev => [...prev, updatedLocation]);\n      }\n    } else {\n      // Editing existing\n      const updateInTree = (locations) => {\n        return locations.map(loc => {\n          if (loc.id === updatedLocation.id) {\n            return { ...updatedLocation, children: loc.children };\n          }\n          if (loc.children) {\n            return { ...loc, children: updateInTree(loc.children) };\n          }\n          return loc;\n        });\n      };\n      setEditLocations(prev => updateInTree([...prev]));\n    }\n\n    setEditingLocation(null);\n    setIsAddingNew(false);\n    setParentForNew(null);\n  };\n\n  // Cancel editing\n  const handleCancelEdit = () => {\n    setEditingLocation(null);\n    setIsAddingNew(false);\n    setParentForNew(null);\n  };\n\n  // Filter locations by search\n  const filteredLocations = useMemo(() => {\n    if (!searchQuery.trim()) return editLocations;\n\n    const query = searchQuery.toLowerCase();\n    \n    const filterTree = (locations) => {\n      return locations.reduce((acc, loc) => {\n        const nameMatches = loc.name.toLowerCase().includes(query);\n        const filteredChildren = loc.children ? filterTree(loc.children) : [];\n        \n        if (nameMatches || filteredChildren.length > 0) {\n          acc.push({\n            ...loc,\n            children: filteredChildren,\n          });\n        }\n        return acc;\n      }, []);\n    };\n\n    return filterTree(editLocations);\n  }, [editLocations, searchQuery]);\n\n  // Flatten locations for display using shared utility\n  const flattenedLocations = useMemo(() => {\n    return flattenLocations(editLocations);\n  }, [editLocations]);\n\n  // Save all changes\n  const handleSaveAll = () => {\n    onSave(editLocations);\n    if (onClose) onClose();\n  };\n\n  return (\n    <>\n      <PageHeader \n        title=\"Manage Locations\" \n        subtitle=\"Organize storage in a hierarchy\"\n        onBack={onClose}\n        backLabel=\"Back to Admin\"\n        action={<Button onClick={handleSaveAll} icon={Save}>Save Changes</Button>}\n      />\n\n      <p style={{ color: colors.textSecondary, marginBottom: spacing[4], fontSize: typography.fontSize.sm }}>\n        Organize your storage locations in a hierarchy (Building → Room → Shelf). Items can be assigned to any level.\n      </p>\n\n      {/* Edit form */}\n      {(isAddingNew || editingLocation) && (\n        <LocationEditForm\n          location={editingLocation}\n          parentLocation={parentForNew}\n          isNew={isAddingNew}\n          onSave={handleSaveLocation}\n          onCancel={handleCancelEdit}\n        />\n      )}\n\n      <div className=\"responsive-two-col\" style={{ display: 'grid', gap: spacing[4] }}>\n        {/* Main tree */}\n        <Card padding={false}>\n          <div style={{ \n            padding: spacing[3], \n            borderBottom: `1px solid ${colors.borderLight}`,\n            display: 'flex',\n            gap: spacing[3],\n            alignItems: 'center',\n          }}>\n            <SearchInput\n              value={searchQuery}\n              onChange={setSearchQuery}\n              placeholder=\"Search locations...\"\n              style={{ flex: 1 }}\n            />\n            <Button onClick={handleAddRoot} icon={Plus} size=\"sm\">\n              Add Location\n            </Button>\n          </div>\n\n          <div style={{ maxHeight: '60vh', overflowY: 'auto' }}>\n            {filteredLocations.length === 0 ? (\n              <div style={{ padding: spacing[6], textAlign: 'center', color: colors.textMuted }}>\n                <FolderTree size={32} style={{ marginBottom: spacing[2], opacity: 0.3 }} />\n                <p style={{ margin: 0 }}>\n                  {searchQuery ? 'No locations match your search' : 'No locations defined yet'}\n                </p>\n                {!searchQuery && (\n                  <Button variant=\"secondary\" onClick={handleAddRoot} icon={Plus} style={{ marginTop: spacing[3] }}>\n                    Add First Location\n                  </Button>\n                )}\n              </div>\n            ) : (\n              filteredLocations.map(location => (\n                <LocationTreeItem\n                  key={location.id}\n                  location={location}\n                  onEdit={handleEdit}\n                  onDelete={handleDelete}\n                  onAddChild={handleAddChild}\n                  expandedIds={expandedIds}\n                  toggleExpand={toggleExpand}\n                  itemCounts={itemCounts}\n                />\n              ))\n            )}\n          </div>\n        </Card>\n\n        {/* Sidebar with stats */}\n        <div style={{ display: 'flex', flexDirection: 'column', gap: spacing[4] }}>\n          <Card padding={false}>\n            <CardHeader title=\"Location Summary\" icon={FolderTree} />\n            <div style={{ padding: spacing[4] }}>\n              <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: spacing[2] }}>\n                <span style={{ color: colors.textSecondary }}>Total Locations</span>\n                <span style={{ color: colors.textPrimary, fontWeight: typography.fontWeight.medium }}>\n                  {flattenedLocations.length}\n                </span>\n              </div>\n              <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: spacing[2] }}>\n                <span style={{ color: colors.textSecondary }}>Root Locations</span>\n                <span style={{ color: colors.textPrimary, fontWeight: typography.fontWeight.medium }}>\n                  {editLocations.length}\n                </span>\n              </div>\n              <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                <span style={{ color: colors.textSecondary }}>Items Assigned</span>\n                <span style={{ color: colors.textPrimary, fontWeight: typography.fontWeight.medium }}>\n                  {inventory.filter(i => i.location).length}\n                </span>\n              </div>\n            </div>\n          </Card>\n\n          <Card padding={false}>\n            <CardHeader title=\"Location Types\" />\n            <div style={{ padding: spacing[4] }}>\n              {LOCATION_TYPES.map(type => {\n                const count = flattenedLocations.filter(l => l.type === type.value).length;\n                const Icon = getLocationIcon(type.value);\n                return (\n                  <div key={type.value} style={{ \n                    display: 'flex', \n                    alignItems: 'center', \n                    gap: spacing[2],\n                    marginBottom: spacing[2],\n                  }}>\n                    <Icon size={14} color={colors.textMuted} />\n                    <span style={{ flex: 1, color: colors.textSecondary, fontSize: typography.fontSize.sm }}>\n                      {type.label}\n                    </span>\n                    <span style={{ color: colors.textPrimary, fontSize: typography.fontSize.sm }}>\n                      {count}\n                    </span>\n                  </div>\n                );\n              })}\n            </div>\n          </Card>\n        </div>\n      </div>\n    </>\n  );\n}\n\nexport default memo(LocationsManager);\n"],"names":["getLocationIcon","type","Building2","DoorOpen","Archive","Layers","Box","MapPin","FolderTree","LocationTreeItem","memo","location","level","onEdit","onDelete","onAddChild","expandedIds","toggleExpand","itemCounts","Icon","hasChildren","isExpanded","itemCount","jsxs","spacing","withOpacity","colors","jsx","ChevronDown","ChevronRight","borderRadius","typography","Badge","styles","Plus","Edit","Trash2","child","LocationEditForm","parentLocation","isNew","onSave","onCancel","name","setName","useState","setType","error","setError","handleSave","e","Select","LOCATION_TYPES","Button","Save","LocationsManager","locations","inventory","onClose","editLocations","setEditLocations","setExpandedIds","editingLocation","setEditingLocation","parentForNew","setParentForNew","isAddingNew","setIsAddingNew","searchQuery","setSearchQuery","useMemo","counts","locationNameToId","processLocation","loc","parentPath","fullPath","item","locLower","key","useCallback","id","prev","next","handleAddChild","parent","handleAddRoot","handleEdit","handleDelete","deleteFromTree","handleSaveLocation","updatedLocation","addToParent","updateInTree","handleCancelEdit","filteredLocations","query","filterTree","acc","nameMatches","filteredChildren","flattenedLocations","flattenLocations","handleSaveAll","Fragment","PageHeader","Card","SearchInput","CardHeader","i","count","l","LocationsManager_default"],"mappings":"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"}